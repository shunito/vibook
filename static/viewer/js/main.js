!function(){return function t(e,n,i){function o(a,s){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){return o(e[a][1][t]||t)},c,c.exports,t,e,n,i)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}}()({1:[function(t,e,n){!function(t){var i=this||(0,eval)("this"),o=i.document,r=i.navigator,a=i.jQuery,s=i.JSON;a||"undefined"==typeof jQuery||(a=jQuery),function(t){"function"==typeof define&&define.amd?define(["exports","require"],t):t("object"==typeof n&&"object"==typeof e?e.exports||n:i.ko={})}(function(e,n){function l(t,e){return(null===t||typeof t in E)&&t===e}function u(e,n){var i;return function(){i||(i=w.a.setTimeout(function(){i=t,e()},n))}}function c(t,e){var n;return function(){clearTimeout(n),n=w.a.setTimeout(t,e)}}function h(t,e){e&&"change"!==e?"beforeChange"===e?this.oc(t):this.bb(t,e):this.pc(t)}function p(t,e){null!==e&&e.s&&e.s()}function f(t,e){var n=this.pd,i=n[x];i.qa||(this.Pb&&this.kb[e]?(n.tc(e,t,this.kb[e]),this.kb[e]=null,--this.Pb):i.F[e]||n.tc(e,t,i.G?{da:t}:n.Zc(t)),t.Ka&&t.fd())}var d,g,m,v,y,b,w=void 0!==e?e:{};w.b=function(t,e){for(var n=t.split("."),i=w,o=0;o<n.length-1;o++)i=i[n[o]];i[n[n.length-1]]=e},w.J=function(t,e,n){t[e]=n},w.version="3.5.0",w.b("version",w.version),w.options={deferUpdates:!1,useOnlyNativeEvents:!1,foreachHidesDestroyed:!1},w.a=function(){function e(t,e){for(var n in t)c.call(t,n)&&e(n,t[n])}function n(t,e){if(e)for(var n in e)c.call(e,n)&&(t[n]=e[n]);return t}function l(t,e){return t.__proto__=e,t}function u(t,e,n,i){var o=t[e].match(y)||[];w.a.C(n.match(y),function(t){w.a.Oa(o,t,i)}),t[e]=o.join(" ")}var c=Object.prototype.hasOwnProperty,h={__proto__:[]}instanceof Array,p="function"==typeof Symbol,f={},d={};f[r&&/Firefox\/2/i.test(r.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],f.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),e(f,function(t,e){if(e.length)for(var n=0,i=e.length;n<i;n++)d[e[n]]=t});var g,m={propertychange:!0},v=o&&function(){for(var e=3,n=o.createElement("div"),i=n.getElementsByTagName("i");n.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",i[0];);return 4<e?e:t}(),y=/\S+/g;return{Ic:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],C:function(t,e,n){for(var i=0,o=t.length;i<o;i++)e.call(n,t[i],i,t)},A:"function"==typeof Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e)}:function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},Lb:function(e,n,i){for(var o=0,r=e.length;o<r;o++)if(n.call(i,e[o],o,e))return e[o];return t},hb:function(t,e){var n=w.a.A(t,e);0<n?t.splice(n,1):0===n&&t.shift()},vc:function(t){var e=[];return t&&w.a.C(t,function(t){0>w.a.A(e,t)&&e.push(t)}),e},Mb:function(t,e,n){var i=[];if(t)for(var o=0,r=t.length;o<r;o++)i.push(e.call(n,t[o],o));return i},fb:function(t,e,n){var i=[];if(t)for(var o=0,r=t.length;o<r;o++)e.call(n,t[o],o)&&i.push(t[o]);return i},gb:function(t,e){if(e instanceof Array)t.push.apply(t,e);else for(var n=0,i=e.length;n<i;n++)t.push(e[n]);return t},Oa:function(t,e,n){var i=w.a.A(w.a.$b(t),e);0>i?n&&t.push(e):n||t.splice(i,1)},Ba:h,extend:n,setPrototypeOf:l,zb:h?l:n,O:e,Ha:function(t,e,n){if(!t)return t;var i,o={};for(i in t)c.call(t,i)&&(o[i]=e.call(n,t[i],i,t));return o},Sb:function(t){for(;t.firstChild;)w.removeNode(t.firstChild)},Xb:function(t){for(var e=((t=w.a.la(t))[0]&&t[0].ownerDocument||o).createElement("div"),n=0,i=t.length;n<i;n++)e.appendChild(w.na(t[n]));return e},Ca:function(t,e){for(var n=0,i=t.length,o=[];n<i;n++){var r=t[n].cloneNode(!0);o.push(e?w.na(r):r)}return o},ua:function(t,e){if(w.a.Sb(t),e)for(var n=0,i=e.length;n<i;n++)t.appendChild(e[n])},Wc:function(t,e){var n=t.nodeType?[t]:t;if(0<n.length){for(var i=n[0],o=i.parentNode,r=0,a=e.length;r<a;r++)o.insertBefore(e[r],i);for(r=0,a=n.length;r<a;r++)w.removeNode(n[r])}},Ua:function(t,e){if(t.length){for(e=8===e.nodeType&&e.parentNode||e;t.length&&t[0].parentNode!==e;)t.splice(0,1);for(;1<t.length&&t[t.length-1].parentNode!==e;)t.length--;if(1<t.length){var n=t[0],i=t[t.length-1];for(t.length=0;n!==i;)t.push(n),n=n.nextSibling;t.push(i)}}return t},Yc:function(t,e){7>v?t.setAttribute("selected",e):t.selected=e},Cb:function(e){return null===e||e===t?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Td:function(t,e){return t=t||"",!(e.length>t.length)&&t.substring(0,e.length)===e},ud:function(t,e){if(t===e)return!0;if(11===t.nodeType)return!1;if(e.contains)return e.contains(1!==t.nodeType?t.parentNode:t);if(e.compareDocumentPosition)return 16==(16&e.compareDocumentPosition(t));for(;t&&t!=e;)t=t.parentNode;return!!t},Rb:function(t){return w.a.ud(t,t.ownerDocument.documentElement)},jd:function(t){return!!w.a.Lb(t,w.a.Rb)},P:function(t){return t&&t.tagName&&t.tagName.toLowerCase()},zc:function(t){return w.onError?function(){try{return t.apply(this,arguments)}catch(t){throw w.onError&&w.onError(t),t}}:t},setTimeout:function(t,e){return setTimeout(w.a.zc(t),e)},Fc:function(t){setTimeout(function(){throw w.onError&&w.onError(t),t},0)},H:function(t,e,n){var i=w.a.zc(n);if(n=m[e],w.options.useOnlyNativeEvents||n||!a)if(n||"function"!=typeof t.addEventListener){if(void 0===t.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var o=function(e){i.call(t,e)},r="on"+e;t.attachEvent(r,o),w.a.I.za(t,function(){t.detachEvent(r,o)})}else t.addEventListener(e,i,!1);else g||(g="function"==typeof a(t).on?"on":"bind"),a(t)[g](e,i)},Fb:function(t,e){if(!t||!t.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var n;if(n=!("input"!==w.a.P(t)||!t.type||"click"!=e.toLowerCase())&&("checkbox"==(n=t.type)||"radio"==n),w.options.useOnlyNativeEvents||!a||n)if("function"==typeof o.createEvent){if("function"!=typeof t.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(n=o.createEvent(d[e]||"HTMLEvents")).initEvent(e,!0,!0,i,0,0,0,0,0,!1,!1,!1,!1,0,t),t.dispatchEvent(n)}else if(n&&t.click)t.click();else{if(void 0===t.fireEvent)throw Error("Browser doesn't support triggering events");t.fireEvent("on"+e)}else a(t).trigger(e)},c:function(t){return w.N(t)?t():t},$b:function(t){return w.N(t)?t.w():t},Eb:function(t,e,n){var i;e&&("object"==typeof t.classList?(i=t.classList[n?"add":"remove"],w.a.C(e.match(y),function(e){i.call(t.classList,e)})):"string"==typeof t.className.baseVal?u(t.className,"baseVal",e,n):u(t,"className",e,n))},Ab:function(e,n){var i=w.a.c(n);null!==i&&i!==t||(i="");var o=w.h.firstChild(e);!o||3!=o.nodeType||w.h.nextSibling(o)?w.h.ua(e,[e.ownerDocument.createTextNode(i)]):o.data=i,w.a.zd(e)},Xc:function(t,e){if(t.name=e,7>=v)try{var n=t.name.replace(/[&<>'"]/g,function(t){return"&#"+t.charCodeAt(0)+";"});t.mergeAttributes(o.createElement("<input name='"+n+"'/>"),!1)}catch(t){}},zd:function(t){9<=v&&(t=1==t.nodeType?t:t.parentNode).style&&(t.style.zoom=t.style.zoom)},vd:function(t){if(v){var e=t.style.width;t.style.width=0,t.style.width=e}},Od:function(t,e){t=w.a.c(t),e=w.a.c(e);for(var n=[],i=t;i<=e;i++)n.push(i);return n},la:function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(t[n]);return e},Da:function(t){return p?Symbol(t):t},Xd:6===v,Yd:7===v,W:v,Kc:function(t,e){for(var n=w.a.la(t.getElementsByTagName("input")).concat(w.a.la(t.getElementsByTagName("textarea"))),i="string"==typeof e?function(t){return t.name===e}:function(t){return e.test(t.name)},o=[],r=n.length-1;0<=r;r--)i(n[r])&&o.push(n[r]);return o},Md:function(t){return"string"==typeof t&&(t=w.a.Cb(t))?s&&s.parse?s.parse(t):new Function("return "+t)():null},fc:function(t,e,n){if(!s||!s.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return s.stringify(w.a.c(t),e,n)},Nd:function(t,n,i){var r=(i=i||{}).params||{},a=i.includeFields||this.Ic,s=t;if("object"==typeof t&&"form"===w.a.P(t)){s=t.action;for(var l=a.length-1;0<=l;l--)for(var u=w.a.Kc(t,a[l]),c=u.length-1;0<=c;c--)r[u[c].name]=u[c].value}n=w.a.c(n);var h=o.createElement("form");for(var p in h.style.display="none",h.action=s,h.method="post",n)(t=o.createElement("input")).type="hidden",t.name=p,t.value=w.a.fc(w.a.c(n[p])),h.appendChild(t);e(r,function(t,e){var n=o.createElement("input");n.type="hidden",n.name=t,n.value=e,h.appendChild(n)}),o.body.appendChild(h),i.submitter?i.submitter(h):h.submit(),setTimeout(function(){h.parentNode.removeChild(h)},0)}}}(),w.b("utils",w.a),w.b("utils.arrayForEach",w.a.C),w.b("utils.arrayFirst",w.a.Lb),w.b("utils.arrayFilter",w.a.fb),w.b("utils.arrayGetDistinctValues",w.a.vc),w.b("utils.arrayIndexOf",w.a.A),w.b("utils.arrayMap",w.a.Mb),w.b("utils.arrayPushAll",w.a.gb),w.b("utils.arrayRemoveItem",w.a.hb),w.b("utils.cloneNodes",w.a.Ca),w.b("utils.createSymbolOrString",w.a.Da),w.b("utils.extend",w.a.extend),w.b("utils.fieldsIncludedWithJsonPost",w.a.Ic),w.b("utils.getFormFields",w.a.Kc),w.b("utils.objectMap",w.a.Ha),w.b("utils.peekObservable",w.a.$b),w.b("utils.postJson",w.a.Nd),w.b("utils.parseJson",w.a.Md),w.b("utils.registerEventHandler",w.a.H),w.b("utils.stringifyJson",w.a.fc),w.b("utils.range",w.a.Od),w.b("utils.toggleDomNodeCssClass",w.a.Eb),w.b("utils.triggerEvent",w.a.Fb),w.b("utils.unwrapObservable",w.a.c),w.b("utils.objectForEach",w.a.O),w.b("utils.addOrRemoveItem",w.a.Oa),w.b("utils.setTextContent",w.a.Ab),w.b("unwrap",w.a.c),Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if(1===arguments.length)return function(){return e.apply(t,arguments)};var n=Array.prototype.slice.call(arguments,1);return function(){var i=n.slice(0);return i.push.apply(i,arguments),e.apply(t,i)}}),w.a.g=new function(){var e,n,i=0,o="__ko__"+(new Date).getTime(),r={};return w.a.W?(e=function(e,n){var a=e[o];if(!a||"null"===a||!r[a]){if(!n)return t;a=e[o]="ko"+i++,r[a]={}}return r[a]},n=function(t){var e=t[o];return!!e&&(delete r[e],t[o]=null,!0)}):(e=function(t,e){var n=t[o];return!n&&e&&(n=t[o]={}),n},n=function(t){return!!t[o]&&(delete t[o],!0)}),{get:function(t,n){var i=e(t,!1);return i&&i[n]},set:function(n,i,o){(n=e(n,o!==t))&&(n[i]=o)},Tb:function(t,n,i){return(t=e(t,!0))[n]||(t[n]=i)},clear:n,Z:function(){return i+++o}}},w.b("utils.domData",w.a.g),w.b("utils.domData.clear",w.a.g.clear),w.a.I=new function(){function e(e,n){var i=w.a.g.get(e,o);return i===t&&n&&(i=[],w.a.g.set(e,o,i)),i}function n(t){if(n=e(t,!1))for(var n=n.slice(0),o=0;o<n.length;o++)n[o](t);w.a.g.clear(t),w.a.I.cleanExternalData(t),s[t.nodeType]&&i(t.childNodes,!0)}function i(t,e){for(var i,o=[],r=0;r<t.length;r++)if((!e||8===t[r].nodeType)&&(n(o[o.length]=i=t[r]),t[r]!==i))for(;r--&&-1==w.a.A(o,t[r]););}var o=w.a.g.Z(),r={1:!0,8:!0,9:!0},s={1:!0,9:!0};return{za:function(t,n){if("function"!=typeof n)throw Error("Callback must be a function");e(t,!0).push(n)},xb:function(n,i){var r=e(n,!1);r&&(w.a.hb(r,i),0==r.length&&w.a.g.set(n,o,t))},na:function(t){return r[t.nodeType]&&(n(t),s[t.nodeType]&&i(t.getElementsByTagName("*"))),t},removeNode:function(t){w.na(t),t.parentNode&&t.parentNode.removeChild(t)},cleanExternalData:function(t){a&&"function"==typeof a.cleanData&&a.cleanData([t])}}},w.na=w.a.I.na,w.removeNode=w.a.I.removeNode,w.b("cleanNode",w.na),w.b("removeNode",w.removeNode),w.b("utils.domNodeDisposal",w.a.I),w.b("utils.domNodeDisposal.addDisposeCallback",w.a.I.za),w.b("utils.domNodeDisposal.removeDisposeCallback",w.a.I.xb),d=[0,"",""],y={thead:g=[1,"<table>","</table>"],tbody:g,tfoot:g,tr:[2,"<table><tbody>","</tbody></table>"],td:m=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:m,option:v=[1,"<select multiple='multiple'>","</select>"],optgroup:v},b=8>=w.a.W,w.a.ta=function(t,e){var n;if(a){if(a.parseHTML)n=a.parseHTML(t,e)||[];else if((n=a.clean([t],e))&&n[0]){for(var r=n[0];r.parentNode&&11!==r.parentNode.nodeType;)r=r.parentNode;r.parentNode&&r.parentNode.removeChild(r)}}else{(n=e)||(n=o),r=n.parentWindow||n.defaultView||i;var s,l=w.a.Cb(t).toLowerCase(),u=n.createElement("div");for(s=(l=l.match(/^(?:\x3c!--.*?--\x3e\s*?)*?<([a-z]+)[\s>]/))&&y[l[1]]||d,l=s[0],s="ignored<div>"+s[1]+t+s[2]+"</div>","function"==typeof r.innerShiv?u.appendChild(r.innerShiv(s)):(b&&n.body.appendChild(u),u.innerHTML=s,b&&u.parentNode.removeChild(u));l--;)u=u.lastChild;n=w.a.la(u.lastChild.childNodes)}return n},w.a.Ld=function(t,e){var n=w.a.ta(t,e);return n.length&&n[0].parentElement||w.a.Xb(n)},w.a.dc=function(e,n){if(w.a.Sb(e),null!==(n=w.a.c(n))&&n!==t)if("string"!=typeof n&&(n=n.toString()),a)a(e).html(n);else for(var i=w.a.ta(n,e.ownerDocument),o=0;o<i.length;o++)e.appendChild(i[o])},w.b("utils.parseHtmlFragment",w.a.ta),w.b("utils.setHtml",w.a.dc),w.aa=function(){var e={};return{Wb:function(t){if("function"!=typeof t)throw Error("You can only pass a function to ko.memoization.memoize()");var n=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return e[n]=t,"\x3c!--[ko_memo:"+n+"]--\x3e"},ad:function(n,i){var o=e[n];if(o===t)throw Error("Couldn't find any memo with ID "+n+". Perhaps it's already been unmemoized.");try{return o.apply(null,i||[]),!0}finally{delete e[n]}},bd:function(t,e){var n=[];!function t(e,n){if(e)if(8==e.nodeType)null!=(i=w.aa.Tc(e.nodeValue))&&n.push({sd:e,Jd:i});else if(1==e.nodeType)for(var i=0,o=e.childNodes,r=o.length;i<r;i++)t(o[i],n)}(t,n);for(var i=0,o=n.length;i<o;i++){var r=n[i].sd,a=[r];e&&w.a.gb(a,e),w.aa.ad(n[i].Jd,a),r.nodeValue="",r.parentNode&&r.parentNode.removeChild(r)}},Tc:function(t){return(t=t.match(/^\[ko_memo\:(.*?)\]$/))?t[1]:null}}}(),w.b("memoization",w.aa),w.b("memoization.memoize",w.aa.Wb),w.b("memoization.unmemoize",w.aa.ad),w.b("memoization.parseMemoText",w.aa.Tc),w.b("memoization.unmemoizeDomNodeAndDescendants",w.aa.bd),w.ma=function(){function t(){if(r)for(var t,e=r,i=0;s<r;)if(t=n[s++]){if(s>e){if(5e3<=++i){s=r,w.a.Fc(Error("'Too much recursion' after processing "+i+" task groups."));break}e=r}try{t()}catch(t){w.a.Fc(t)}}}function e(){t(),s=r=n.length=0}var n=[],r=0,a=1,s=0;return{scheduler:i.MutationObserver?function(t){var e=o.createElement("div");return new MutationObserver(t).observe(e,{attributes:!0}),function(){e.classList.toggle("foo")}}(e):o&&"onreadystatechange"in o.createElement("script")?function(t){var e=o.createElement("script");e.onreadystatechange=function(){e.onreadystatechange=null,o.documentElement.removeChild(e),e=null,t()},o.documentElement.appendChild(e)}:function(t){setTimeout(t,0)},yb:function(t){return r||w.ma.scheduler(e),n[r++]=t,a++},cancel:function(t){(t-=a-r)>=s&&t<r&&(n[t]=null)},resetForTesting:function(){var t=r-s;return s=r=n.length=0,t},Rd:t}}(),w.b("tasks",w.ma),w.b("tasks.schedule",w.ma.yb),w.b("tasks.runEarly",w.ma.Rd),w.Ta={throttle:function(t,e){t.throttleEvaluation=e;var n=null;return w.$({read:t,write:function(i){clearTimeout(n),n=w.a.setTimeout(function(){t(i)},e)}})},rateLimit:function(t,e){var n,i,o;"number"==typeof e?n=e:(n=e.timeout,i=e.method),t.Hb=!1,o="function"==typeof i?i:"notifyWhenChangesStop"==i?c:u,t.tb(function(t){return o(t,n,e)})},deferred:function(e,n){if(!0!==n)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");e.Hb||(e.Hb=!0,e.tb(function(n){var i,o=!1;return function(){if(!o){w.ma.cancel(i),i=w.ma.yb(n);try{o=!0,e.notifySubscribers(t,"dirty")}finally{o=!1}}}}))},notify:function(t,e){t.equalityComparer="always"==e?null:l}};var E={undefined:1,boolean:1,number:1,string:1};w.b("extenders",w.Ta),w.gc=function(t,e,n){this.da=t,this.kc=e,this.lc=n,this.Ib=!1,this.ab=this.Jb=null,w.J(this,"dispose",this.s),w.J(this,"disposeWhenNodeIsRemoved",this.l)},w.gc.prototype.s=function(){this.Ib||(this.ab&&w.a.I.xb(this.Jb,this.ab),this.Ib=!0,this.lc(),this.da=this.kc=this.lc=this.Jb=this.ab=null)},w.gc.prototype.l=function(t){this.Jb=t,w.a.I.za(t,this.ab=this.s.bind(this))},w.R=function(){w.a.zb(this,S),S.ob(this)};var S={ob:function(t){t.S={change:[]},t.rc=1},subscribe:function(t,e,n){var i=this;n=n||"change";var o=new w.gc(i,e?t.bind(e):t,function(){w.a.hb(i.S[n],o),i.cb&&i.cb(n)});return i.Qa&&i.Qa(n),i.S[n]||(i.S[n]=[]),i.S[n].push(o),o},notifySubscribers:function(t,e){if("change"===(e=e||"change")&&this.Gb(),this.Wa(e)){var n="change"===e&&this.dd||this.S[e].slice(0);try{w.v.wc();for(var i,o=0;i=n[o];++o)i.Ib||i.kc(t)}finally{w.v.end()}}},mb:function(){return this.rc},Cd:function(t){return this.mb()!==t},Gb:function(){++this.rc},tb:function(t){var e,n,i,o,r,a=this,s=w.N(a);a.bb||(a.bb=a.notifySubscribers,a.notifySubscribers=h);var l=t(function(){a.Ka=!1,s&&o===a&&(o=a.mc?a.mc():a());var t=n||r&&a.qb(i,o);r=n=e=!1,t&&a.bb(i=o)});a.pc=function(t,n){n&&a.Ka||(r=!n),a.dd=a.S.change.slice(0),a.Ka=e=!0,o=t,l()},a.oc=function(t){e||(i=t,a.bb(t,"beforeChange"))},a.qc=function(){r=!0},a.fd=function(){a.qb(i,a.w(!0))&&(n=!0)}},Wa:function(t){return this.S[t]&&this.S[t].length},Ad:function(t){if(t)return this.S[t]&&this.S[t].length||0;var e=0;return w.a.O(this.S,function(t,n){"dirty"!==t&&(e+=n.length)}),e},qb:function(t,e){return!this.equalityComparer||!this.equalityComparer(t,e)},toString:function(){return"[object Object]"},extend:function(t){var e=this;return t&&w.a.O(t,function(t,n){var i=w.Ta[t];"function"==typeof i&&(e=i(e,n)||e)}),e}};w.J(S,"init",S.ob),w.J(S,"subscribe",S.subscribe),w.J(S,"extend",S.extend),w.J(S,"getSubscriptionsCount",S.Ad),w.a.Ba&&w.a.setPrototypeOf(S,Function.prototype),w.R.fn=S,w.Pc=function(t){return null!=t&&"function"==typeof t.subscribe&&"function"==typeof t.notifySubscribers},w.b("subscribable",w.R),w.b("isSubscribable",w.Pc),w.U=w.v=function(){function t(t){i.push(n),n=t}function e(){n=i.pop()}var n,i=[],o=0;return{wc:t,end:e,ac:function(t){if(n){if(!w.Pc(t))throw Error("Only subscribable things can act as dependencies");n.nd.call(n.od,t,t.ed||(t.ed=++o))}},K:function(n,i,o){try{return t(),n.apply(i,o||[])}finally{e()}},pa:function(){if(n)return n.o.pa()},Va:function(){if(n)return n.o.Va()},rb:function(){if(n)return n.rb},o:function(){if(n)return n.o}}}(),w.b("computedContext",w.U),w.b("computedContext.getDependenciesCount",w.U.pa),w.b("computedContext.getDependencies",w.U.Va),w.b("computedContext.isInitial",w.U.rb),w.b("computedContext.registerDependency",w.U.ac),w.b("ignoreDependencies",w.Wd=w.v.K);var N=w.a.Da("_latestValue");w.sa=function(t){function e(){return 0<arguments.length?(e.qb(e[N],arguments[0])&&(e.xa(),e[N]=arguments[0],e.wa()),this):(w.v.ac(e),e[N])}return e[N]=t,w.a.Ba||w.a.extend(e,w.R.fn),w.R.fn.ob(e),w.a.zb(e,C),w.options.deferUpdates&&w.Ta.deferred(e,!0),e};var C={equalityComparer:l,w:function(){return this[N]},wa:function(){this.notifySubscribers(this[N],"spectate"),this.notifySubscribers(this[N])},xa:function(){this.notifySubscribers(this[N],"beforeChange")}};w.a.Ba&&w.a.setPrototypeOf(C,w.R.fn);var T=w.sa.Na="__ko_proto__";C[T]=w.sa,w.N=function(t){if((t="function"==typeof t&&t[T])&&t!==C[T]&&t!==w.o.fn[T])throw Error("Invalid object that looks like an observable; possibly from another Knockout instance");return!!t},w.Ya=function(t){return"function"==typeof t&&(t[T]===C[T]||t[T]===w.o.fn[T]&&t.Mc)},w.b("observable",w.sa),w.b("isObservable",w.N),w.b("isWriteableObservable",w.Ya),w.b("isWritableObservable",w.Ya),w.b("observable.fn",C),w.J(C,"peek",C.w),w.J(C,"valueHasMutated",C.wa),w.J(C,"valueWillMutate",C.xa),w.Ia=function(t){if("object"!=typeof(t=t||[])||!("length"in t))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return t=w.sa(t),w.a.zb(t,w.Ia.fn),t.extend({trackArrayChanges:!0})},w.Ia.fn={remove:function(t){for(var e=this.w(),n=[],i="function"!=typeof t||w.N(t)?function(e){return e===t}:t,o=0;o<e.length;o++){var r=e[o];if(i(r)){if(0===n.length&&this.xa(),e[o]!==r)throw Error("Array modified during remove; cannot remove item");n.push(r),e.splice(o,1),o--}}return n.length&&this.wa(),n},removeAll:function(e){if(e===t){var n=this.w(),i=n.slice(0);return this.xa(),n.splice(0,n.length),this.wa(),i}return e?this.remove(function(t){return 0<=w.a.A(e,t)}):[]},destroy:function(t){var e=this.w(),n="function"!=typeof t||w.N(t)?function(e){return e===t}:t;this.xa();for(var i=e.length-1;0<=i;i--){var o=e[i];n(o)&&(o._destroy=!0)}this.wa()},destroyAll:function(e){return e===t?this.destroy(function(){return!0}):e?this.destroy(function(t){return 0<=w.a.A(e,t)}):[]},indexOf:function(t){var e=this();return w.a.A(e,t)},replace:function(t,e){var n=this.indexOf(t);0<=n&&(this.xa(),this.w()[n]=e,this.wa())},sorted:function(t){var e=this().slice(0);return t?e.sort(t):e.sort()},reversed:function(){return this().slice(0).reverse()}},w.a.Ba&&w.a.setPrototypeOf(w.Ia.fn,w.sa.fn),w.a.C("pop push reverse shift sort splice unshift".split(" "),function(t){w.Ia.fn[t]=function(){var e=this.w();this.xa(),this.yc(e,t,arguments);var n=e[t].apply(e,arguments);return this.wa(),n===e?this:n}}),w.a.C(["slice"],function(t){w.Ia.fn[t]=function(){var e=this();return e[t].apply(e,arguments)}}),w.Oc=function(t){return w.N(t)&&"function"==typeof t.remove&&"function"==typeof t.push},w.b("observableArray",w.Ia),w.b("isObservableArray",w.Oc),w.Ta.trackArrayChanges=function(e,n){function i(){function t(){if(u){var t,n=[].concat(e.w()||[]);e.Wa("arrayChange")&&((!l||1<u)&&(l=w.a.Ob(r,n,e.Nb)),t=l),r=n,l=null,u=0,t&&t.length&&e.notifySubscribers(t,"arrayChange")}}s?t():(s=!0,a=e.notifySubscribers,e.notifySubscribers=function(t,e){return e&&"change"!==e||++u,a.apply(this,arguments)},r=[].concat(e.w()||[]),l=null,o=e.subscribe(t))}if(e.Nb={},n&&"object"==typeof n&&w.a.extend(e.Nb,n),e.Nb.sparse=!0,!e.yc){var o,r,a,s=!1,l=null,u=0,c=e.Qa,h=e.cb;e.Qa=function(t){c&&c.call(e,t),"arrayChange"===t&&i()},e.cb=function(n){h&&h.call(e,n),"arrayChange"!==n||e.Wa("arrayChange")||(a&&(e.notifySubscribers=a,a=t),o&&o.s(),o=null,s=!1,r=t)},e.yc=function(t,e,n){function i(t,e,n){return o[o.length]={status:t,value:e,index:n}}if(s&&!u){var o=[],r=t.length,a=n.length,c=0;switch(e){case"push":c=r;case"unshift":for(e=0;e<a;e++)i("added",n[e],c+e);break;case"pop":c=r-1;case"shift":r&&i("deleted",t[c],c);break;case"splice":e=Math.min(Math.max(0,0>n[0]?r+n[0]:n[0]),r),r=1===a?r:Math.min(e+(n[1]||0),r),a=e+a-2,c=Math.max(r,a);for(var h=[],p=[],f=2;e<c;++e,++f)e<r&&p.push(i("deleted",t[e],e)),e<a&&h.push(i("added",n[f],e));w.a.Jc(p,h);break;default:return}l=o}}}};var x=w.a.Da("_state");w.o=w.$=function(e,n,i){function o(){if(0<arguments.length){if("function"!=typeof r)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return r.apply(a.lb,arguments),this}return a.qa||w.v.ac(o),(a.ka||a.G&&o.Xa())&&o.ha(),a.X}if("object"==typeof e?i=e:(i=i||{},e&&(i.read=e)),"function"!=typeof i.read)throw Error("Pass a function that returns the value of the ko.computed");var r=i.write,a={X:t,ra:!0,ka:!0,pb:!1,hc:!1,qa:!1,vb:!1,G:!1,Vc:i.read,lb:n||i.owner,l:i.disposeWhenNodeIsRemoved||i.l||null,Sa:i.disposeWhen||i.Sa,Qb:null,F:{},V:0,Hc:null};return o[x]=a,o.Mc="function"==typeof r,w.a.Ba||w.a.extend(o,w.R.fn),w.R.fn.ob(o),w.a.zb(o,I),i.pure?(a.vb=!0,a.G=!0,w.a.extend(o,P)):i.deferEvaluation&&w.a.extend(o,O),w.options.deferUpdates&&w.Ta.deferred(o,!0),a.l&&(a.hc=!0,a.l.nodeType||(a.l=null)),a.G||i.deferEvaluation||o.ha(),a.l&&o.ja()&&w.a.I.za(a.l,a.Qb=function(){o.s()}),o};var I={equalityComparer:l,pa:function(){return this[x].V},Va:function(){var t=[];return w.a.O(this[x].F,function(e,n){t[n.La]=n.da}),t},Ub:function(t){if(!this[x].V)return!1;var e=this.Va();return-1!==w.a.A(e,t)||!!w.a.Lb(e,function(e){return e.Ub&&e.Ub(t)})},tc:function(t,e,n){if(this[x].vb&&e===this)throw Error("A 'pure' computed must not be called recursively");this[x].F[t]=n,n.La=this[x].V++,n.Ma=e.mb()},Xa:function(){var t,e,n=this[x].F;for(t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&(e=n[t],this.Ja&&e.da.Ka||e.da.Cd(e.Ma)))return!0},Id:function(){this.Ja&&!this[x].pb&&this.Ja(!1)},ja:function(){var t=this[x];return t.ka||0<t.V},Qd:function(){this.Ka?this[x].ka&&(this[x].ra=!0):this.Gc()},Zc:function(t){if(t.Hb){var e=t.subscribe(this.Id,this,"dirty"),n=t.subscribe(this.Qd,this);return{da:t,s:function(){e.s(),n.s()}}}return t.subscribe(this.Gc,this)},Gc:function(){var t=this,e=t.throttleEvaluation;e&&0<=e?(clearTimeout(this[x].Hc),this[x].Hc=w.a.setTimeout(function(){t.ha(!0)},e)):t.Ja?t.Ja(!0):t.ha(!0)},ha:function(t){var e=this[x],n=e.Sa,i=!1;if(!e.pb&&!e.qa){if(e.l&&!w.a.Rb(e.l)||n&&n()){if(!e.hc)return void this.s()}else e.hc=!1;e.pb=!0;try{i=this.yd(t)}finally{e.pb=!1}return i}},yd:function(e){var n=this[x],i=!1,o=n.vb?t:!n.V;i={pd:this,kb:n.F,Pb:n.V},w.v.wc({od:i,nd:f,o:this,rb:o}),n.F={},n.V=0;var r=this.xd(n,i);return n.V?i=this.qb(n.X,r):(this.s(),i=!0),i&&(n.G?this.Gb():this.notifySubscribers(n.X,"beforeChange"),n.X=r,this.notifySubscribers(n.X,"spectate"),!n.G&&e&&this.notifySubscribers(n.X),this.qc&&this.qc()),o&&this.notifySubscribers(n.X,"awake"),i},xd:function(t,e){try{var n=t.Vc;return t.lb?n.call(t.lb):n()}finally{w.v.end(),e.Pb&&!t.G&&w.a.O(e.kb,p),t.ra=t.ka=!1}},w:function(t){var e=this[x];return(e.ka&&(t||!e.V)||e.G&&this.Xa())&&this.ha(),e.X},tb:function(t){w.R.fn.tb.call(this,t),this.mc=function(){return this[x].G||(this[x].ra?this.ha():this[x].ka=!1),this[x].X},this.Ja=function(t){this.oc(this[x].X),this[x].ka=!0,t&&(this[x].ra=!0),this.pc(this,!t)}},s:function(){var e=this[x];!e.G&&e.F&&w.a.O(e.F,function(t,e){e.s&&e.s()}),e.l&&e.Qb&&w.a.I.xb(e.l,e.Qb),e.F=t,e.V=0,e.qa=!0,e.ra=!1,e.ka=!1,e.G=!1,e.l=t,e.Sa=t,e.Vc=t,this.Mc||(e.lb=t)}},P={Qa:function(t){var e=this,n=e[x];if(!n.qa&&n.G&&"change"==t){if(n.G=!1,n.ra||e.Xa())n.F=null,n.V=0,e.ha()&&e.Gb();else{var i=[];w.a.O(n.F,function(t,e){i[e.La]=t}),w.a.C(i,function(t,i){var o=n.F[t],r=e.Zc(o.da);r.La=i,r.Ma=o.Ma,n.F[t]=r}),e.Xa()&&e.ha()&&e.Gb()}n.qa||e.notifySubscribers(n.X,"awake")}},cb:function(e){var n=this[x];n.qa||"change"!=e||this.Wa("change")||(w.a.O(n.F,function(t,e){e.s&&(n.F[t]={da:e.da,La:e.La,Ma:e.Ma},e.s())}),n.G=!0,this.notifySubscribers(t,"asleep"))},mb:function(){var t=this[x];return t.G&&(t.ra||this.Xa())&&this.ha(),w.R.fn.mb.call(this)}},O={Qa:function(t){"change"!=t&&"beforeChange"!=t||this.w()}};w.a.Ba&&w.a.setPrototypeOf(I,w.R.fn);var k=w.sa.Na;I[k]=w.o,w.Nc=function(t){return"function"==typeof t&&t[k]===I[k]},w.Ed=function(t){return w.Nc(t)&&t[x]&&t[x].vb},w.b("computed",w.o),w.b("dependentObservable",w.o),w.b("isComputed",w.Nc),w.b("isPureComputed",w.Ed),w.b("computed.fn",I),w.J(I,"peek",I.w),w.J(I,"dispose",I.s),w.J(I,"isActive",I.ja),w.J(I,"getDependenciesCount",I.pa),w.J(I,"getDependencies",I.Va),w.wb=function(t,e){return"function"==typeof t?w.o(t,e,{pure:!0}):((t=w.a.extend({},t)).pure=!0,w.o(t,e))},w.b("pureComputed",w.wb),function(){function e(i,o,r){if(r=r||new n,"object"!=typeof(i=o(i))||null===i||i===t||i instanceof RegExp||i instanceof Date||i instanceof String||i instanceof Number||i instanceof Boolean)return i;var a=i instanceof Array?[]:{};return r.save(i,a),function(t,e){if(t instanceof Array){for(var n=0;n<t.length;n++)e(n);"function"==typeof t.toJSON&&e("toJSON")}else for(n in t)e(n)}(i,function(n){var s=o(i[n]);switch(typeof s){case"boolean":case"number":case"string":case"function":a[n]=s;break;case"object":case"undefined":var l=r.get(s);a[n]=l!==t?l:e(s,o,r)}}),a}function n(){this.keys=[],this.values=[]}w.$c=function(t){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return e(t,function(t){for(var e=0;w.N(t)&&10>e;e++)t=t();return t})},w.toJSON=function(t,e,n){return t=w.$c(t),w.a.fc(t,e,n)},n.prototype={constructor:n,save:function(t,e){var n=w.a.A(this.keys,t);0<=n?this.values[n]=e:(this.keys.push(t),this.values.push(e))},get:function(e){return 0<=(e=w.a.A(this.keys,e))?this.values[e]:t}}}(),w.b("toJS",w.$c),w.b("toJSON",w.toJSON),w.Vd=function(t,e,n){function i(e){var i=w.wb(t,n).extend({Ga:"always"}),o=i.subscribe(function(t){t&&(o.s(),e(t))});return i.notifySubscribers(i.w()),o}return"function"!=typeof Promise||e?i(e.bind(n)):new Promise(i)},w.b("when",w.Vd),w.u={L:function(e){switch(w.a.P(e)){case"option":return!0===e.__ko__hasDomDataOptionValue__?w.a.g.get(e,w.f.options.Yb):7>=w.a.W?e.getAttributeNode("value")&&e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return 0<=e.selectedIndex?w.u.L(e.options[e.selectedIndex]):t;default:return e.value}},ya:function(e,n,i){switch(w.a.P(e)){case"option":"string"==typeof n?(w.a.g.set(e,w.f.options.Yb,t),"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__,e.value=n):(w.a.g.set(e,w.f.options.Yb,n),e.__ko__hasDomDataOptionValue__=!0,e.value="number"==typeof n?n:"");break;case"select":""!==n&&null!==n||(n=t);for(var o,r=-1,a=0,s=e.options.length;a<s;++a)if((o=w.u.L(e.options[a]))==n||""===o&&n===t){r=a;break}(i||0<=r||n===t&&1<e.size)&&(e.selectedIndex=r,6===w.a.W&&w.a.setTimeout(function(){e.selectedIndex=r},0));break;default:null!==n&&n!==t||(n=""),e.value=n}}},w.b("selectExtensions",w.u),w.b("selectExtensions.readValue",w.u.L),w.b("selectExtensions.writeValue",w.u.ya),w.m=function(){function t(t){123===(t=w.a.Cb(t)).charCodeAt(0)&&(t=t.slice(1,-1));var e,n=[],a=(t+="\n,").match(i),s=[],l=0;if(1<a.length){for(var u,c=0;u=a[c];++c){var h=u.charCodeAt(0);if(44===h){if(0>=l){n.push(e&&s.length?{key:e,value:s.join("")}:{unknown:e||s.join("")}),e=l=0,s=[];continue}}else if(58===h){if(!l&&!e&&1===s.length){e=s.pop();continue}}else{if(47===h&&1<u.length&&(47===u.charCodeAt(1)||42===u.charCodeAt(1)))continue;47===h&&c&&1<u.length?(h=a[c-1].match(o))&&!r[h[0]]&&(a=(t=t.substr(t.indexOf(u)+1)).match(i),c=-1,u="/"):40===h||123===h||91===h?++l:41===h||125===h||93===h?--l:e||s.length||34!==h&&39!==h||(u=u.slice(1,-1))}s.push(u)}if(0<l)throw Error("Unbalanced parentheses, braces, or brackets")}return n}var e=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,i=RegExp("\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|`(?:\\\\.|[^`])*`|/\\*(?:[^*]|\\*+[^*/])*\\*+/|//.*\n|/(?:\\\\.|[^/])+/w*|[^\\s:,/][^,\"'`{}()/:[\\]]*[^\\s,\"'`{}()/:[\\]]|[^\\s]","g"),o=/[\])"'A-Za-z0-9_$]+$/,r={in:1,return:1,typeof:1},a={};return{Ra:[],va:a,Zb:t,ub:function(i,o){function r(t,i){var o;if(!c){var h=w.getBindingHandler(t);if(h&&h.preprocess&&!(i=h.preprocess(i,t,r)))return;(h=a[t])&&(o=i,0<=w.a.A(e,o)?o=!1:(h=o.match(n),o=null!==h&&(h[1]?"Object("+h[1]+")"+h[2]:o)),h=o),h&&l.push("'"+("string"==typeof a[t]?a[t]:t)+"':function(_z){"+o+"=_z}")}u&&(i="function(){return "+i+" }"),s.push("'"+t+"':"+i)}var s=[],l=[],u=(o=o||{}).valueAccessors,c=o.bindingParams,h="string"==typeof i?t(i):i;return w.a.C(h,function(t){r(t.key||t.unknown,t.value)}),l.length&&r("_ko_property_writers","{"+l.join(",")+" }"),s.join(",")},Hd:function(t,e){for(var n=0;n<t.length;n++)if(t[n].key==e)return!0;return!1},$a:function(t,e,n,i,o){t&&w.N(t)?!w.Ya(t)||o&&t.w()===i||t(i):(t=e.get("_ko_property_writers"))&&t[n]&&t[n](i)}}}(),w.b("expressionRewriting",w.m),w.b("expressionRewriting.bindingRewriteValidators",w.m.Ra),w.b("expressionRewriting.parseObjectLiteral",w.m.Zb),w.b("expressionRewriting.preProcessBindings",w.m.ub),w.b("expressionRewriting._twoWayBindings",w.m.va),w.b("jsonExpressionRewriting",w.m),w.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",w.m.ub),function(){function t(t){return 8==t.nodeType&&a.test(r?t.text:t.nodeValue)}function e(t){return 8==t.nodeType&&s.test(r?t.text:t.nodeValue)}function n(n,i){for(var o=n,r=1,a=[];o=o.nextSibling;){if(e(o)&&(w.a.g.set(o,u,!0),0==--r))return a;a.push(o),t(o)&&r++}if(!i)throw Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function i(t,e){var i=n(t,e);return i?0<i.length?i[i.length-1].nextSibling:t.nextSibling:null}var r=o&&"\x3c!--test--\x3e"===o.createComment("test").text,a=r?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,s=r?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,l={ul:!0,ol:!0},u="__ko_matchedEndComment__";w.h={ea:{},childNodes:function(e){return t(e)?n(e):e.childNodes},Ea:function(e){if(t(e))for(var n=0,i=(e=w.h.childNodes(e)).length;n<i;n++)w.removeNode(e[n]);else w.a.Sb(e)},ua:function(e,n){if(t(e)){w.h.Ea(e);for(var i=e.nextSibling,o=0,r=n.length;o<r;o++)i.parentNode.insertBefore(n[o],i)}else w.a.ua(e,n)},Uc:function(e,n){t(e)?e.parentNode.insertBefore(n,e.nextSibling):e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)},Vb:function(e,n,i){i?t(e)?e.parentNode.insertBefore(n,i.nextSibling):i.nextSibling?e.insertBefore(n,i.nextSibling):e.appendChild(n):w.h.Uc(e,n)},firstChild:function(n){if(t(n))return!n.nextSibling||e(n.nextSibling)?null:n.nextSibling;if(n.firstChild&&e(n.firstChild))throw Error("Found invalid end comment, as the first child of "+n);return n.firstChild},nextSibling:function(n){if(t(n)&&(n=i(n)),n.nextSibling&&e(n.nextSibling)){var o=n.nextSibling;if(e(o)&&!w.a.g.get(o,u))throw Error("Found end comment without a matching opening comment, as child of "+n);return null}return n.nextSibling},Bd:t,Ud:function(t){return(t=(r?t.text:t.nodeValue).match(a))?t[1]:null},Rc:function(n){if(l[w.a.P(n)]){var o=n.firstChild;if(o)do{if(1===o.nodeType){var r,a=null;if(r=o.firstChild)do{if(a)a.push(r);else if(t(r)){var s=i(r,!0);s?r=s:a=[r]}else e(r)&&(a=[r])}while(r=r.nextSibling);if(r=a)for(a=o.nextSibling,s=0;s<r.length;s++)a?n.insertBefore(r[s],a):n.appendChild(r[s])}}while(o=o.nextSibling)}}}}(),w.b("virtualElements",w.h),w.b("virtualElements.allowedBindings",w.h.ea),w.b("virtualElements.emptyNode",w.h.Ea),w.b("virtualElements.insertAfter",w.h.Vb),w.b("virtualElements.prepend",w.h.Uc),w.b("virtualElements.setDomNodeChildren",w.h.ua),w.ga=function(){this.md={}},w.a.extend(w.ga.prototype,{nodeHasBindings:function(t){switch(t.nodeType){case 1:return null!=t.getAttribute("data-bind")||w.i.getComponentNameForNode(t);case 8:return w.h.Bd(t);default:return!1}},getBindings:function(t,e){var n=(n=this.getBindingsString(t,e))?this.parseBindingsString(n,e,t):null;return w.i.sc(n,t,e,!1)},getBindingAccessors:function(t,e){var n=(n=this.getBindingsString(t,e))?this.parseBindingsString(n,e,t,{valueAccessors:!0}):null;return w.i.sc(n,t,e,!0)},getBindingsString:function(t){switch(t.nodeType){case 1:return t.getAttribute("data-bind");case 8:return w.h.Ud(t);default:return null}},parseBindingsString:function(t,e,n,i){try{var o,r=this.md,a=t+(i&&i.valueAccessors||"");if(!(o=r[a])){var s,l="with($context){with($data||{}){return{"+w.m.ub(t,i)+"}}}";s=new Function("$context","$element",l),o=r[a]=s}return o(e,n)}catch(e){throw e.message="Unable to parse bindings.\nBindings value: "+t+"\nMessage: "+e.message,e}}}),w.ga.instance=new w.ga,w.b("bindingProvider",w.ga),function(){function e(t){var e=(t=w.a.g.get(t,E))&&t.M;e&&(t.M=null,e.Sc())}function n(t,n,i){this.node=t,this.xc=n,this.ib=[],this.T=!1,n.M||w.a.I.za(t,e),i&&i.M&&(i.M.ib.push(t),this.Kb=i)}function r(t){return function(){return t}}function s(t){return t()}function l(t){return w.a.Ha(w.v.K(t),function(e,n){return function(){return t()[n]}})}function u(t,e,n){return"function"==typeof t?l(t.bind(null,e,n)):w.a.Ha(t,r)}function c(t,e){return l(this.getBindings.bind(this,t,e))}function h(t,e){var n=w.h.firstChild(e);if(n){var i,o=w.ga.instance,r=o.preprocessNode;if(r){for(;i=n;)n=w.h.nextSibling(i),r.call(o,i);n=w.h.firstChild(e)}for(;i=n;)n=w.h.nextSibling(i),p(t,i)}w.j.Ga(e,w.j.T)}function p(t,e){var n=t,i=1===e.nodeType;i&&w.h.Rc(e),(i||w.ga.instance.nodeHasBindings(e))&&(n=f(e,null,t).bindingContextForDescendants),n&&!y[w.a.P(e)]&&h(n,e)}function f(e,n,i){var o,r=w.a.g.Tb(e,E,{}),a=r.gd;if(!n){if(a)throw Error("You cannot apply bindings multiple times to the same element.");r.gd=!0}if(a||(r.context=i),n&&"function"!=typeof n)o=n;else{var l=w.ga.instance,u=l.getBindingAccessors||c,h=w.$(function(){return(o=n?n(i,e):u.call(l,e,i))&&(i[g]&&i[g](),i[v]&&i[v]()),o},null,{l:e});o&&h.ja()||(h=null)}var p,f=i;if(o){var d=function(){return w.a.Ha(h?h():o,s)},m=h?function(t){return function(){return s(h()[t])}}:function(t){return o[t]};d.get=function(t){return o[t]&&s(m(t))},d.has=function(t){return t in o},w.j.T in o&&w.j.subscribe(e,w.j.T,function(){var t=(0,o[w.j.T])();if(t){var n=w.h.childNodes(e);n.length&&t(n,w.Dc(n[0]))}}),w.j.oa in o&&(f=w.j.Bb(e,i),w.j.subscribe(e,w.j.oa,function(){var t=(0,o[w.j.oa])();t&&w.h.firstChild(e)&&t(e)})),r=function(t){var e=[],n={},i=[];return w.a.O(t,function o(r){if(!n[r]){var a=w.getBindingHandler(r);a&&(a.after&&(i.push(r),w.a.C(a.after,function(e){if(t[e]){if(-1!==w.a.A(i,e))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+i.join(", "));o(e)}}),i.length--),e.push({key:r,Lc:a})),n[r]=!0}}),e}(o),w.a.C(r,function(n){var i=n.Lc.init,r=n.Lc.update,a=n.key;if(8===e.nodeType&&!w.h.ea[a])throw Error("The binding '"+a+"' cannot be used with virtual elements");try{"function"==typeof i&&w.v.K(function(){var n=i(e,m(a),d,f.$data,f);if(n&&n.controlsDescendantBindings){if(p!==t)throw Error("Multiple bindings ("+p+" and "+a+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");p=a}}),"function"==typeof r&&w.$(function(){r(e,m(a),d,f.$data,f)},null,{l:e})}catch(t){throw t.message='Unable to process binding "'+a+": "+o[a]+'"\nMessage: '+t.message,t}})}return{shouldBindDescendants:r=p===t,bindingContextForDescendants:r&&f}}function d(e,n){return e&&e instanceof w.fa?e:new w.fa(e,t,t,n)}var g=w.a.Da("_subscribable"),m=w.a.Da("_ancestorBindingInfo"),v=w.a.Da("_dataDependency");w.f={};var y={script:!0,textarea:!0,template:!0};w.getBindingHandler=function(t){return w.f[t]};var b={};w.fa=function(e,n,i,o,r){function a(){var t=h?c():c,e=w.a.c(t);return n?(w.a.extend(l,n),m in n&&(l[m]=n[m])):(l.$parents=[],l.$root=e,l.ko=w),l[g]=s,u?e=l.$data:(l.$rawData=t,l.$data=e),i&&(l[i]=e),o&&o(l,n,e),n&&n[g]&&!w.U.o().Ub(n[g])&&n[g](),p&&(l[v]=p),l.$data}var s,l=this,u=e===b,c=u?t:e,h="function"==typeof c&&!w.N(c),p=r&&r.dataDependency;r&&r.exportDependencies?a():((s=w.wb(a)).w(),s.ja()?s.equalityComparer=null:l[g]=t)},w.fa.prototype.createChildContext=function(t,e,n,i){if(!i&&e&&"object"==typeof e&&(e=(i=e).as,n=i.extend),e&&i&&i.noChildContext){var o="function"==typeof t&&!w.N(t);return new w.fa(b,this,null,function(i){n&&n(i),i[e]=o?t():t},i)}return new w.fa(t,this,e,function(t,e){t.$parentContext=e,t.$parent=e.$data,t.$parents=(e.$parents||[]).slice(0),t.$parents.unshift(t.$parent),n&&n(t)},i)},w.fa.prototype.extend=function(t,e){return new w.fa(b,this,null,function(e){w.a.extend(e,"function"==typeof t?t(e):t)},e)};var E=w.a.g.Z();n.prototype.Sc=function(){this.Kb&&this.Kb.M&&this.Kb.M.rd(this.node)},n.prototype.rd=function(t){w.a.hb(this.ib,t),!this.ib.length&&this.T&&this.Bc()},n.prototype.Bc=function(){this.T=!0,this.xc.M&&!this.ib.length&&(this.xc.M=null,w.a.I.xb(this.node,e),w.j.Ga(this.node,w.j.oa),this.Sc())},w.j={T:"childrenComplete",oa:"descendantsComplete",subscribe:function(t,e,n,i){return(t=w.a.g.Tb(t,E,{})).Fa||(t.Fa=new w.R),t.Fa.subscribe(n,i,e)},Ga:function(e,n){var i=w.a.g.get(e,E);if(i&&(i.Fa&&i.Fa.notifySubscribers(e,n),n==w.j.T))if(i.M)i.M.Bc();else if(i.M===t&&i.Fa&&i.Fa.Wa(w.j.oa))throw Error("descendantsComplete event not supported for bindings on this node")},Bb:function(t,e){var i=w.a.g.Tb(t,E,{});return i.M||(i.M=new n(t,i,e[m])),e[m]==i?e:e.extend(function(t){t[m]=i})}},w.Sd=function(t){return(t=w.a.g.get(t,E))&&t.context},w.eb=function(t,e,n){return 1===t.nodeType&&w.h.Rc(t),f(t,e,d(n))},w.kd=function(t,e,n){return n=d(n),w.eb(t,u(e,n,t),n)},w.Pa=function(t,e){1!==e.nodeType&&8!==e.nodeType||h(d(t),e)},w.uc=function(t,e,n){if(!a&&i.jQuery&&(a=i.jQuery),2>arguments.length){if(!(e=o.body))throw Error("ko.applyBindings: could not find document.body; has the document been loaded?")}else if(!e||1!==e.nodeType&&8!==e.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");p(d(t,n),e)},w.Cc=function(e){return!e||1!==e.nodeType&&8!==e.nodeType?t:w.Sd(e)},w.Dc=function(e){return(e=w.Cc(e))?e.$data:t},w.b("bindingHandlers",w.f),w.b("bindingEvent",w.j),w.b("bindingEvent.subscribe",w.j.subscribe),w.b("bindingEvent.startPossiblyAsyncContentBinding",w.j.Bb),w.b("applyBindings",w.uc),w.b("applyBindingsToDescendants",w.Pa),w.b("applyBindingAccessorsToNode",w.eb),w.b("applyBindingsToNode",w.kd),w.b("contextFor",w.Cc),w.b("dataFor",w.Dc)}(),function(t){function e(e,i){var a,s=Object.prototype.hasOwnProperty.call(o,e)?o[e]:t;s?s.subscribe(i):((s=o[e]=new w.R).subscribe(i),n(e,function(t,n){var i=!(!n||!n.synchronous);r[e]={definition:t,Fd:i},delete o[e],a||i?s.notifySubscribers(t):w.ma.yb(function(){s.notifySubscribers(t)})}),a=!0)}function n(t,e){i("getConfig",[t],function(n){n?i("loadComponent",[t,n],function(t){e(t,n)}):e(null,null)})}function i(e,n,o,r){r||(r=w.i.loaders.slice(0));var a=r.shift();if(a){var s=a[e];if(s){var l=!1;if(s.apply(a,n.concat(function(t){l?o(null):null!==t?o(t):i(e,n,o,r)}))!==t&&(l=!0,!a.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else i(e,n,o,r)}else o(null)}var o={},r={};w.i={get:function(n,i){var o=Object.prototype.hasOwnProperty.call(r,n)?r[n]:t;o?o.Fd?w.v.K(function(){i(o.definition)}):w.ma.yb(function(){i(o.definition)}):e(n,i)},Ac:function(t){delete r[t]},nc:i},w.i.loaders=[],w.b("components",w.i),w.b("components.get",w.i.get),w.b("components.clearCachedDefinition",w.i.Ac)}(),function(){function t(t,e,n,i){function o(){0==--s&&i(r)}var r={},s=2,l=n.template;n=n.viewModel,l?a(e,l,function(e){w.i.nc("loadTemplate",[t,e],function(t){r.template=t,o()})}):o(),n?a(e,n,function(e){w.i.nc("loadViewModel",[t,e],function(t){r[u]=t,o()})}):o()}function e(t){switch(w.a.P(t)){case"script":return w.a.ta(t.text);case"textarea":return w.a.ta(t.value);case"template":if(r(t.content))return w.a.Ca(t.content.childNodes)}return w.a.Ca(t.childNodes)}function r(t){return i.DocumentFragment?t instanceof DocumentFragment:t&&11===t.nodeType}function a(t,e,o){"string"==typeof e.require?n||i.require?(n||i.require)([e.require],o):t("Uses require, but no AMD loader is present"):o(e)}function s(t){return function(e){throw Error("Component '"+t+"': "+e)}}var l={};w.i.register=function(t,e){if(!e)throw Error("Invalid configuration for "+t);if(w.i.sb(t))throw Error("Component "+t+" is already registered");l[t]=e},w.i.sb=function(t){return Object.prototype.hasOwnProperty.call(l,t)},w.i.unregister=function(t){delete l[t],w.i.Ac(t)},w.i.Ec={getConfig:function(t,e){e(w.i.sb(t)?l[t]:null)},loadComponent:function(e,n,i){var o=s(e);a(o,n,function(n){t(e,o,n,i)})},loadTemplate:function(t,n,a){if(t=s(t),"string"==typeof n)a(w.a.ta(n));else if(n instanceof Array)a(n);else if(r(n))a(w.a.la(n.childNodes));else if(n.element)if(n=n.element,i.HTMLElement?n instanceof HTMLElement:n&&n.tagName&&1===n.nodeType)a(e(n));else if("string"==typeof n){var l=o.getElementById(n);l?a(e(l)):t("Cannot find element with ID "+n)}else t("Unknown element type: "+n);else t("Unknown template value: "+n)},loadViewModel:function(t,e,n){!function t(e,n,i){if("function"==typeof n)i(function(t){return new n(t)});else if("function"==typeof n[u])i(n[u]);else if("instance"in n){var o=n.instance;i(function(){return o})}else"viewModel"in n?t(e,n.viewModel,i):e("Unknown viewModel value: "+n)}(s(t),e,n)}};var u="createViewModel";w.b("components.register",w.i.register),w.b("components.isRegistered",w.i.sb),w.b("components.unregister",w.i.unregister),w.b("components.defaultLoader",w.i.Ec),w.i.loaders.push(w.i.Ec),w.i.cd=l}(),function(){function t(t,n){if(i=t.getAttribute("params")){var i=e.parseBindingsString(i,n,t,{valueAccessors:!0,bindingParams:!0}),o=(i=w.a.Ha(i,function(e){return w.o(e,null,{l:t})}),w.a.Ha(i,function(e){var n=e.w();return e.ja()?w.o({read:function(){return w.a.c(e())},write:w.Ya(n)&&function(t){e()(t)},l:t}):n}));return Object.prototype.hasOwnProperty.call(o,"$raw")||(o.$raw=i),o}return{$raw:{}}}w.i.getComponentNameForNode=function(t){var e=w.a.P(t);if(w.i.sb(e)&&(-1!=e.indexOf("-")||"[object HTMLUnknownElement]"==""+t||8>=w.a.W&&t.tagName===e))return e},w.i.sc=function(e,n,i,o){if(1===n.nodeType){var r=w.i.getComponentNameForNode(n);if(r){if((e=e||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var a={name:r,params:t(n,i)};e.component=o?function(){return a}:a}}return e};var e=new w.ga;9>w.a.W&&(w.i.register=function(t){return function(e){return t.apply(this,arguments)}}(w.i.register),o.createDocumentFragment=function(t){return function(){var e,n=t(),i=w.i.cd;for(e in i);return n}}(o.createDocumentFragment))}(),function(){var t=0;w.f.component={init:function(e,n,i,o,r){function a(){var t=s&&s.dispose;"function"==typeof t&&t.call(s),u&&u.s(),l=s=u=null}var s,l,u,c=w.a.la(w.h.childNodes(e));return w.h.Ea(e),w.a.I.za(e,a),w.o(function(){var i,o,h=w.a.c(n());if("string"==typeof h?i=h:(i=w.a.c(h.name),o=w.a.c(h.params)),!i)throw Error("No component name specified");var p=w.j.Bb(e,r),f=l=++t;w.i.get(i,function(t){if(l===f){if(a(),!t)throw Error("Unknown component '"+i+"'");!function(t,e,n){if(!(e=e.template))throw Error("Component '"+t+"' has no template");t=w.a.Ca(e),w.h.ua(n,t)}(i,t,e);var n=function(t,e,n){var i=t.createViewModel;return i?i.call(t,e,n):e}(t,o,{element:e,templateNodes:c});t=p.createChildContext(n,{extend:function(t){t.$component=n,t.$componentTemplateNodes=c}}),n&&n.koDescendantsComplete&&(u=w.j.subscribe(e,w.j.oa,n.koDescendantsComplete,n)),s=n,w.Pa(t,e)}})},null,{l:e}),{controlsDescendantBindings:!0}}},w.h.ea.component=!0}();var A={class:"className",for:"htmlFor"};w.f.attr={update:function(e,n){var i=w.a.c(n())||{};w.a.O(i,function(n,i){i=w.a.c(i);var o=n.indexOf(":"),r=(o="lookupNamespaceURI"in e&&0<o&&e.lookupNamespaceURI(n.substr(0,o)),!1===i||null===i||i===t);r?o?e.removeAttributeNS(o,n):e.removeAttribute(n):i=i.toString(),8>=w.a.W&&n in A?(n=A[n],r?e.removeAttribute(n):e[n]=i):r||(o?e.setAttributeNS(o,n,i):e.setAttribute(n,i)),"name"===n&&w.a.Xc(e,r?"":i)})}},w.f.checked={after:["value","attr"],init:function(e,n,i){function o(){var o=e.checked,l=r();if(!w.U.rb()&&(o||!s&&!w.U.pa())){var h=w.v.K(n);if(u){var f=c?h.w():h,d=p;p=l,d!==l?o&&(w.a.Oa(f,l,!0),w.a.Oa(f,d,!1)):w.a.Oa(f,l,o),c&&w.Ya(h)&&h(f)}else a&&(l===t?l=o:o||(l=t)),w.m.$a(h,i,"checked",l,!0)}}var r=w.wb(function(){return i.has("checkedValue")?w.a.c(i.get("checkedValue")):h?i.has("value")?w.a.c(i.get("value")):e.value:void 0}),a="checkbox"==e.type,s="radio"==e.type;if(a||s){var l=n(),u=a&&w.a.c(l)instanceof Array,c=!(u&&l.push&&l.splice),h=s||u,p=u?r():t;s&&!e.name&&w.f.uniqueName.init(e,function(){return!0}),w.o(o,null,{l:e}),w.a.H(e,"click",o),w.o(function(){var i=w.a.c(n()),o=r();u?(e.checked=0<=w.a.A(i,o),p=o):e.checked=a&&o===t?!!i:r()===i},null,{l:e}),l=t}}},w.m.va.checked=!0,w.f.checkedValue={update:function(t,e){t.value=w.a.c(e())}},w.f.class={update:function(t,e){var n=w.a.Cb(w.a.c(e()));w.a.Eb(t,t.__ko__cssValue,!1),t.__ko__cssValue=n,w.a.Eb(t,n,!0)}},w.f.css={update:function(t,e){var n=w.a.c(e());null!==n&&"object"==typeof n?w.a.O(n,function(e,n){n=w.a.c(n),w.a.Eb(t,e,n)}):w.f.class.update(t,e)}},w.f.enable={update:function(t,e){var n=w.a.c(e());n&&t.disabled?t.removeAttribute("disabled"):n||t.disabled||(t.disabled=!0)}},w.f.disable={update:function(t,e){w.f.enable.update(t,function(){return!w.a.c(e())})}},w.f.event={init:function(t,e,n,i,o){var r=e()||{};w.a.O(r,function(r){"string"==typeof r&&w.a.H(t,r,function(t){var a,s=e()[r];if(s){try{var l=w.a.la(arguments);i=o.$data,l.unshift(i),a=s.apply(i,l)}finally{!0!==a&&(t.preventDefault?t.preventDefault():t.returnValue=!1)}!1===n.get(r+"Bubble")&&(t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation())}})})}},w.f.foreach={Qc:function(t){return function(){var e=t(),n=w.a.$b(e);return n&&"number"!=typeof n.length?(w.a.c(e),{foreach:n.data,as:n.as,noChildContext:n.noChildContext,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:w.ba.Na}):{foreach:e,templateEngine:w.ba.Na}}},init:function(t,e){return w.f.template.init(t,w.f.foreach.Qc(e))},update:function(t,e,n,i,o){return w.f.template.update(t,w.f.foreach.Qc(e),n,i,o)}},w.m.Ra.foreach=!1,w.h.ea.foreach=!0,w.f.hasfocus={init:function(t,e,n){function i(i){t.__ko_hasfocusUpdating=!0;var o=t.ownerDocument;if("activeElement"in o){var r;try{r=o.activeElement}catch(t){r=o.body}i=r===t}o=e(),w.m.$a(o,n,"hasfocus",i,!0),t.__ko_hasfocusLastValue=i,t.__ko_hasfocusUpdating=!1}var o=i.bind(null,!0),r=i.bind(null,!1);w.a.H(t,"focus",o),w.a.H(t,"focusin",o),w.a.H(t,"blur",r),w.a.H(t,"focusout",r),t.__ko_hasfocusLastValue=!1},update:function(t,e){var n=!!w.a.c(e());t.__ko_hasfocusUpdating||t.__ko_hasfocusLastValue===n||(n?t.focus():t.blur(),!n&&t.__ko_hasfocusLastValue&&t.ownerDocument.body.focus(),w.v.K(w.a.Fb,null,[t,n?"focusin":"focusout"]))}},w.m.va.hasfocus=!0,w.f.hasFocus=w.f.hasfocus,w.m.va.hasFocus="hasfocus",w.f.html={init:function(){return{controlsDescendantBindings:!0}},update:function(t,e){w.a.dc(t,e())}},function(){function t(t,e,n){w.f[t]={init:function(t,i,o,r,a){var s,l,u,c,h,p={};if(e){r=o.get("as");var f=o.get("noChildContext");p={as:r,noChildContext:f,exportDependencies:h=!(r&&f)}}return c=(u="render"==o.get("completeOn"))||o.has(w.j.oa),w.o(function(){var o,r=w.a.c(i()),f=!n!=!r,d=!l;(h||f!==s)&&(c&&(a=w.j.Bb(t,a)),f&&(e&&!h||(p.dataDependency=w.U.o()),o=e?a.createChildContext("function"==typeof r?r:i,p):w.U.pa()?a.extend(null,p):a),d&&w.U.pa()&&(l=w.a.Ca(w.h.childNodes(t),!0)),f?(d||w.h.ua(t,w.a.Ca(l)),w.Pa(o,t)):(w.h.Ea(t),u||w.j.Ga(t,w.j.T)),s=f)},null,{l:t}),{controlsDescendantBindings:!0}}},w.m.Ra[t]=!1,w.h.ea[t]=!0}t("if"),t("ifnot",!1,!0),t("with",!0)}(),w.f.let={init:function(t,e,n,i,o){return e=o.extend(e),w.Pa(e,t),{controlsDescendantBindings:!0}}},w.h.ea.let=!0;var R={};w.f.options={init:function(t){if("select"!==w.a.P(t))throw Error("options binding applies only to SELECT elements");for(;0<t.length;)t.remove(0);return{controlsDescendantBindings:!0}},update:function(e,n,i){function o(){return w.a.fb(e.options,function(t){return t.selected})}function r(t,e,n){var i=typeof e;return"function"==i?e(t):"string"==i?t[e]:n}function a(t,n){if(d&&c)w.u.ya(e,w.a.c(i.get("value")),!0);else if(f.length){var o=0<=w.a.A(f,w.u.L(n[0]));w.a.Yc(n[0],o),d&&!o&&w.v.K(w.a.Fb,null,[e,"change"])}}var s=e.multiple,l=0!=e.length&&s?e.scrollTop:null,u=w.a.c(n()),c=i.get("valueAllowUnset")&&i.has("value"),h=i.get("optionsIncludeDestroyed");n={};var p,f=[];c||(s?f=w.a.Mb(o(),w.u.L):0<=e.selectedIndex&&f.push(w.u.L(e.options[e.selectedIndex]))),u&&(void 0===u.length&&(u=[u]),p=w.a.fb(u,function(e){return h||e===t||null===e||!w.a.c(e._destroy)}),i.has("optionsCaption")&&null!==(u=w.a.c(i.get("optionsCaption")))&&u!==t&&p.unshift(R));var d=!1;n.beforeRemove=function(t){e.removeChild(t)},u=a,i.has("optionsAfterRender")&&"function"==typeof i.get("optionsAfterRender")&&(u=function(e,n){a(0,n),w.v.K(i.get("optionsAfterRender"),null,[n[0],e!==R?e:t])}),w.a.cc(e,p,function(n,o,a){return a.length&&(f=!c&&a[0].selected?[w.u.L(a[0])]:[],d=!0),o=e.ownerDocument.createElement("option"),n===R?(w.a.Ab(o,i.get("optionsCaption")),w.u.ya(o,t)):(a=r(n,i.get("optionsValue"),n),w.u.ya(o,w.a.c(a)),n=r(n,i.get("optionsText"),a),w.a.Ab(o,n)),[o]},n,u),w.v.K(function(){c?w.u.ya(e,w.a.c(i.get("value")),!0):(s?f.length&&o().length<f.length:f.length&&0<=e.selectedIndex?w.u.L(e.options[e.selectedIndex])!==f[0]:f.length||0<=e.selectedIndex)&&w.a.Fb(e,"change")}),w.a.vd(e),l&&20<Math.abs(l-e.scrollTop)&&(e.scrollTop=l)}},w.f.options.Yb=w.a.g.Z(),w.f.selectedOptions={after:["options","foreach"],init:function(t,e,n){w.a.H(t,"change",function(){var i=e(),o=[];w.a.C(t.getElementsByTagName("option"),function(t){t.selected&&o.push(w.u.L(t))}),w.m.$a(i,n,"selectedOptions",o)})},update:function(t,e){if("select"!=w.a.P(t))throw Error("values binding applies only to SELECT elements");var n=w.a.c(e()),i=t.scrollTop;n&&"number"==typeof n.length&&w.a.C(t.getElementsByTagName("option"),function(t){var e=0<=w.a.A(n,w.u.L(t));t.selected!=e&&w.a.Yc(t,e)}),t.scrollTop=i}},w.m.va.selectedOptions=!0,w.f.style={update:function(e,n){var i=w.a.c(n()||{});w.a.O(i,function(n,i){if(null!==(i=w.a.c(i))&&i!==t&&!1!==i||(i=""),a)a(e).css(n,i);else if(/^--/.test(n))e.style.setProperty(n,i);else{n=n.replace(/-(\w)/g,function(t,e){return e.toUpperCase()});var o=e.style[n];e.style[n]=i,i===o||e.style[n]!=o||isNaN(i)||(e.style[n]=i+"px")}})}},w.f.submit={init:function(t,e,n,i,o){if("function"!=typeof e())throw Error("The value for a submit binding must be a function");w.a.H(t,"submit",function(n){var i,r=e();try{i=r.call(o.$data,t)}finally{!0!==i&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},w.f.text={init:function(){return{controlsDescendantBindings:!0}},update:function(t,e){w.a.Ab(t,e())}},w.h.ea.text=!0,function(){if(i&&i.navigator){var e,n,o,r,a,s=function(t){if(t)return parseFloat(t[1])},l=i.navigator.userAgent;(e=i.opera&&i.opera.version&&parseInt(i.opera.version()))||(a=s(l.match(/Edge\/([^ ]+)$/)))||s(l.match(/Chrome\/([^ ]+)/))||(n=s(l.match(/Version\/([^ ]+) Safari/)))||(o=s(l.match(/Firefox\/([^ ]+)/)))||(r=w.a.W||s(l.match(/MSIE ([^ ]+)/)))||(r=s(l.match(/rv:([^ )]+)/)))}if(8<=r&&10>r)var u=w.a.g.Z(),c=w.a.g.Z(),h=function(t){var e=this.activeElement;(e=e&&w.a.g.get(e,c))&&e(t)},p=function(t,e){var n=t.ownerDocument;w.a.g.get(n,u)||(w.a.g.set(n,u,!0),w.a.H(n,"selectionchange",h)),w.a.g.set(t,c,e)};w.f.textInput={init:function(i,s,l){function u(t,e){w.a.H(i,t,e)}function c(){f||(d=i.value,f=w.a.setTimeout(h,4))}function h(){clearTimeout(f),d=f=t;var e=i.value;g!==e&&(g=e,w.m.$a(s(),l,"textInput",e))}var f,d,g=i.value,m=9==w.a.W?c:h,v=!1;r&&u("keypress",h),11>r&&u("propertychange",function(t){v||"value"!==t.propertyName||m(t)}),8==r&&(u("keyup",h),u("keydown",h)),p&&(p(i,m),u("dragend",c)),(!r||9<=r)&&u("input",m),5>n&&"textarea"===w.a.P(i)?(u("keydown",c),u("paste",c),u("cut",c)):11>e?u("keydown",c):4>o?(u("DOMAutoComplete",h),u("dragdrop",h),u("drop",h)):a&&"number"===i.type&&u("keydown",c),u("change",h),u("blur",h),w.o(function e(){var n=w.a.c(s());null!==n&&n!==t||(n=""),d!==t&&n===d?w.a.setTimeout(e,4):i.value!==n&&(v=!0,i.value=n,v=!1,g=i.value)},null,{l:i})}},w.m.va.textInput=!0,w.f.textinput={preprocess:function(t,e,n){n("textInput",t)}}}(),w.f.uniqueName={init:function(t,e){if(e()){var n="ko_unique_"+ ++w.f.uniqueName.qd;w.a.Xc(t,n)}}},w.f.uniqueName.qd=0,w.f.using={init:function(t,e,n,i,o){var r;return n.has("as")&&(r={as:n.get("as"),noChildContext:n.get("noChildContext")}),e=o.createChildContext(e,r),w.Pa(e,t),{controlsDescendantBindings:!0}}},w.h.ea.using=!0,w.f.value={after:["options","foreach"],init:function(e,n,i){var o=w.a.P(e),r="input"==o;if(!r||"checkbox"!=e.type&&"radio"!=e.type){var a=["change"],s=i.get("valueUpdate"),l=!1,u=null;s&&("string"==typeof s&&(s=[s]),w.a.gb(a,s),a=w.a.vc(a));var c,h=function(){u=null,l=!1;var t=n(),o=w.u.L(e);w.m.$a(t,i,"value",o)};!w.a.W||!r||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=w.a.A(a,"propertychange")||(w.a.H(e,"propertychange",function(){l=!0}),w.a.H(e,"focus",function(){l=!1}),w.a.H(e,"blur",function(){l&&h()})),w.a.C(a,function(t){var n=h;w.a.Td(t,"after")&&(n=function(){u=w.u.L(e),w.a.setTimeout(h,0)},t=t.substring(5)),w.a.H(e,t,n)}),c=r&&"file"==e.type?function(){var i=w.a.c(n());null===i||i===t||""===i?e.value="":w.v.K(h)}:function(){var r=w.a.c(n()),a=w.u.L(e);null!==u&&r===u?w.a.setTimeout(c,0):r===a&&a!==t||("select"===o?(a=i.get("valueAllowUnset"),w.u.ya(e,r,a),a||r===w.u.L(e)||w.v.K(h)):w.u.ya(e,r))},w.o(c,null,{l:e})}else w.eb(e,{checkedValue:n})},update:function(){}},w.m.va.value=!0,w.f.visible={update:function(t,e){var n=w.a.c(e()),i="none"!=t.style.display;n&&!i?t.style.display="":!n&&i&&(t.style.display="none")}},w.f.hidden={update:function(t,e){w.f.visible.update(t,function(){return!w.a.c(e())})}},function(t){w.f[t]={init:function(e,n,i,o,r){return w.f.event.init.call(this,e,function(){var e={};return e[t]=n(),e},i,o,r)}}}("click"),w.ca=function(){},w.ca.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},w.ca.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},w.ca.prototype.makeTemplateSource=function(t,e){if("string"==typeof t){var n=(e=e||o).getElementById(t);if(!n)throw Error("Cannot find template with ID "+t);return new w.B.D(n)}if(1==t.nodeType||8==t.nodeType)return new w.B.ia(t);throw Error("Unknown template type: "+t)},w.ca.prototype.renderTemplate=function(t,e,n,i){return t=this.makeTemplateSource(t,i),this.renderTemplateSource(t,e,n,i)},w.ca.prototype.isTemplateRewritten=function(t,e){return!1===this.allowTemplateRewriting||this.makeTemplateSource(t,e).data("isRewritten")},w.ca.prototype.rewriteTemplate=function(t,e,n){e=e((t=this.makeTemplateSource(t,n)).text()),t.text(e),t.data("isRewritten",!0)},w.b("templateEngine",w.ca),w.ic=function(){function t(t,e,n,i){t=w.m.Zb(t);for(var o=w.m.Ra,r=0;r<t.length;r++){var a=t[r].key;if(Object.prototype.hasOwnProperty.call(o,a)){var s=o[a];if("function"==typeof s){if(a=s(t[r].value))throw Error(a)}else if(!s)throw Error("This template engine does not support the '"+a+"' binding within its templates")}}return n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+w.m.ub(t,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')",i.createJavaScriptEvaluatorBlock(n)+e}var e=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{wd:function(t,e,n){e.isTemplateRewritten(t,n)||e.rewriteTemplate(t,function(t){return w.ic.Kd(t,e)},n)},Kd:function(i,o){return i.replace(e,function(e,n,i,r,a){return t(a,n,i,o)}).replace(n,function(e,n){return t(n,"\x3c!-- ko --\x3e","#comment",o)})},ld:function(t,e){return w.aa.Wb(function(n,i){var o=n.nextSibling;o&&o.nodeName.toLowerCase()===e&&w.eb(o,t,i)})}}}(),w.b("__tr_ambtns",w.ic.ld),function(){w.B={},w.B.D=function(t){if(this.D=t){var e=w.a.P(t);this.Db="script"===e?1:"textarea"===e?2:"template"==e&&t.content&&11===t.content.nodeType?3:4}},w.B.D.prototype.text=function(){var t=1===this.Db?"text":2===this.Db?"value":"innerHTML";if(0==arguments.length)return this.D[t];var e=arguments[0];"innerHTML"===t?w.a.dc(this.D,e):this.D[t]=e};var e=w.a.g.Z()+"_";w.B.D.prototype.data=function(t){if(1===arguments.length)return w.a.g.get(this.D,e+t);w.a.g.set(this.D,e+t,arguments[1])};var n=w.a.g.Z();w.B.D.prototype.nodes=function(){var e=this.D;if(0==arguments.length){var i=w.a.g.get(e,n)||{},o=i.jb||(3===this.Db?e.content:4===this.Db?e:t);return o&&!i.hd||(i=this.text())&&(o=w.a.Ld(i,e.ownerDocument),this.text(""),w.a.g.set(e,n,{jb:o,hd:!0})),o}w.a.g.set(e,n,{jb:arguments[0]})},w.B.ia=function(t){this.D=t},w.B.ia.prototype=new w.B.D,w.B.ia.prototype.constructor=w.B.ia,w.B.ia.prototype.text=function(){if(0==arguments.length){var e=w.a.g.get(this.D,n)||{};return e.jc===t&&e.jb&&(e.jc=e.jb.innerHTML),e.jc}w.a.g.set(this.D,n,{jc:arguments[0]})},w.b("templateSources",w.B),w.b("templateSources.domElement",w.B.D),w.b("templateSources.anonymousTemplate",w.B.ia)}(),function(){function e(t,e,n){var i;for(e=w.h.nextSibling(e);t&&(i=t)!==e;)n(i,t=w.h.nextSibling(i))}function n(t,n){if(t.length){var i=t[0],o=t[t.length-1],r=i.parentNode,a=w.ga.instance,s=a.preprocessNode;if(s){if(e(i,o,function(t,e){var n=t.previousSibling,r=s.call(a,t);r&&(t===i&&(i=r[0]||e),t===o&&(o=r[r.length-1]||n))}),t.length=0,!i)return;i===o?t.push(i):(t.push(i,o),w.a.Ua(t,r))}e(i,o,function(t){1!==t.nodeType&&8!==t.nodeType||w.uc(n,t)}),e(i,o,function(t){1!==t.nodeType&&8!==t.nodeType||w.aa.bd(t,[n])}),w.a.Ua(t,r)}}function i(t){return t.nodeType?t:0<t.length?t[0]:null}function o(t,e,o,r,s){s=s||{};var l=(t&&i(t)||o||{}).ownerDocument,u=s.templateEngine||a;if(w.ic.wd(o,u,l),"number"!=typeof(o=u.renderTemplate(o,r,s,l)).length||0<o.length&&"number"!=typeof o[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(l=!1,e){case"replaceChildren":w.h.ua(t,o),l=!0;break;case"replaceNode":w.a.Wc(t,o),l=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+e)}return l&&(n(o,r),s.afterRender&&w.v.K(s.afterRender,null,[o,r[s.as||"$data"]]),"replaceChildren"==e&&w.j.Ga(t,w.j.T)),o}function r(t,e,n){return w.N(t)?t():"function"==typeof t?t(e,n):t}var a;w.ec=function(e){if(e!=t&&!(e instanceof w.ca))throw Error("templateEngine must inherit from ko.templateEngine");a=e},w.bc=function(e,n,s,l,u){if(((s=s||{}).templateEngine||a)==t)throw Error("Set a template engine before calling renderTemplate");if(u=u||"replaceChildren",l){var c=i(l);return w.$(function(){var t=n&&n instanceof w.fa?n:new w.fa(n,null,null,null,{exportDependencies:!0}),a=r(e,t.$data,t);t=o(l,u,a,t,s),"replaceNode"==u&&(c=i(l=t))},null,{Sa:function(){return!c||!w.a.Rb(c)},l:c&&"replaceNode"==u?c.parentNode:c})}return w.aa.Wb(function(t){w.bc(e,n,s,t,"replaceNode")})},w.Pd=function(e,i,a,s,l){function u(t,e){w.v.K(w.a.cc,null,[s,t,h,a,c,e]),w.j.Ga(s,w.j.T)}function c(t,e){n(e,p),a.afterRender&&a.afterRender(e,t),p=null}function h(t,n){p=l.createChildContext(t,{as:f,noChildContext:a.noChildContext,extend:function(t){t.$index=n,f&&(t[f+"Index"]=n)}});var i=r(e,t,p);return o(s,"ignoreTargetNode",i,p,a)}var p,f=a.as,d=!1===a.includeDestroyed||w.options.foreachHidesDestroyed&&!a.includeDestroyed;if(d||a.beforeRemove||!w.Oc(i))return w.$(function(){var e=w.a.c(i)||[];void 0===e.length&&(e=[e]),d&&(e=w.a.fb(e,function(e){return e===t||null===e||!w.a.c(e._destroy)})),u(e)},null,{l:s});u(i.w());var g=i.subscribe(function(t){u(i(),t)},null,"arrayChange");return g.l(s),g};var s=w.a.g.Z(),l=w.a.g.Z();w.f.template={init:function(t,e){var n=w.a.c(e());if("string"==typeof n||n.name)w.h.Ea(t);else if("nodes"in n){if(n=n.nodes||[],w.N(n))throw Error('The "nodes" option must be a plain, non-observable array.');var i=n[0]&&n[0].parentNode;i&&w.a.g.get(i,l)||(i=w.a.Xb(n),w.a.g.set(i,l,!0)),new w.B.ia(t).nodes(i)}else{if(!(0<(n=w.h.childNodes(t)).length))throw Error("Anonymous template defined, but no template content was provided");i=w.a.Xb(n),new w.B.ia(t).nodes(i)}return{controlsDescendantBindings:!0}},update:function(e,n,i,o,r){var a=n();i=!0,o=null,"string"==typeof(n=w.a.c(a))?n={}:(a=n.name,"if"in n&&(i=w.a.c(n.if)),i&&"ifnot"in n&&(i=!w.a.c(n.ifnot))),"foreach"in n?o=w.Pd(a||e,i&&n.foreach||[],n,e,r):i?(i=r,"data"in n&&(i=r.createChildContext(n.data,{as:n.as,noChildContext:n.noChildContext,exportDependencies:!0})),o=w.bc(a||e,i,n,e)):w.h.Ea(e),r=o,(n=w.a.g.get(e,s))&&"function"==typeof n.s&&n.s(),w.a.g.set(e,s,!r||r.ja&&!r.ja()?t:r)}},w.m.Ra.template=function(t){return 1==(t=w.m.Zb(t)).length&&t[0].unknown||w.m.Hd(t,"name")?null:"This template engine does not support anonymous templates nested within its templates"},w.h.ea.template=!0}(),w.b("setTemplateEngine",w.ec),w.b("renderTemplate",w.bc),w.a.Jc=function(t,e,n){var i,o,r,a,s;if(t.length&&e.length)for(i=o=0;(!n||i<n)&&(a=t[o]);++o){for(r=0;s=e[r];++r)if(a.value===s.value){a.moved=s.index,s.moved=a.index,e.splice(r,1),i=r=0;break}i+=r}},w.a.Ob=function(){function t(t,e,n,i,o){var r,a,s,l,u,c=Math.min,h=Math.max,p=[],f=t.length,d=e.length,g=d-f||1,m=f+d+1;for(r=0;r<=f;r++)for(l=s,p.push(s=[]),u=c(d,r+g),a=h(0,r-1);a<=u;a++)s[a]=a?r?t[r-1]===e[a-1]?l[a-1]:c(l[a]||m,s[a-1]||m)+1:a+1:r+1;for(c=[],h=[],g=[],r=f,a=d;r||a;)d=p[r][a]-1,a&&d===p[r][a-1]?h.push(c[c.length]={status:n,value:e[--a],index:a}):r&&d===p[r-1][a]?g.push(c[c.length]={status:i,value:t[--r],index:r}):(--a,--r,o.sparse||c.push({status:"retained",value:e[a]}));return w.a.Jc(g,h,!o.dontLimitMoves&&10*f),c.reverse()}return function(e,n,i){return i="boolean"==typeof i?{dontLimitMoves:i}:i||{},n=n||[],(e=e||[]).length<n.length?t(e,n,"added","deleted",i):t(n,e,"deleted","added",i)}}(),w.b("utils.compareArrays",w.a.Ob),function(){function e(e,n,i,o,r){var a=[],s=w.$(function(){var t=n(i,r,w.a.Ua(a,e))||[];0<a.length&&(w.a.Wc(a,t),o&&w.v.K(o,null,[i,t,r])),a.length=0,w.a.gb(a,t)},null,{l:e,Sa:function(){return!w.a.jd(a)}});return{Y:a,$:s.ja()?s:t}}var n=w.a.g.Z(),i=w.a.g.Z();w.a.cc=function(o,r,a,s,l,u){function c(t){f={Aa:t,nb:w.sa(S++)},b.push(f),y||I.push(f)}function h(t){f=v[t],S!==f.nb.w()&&x.push(f),f.nb(S++),w.a.Ua(f.Y,o),b.push(f)}function p(t,e){if(t)for(var n=0,i=e.length;n<i;n++)w.a.C(e[n].Y,function(i){t(i,n,e[n].Aa)})}void 0===(r=r||[]).length&&(r=[r]),s=s||{};var f,d,g,m,v=w.a.g.get(o,n),y=!v,b=[],E=0,S=0,N=[],C=[],T=[],x=[],I=[],P=0;if(y)w.a.C(r,c);else{if(!u||v&&v._countWaitingForRemove){var O=w.a.Mb(v,function(t){return t.Aa});u=w.a.Ob(O,r,{dontLimitMoves:s.dontLimitMoves,sparse:!0})}var k,A,R;for(O=0;k=u[O];O++)switch(A=k.moved,R=k.index,k.status){case"deleted":for(;E<R;)h(E++);A===t&&((f=v[E]).$&&(f.$.s(),f.$=t),w.a.Ua(f.Y,o).length&&(s.beforeRemove&&(b.push(f),P++,f.Aa===i?f=null:T.push(f)),f&&N.push.apply(N,f.Y))),E++;break;case"added":for(;S<R;)h(E++);A!==t?(C.push(b.length),h(A)):c(k.value)}for(;S<r.length;)h(E++);b._countWaitingForRemove=P}w.a.g.set(o,n,b),p(s.beforeMove,x),w.a.C(N,s.beforeRemove?w.na:w.removeNode);try{m=o.ownerDocument.activeElement}catch(t){}if(C.length)for(;(O=C.shift())!=t;){for(f=b[O],d=t;O;)if((g=b[--O].Y)&&g.length){d=g[g.length-1];break}for(r=0;E=f.Y[r];d=E,r++)w.h.Vb(o,E,d)}for(O=0,C=w.h.firstChild(o);f=b[O];O++){for(f.Y||w.a.extend(f,e(o,a,f.Aa,l,f.nb)),r=0;E=f.Y[r];C=E.nextSibling,d=E,r++)E!==C&&w.h.Vb(o,E,d);!f.Dd&&l&&(l(f.Aa,f.Y,f.nb),f.Dd=!0,d=f.Y[f.Y.length-1])}for(m&&o.ownerDocument.activeElement!=m&&m.focus(),p(s.beforeRemove,T),O=0;O<T.length;++O)T[O].Aa=i;p(s.afterMove,x),p(s.afterAdd,I)}}(),w.b("utils.setDomNodeChildrenFromArrayMapping",w.a.cc),w.ba=function(){this.allowTemplateRewriting=!1},w.ba.prototype=new w.ca,w.ba.prototype.constructor=w.ba,w.ba.prototype.renderTemplateSource=function(t,e,n,i){return(e=9>w.a.W||!t.nodes?null:t.nodes())?w.a.la(e.cloneNode(!0).childNodes):(t=t.text(),w.a.ta(t,i))},w.ba.Na=new w.ba,w.ec(w.ba.Na),w.b("nativeTemplateEngine",w.ba),function(){w.Za=function(){var t=this.Gd=function(){if(!a||!a.tmpl)return 0;try{if(0<=a.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(t){}return 1}();this.renderTemplateSource=function(e,n,i,r){if(r=r||o,i=i||{},2>t)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var s=e.data("precompiled");return s||(s=e.text()||"",s=a.template(null,"{{ko_with $item.koBindingContext}}"+s+"{{/ko_with}}"),e.data("precompiled",s)),e=[n.$data],n=a.extend({koBindingContext:n},i.templateOptions),(n=a.tmpl(s,e,n)).appendTo(r.createElement("div")),a.fragments={},n},this.createJavaScriptEvaluatorBlock=function(t){return"{{ko_code ((function() { return "+t+" })()) }}"},this.addTemplate=function(t,e){o.write("<script type='text/html' id='"+t+"'>"+e+"<\/script>")},0<t&&(a.tmpl.tag.ko_code={open:"__.push($1 || '');"},a.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},w.Za.prototype=new w.ca,w.Za.prototype.constructor=w.Za;var t=new w.Za;0<t.Gd&&w.ec(t),w.b("jqueryTmplTemplateEngine",w.Za)}()})}()},{}],2:[function(t,e,n){"use strict";var i,o=(i=t("knockout"))&&i.__esModule?i:{default:i};var r="ontouchstart"in window;o.default.bindingHandlers.menuButton={init:function(t,e){o.default.unwrap(e())&&(r?(t.addEventListener("touchstart",function(){o.default.utils.toggleDomNodeCssClass(t,"hover active",!0)}),t.addEventListener("touchend",function(){o.default.utils.toggleDomNodeCssClass(t,"hover active",!1)})):(t.addEventListener("mouseover",function(){o.default.utils.toggleDomNodeCssClass(t,"hover",!0)}),t.addEventListener("mousedown",function(){o.default.utils.toggleDomNodeCssClass(t,"active",!0)}),t.addEventListener("mouseup",function(){o.default.utils.toggleDomNodeCssClass(t,"active",!1)}),t.addEventListener("mouseout",function(){o.default.utils.toggleDomNodeCssClass(t,"hover",!1),o.default.utils.toggleDomNodeCssClass(t,"active",!1),window.getSelection().removeAllRanges()})))}}},{knockout:1}],3:[function(t,e,n){"use strict";var i,o=(i=t("knockout"))&&i.__esModule?i:{default:i};var r="ontouchstart"in window,a=null,s=null,l=null;o.default.bindingHandlers.swipePages={init:function(t,e){r&&o.default.unwrap(e())&&(t.addEventListener("touchstart",function(t){if(!(t.touches.length>1||window.visualViewport&&window.visualViewport.scale>1)){var e=document.getElementById("vivliostyle-viewer-viewport");e&&e.scrollWidth>e.clientWidth||(a=t.touches[0].clientX,s=t.touches[0].clientY)}}),t.addEventListener("touchmove",function(t){if(!(t.touches.length>1)&&null!==a&&null!==s){var e=t.touches[0].clientX-a,n=t.touches[0].clientY-s;Math.abs(e)>Math.abs(n)&&(l=e<0?document.getElementById("vivliostyle-page-navigation-right"):document.getElementById("vivliostyle-page-navigation-left")),Math.abs(e)+Math.abs(n)>=16&&(l&&(l.click(),o.default.utils.toggleDomNodeCssClass(l,"active",!0)),a=null,s=null)}}),t.addEventListener("touchend",function(t){l&&o.default.utils.toggleDomNodeCssClass(l,"active",!1),l=null,a=null,s=null}))}}},{knockout:1}],4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=(i=t("../models/message-queue"))&&i.__esModule?i:{default:i};function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var a={DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error"},s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.logLevel=a.ERROR}var e,n,i;return e=t,(n=[{key:"setLogLevel",value:function(t){this.logLevel=t}},{key:"debug",value:function(t){this.logLevel===a.DEBUG&&o.default.push({type:"debug",content:t})}},{key:"info",value:function(t){this.logLevel!==a.DEBUG&&this.logLevel!==a.INFO||o.default.push({type:"info",content:t})}},{key:"warn",value:function(t){this.logLevel!==a.DEBUG&&this.logLevel!==a.INFO&&this.logLevel!==a.WARN||o.default.push({type:"warn",content:t})}},{key:"error",value:function(t){this.logLevel!==a.DEBUG&&this.logLevel!==a.INFO&&this.logLevel!==a.WARN&&this.logLevel!==a.ERROR||o.default.push({type:"error",content:t})}}])&&r(e.prototype,n),i&&r(e,i),t}();s.LogLevel=a;var l=new s;s.getLogger=function(){return l};var u=s;n.default=u},{"../models/message-queue":7}],5:[function(t,e,n){"use strict";var i=a(t("vivliostyle")),o=a(t("./models/vivliostyle")),r=a(t("./vivliostyle-viewer"));function a(t){return t&&t.__esModule?t:{default:t}}o.default.setInstance(i.default),r.default.start()},{"./models/vivliostyle":11,"./vivliostyle-viewer":22,vivliostyle:23}],6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=s(t("knockout")),o=s(t("../stores/url-parameters")),r=s(t("./page-style")),a=s(t("../utils/string-util"));function s(t){return t&&t.__esModule?t:{default:t}}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var u=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n,a,s,l,u,c=(n=o.default.getParameter("b"),a=o.default.getParameter("x"),s=o.default.getParameter("f"),l=o.default.getParameter("style"),u=o.default.getParameter("userStyle"),{bookUrl:n[0]||null,xUrl:!n[0]&&a.length&&a[0]?a:null,fragment:s[0]||null,authorStyleSheet:l.length?l:[],userStyleSheet:u.length?u:[]});this.bookUrl=i.default.observable(c.bookUrl||""),this.xUrl=i.default.observable(c.xUrl||null),this.fragment=i.default.observable(c.fragment||""),this.authorStyleSheet=i.default.observable(c.authorStyleSheet),this.userStyleSheet=i.default.observable(c.userStyleSheet),this.pageStyle=new r.default,this.dataUserStyleIndex=-1,this.fragment.subscribe(function(t){if(/^epubcfi\(\/([246]\/)?2!\)/.test(t))o.default.removeParameter("f");else{var e=t.replace(/[\s+&?=#\u007F-\uFFFF]+/g,encodeURIComponent);o.default.setParameter("f",e)}}),c.userStyleSheet.find(function(t,n){if(/^data:,.*?\/\*(?:<|%3C)viewer(?:>|%3E)\*\//.test(t)){e.dataUserStyleIndex=n;var i=t.replace(/^data:,/,"").replace(/%(?![0-9A-Fa-f]{2})/g,"%25"),o=decodeURIComponent(i);return e.pageStyle.cssText(o),!0}return!1}),this.pageStyle.cssText.subscribe(function(t){e.updateUserStyleSheetFromCSSText(t)})}var e,n,s;return e=t,(n=[{key:"toObject",value:function(){function t(t){return t.map(function(t){return{url:t}})}var e=t(this.userStyleSheet());return this.pageStyle.pageSizeMode()==r.default.Mode.DEFAULT&&e.unshift({text:"@page{size:auto}"}),{fragment:this.fragment(),authorStyleSheet:t(this.authorStyleSheet()),userStyleSheet:e}}},{key:"updateUserStyleSheetFromCSSText",value:function(t){null==t&&(t=this.pageStyle.toCSSText());var e=this.userStyleSheet();if((!t||/^\s*(\/\*.*?\*\/\s*)*$/.test(t))&&e.length<=(-1==this.dataUserStyleIndex?0:1))return e.pop(),this.dataUserStyleIndex=-1,this.userStyleSheet(e),void o.default.removeParameter("userStyle");var n="data:,"+a.default.percentEncodeForDataURI(t.trim());-1==this.dataUserStyleIndex?(e.push(n),this.dataUserStyleIndex=e.length-1):e[this.dataUserStyleIndex]=n,this.userStyleSheet(e),o.default.setParameter("userStyle",n,this.dataUserStyleIndex)}}])&&l(e.prototype,n),s&&l(e,s),t}();n.default=u},{"../stores/url-parameters":13,"../utils/string-util":16,"./page-style":8,knockout:1}],7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=(i=t("knockout"))&&i.__esModule?i:{default:i};var r=new function(){return o.default.observableArray()};n.default=r},{knockout:1}],8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=(i=t("knockout"))&&i.__esModule?i:{default:i};function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var s={DEFAULT:"",AUTO:"auto",PRESET:"preset",CUSTOM:"custom",ZERO:"0"},l=[{name:"A5",description:"A5"},{name:"A4",description:"A4"},{name:"A3",description:"A3"},{name:"B5",description:"B5 (ISO)"},{name:"B4",description:"B4 (ISO)"},{name:"JIS-B5",description:"B5 (JIS)"},{name:"JIS-B4",description:"B4 (JIS)"},{name:"letter",description:"letter"},{name:"legal",description:"legal"},{name:"ledger",description:"ledger"}],u={customWidth:"210mm",customHeight:"297mm",customMargin:"10%",baseFontSize:"12pt",baseLineHeight:"1.2",baseFontFamily:"serif",viewerFontSize:16},c=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pageSizeMode=o.default.observable(s.DEFAULT),this.presetSize=o.default.observable(l[1]),this.isLandscape=o.default.observable(!1),this.customWidth=o.default.observable(u.customWidth),this.customHeight=o.default.observable(u.customHeight),this.pageSizeImportant=o.default.observable(!1),this.pageMarginMode=o.default.observable(s.DEFAULT),this.customMargin=o.default.observable(u.customMargin),this.pageMarginImportant=o.default.observable(!1),this.firstPageMarginZero=o.default.observable(!1),this.firstPageMarginZeroImportant=o.default.observable(!1),this.forceHtmlBodyMarginZero=o.default.observable(!1),this.widowsOrphans=o.default.observable(""),this.widowsOrphansImportant=o.default.observable(!1),this.imageMaxSizeToFitPage=o.default.observable(!1),this.imageMaxSizeToFitPageImportant=o.default.observable(!1),this.imageKeepAspectRatio=o.default.observable(!1),this.imageKeepAspectRatioImportant=o.default.observable(!1),this.baseFontSize=o.default.observable(u.baseFontSize),this.baseFontSizeSpecified=o.default.observable(!1),this.baseFontSizeImportant=o.default.observable(!1),this.baseLineHeight=o.default.observable(u.baseLineHeight),this.baseLineHeightSpecified=o.default.observable(!1),this.baseLineHeightImportant=o.default.observable(!1),this.baseFontFamily=o.default.observable(u.baseFontFamily),this.baseFontFamilySpecified=o.default.observable(!1),this.baseFontFamilyImportant=o.default.observable(!1),this.allImportant=o.default.observable(!1),this.pageOtherStyle=o.default.observable(""),this.firstPageOtherStyle=o.default.observable(""),this.rootOtherStyle=o.default.observable(""),this.beforeOtherStyle=o.default.observable(""),this.afterOtherStyle=o.default.observable(""),this.viewerFontSize=null,this.setViewerFontSizeObservable=function(t){n.viewerFontSize=t;var e=document.getElementsByName("vivliostyle-settings_viewer-font-size")[0];e&&(e.value=n.fontSizePxToPercent(t(),100,5))},this.viewerFontSizePercent=o.default.pureComputed({read:function(){return this.viewerFontSize?this.fontSizePxToPercent(this.viewerFontSize(),100,5):100},write:function(t){if(this.viewerFontSize){var e=parseFloat(t),n=e&&this.fontSizePercentToPx(e);if(!n||n<5||n>72){var i=document.getElementsByName("vivliostyle-settings_viewer-font-size")[0];i&&(i.value="100"),n=u.viewerFontSize}this.viewerFontSize(n)}},owner:this}),this.cssText=o.default.pureComputed({read:this.toCSSText,write:this.fromCSSText,owner:this}),this.allImportant.subscribe(function(t){n.pageSizeImportant(t),n.pageMarginImportant(t),n.firstPageMarginZeroImportant(t),n.widowsOrphansImportant(t),n.imageMaxSizeToFitPageImportant(t),n.imageKeepAspectRatioImportant(t),n.baseFontSizeImportant(t),n.baseLineHeightImportant(t),n.baseFontFamilyImportant(t)}),this.pageStyleRegExp=new RegExp("^((?:\\n|.)*?)\\/\\*<viewer>\\*\\/\\s*(?:@page\\s*\\{\\s*(?:size:\\s*([^\\s!;{}]+)(?:\\s+([^\\s!;{}]+))?\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?(?:margin:\\s*([^\\s!;{}]+(?:\\s+[^\\s!;{}]+)?(?:\\s+[^\\s!;{}]+)?(?:\\s+[^\\s!;{}]+)?)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?((?:[^{}]+|\\{[^{}]*\\})*)\\}\\s*)?(?:@page\\s*:first\\s*\\{\\s*(margin:\\s*0(?:\\w+|%)?\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?((?:[^{}]+|\\{[^{}]*\\})*)\\}\\s*)?((?:html|:root),\\s*body\\s*\\{\\s*margin:\\s*0(?:\\w+|%)?\\s*!important(?:;|(?=[\\s{}]))\\s*\\}\\s*)?(?:(?:html|:root)\\s*\\{\\s*(?:font-size:\\s*(calc\\([^()]+\\)|[^\\s!;{}]+)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?(?:line-height:\\s*([^\\s!;{}]+)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?(?:font-family:\\s*([^!;{}]+)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?([^{}]*)\\}\\s*)?(?:body\\s*\\{\\s*(?:[-\\w]+:\\s*inherit\\s*!important(?:;|(?=[\\s{}]))\\s*)+\\}\\s*)?(?:\\*\\s*\\{\\s*widows:\\s*(1|999)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*orphans:\\s*\\19\\s*\\20(?:;|(?=[\\s{}]))\\s*\\}\\s*)?(?:img,\\s*svg\\s*\\{\\s*(max-inline-size:\\s*100%\\s*(!important)?(?:;|(?=[\\s{}]))\\s*max-block-size:\\s*100vb\\s*\\22(?:;|(?=[\\s{}]))\\s*)?(object-fit:\\s*contain\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?\\}\\s*)?((?:\\n|.)*)$"),e&&this.copyFrom(e)}var e,n,i;return e=t,(n=[{key:"fontSizePxToPercent",value:function(t,e,n){var i=t/u.viewerFontSize*(e||100);return n&&(i=i.toPrecision(n).replace(/(?:\.0*|(\.\d*?)0+)$/,"$1")),i}},{key:"fontSizePercentToPx",value:function(t,e,n){var i=t/(e||100)*u.viewerFontSize;return n&&(i=i.toPrecision(n).replace(/(?:\.0*|(\.\d*?)0+)$/,"$1")),i}},{key:"fromCSSText",value:function(t){var e=this.pageStyleRegExp.exec(t);if(e){var n=r(e,26),i=n[1],o=n[2],a=n[3],u=n[4],c=n[5],h=n[6],p=n[7],f=n[8],d=n[9],g=n[10],m=n[11],v=n[12],y=n[13],b=n[14],w=n[15],E=n[16],S=n[17],N=n[18],C=n[19],T=n[20],x=n[21],I=n[22],P=n[23],O=n[24],k=n[25],A=0,R=0;if(this.beforeOtherStyle(i),"landscape"==o||"portrait"==o?(this.isLandscape("landscape"==o),o=a,a=null):"landscape"!=a&&"portrait"!=a||(this.isLandscape("landscape"==a),a=null),null!=o){if(null==a)if("auto"==o)this.pageSizeMode(s.AUTO);else{var L=l.find(function(t){return t.name.toLowerCase()==o.toLowerCase()});L?(this.pageSizeMode(s.PRESET),this.presetSize(L)):(this.pageSizeMode(s.CUSTOM),this.customWidth(o),this.customHeight(o))}else this.pageSizeMode(s.CUSTOM),this.customWidth(o),this.customHeight(a);this.pageSizeImportant(!!u),u?A++:R++}else this.pageSizeMode(s.DEFAULT);null!=c?(this.pageMarginMode("0"==c?s.ZERO:s.CUSTOM),"0"==c?this.pageMarginMode(s.ZERO):(this.pageMarginMode(s.CUSTOM),this.customMargin(c)),this.pageMarginImportant(!!h),h?A++:R++):this.pageMarginMode(s.DEFAULT),p=p||"",this.pageOtherStyle(p),f?(this.firstPageMarginZero(!0),this.firstPageMarginZeroImportant(!!d),d?A++:R++):this.firstPageMarginZero(!1),g=g||"",this.firstPageOtherStyle(g),m?this.forceHtmlBodyMarginZero(!0):this.forceHtmlBodyMarginZero(!1),null!=v?(v=v.replace(/^\s*calc\([.\d]+\s*\*\s*([.\d]+\w+)\)\s*$/,"$1"),this.baseFontSizeSpecified(!0),this.baseFontSize(v),this.baseFontSizeImportant(!!y),y?A++:R++):this.baseFontSizeSpecified(!1),null!=b?(this.baseLineHeightSpecified(!0),this.baseLineHeight(b),this.baseLineHeightImportant(!!w),w?A++:R++):this.baseLineHeightSpecified(!1),null!=E?(E=E.trim(),this.baseFontFamilySpecified(!0),this.baseFontFamily(E),this.baseFontFamilyImportant(!!S),S?A++:R++):this.baseFontFamilySpecified(!1),N=N||"",this.rootOtherStyle(N),null!=C?(this.widowsOrphans(C),this.widowsOrphansImportant(!!T),T?A++:R++):this.widowsOrphans(s.DEFAULT),x?(this.imageMaxSizeToFitPage(!0),this.imageMaxSizeToFitPageImportant(!!I),I?A++:R++):this.imageMaxSizeToFitPage(!1),P?(this.imageKeepAspectRatio(!0),this.imageKeepAspectRatioImportant(!!O),O?A++:R++):this.imageKeepAspectRatio(!1),k=k.replace(/\/\*<\/?viewer>\*\/\n?/g,"")||"",this.afterOtherStyle(k),this.allImportant(A>0&&0==R)}else{var _=t.replace(/\/\*<\/?viewer>\*\/\n?/g,"")||"";this.afterOtherStyle(_)}}},{key:"toCSSText",value:function(){function t(t){return t?" !important":""}var e=this.beforeOtherStyle();if(e+="/*<viewer>*/\n",this.pageSizeMode()!=s.DEFAULT||this.pageMarginMode()!=s.DEFAULT||this.pageOtherStyle()){if(e+="@page { ",this.pageSizeMode()!=s.DEFAULT){switch(e+="size: ",this.pageSizeMode()){case s.AUTO:e+="auto";break;case s.PRESET:e+=this.presetSize().name,this.isLandscape()&&(e+=" landscape");break;case s.CUSTOM:e+="".concat(this.customWidth()," ").concat(this.customHeight());break;default:throw new Error("Unknown pageSizeMode ".concat(this.pageSizeMode()))}e+="".concat(t(this.pageSizeImportant()),"; ")}if(this.pageMarginMode()!=s.DEFAULT){switch(e+="margin: ",this.pageMarginMode()){case s.AUTO:e+="auto";break;case s.ZERO:e+="0";break;case s.CUSTOM:e+="".concat(this.customMargin());break;default:throw new Error("Unknown pageMarginMode ".concat(this.pageMarginMode()))}e+="".concat(t(this.pageMarginImportant()),"; ")}e+=this.pageOtherStyle(),e+="}\n"}if((this.firstPageMarginZero()||this.firstPageOtherStyle())&&(e+="@page :first { ",this.firstPageMarginZero()&&(e+="margin: 0".concat(t(this.firstPageMarginZeroImportant()),"; ")),e+=this.firstPageOtherStyle(),e+="}\n"),this.forceHtmlBodyMarginZero()&&(e+=":root, body { margin: 0 !important; }\n"),this.baseFontSizeSpecified()||this.baseLineHeightSpecified()||this.baseFontFamilySpecified()||this.rootOtherStyle()){e+=":root { ";var n=this.baseFontSize();if(this.baseFontSizeSpecified())if(this.viewerFontSize&&this.viewerFontSize()!=u.viewerFontSize&&!n.endsWith("%")){var i=this.fontSizePxToPercent(this.viewerFontSize(),1,5);e+="font-size: calc(".concat(i," * ").concat(n,")").concat(t(this.baseFontSizeImportant()),"; ")}else e+="font-size: ".concat(this.baseFontSize()).concat(t(this.baseFontSizeImportant()),"; ");this.baseLineHeightSpecified()&&(e+="line-height: ".concat(this.baseLineHeight()).concat(t(this.baseLineHeightImportant()),"; ")),this.baseFontFamilySpecified()&&(e+="font-family: ".concat(this.baseFontFamily()).concat(t(this.baseFontFamilyImportant()),"; ")),e+=this.rootOtherStyle(),e+="}\n"}return(this.baseFontSizeSpecified()&&this.baseFontSizeImportant()||this.baseLineHeightSpecified()&&this.baseLineHeightImportant()||this.baseFontFamilySpecified()&&this.baseFontFamilyImportant())&&(e+="body { ",this.baseFontSizeSpecified()&&this.baseFontSizeImportant()&&(e+="font-size: inherit !important; "),this.baseLineHeightSpecified()&&this.baseLineHeightImportant()&&(e+="line-height: inherit !important; "),this.baseFontFamilySpecified()&&this.baseFontFamilyImportant()&&(e+="font-family: inherit !important; "),e+="}\n"),this.widowsOrphans()&&(e+="* { ",e+="widows: ".concat(this.widowsOrphans()).concat(t(this.widowsOrphansImportant()),"; "),e+="orphans: ".concat(this.widowsOrphans()).concat(t(this.widowsOrphansImportant()),"; "),e+="}\n"),(this.imageMaxSizeToFitPage()||this.imageKeepAspectRatio())&&(e+="img, svg { ",this.imageMaxSizeToFitPage()&&(e+="max-inline-size: 100%".concat(t(this.imageMaxSizeToFitPageImportant()),"; "),e+="max-block-size: 100vb".concat(t(this.imageMaxSizeToFitPageImportant()),"; ")),this.imageKeepAspectRatio()&&(e+="object-fit: contain".concat(t(this.imageKeepAspectRatioImportant()),"; ")),e+="}\n"),e+="/*</viewer>*/\n",e+=this.afterOtherStyle()}},{key:"copyFrom",value:function(t){this.pageSizeMode(t.pageSizeMode()),this.presetSize(t.presetSize()),this.isLandscape(t.isLandscape()),this.customWidth(t.customWidth()),this.customHeight(t.customHeight()),this.pageSizeImportant(t.pageSizeImportant()),this.pageMarginMode(t.pageMarginMode()),this.customMargin(t.customMargin()),this.pageMarginImportant(t.pageMarginImportant()),this.firstPageMarginZero(t.firstPageMarginZero()),this.firstPageMarginZeroImportant(t.firstPageMarginZeroImportant()),this.forceHtmlBodyMarginZero(t.forceHtmlBodyMarginZero()),this.widowsOrphans(t.widowsOrphans()),this.widowsOrphansImportant(t.widowsOrphansImportant()),this.imageMaxSizeToFitPage(t.imageMaxSizeToFitPage()),this.imageMaxSizeToFitPageImportant(t.imageMaxSizeToFitPageImportant()),this.imageKeepAspectRatio(t.imageKeepAspectRatio()),this.imageKeepAspectRatioImportant(t.imageKeepAspectRatioImportant()),this.baseFontSize(t.baseFontSize()),this.baseFontSizeSpecified(t.baseFontSizeSpecified()),this.baseFontSizeImportant(t.baseFontSizeImportant()),this.baseLineHeight(t.baseLineHeight()),this.baseLineHeightSpecified(t.baseLineHeightSpecified()),this.baseLineHeightImportant(t.baseLineHeightImportant()),this.baseFontFamily(t.baseFontFamily()),this.baseFontFamilySpecified(t.baseFontFamilySpecified()),this.baseFontFamilyImportant(t.baseFontFamilyImportant()),this.allImportant(t.allImportant()),this.pageOtherStyle(t.pageOtherStyle()),this.firstPageOtherStyle(t.firstPageOtherStyle()),this.rootOtherStyle(t.rootOtherStyle()),this.beforeOtherStyle(t.beforeOtherStyle()),this.afterOtherStyle(t.afterOtherStyle()),this.viewerFontSize&&t.viewerFontSize&&this.viewerFontSize(t.viewerFontSize())}},{key:"equivalentTo",value:function(t){return this.pageSizeMode()===t.pageSizeMode()&&((this.pageSizeMode()!==s.PRESET||this.presetSize()===t.presetSize())&&((this.pageSizeMode()!==s.PRESET||this.isLandscape()===t.isLandscape())&&((this.pageSizeMode()!==s.CUSTOM||this.customWidth()===t.customWidth())&&((this.pageSizeMode()!==s.CUSTOM||this.customHeight()===t.customHeight())&&(this.pageSizeImportant()===t.pageSizeImportant()&&(this.pageMarginMode()===t.pageMarginMode()&&((this.pageMarginMode()!==s.CUSTOM||this.customMargin()===t.customMargin())&&(this.pageMarginImportant()===t.pageMarginImportant()&&(this.firstPageMarginZero()===t.firstPageMarginZero()&&(this.firstPageMarginZeroImportant()===t.firstPageMarginZeroImportant()&&(this.forceHtmlBodyMarginZero()===t.forceHtmlBodyMarginZero()&&(this.widowsOrphans()===t.widowsOrphans()&&(this.widowsOrphansImportant()===t.widowsOrphansImportant()&&(this.imageMaxSizeToFitPage()===t.imageMaxSizeToFitPage()&&(this.imageMaxSizeToFitPageImportant()===t.imageMaxSizeToFitPageImportant()&&(this.imageKeepAspectRatio()===t.imageKeepAspectRatio()&&(this.imageKeepAspectRatioImportant()===t.imageKeepAspectRatioImportant()&&(this.baseFontSizeSpecified()===t.baseFontSizeSpecified()&&((!this.baseFontSizeSpecified()||this.baseFontSize()===t.baseFontSize())&&(this.baseFontSizeImportant()===t.baseFontSizeImportant()&&(this.baseLineHeightSpecified()===t.baseLineHeightSpecified()&&((!this.baseLineHeightSpecified()||this.baseLineHeight()===t.baseLineHeight())&&(this.baseLineHeightImportant()===t.baseLineHeightImportant()&&(this.baseFontFamilySpecified()===t.baseFontFamilySpecified()&&((!this.baseFontFamilySpecified()||this.baseFontFamily()===t.baseFontFamily())&&(this.baseFontFamilyImportant()===t.baseFontFamilyImportant()&&(this.allImportant()===t.allImportant()&&(this.pageOtherStyle()===t.pageOtherStyle()&&(this.firstPageOtherStyle()===t.firstPageOtherStyle()&&(this.rootOtherStyle()===t.rootOtherStyle()&&(this.beforeOtherStyle()===t.beforeOtherStyle()&&(this.afterOtherStyle()===t.afterOtherStyle()&&!(!this.viewerFontSize!=!t.viewerFontSize||this.viewerFontSize&&this.viewerFontSize()!==t.viewerFontSize())))))))))))))))))))))))))))))))))}}])&&a(e.prototype,n),i&&a(e,i),t}();c.Mode=s,c.Constants=u,c.PresetSize=c.prototype.PresetSize=l;var h=c;n.default=h},{knockout:1}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=(i=t("../models/vivliostyle"))&&i.__esModule?i:{default:i};function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"toSpreadViewString",value:function(){switch(this){case s.SPREAD:return"true";case s.SINGLE_PAGE:return"false";case s.AUTO_SPREAD:return"auto";default:throw new Error("Invalid PageViewMode")}}},{key:"toString",value:function(){switch(this){case s.SPREAD:return"spread";case s.SINGLE_PAGE:return"singlePage";case s.AUTO_SPREAD:return"autoSpread";default:throw new Error("Invalid PageViewMode")}}}])&&r(e.prototype,n),i&&r(e,i),t}(),s={AUTO_SPREAD:new a,SINGLE_PAGE:new a,SPREAD:new a,defaultMode:function(){return this.AUTO_SPREAD},fromSpreadViewString:function(t){switch(t){case"true":return this.SPREAD;case"false":return this.SINGLE_PAGE;case"auto":default:return this.AUTO_SPREAD}},of:function(t){switch(t){case o.default.viewer.PageViewMode.SPREAD:return this.SPREAD;case o.default.viewer.PageViewMode.SINGLE_PAGE:return this.SINGLE_PAGE;case o.default.viewer.PageViewMode.AUTO_SPREAD:return this.AUTO_SPREAD;default:throw new Error("Invalid PageViewMode name: ".concat(t))}}},l=s;n.default=l},{"../models/vivliostyle":11}],10:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=s(t("knockout")),o=s(t("../stores/url-parameters")),r=s(t("./page-view-mode")),a=s(t("./zoom-options"));function s(t){return t&&t.__esModule?t:{default:t}}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(){return{renderAllPages:o.default.hasParameter("x"),fontSize:16,profile:!1,pageViewMode:r.default.defaultMode(),zoom:a.default.createDefaultOptions()}}var h=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderAllPages=i.default.observable(),this.fontSize=i.default.observable(),this.profile=i.default.observable(),this.pageViewMode=i.default.observable(),this.zoom=i.default.observable(),e)this.copyFrom(e);else{var n=c(),a=function(){var t=o.default.getParameter("renderAllPages")[0],e=o.default.getParameter("fontSize")[0],n=/^([\d.]+)(?:(%25|%)|\/([\d.]+))?$/.exec(e),i=null;if(n){var a=u(n,4),s=a[1],l=a[2],c=a[3];i=parseFloat(s),(l||c)&&(i=16*i/(l?100:parseFloat(c))),i<5&&(i=5),i>72&&(i=72)}return{renderAllPages:"true"===t||"false"!==t&&null,fontSize:i,profile:"true"===o.default.getParameter("profile")[0],pageViewMode:r.default.fromSpreadViewString(o.default.getParameter("spread")[0])}}();this.renderAllPages(null!==a.renderAllPages?a.renderAllPages:n.renderAllPages),this.fontSize(a.fontSize||n.fontSize),this.profile(a.profile||n.profile),this.pageViewMode(a.pageViewMode||n.pageViewMode),this.zoom(n.zoom),this.pageViewMode.subscribe(function(t){t===n.pageViewMode?o.default.removeParameter("spread"):o.default.setParameter("spread",t.toSpreadViewString())}),this.renderAllPages.subscribe(function(t){t===n.renderAllPages?o.default.removeParameter("renderAllPages"):o.default.setParameter("renderAllPages",t.toString())}),this.fontSize.subscribe(function(t){"number"==typeof t&&(t=t.toPrecision(10).replace(/(?:\.0*|(\.\d*?)0+)$/,"$1")),t==n.fontSize?o.default.removeParameter("fontSize"):o.default.setParameter("fontSize","".concat(t,"/").concat(n.fontSize))})}}var e,n,a;return e=t,(n=[{key:"copyFrom",value:function(t){this.renderAllPages(t.renderAllPages()),this.fontSize(t.fontSize()),this.profile(t.profile()),this.pageViewMode(t.pageViewMode()),this.zoom(t.zoom())}},{key:"toObject",value:function(){return{renderAllPages:this.renderAllPages(),fontSize:this.fontSize(),pageViewMode:this.pageViewMode().toString(),zoom:this.zoom().zoom,fitToScreen:this.zoom().fitToScreen}}}])&&l(e.prototype,n),a&&l(e,a),t}();h.getDefaultValues=c;var p=h;n.default=p},{"../stores/url-parameters":13,"./page-view-mode":9,"./zoom-options":12,knockout:1}],11:[function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewer=null,this.constants=null,this.profile=null}var e,n,o;return e=t,(n=[{key:"setInstance",value:function(t){this.viewer=t.viewer,this.constants=t.constants,this.profile=t.profile}}])&&i(e.prototype,n),o&&i(e,o),t}());n.default=o},{}],12:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=(i=t("../models/vivliostyle"))&&i.__esModule?i:{default:i};function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function p(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),t}var f=function(){function t(e){c(this,t),this.zoom=e}return p(t,[{key:"zoomIn",value:function(t){return new g(1.25*this.getCurrentZoomFactor(t))}},{key:"zoomOut",value:function(t){return new g(.8*this.getCurrentZoomFactor(t))}},{key:"zoomToActualSize",value:function(){return new g(1)}}],[{key:"createDefaultOptions",value:function(){return new d}},{key:"createFromZoomFactor",value:function(t){return new g(t)}}]),t}(),d=function(t){function e(){return c(this,e),a(this,s(e).call(this,1))}return l(e,f),p(e,[{key:"toggleFitToScreen",value:function(){return new g(1)}},{key:"getCurrentZoomFactor",value:function(t){return t.queryZoomFactor(o.default.viewer.ZoomType.FIT_INSIDE_VIEWPORT)}},{key:"fitToScreen",get:function(){return!0}}]),e}(),g=function(t){function e(){return c(this,e),a(this,s(e).apply(this,arguments))}return l(e,f),p(e,[{key:"toggleFitToScreen",value:function(){return new d}},{key:"getCurrentZoomFactor",value:function(t){return this.zoom}},{key:"fitToScreen",get:function(){return!1}}]),e}(),m=f;n.default=m},{"../models/vivliostyle":11}],13:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=(i=t("../utils/string-util"))&&i.__esModule?i:{default:i};function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t){return new RegExp("[#&]".concat(o.default.escapeUnicodeString(t),"=([^&]*)"),"g")}var s=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.history=window?window.history:{},this.location=window?window.location:{href:""},this.storedUrl=this.location.href}var e,n,i;return e=t,(n=[{key:"getBaseURL",value:function(){var t=this.location.href;return(t=t.replace(/#.*$/,"")).replace(/\/[^\/]*$/,"/")}},{key:"hasParameter",value:function(t){var e=this.location.href;return a(t).test(e)}},{key:"getParameter",value:function(t){for(var e,n=this.location.href,i=a(t),o=[];e=i.exec(n);)o.push(e[1]);return o}},{key:"setParameter",value:function(t,e,n){var i,o=this.location.href,r=a(t),s=r.exec(o);if(s&&n)for(;n-- >=1;)s=r.exec(o);if(s){var l=s[1].length,u=s.index+s[0].length-l;i=o.substring(0,u)+e+o.substring(u+l)}else i="".concat(o+(o.match(/[#&]$/)?"":o.match(/#/)?"&":"#")+t,"=").concat(e);this.history.replaceState?this.history.replaceState(null,"",i):this.location.href=i,this.storedUrl=i}},{key:"removeParameter",value:function(t,e){var n,i=this.location.href,o=a(t),r=o.exec(i);if(r&&e&&(r=o.exec(i)),r){for(n=i;r;r=o.exec(n)){var s=r.index+r[0].length;n="#"==r[0].charAt(0)?n.substring(0,r.index+1)+n.substring(s+1):n.substring(0,r.index)+n.substring(s),o.lastIndex-=r[0].length}n=n.replace(/^(.*?)[#&]$/,"$1"),this.history.replaceState?this.history.replaceState(null,"",n):this.location.href=n}this.storedUrl=n}}])&&r(e.prototype,n),i&&r(e,i),t}());n.default=s},{"../utils/string-util":16}],14:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i={Unidentified:"Unidentified",ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ArrowUp:"ArrowUp",Home:"Home",End:"End",PageDown:"PageDown",PageUp:"PageUp",Escape:"Escape",Enter:"Enter",Space:" "};var o={Keys:i,identifyKeyFromEvent:function(t){var e=t.key,n=t.keyIdentifier,o=t.location;return e===i.ArrowDown||"Down"===e||"Down"===n?t.metaKey?i.End:i.ArrowDown:e===i.ArrowLeft||"Left"===e||"Left"===n?i.ArrowLeft:e===i.ArrowRight||"Right"===e||"Right"===n?i.ArrowRight:e===i.ArrowUp||"Up"===e||"Up"===n?t.metaKey?i.Home:i.ArrowUp:e===i.Escape||"Esc"===e||"U+001B"===n?i.Escape:e===i.Enter||"Enter"===n?i.Enter:e===i.Space||"U+0020"===n?i.Space:"0"===e||"U+0030"===n?"0":"+"===e||"Add"===e||"U+002B"===n||"U+00BB"===n||"U+004B"===n&&o===KeyboardEvent.DOM_KEY_LOCATION_NUMPAD?"+":"-"===e||"Subtract"===e||"U+002D"===n||"U+00BD"===n||"U+004D"===n&&o===KeyboardEvent.DOM_KEY_LOCATION_NUMPAD?"-":e||n||i.Unidentified}};n.default=o},{}],15:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=(i=t("knockout"))&&i.__esModule?i:{default:i};var r={readonlyObservable:function(t){var e=o.default.observable(t);return{getter:o.default.pureComputed(function(){return e()}),value:e}}};n.default=r},{knockout:1}],16:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i={escapeUnicodeChar:function(t){return"\\u".concat((65536|t.charCodeAt(0)).toString(16).substring(1))},escapeUnicodeString:function(t){return t.replace(/[^-a-zA-Z0-9_]/g,this.escapeUnicodeChar)},percentEncodeAmpersandAndUnencodedPercent:function(t){return t.replace(/%(?![0-9A-Fa-f]{2})/g,"%25").replace(/&/g,"%26")},percentEncodeAmpersandAndPercent:function(t){return t.replace(/%/g,"%25").replace(/&/g,"%26")},percentDecodeAmpersandAndPercent:function(t){return t.replace(/%26/g,"&").replace(/%25/g,"%")},percentEncodeForDataURI:function(t){return encodeURI(t).replace(/#/g,"%23").replace(/&/g,"%26")}};n.default=i},{}],17:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=(i=t("knockout"))&&i.__esModule?i:{default:i};function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.list=e,this.visible=o.default.pureComputed(function(){return e().length>0})}var e,n,i;return e=t,(n=[{key:"getDisplayMessage",value:function(t){var e=t.error,n=e&&(e.toString()||e.frameTrace||e.stack);return n&&(n=n.split("\n",1)[0]),n||(n=t.messages.join("\n")),n}}])&&r(e.prototype,n),i&&r(e,i),t}();n.default=a},{knockout:1}],18:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=s(t("knockout")),o=s(t("../models/viewer-options")),r=s(t("../utils/key-util")),a=s(t("../models/vivliostyle"));function s(t){return t&&t.__esModule?t:{default:t}}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var u=r.default.Keys,c=function(){function t(e,n,o,r){var s=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewerOptions_=e,this.viewer_=n,this.settingsPanel_=o,this.justClicked=!1,this.isDisabled=i.default.pureComputed(function(){return s.settingsPanel_.opened()&&!s.settingsPanel_.pinned()||!s.viewer_.state.navigatable()});var l=i.default.pureComputed(function(){return r.disablePageNavigation||s.isDisabled()});l.subscribe(function(t){var e=document.getElementById("vivliostyle-page-number");e&&(e.disabled=t)}),this.isPageNumberDisabled=i.default.pureComputed(function(){return l()}),this.isNavigateToPreviousDisabled=i.default.pureComputed(function(){return!!l()||void 0!==s.viewer_.state.status&&s.viewer_.firstPage()}),this.isNavigateToNextDisabled=i.default.pureComputed(function(){return!!l()||void 0!==s.viewer_.state.status&&((!s.viewerOptions_.renderAllPages()||s.viewer_.state.status()==a.default.constants.ReadyState.COMPLETE)&&s.viewer_.lastPage())}),this.isNavigateToLeftDisabled=i.default.pureComputed(function(){return!!l()||void 0!==s.viewer_.state.pageProgression&&(s.viewer_.state.pageProgression()===a.default.constants.PageProgression.LTR?s.isNavigateToPreviousDisabled():s.isNavigateToNextDisabled())}),this.isNavigateToRightDisabled=i.default.pureComputed(function(){return!!l()||void 0!==s.viewer_.state.pageProgression&&(s.viewer_.state.pageProgression()===a.default.constants.PageProgression.LTR?s.isNavigateToNextDisabled():s.isNavigateToPreviousDisabled())}),this.isNavigateToFirstDisabled=this.isNavigateToPreviousDisabled,this.isNavigateToLastDisabled=i.default.pureComputed(function(){return!!l()||void 0!==s.viewer_.state.status&&(!(!s.viewerOptions_.renderAllPages()||s.viewer_.state.status()==a.default.constants.ReadyState.COMPLETE)||s.viewer_.lastPage())}),this.hidePageNavigation=!!r.disablePageNavigation;var u=i.default.pureComputed(function(){return r.disableZoom||s.isDisabled()});this.isZoomOutDisabled=u,this.isZoomInDisabled=u,this.isZoomToActualSizeDisabled=u,this.isToggleFitToScreenDisabled=u,this.hideZoom=!!r.disableZoom,this.fitToScreen=i.default.pureComputed(function(){return e.zoom().fitToScreen});var c=i.default.pureComputed(function(){return r.disableFontSizeChange||s.isDisabled()});this.isIncreaseFontSizeDisabled=i.default.pureComputed(function(){return!!c()||s.viewerOptions_.fontSize()>=72}),this.isDecreaseFontSizeDisabled=i.default.pureComputed(function(){return!!c()||s.viewerOptions_.fontSize()<=5}),this.isDefaultFontSizeDisabled=c,this.hideFontSizeChange=!!r.disableFontSizeChange,this.isTOCToggleDisabled=i.default.pureComputed(function(){return r.disableTOCNavigation||s.isDisabled()||null==s.viewer_.tocVisible()}),this.hideTOCNavigation=!!r.disableTOCNavigation,this.pageNumber=i.default.pureComputed({read:function(){return this.viewer_.epageToPageNumber(this.viewer_.epage())},write:function(t){var e=this,n=this.viewer_.epage(),i=this.viewer_.epageToPageNumber(n),o=parseFloat(t.replace(/[０-９]/g,function(t){return String.fromCharCode(t.charCodeAt(0)-65248)}))||0;if(/^[-+]/.test(t)&&(o=i+o),o<1)o=1;else{var r=this.viewer_.epageCount();this.viewerOptions_.renderAllPages()?o>r&&(o=r):o>r+1&&(o=r+1)}var s=this.viewer_.epageFromPageNumber(o),l=document.getElementById("vivliostyle-page-number");l.value=o,this.viewer_.navigateToEPage(s),setTimeout(function(){e.viewer_.state.status()!=a.default.constants.ReadyState.LOADING&&e.viewer_.epage()===n&&(l.value=i),document.getElementById("vivliostyle-viewer-viewport").focus()},10)},owner:this}),this.totalPages=i.default.pureComputed(function(){var t=s.viewer_.epageCount();if(!t)return t;var e=s.pageNumber();return s.viewer_.lastPage()?t=e:e>=t&&t++,t}),["navigateToPrevious","navigateToNext","navigateToLeft","navigateToRight","navigateToFirst","navigateToLast","zoomIn","zoomOut","zoomToActualSize","toggleFitToScreen","increaseFontSize","decreaseFontSize","defaultFontSize","onclickViewport","toggleTOC"].forEach(function(t){s[t]=s[t].bind(s)})}var e,n,r;return e=t,(n=[{key:"navigateToPrevious",value:function(){return!this.isNavigateToPreviousDisabled()&&(this.viewer_.navigateToPrevious(),!0)}},{key:"navigateToNext",value:function(){return!this.isNavigateToNextDisabled()&&(this.viewer_.navigateToNext(),!0)}},{key:"navigateToLeft",value:function(){return!this.isNavigateToLeftDisabled()&&(this.viewer_.navigateToLeft(),!0)}},{key:"navigateToRight",value:function(){return!this.isNavigateToRightDisabled()&&(this.viewer_.navigateToRight(),!0)}},{key:"navigateToFirst",value:function(){return!this.isNavigateToFirstDisabled()&&(this.viewer_.navigateToFirst(),!0)}},{key:"navigateToLast",value:function(){return!this.isNavigateToLastDisabled()&&(this.viewer_.navigateToLast(),!0)}},{key:"zoomIn",value:function(){if(this.isZoomInDisabled())return!1;var t=this.viewerOptions_.zoom();return this.viewerOptions_.zoom(t.zoomIn(this.viewer_)),!0}},{key:"zoomOut",value:function(){if(this.isZoomOutDisabled())return!1;var t=this.viewerOptions_.zoom();return this.viewerOptions_.zoom(t.zoomOut(this.viewer_)),!0}},{key:"zoomToActualSize",value:function(){if(this.isZoomToActualSizeDisabled())return!1;var t=this.viewerOptions_.zoom();return this.viewerOptions_.zoom(t.zoomToActualSize()),!0}},{key:"toggleFitToScreen",value:function(){if(this.isToggleFitToScreenDisabled())return!1;var t=this.viewerOptions_.zoom();return this.viewerOptions_.zoom(t.toggleFitToScreen()),!0}},{key:"increaseFontSize",value:function(){if(this.isIncreaseFontSizeDisabled())return!1;var t=this.viewerOptions_.fontSize();return t=t<10?Math.floor(t)+1:t<20?2*(Math.floor(t/2)+1):t<40?4*(Math.floor(t/4)+1):t<72?8*(Math.floor(t/8)+1):72,this.viewerOptions_.fontSize(t),this.updateFontSizeSettings(),!0}},{key:"decreaseFontSize",value:function(){if(this.isDecreaseFontSizeDisabled())return!1;var t=this.viewerOptions_.fontSize();return t=t>40?8*(Math.ceil(t/8)-1):t>20?4*(Math.ceil(t/4)-1):t>10?2*(Math.ceil(t/2)-1):t>5?Math.ceil(t)-1:5,this.viewerOptions_.fontSize(t),this.updateFontSizeSettings(),!0}},{key:"defaultFontSize",value:function(){if(this.isDefaultFontSizeDisabled())return!1;var t=o.default.getDefaultValues().fontSize;return this.viewerOptions_.fontSize(t),this.updateFontSizeSettings(),!0}},{key:"updateFontSizeSettings",value:function(){this.settingsPanel_.state.viewerOptions.fontSize(this.viewerOptions_.fontSize()),this.viewer_.documentOptions_.pageStyle.baseFontSizeSpecified()&&(this.viewer_.documentOptions_.updateUserStyleSheetFromCSSText(),this.viewer_.loadDocument(this.viewer_.documentOptions_,this.viewerOptions_))}},{key:"onclickViewport",value:function(){if(this.settingsPanel_.justClicked)return!0;if(this.viewer_.tocVisible()&&!this.viewer_.tocPinned()){var t=document.querySelector("[data-vivliostyle-toc-box]");t&&!t.contains(document.activeElement)&&this.toggleTOC()}return this.settingsPanel_.opened()&&!this.settingsPanel_.pinned()&&this.settingsPanel_.close(),!0}},{key:"toggleTOC",value:function(){var t=this;if(this.isTOCToggleDisabled())return!1;var e=0;document.getElementById("vivliostyle-menu-item_toc-toggle");return this.viewer_.tocVisible()?this.justClicked?(this.viewer_.showTOC(!0,!1),this.justClicked=!1):(e&&(clearInterval(e),e=0),this.viewer_.showTOC(!1),this.justClicked=!0,setTimeout(function(){t.justClicked&&(document.getElementById("vivliostyle-viewer-viewport").focus(),t.justClicked=!1)},300)):(this.justClicked?(this.viewer_.showTOC(!0,!1),this.justClicked=!1):(this.viewer_.showTOC(!0,!0),this.justClicked=!0),e=setInterval(function(){var n=document.querySelector("[data-vivliostyle-toc-box]");n&&"visible"===n.style.visibility&&(n.tabIndex=0,n.focus(),clearInterval(e),e=0),t.justClicked=!1},300)),!0}},{key:"navigateTOC",value:function(t){var e=Array.from(document.querySelectorAll("[data-vivliostyle-toc-box]>*>*>*>*>*:not([hidden]) [tabindex='0'],[data-vivliostyle-toc-box]>*>*>*>*>*:not([hidden]) a[href]:not([tabindex='-1'])")),n=e.indexOf(document.activeElement),i=function(t){return e[t]&&"button"===e[t].getAttribute("role")},o=function(t){return e[t]&&"true"===e[t].getAttribute("aria-expanded")};switch(t){case u.ArrowLeft:if(-1==n){n=e.length-1;break}if(!i(n)&&i(n-1)&&n--,i(n)&&o(n))e[n].click();else for(var r=n-1;r>=0;r--)if(i(r)&&e[r].parentElement.contains(e[n])){n=r;break}break;case u.ArrowRight:if(-1==n){n=0;break}!i(n)&&i(n-1)&&n--,i(n)&&(o(n)?n+=2:e[n].click());break;case u.ArrowDown:n++;break;case u.ArrowUp:if(-1==n){n=e.length-1;break}n>0&&i(--n)&&n--;break;case u.Home:n=0;break;case u.End:n=e.length-1;break;case u.Space:!i(n)&&i(n-1)&&n--,i(n)&&e[n].click()}return i(n)&&n++,e[n]&&e[n].focus(),!0}},{key:"handleKey",value:function(t){if(this.settingsPanel_.opened()&&this.settingsPanel_.settingsToggle.contains(document.activeElement))return!0;var e=document.getElementById("vivliostyle-page-number"),n=document.getElementById("vivliostyle-viewer-viewport"),i=n.scrollWidth>n.clientWidth,o=n.scrollHeight>n.clientHeight,r=e===document.activeElement,a=this.viewer_.tocVisible()&&!r&&n!=document.activeElement;switch(t){case"+":return r||!this.increaseFontSize();case"-":return r||!this.decreaseFontSize();case"0":return r||!this.defaultFontSize();case"1":return r||!this.zoomToActualSize();case u.ArrowLeft:return a?!this.navigateTOC(t):r||i||!this.navigateToLeft();case u.ArrowRight:return a?!this.navigateTOC(t):r||i||!this.navigateToRight();case u.ArrowDown:return a?!this.navigateTOC(t):(n.focus(),o||!this.navigateToNext());case u.ArrowUp:return a?!this.navigateTOC(t):(n.focus(),o||!this.navigateToPrevious());case u.PageDown:return!!a||(n.focus(),!this.navigateToNext());case u.PageUp:return!!a||(n.focus(),!this.navigateToPrevious());case u.Home:return a?!this.navigateTOC(t):(n.focus(),!this.navigateToFirst());case u.End:return a?!this.navigateTOC(t):(n.focus(),!this.navigateToLast());case"o":case"O":return n.focus(),!this.zoomOut();case"i":case"I":return n.focus(),!this.zoomIn();case"f":case"F":return n.focus(),!this.toggleFitToScreen();case"g":case"G":return e.focus(),!1;case"t":case"T":return n.focus(),!this.toggleTOC();case u.Escape:return this.viewer_.tocVisible()?!this.toggleTOC():(n.focus(),!0);case u.Space:return a?!this.navigateTOC(t):"button"!==document.activeElement.getAttribute("role")||(document.activeElement.click(),!1);default:return!0}}}])&&l(e.prototype,n),r&&l(e,r),t}();n.default=c},{"../models/viewer-options":10,"../models/vivliostyle":11,"../utils/key-util":14,knockout:1}],19:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=s(t("knockout")),o=s(t("../models/viewer-options")),r=s(t("../models/page-style")),a=s(t("../models/page-view-mode"));function s(t){return t&&t.__esModule?t:{default:t}}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var u=s(t("../utils/key-util")).default.Keys,c=function(){function t(e,n,s,l,u){var c=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewerOptions_=e,this.documentOptions_=n,this.viewer_=s,this.isPageStyleChangeDisabled=!!u.disablePageStyleChange,this.isOverrideDocumentStyleSheetDisabled=this.isPageStyleChangeDisabled,this.isPageViewModeChangeDisabled=!!u.disablePageViewModeChange,this.isRenderAllPagesChangeDisabled=!!u.disableRenderAllPagesChange,this.justClicked=!1,this.settingsToggle=document.getElementById("vivliostyle-menu-item_settings-toggle"),this.opened=i.default.observable(!1),this.pinned=i.default.observable(!1),this.state={viewerOptions:new o.default(e),pageStyle:new r.default(n.pageStyle),pageViewMode:i.default.pureComputed({read:function(){return c.state.viewerOptions.pageViewMode().toString()},write:function(t){c.state.viewerOptions.pageViewMode(a.default.of(t))}}),renderAllPages:i.default.pureComputed({read:function(){return c.state.viewerOptions.renderAllPages()},write:function(t){c.state.viewerOptions.renderAllPages(t)}})},this.state.pageStyle.setViewerFontSizeObservable(this.state.viewerOptions.fontSize),this.defaultPageStyle=new r.default,["close","toggle","apply","cancel","resetUserStyle"].forEach(function(t){this[t]=this[t].bind(this)},this),l.visible.subscribe(function(t){t&&this.close()},this)}var e,n,s;return e=t,(n=[{key:"close",value:function(){this.opened(!1),this.pinned(!1);var t=document.getElementById("vivliostyle-viewer-viewport");return t&&t.focus(),!0}},{key:"toggle",value:function(){var t=this;this.opened()?this.justClicked?(this.justClicked=!1,this.pinned(!0)):(this.close(),this.justClicked=!0,setTimeout(function(){t.justClicked=!1},300)):(this.viewer_.tocPinned()||this.viewer_.showTOC(!1),this.opened(!0),this.justClicked?(this.justClicked=!1,this.pinned(!0)):(this.pinned(!1),this.justClicked=!0,this.focusToFirstItem(),setTimeout(function(){t.justClicked=!1},300)))}},{key:"apply",value:function(){this.state.renderAllPages()===this.viewerOptions_.renderAllPages()&&this.state.pageStyle.equivalentTo(this.documentOptions_.pageStyle)?this.viewerOptions_.copyFrom(this.state.viewerOptions):(this.documentOptions_.pageStyle.copyFrom(this.state.pageStyle),this.documentOptions_.pageStyle.baseFontSizeSpecified()&&this.documentOptions_.updateUserStyleSheetFromCSSText(),this.viewer_.loadDocument(this.documentOptions_,this.state.viewerOptions)),this.pinned()?this.focusToFirstItem():this.close()}},{key:"cancel",value:function(){this.state.viewerOptions.copyFrom(this.viewerOptions_),this.state.pageStyle.copyFrom(this.documentOptions_.pageStyle),this.close()}},{key:"resetUserStyle",value:function(){return this.state.pageStyle.copyFrom(this.defaultPageStyle),this.state.viewerOptions.fontSize(o.default.getDefaultValues().fontSize),setTimeout(function(){document.getElementsByName("vivliostyle-settings_reset-user-style")[0].checked=!1},200),!0}},{key:"focusToFirstItem",value:function(t){var e=t||this.settingsToggle,n=["input","textarea","summary"].includes(e.localName)?e:Array.from(e.getElementsByTagName("input")).find(function(t){return!t.disabled&&("radio"!=t.type||t.checked)});if(n){for(var i=n.parentElement;i&&i!=this.settingsToggle;i=i.parentElement)"details"==i.localName&&(i.open=!0);n.focus()}}},{key:"handleKey",value:function(t){var e=this.opened()&&this.settingsToggle.contains(document.activeElement),n=e&&("text"==document.activeElement.type||"select"==document.activeElement.localName),i=e&&"textarea"==document.activeElement.localName,o=e&&!n&&!i;switch(t){case u.Escape:return this.opened()&&(this.cancel(),this.close()),!0;case"s":case"S":return!(!this.opened()||o||!e)||(this.toggle(),!1);case"p":case"P":return!o||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-view-and-rendering").firstElementChild),!1);case"v":case"V":return!o||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-view-mode")),!1);case"a":case"A":return!o||(this.focusToFirstItem(document.getElementsByName("vivliostyle-settings_render-all-pages")[0]),!1);case"u":case"U":return!o||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_user-style").firstElementChild),!1);case"z":case"Z":return!o||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-size")),!1);case"m":case"M":return!o||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-margin")),!1);case"b":case"B":return!o||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-breaks")),!1);case"i":case"I":return!o||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_images")),!1);case"t":case"T":return!o||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_text")),!1);case"o":case"O":return!o||(this.focusToFirstItem(document.getElementsByName("vivliostyle-settings_override-document-stylesheets")[0]),!1);case"c":case"C":return!o||(this.focusToFirstItem(document.getElementsByName("vivliostyle-settings_css-details")[0]),!1);case"r":case"R":return!o||(this.focusToFirstItem(document.getElementsByName("vivliostyle-settings_reset-user-style")[0]),!1);case u.Enter:return!(n||o&&"vivliostyle-menu-button_apply"!==document.activeElement.id&&"vivliostyle-menu-button_reset"!==document.activeElement.id)||(document.getElementById("vivliostyle-menu-button_apply").focus(),!1);default:return!0}}}])&&l(e.prototype,n),s&&l(e,s),t}();n.default=c},{"../models/page-style":8,"../models/page-view-mode":9,"../models/viewer-options":10,"../utils/key-util":14,knockout:1}],20:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=d(t("../models/vivliostyle")),o=d(t("../models/document-options")),r=d(t("../models/viewer-options")),a=d(t("../models/message-queue")),s=d(t("./viewer")),l=d(t("./navigation")),u=d(t("./settings-panel")),c=d(t("./message-dialog")),h=d(t("../utils/key-util")),p=d(t("../utils/string-util")),f=d(t("../stores/url-parameters"));function d(t){return t&&t.__esModule?t:{default:t}}var g=function(){var t=this;this.documentOptions=new o.default,this.viewerOptions=new r.default,this.documentOptions.pageStyle.setViewerFontSizeObservable(this.viewerOptions.fontSize),this.viewerOptions.profile()&&i.default.profile.profiler.enable(),this.isDebug="true"===f.default.getParameter("debug")[0],this.viewerSettings={userAgentRootURL:"".concat(f.default.getBaseURL(),"resources/"),viewportElement:document.getElementById("vivliostyle-viewer-viewport"),debug:this.isDebug},f.default.getParameter("b")[0]&&(f.default.removeParameter("b",!0),f.default.removeParameter("x")),f.default.removeParameter("f",!0),f.default.removeParameter("spread",!0),f.default.removeParameter("renderAllPages",!0),f.default.removeParameter("fontSize",!0),f.default.removeParameter("profile",!0),f.default.removeParameter("debug",!0),this.viewer=new s.default(this.viewerSettings,this.viewerOptions),this.viewer.inputUrl.subscribe(function(t){""!=t?(f.default.hasParameter("b")||f.default.history.pushState&&f.default.history.pushState(null,""),t=t.startsWith("<")?"data:,"+p.default.percentEncodeForDataURI(t):p.default.percentEncodeAmpersandAndUnencodedPercent(t),f.default.setParameter("b",t)):f.default.removeParameter("b")}),this.messageDialog=new c.default(a.default),this.settingsPanel=new u.default(this.viewerOptions,this.documentOptions,this.viewer,this.messageDialog,{disablePageStyleChange:!1,disablePageViewModeChange:!1,disableRenderAllPagesChange:!1}),this.navigation=new l.default(this.viewerOptions,this.viewer,this.settingsPanel,{disableTOCNavigation:!1,disablePageNavigation:!1,disableZoom:!1,disableFontSizeChange:!1}),this.handleKey=function(e,n){var i=h.default.identifyKeyFromEvent(n);if("vivliostyle-input-url"===document.activeElement.id)return"Enter"!==i||13!==n.keyCode||(t.documentOptions.bookUrl(f.default.getParameter("b")[0]),t.viewer.loadDocument(t.documentOptions),!1);if("Home"!==i&&"End"!==i&&(n.ctrlKey||n.metaKey)||n.altKey||n.shiftKey)return!0;var o=t.settingsPanel.handleKey(i);return o&&(o=t.navigation.handleKey(i)),o},this.viewer.loadDocument(this.documentOptions),window.onhashchange=function(){window.location.href!=f.default.storedUrl&&window.location.reload()}};n.default=g},{"../models/document-options":6,"../models/message-queue":7,"../models/viewer-options":10,"../models/vivliostyle":11,"../stores/url-parameters":13,"../utils/key-util":14,"../utils/string-util":16,"./message-dialog":17,"./navigation":18,"./settings-panel":19,"./viewer":21}],21:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=s(t("knockout")),o=s(t("../utils/observable-util")),r=s(t("../logging/logger")),a=s(t("../models/vivliostyle"));function s(t){return t&&t.__esModule?t:{default:t}}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var u=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewerOptions_=n,this.documentOptions_=null,this.viewer_=new a.default.viewer.Viewer(e,n.toObject());var r=this.state_={status:o.default.readonlyObservable(a.default.constants.ReadyState.LOADING),pageProgression:o.default.readonlyObservable(a.default.constants.PageProgression.LTR)};this.state={status:r.status.getter.extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"},notify:"always"}),navigatable:i.default.pureComputed(function(){return r.status.value()&&r.status.value()!==a.default.constants.ReadyState.LOADING}),pageProgression:r.pageProgression.getter},this.epage=i.default.observable(),this.epageCount=i.default.observable(),this.firstPage=i.default.observable(),this.lastPage=i.default.observable(),this.tocVisible=i.default.observable(),this.tocPinned=i.default.observable(),this.inputUrl=i.default.observable(""),this.setupViewerEventHandler(),this.setupViewerOptionSubscriptions()}var e,n,s;return e=t,(n=[{key:"setupViewerEventHandler",value:function(){var t=this,e=r.default.getLogger();this.viewer_.addListener("debug",function(t){e.debug(t.content)}),this.viewer_.addListener("info",function(t){e.info(t.content)}),this.viewer_.addListener("warn",function(t){e.warn(t.content)}),this.viewer_.addListener("error",function(t){e.error(t.content)}),this.viewer_.addListener("readystatechange",function(){var e=t.viewer_.readyState;e!==a.default.constants.ReadyState.INTERACTIVE&&e!==a.default.constants.ReadyState.COMPLETE||t.state_.pageProgression.value(t.viewer_.getCurrentPageProgression()),t.state_.status.value(e)}),this.viewer_.addListener("loaded",function(){t.viewerOptions_.profile()&&a.default.profile.profiler.printTimings()}),this.viewer_.addListener("nav",function(e){var n=e.cfi,i=e.first,o=e.last,r=e.epage,a=e.epageCount,s=e.metadata,l=e.docTitle;if(n&&t.documentOptions_.fragment(n),void 0!==i&&t.firstPage(i),void 0!==o&&t.lastPage(o),void 0!==r&&t.epage(r),void 0!==a&&t.epageCount(a),s||l){var u=s&&s["http://purl.org/dc/terms/title"],c=u&&u[0]&&u[0].v;c?!l||l===c||t.firstPage()||/\.xhtml$/.test(l)?document.title=c:document.title="".concat(l," | ").concat(c):document.title=l||"Vivliostyle Viewer"}var h=t.tocVisible(),p=t.viewer_.isTOCVisible();h&&!p||t.tocVisible(p)}),this.viewer_.addListener("hyperlink",function(e){e.internal?(t.navigateToInternalUrl(e.href),t.tocVisible()&&t.tocVisible(!1),document.getElementById("vivliostyle-viewer-viewport").focus()):window.location.href=e.href})}},{key:"setupViewerOptionSubscriptions",value:function(){i.default.computed(function(){var t=this.viewerOptions_.toObject();this.viewer_.setOptions(t)},this).extend({rateLimit:0})}},{key:"loadDocument",value:function(t,e){this.state_.status.value(a.default.constants.ReadyState.LOADING),e&&this.viewerOptions_.copyFrom(e),this.documentOptions_=t,t.xUrl()?this.viewer_.loadDocument(t.xUrl(),t.toObject(),this.viewerOptions_.toObject()):t.bookUrl()?this.viewer_.loadPublication?this.viewer_.loadPublication(t.bookUrl(),t.toObject(),this.viewerOptions_.toObject()):this.viewer_.loadEPUB(t.bookUrl(),t.toObject(),this.viewerOptions_.toObject()):this.state_.status.value("")}},{key:"navigateToPrevious",value:function(){this.viewer_.navigateToPage("previous")}},{key:"navigateToNext",value:function(){this.viewer_.navigateToPage("next")}},{key:"navigateToLeft",value:function(){this.viewer_.navigateToPage("left")}},{key:"navigateToRight",value:function(){this.viewer_.navigateToPage("right")}},{key:"navigateToFirst",value:function(){this.viewer_.navigateToPage("first")}},{key:"navigateToLast",value:function(){this.viewer_.navigateToPage("last")}},{key:"navigateToEPage",value:function(t){this.viewer_.navigateToPage("epage",t)}},{key:"navigateToInternalUrl",value:function(t){this.viewer_.navigateToInternalUrl(t)}},{key:"queryZoomFactor",value:function(t){return this.viewer_.queryZoomFactor(t)}},{key:"epageToPageNumber",value:function(t){if(t||0==t)return Math.round(t+1)}},{key:"epageFromPageNumber",value:function(t){if(t||0==t)return t-1}},{key:"showTOC",value:function(t,e){if(null!=this.viewer_.isTOCVisible()){var n=null==t?!this.tocVisible():t;this.tocVisible(n),this.tocPinned(!!n&&!e),this.viewer_.showTOC(n,e)}}}])&&l(e.prototype,n),s&&l(e,s),t}();n.default=u},{"../logging/logger":4,"../models/vivliostyle":11,"../utils/observable-util":15,knockout:1}],22:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(t("knockout")),o=(r(t("./bindings/menuButton.js")),r(t("./bindings/swipePages.js")),r(t("./viewmodels/viewer-app")));function r(t){return t&&t.__esModule?t:{default:t}}var a={start:function(){function t(){i.default.applyBindings(new o.default)}window.__loaded?t():window.onload=t}};n.default=a},{"./bindings/menuButton.js":2,"./bindings/swipePages.js":3,"./viewmodels/viewer-app":20,knockout:1}],23:[function(t,e,n){var i,o;i=window,o=function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=32)}([function(t,e,n){"use strict";n.d(e,"m",function(){return s}),n.d(e,"d",function(){return l}),n.d(e,"o",function(){return c}),n.d(e,"w",function(){return h}),n.d(e,"k",function(){return p}),n.d(e,"f",function(){return d}),n.d(e,"r",function(){return g}),n.d(e,"i",function(){return m}),n.d(e,"h",function(){return v}),n.d(e,"g",function(){return y}),n.d(e,"a",function(){return b}),n.d(e,"l",function(){return w}),n.d(e,"j",function(){return S}),n.d(e,"b",function(){return N}),n.d(e,"e",function(){return C}),n.d(e,"c",function(){return T}),n.d(e,"x",function(){return x}),n.d(e,"n",function(){return I}),n.d(e,"t",function(){return P}),n.d(e,"s",function(){return O}),n.d(e,"q",function(){return k}),n.d(e,"p",function(){return A}),n.d(e,"u",function(){return R}),n.d(e,"v",function(){return _});var i,o=n(1),r=n(4),a=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(){function t(){}return t.prototype.visitValues=function(t){for(var e=0;e<t.length;e++)t[e].visit(this)},t.prototype.visitEmpty=function(t){throw new Error("E_CSS_EMPTY_NOT_ALLOWED")},t.prototype.visitSlash=function(t){throw new Error("E_CSS_SLASH_NOT_ALLOWED")},t.prototype.visitStr=function(t){throw new Error("E_CSS_STR_NOT_ALLOWED")},t.prototype.visitIdent=function(t){throw new Error("E_CSS_IDENT_NOT_ALLOWED")},t.prototype.visitNumeric=function(t){throw new Error("E_CSS_NUMERIC_NOT_ALLOWED")},t.prototype.visitNum=function(t){throw new Error("E_CSS_NUM_NOT_ALLOWED")},t.prototype.visitInt=function(t){return this.visitNum(t)},t.prototype.visitColor=function(t){throw new Error("E_CSS_COLOR_NOT_ALLOWED")},t.prototype.visitURL=function(t){throw new Error("E_CSS_URL_NOT_ALLOWED")},t.prototype.visitSpaceList=function(t){throw new Error("E_CSS_LIST_NOT_ALLOWED")},t.prototype.visitCommaList=function(t){throw new Error("E_CSS_COMMA_NOT_ALLOWED")},t.prototype.visitFunc=function(t){throw new Error("E_CSS_FUNC_NOT_ALLOWED")},t.prototype.visitExpr=function(t){throw new Error("E_CSS_EXPR_NOT_ALLOWED")},t}(),l=function(t){function e(){return t.call(this)||this}return a(e,t),e.prototype.visitValues=function(t){for(var e=null,n=0;n<t.length;n++){var i=t[n],o=i.visit(this);if(e)e[n]=o;else if(i!==o){e=new Array(t.length);for(var r=0;r<n;r++)e[r]=t[r];e[n]=o}}return e||t},e.prototype.visitStr=function(t){return t},e.prototype.visitIdent=function(t){return t},e.prototype.visitSlash=function(t){return t},e.prototype.visitNumeric=function(t){return t},e.prototype.visitNum=function(t){return t},e.prototype.visitInt=function(t){return t},e.prototype.visitColor=function(t){return t},e.prototype.visitURL=function(t){return t},e.prototype.visitSpaceList=function(t){var e=this.visitValues(t.values);return e===t.values?t:new S(e)},e.prototype.visitCommaList=function(t){var e=this.visitValues(t.values);return e===t.values?t:new N(e)},e.prototype.visitFunc=function(t){var e=this.visitValues(t.values);return e===t.values?t:new C(t.name,e)},e.prototype.visitExpr=function(t){return t},e}(s),u=function(){function t(){}return t.prototype.toString=function(){var t=new o.d;return this.appendTo(t,!0),t.toString()},t.prototype.stringValue=function(){var t=new o.d;return this.appendTo(t,!1),t.toString()},t.prototype.toExpr=function(t,e){throw new Error("F_ABSTRACT")},t.prototype.appendTo=function(t,e){t.append("[error]")},t.prototype.isExpr=function(){return!1},t.prototype.isNumeric=function(){return!1},t.prototype.isNum=function(){return!1},t.prototype.isIdent=function(){return!1},t.prototype.isSpaceList=function(){return!1},t.prototype.visit=function(t){throw new Error("F_ABSTRACT")},t}(),c=function(t){function e(){return t.call(this)||this}return a(e,t),Object.defineProperty(e,"instance",{get:function(){return this.empty||(this.empty=new e),this.empty},enumerable:!0,configurable:!0}),e.prototype.toExpr=function(t,e){return new r.f(t,"")},e.prototype.appendTo=function(t,e){},e.prototype.visit=function(t){return t.visitEmpty(this)},e}(u).instance,h=function(t){function e(){return t.call(this)||this}return a(e,t),Object.defineProperty(e,"instance",{get:function(){return this.slash||(this.slash=new e),this.slash},enumerable:!0,configurable:!0}),e.prototype.toExpr=function(t,e){return new r.f(t,"/")},e.prototype.appendTo=function(t,e){t.append("/")},e.prototype.visit=function(t){return t.visitSlash(this)},e}(u).instance,p=function(t){function e(e){var n=t.call(this)||this;return n.str=e,n}return a(e,t),e.prototype.toExpr=function(t,e){return new r.f(t,this.str)},e.prototype.appendTo=function(t,e){e?(t.append('"'),t.append(o.q(this.str)),t.append('"')):t.append(this.str)},e.prototype.visit=function(t){return t.visitStr(this)},e}(u),f={},d=function(t){function e(e){var n=t.call(this)||this;if(n.name=e,f[e])throw new Error("E_INVALID_CALL");return f[e]=n,n}return a(e,t),e.prototype.toExpr=function(t,e){return new r.f(t,this.name)},e.prototype.appendTo=function(t,e){e?t.append(o.p(this.name)):t.append(this.name)},e.prototype.visit=function(t){return t.visitIdent(this)},e.prototype.isIdent=function(){return!0},e}(u);function g(t){var e=f[t];return e||(e=new d(t)),e}var m=function(t){function e(e,n){var i=t.call(this)||this;return i.num=e,i.unit=n.toLowerCase(),i}return a(e,t),e.prototype.toExpr=function(t,e){return 0==this.num?t.zero:e&&"%"==this.unit?100==this.num?e:new r.r(t,e,new r.f(t,this.num/100)):new r.x(t,this.num,this.unit)},e.prototype.appendTo=function(t,e){t.append(this.num.toString()),t.append(this.unit)},e.prototype.visit=function(t){return t.visitNumeric(this)},e.prototype.isNumeric=function(){return!0},e}(u),v=function(t){function e(e){var n=t.call(this)||this;return n.num=e,n}return a(e,t),e.prototype.toExpr=function(t,e){return 0==this.num?t.zero:1==this.num?t.one:new r.f(t,this.num)},e.prototype.appendTo=function(t,e){t.append(this.num.toString())},e.prototype.visit=function(t){return t.visitNum(this)},e.prototype.isNum=function(){return!0},e}(u),y=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.visit=function(t){return t.visitInt(this)},e}(v),b=function(t){function e(e){var n=t.call(this)||this;return n.rgb=e,n}return a(e,t),e.prototype.appendTo=function(t,e){t.append("#");var n=this.rgb.toString(16);t.append("000000".substr(n.length)),t.append(n)},e.prototype.visit=function(t){return t.visitColor(this)},e}(u),w=function(t){function e(e){var n=t.call(this)||this;return n.url=e,n}return a(e,t),e.prototype.appendTo=function(t,e){t.append('url("'),t.append(o.q(this.url)),t.append('")')},e.prototype.visit=function(t){return t.visitURL(this)},e}(u);function E(t,e,n,i){var o=e.length;e[0].appendTo(t,i);for(var r=1;r<o;r++)t.append(n),e[r].appendTo(t,i)}var S=function(t){function e(e){var n=t.call(this)||this;return n.values=e,n}return a(e,t),e.prototype.appendTo=function(t,e){E(t,this.values," ",e)},e.prototype.visit=function(t){return t.visitSpaceList(this)},e.prototype.isSpaceList=function(){return!0},e}(u),N=function(t){function e(e){var n=t.call(this)||this;return n.values=e,n}return a(e,t),e.prototype.appendTo=function(t,e){E(t,this.values,",",e)},e.prototype.visit=function(t){return t.visitCommaList(this)},e}(u),C=function(t){function e(e,n){var i=t.call(this)||this;return i.name=e,i.values=n,i}return a(e,t),e.prototype.appendTo=function(t,e){t.append(o.p(this.name)),t.append("("),E(t,this.values,",",e),t.append(")")},e.prototype.visit=function(t){return t.visitFunc(this)},e}(u),T=function(t){function e(e){var n=t.call(this)||this;return n.expr=e,n}return a(e,t),e.prototype.toExpr=function(){return this.expr},e.prototype.appendTo=function(t,e){t.append("-epubx-expr("),this.expr.appendTo(t,0),t.append(")")},e.prototype.visit=function(t){return t.visitExpr(this)},e.prototype.isExpr=function(){return!0},e}(u);function x(t,e){if(t){if(t.isNumeric()){var n=t;return e.queryUnitSize(n.unit,!1)*n.num}if(t.isNum())return t.num}return 0}function I(t,e){return new m(x(t,e),"px")}var P={absolute:g("absolute"),all:g("all"),always:g("always"),auto:g("auto"),avoid:g("avoid"),balance:g("balance"),balance_all:g("balance-all"),block:g("block"),block_end:g("block-end"),block_start:g("block-start"),both:g("both"),bottom:g("bottom"),border_box:g("border-box"),break_all:g("break-all"),break_word:g("break-word"),crop:g("crop"),cross:g("cross"),column:g("column"),exclusive:g("exclusive"),_false:g("false"),fixed:g("fixed"),flex:g("flex"),footnote:g("footnote"),footer:g("footer"),header:g("header"),hidden:g("hidden"),horizontal_tb:g("horizontal-tb"),inherit:g("inherit"),inline:g("inline"),inline_block:g("inline-block"),inline_end:g("inline-end"),inline_start:g("inline-start"),landscape:g("landscape"),left:g("left"),line:g("line"),list_item:g("list-item"),ltr:g("ltr"),manual:g("manual"),none:g("none"),normal:g("normal"),oeb_page_foot:g("oeb-page-foot"),oeb_page_head:g("oeb-page-head"),page:g("page"),relative:g("relative"),right:g("right"),same:g("same"),scale:g("scale"),snap_block:g("snap-block"),spread:g("spread"),_static:g("static"),rtl:g("rtl"),table:g("table"),table_caption:g("table-caption"),table_cell:g("table-cell"),table_footer_group:g("table-footer-group"),table_header_group:g("table-header-group"),table_row:g("table-row"),top:g("top"),transparent:g("transparent"),vertical_lr:g("vertical-lr"),vertical_rl:g("vertical-rl"),visible:g("visible"),_true:g("true")},O=new m(100,"%"),k=new m(100,"pvw"),A=new m(100,"pvh"),R=new m(0,"px"),L={"font-size":1,color:2};function _(t,e){return(L[t]||Number.MAX_VALUE)-(L[e]||Number.MAX_VALUE)}},function(t,e,n){"use strict";n.d(e,"o",function(){return o}),n.d(e,"H",function(){return r}),n.d(e,"I",function(){return a}),n.d(e,"h",function(){return s}),n.d(e,"E",function(){return l}),n.d(e,"D",function(){return c}),n.d(e,"G",function(){return h}),n.d(e,"C",function(){return p}),n.d(e,"n",function(){return f}),n.d(e,"a",function(){return u}),n.d(e,"g",function(){return d}),n.d(e,"b",function(){return g}),n.d(e,"v",function(){return b}),n.d(e,"F",function(){return w}),n.d(e,"t",function(){return E}),n.d(e,"u",function(){return S}),n.d(e,"d",function(){return N}),n.d(e,"p",function(){return T}),n.d(e,"q",function(){return x}),n.d(e,"y",function(){return I}),n.d(e,"x",function(){return P}),n.d(e,"r",function(){return O}),n.d(e,"s",function(){return k}),n.d(e,"J",function(){return A}),n.d(e,"i",function(){return R}),n.d(e,"B",function(){return L}),n.d(e,"e",function(){return F}),n.d(e,"w",function(){return D}),n.d(e,"f",function(){return B}),n.d(e,"A",function(){return M}),n.d(e,"z",function(){return U}),n.d(e,"c",function(){return z}),n.d(e,"m",function(){return H}),n.d(e,"j",function(){return W}),n.d(e,"k",function(){return X}),n.d(e,"l",function(){return q});var i=n(6),o={};function r(t){return JSON.parse(t)}function a(t){var e=t.match(/^([^#]*)/);return e?e[1]:t}var s=window.location.href;function l(t){s=t}var u,c=window.location.href;function h(t){c=t}function p(t,e){if(e.startsWith("data:"))return t||e;if(!e||t.match(/^\w{2,}:/))return t.toLowerCase().match("^javascript:")?"#":(t.match(/^\w{2,}:\/\/[^\/]+$/)&&(t+="/"),t);var n;if(e.match(/^\w{2,}:\/\/[^\/]+$/)&&(e+="/"),t.match(/^\/\//))return(n=e.match(/^(\w{2,}:)\/\//))?n[1]+t:t;if(t.match(/^\//))return(n=e.match(/^(\w{2,}:\/\/[^\/]+)\//))?n[1]+t:t;if(t.match(/^\.(\/|$)/)&&(t=t.substr(2)),e=function(t){var e=t.match(/^([^#?]*)/);return e?e[1]:t}(e),t.match(/^#/))return e+t;var i=e.lastIndexOf("/");if(i<0)return t;if(i<e.length-1&&(r=e.lastIndexOf("."))<i){if(""==t)return e;i=(e+="/").length-1}for(var o=e.substr(0,i+1)+t;!((i=o.indexOf("/../"))<=0);){var r;if((r=o.lastIndexOf("/",i-1))<=0)break;o=o.substr(0,r)+o.substr(i+3)}return o.replace(/\/(\.\/)+/g,"/")}function f(t){var e;return(e=/^(https?:)\/\/github\.com\/([^\/]+\/[^\/]+)\/(blob\/|tree\/|raw\/)?(.*)$/.exec(t))?t=e[1]+"//raw.githubusercontent.com/"+e[2]+"/"+(e[3]?"":"master/")+e[4]:(e=/^(https?:)\/\/www\.aozora\.gr\.jp\/(cards\/[^\/]+\/files\/[^\/.]+\.html)$/.exec(t))?t=e[1]+"//raw.githubusercontent.com/aozorabunko/aozorabunko/master/"+e[2]:(e=/^(https?:)\/\/gist\.github\.com\/([^\/]+\/\w+)(\/|$)(raw(\/|$))?(.*)$/.exec(t))?t=e[1]+"//gist.githubusercontent.com/"+e[2]+"/raw/"+e[6]:(e=/^(https?:)\/\/(?:[^\/.]+\.)?jsbin\.com\/(?!(?:blog|help)\b)(\w+)((\/\d+)?).*$/.exec(t))&&(t=e[1]+"//output.jsbin.com/"+e[2]+e[3]+"/"),t}function d(t){return null==t?t:t.toString()}!function(t){t.FB2="http://www.gribuser.ru/xml/fictionbook/2.0",t.epub="http://www.idpf.org/2007/ops",t.EV="http://www.w3.org/2001/xml-events",t.MATHML="http://www.w3.org/1998/Math/MathML",t.XML="http://www.w3.org/XML/1998/namespace",t.XHTML="http://www.w3.org/1999/xhtml",t.XLINK="http://www.w3.org/1999/xlink",t.SHADOW="http://www.pyroxy.com/ns/shadow",t.SVG="http://www.w3.org/2000/svg",t.DC="http://purl.org/dc/elements/1.1/",t.NCX="http://www.daisy.org/z3986/2005/ncx/",t.SSE="http://example.com/sse"}(u||(u={}));var g=function(){function t(){this.queue=[null]}return t.prototype.length=function(){return this.queue.length-1},t.prototype.add=function(t){for(var e=this.queue.length;e>1;){var n=Math.floor(e/2),i=this.queue[n];if(i.compare(t)>0)return void(this.queue[e]=t);this.queue[e]=i,e=n}this.queue[1]=t},t.prototype.peek=function(){return this.queue[1]},t.prototype.remove=function(){var t=this.queue[1],e=this.queue.pop(),n=this.queue.length;if(n>1){for(var i=1;;){var o=2*i;if(o>=n)break;if(this.queue[o].compare(e)>0)o+1<n&&this.queue[o+1].compare(this.queue[o])>0&&o++;else{if(!(o+1<n&&this.queue[o+1].compare(e)>0))break;o++}this.queue[i]=this.queue[o],i=o}this.queue[i]=e}return t},t}(),m=["","-webkit-","-moz-","-ms-","-o-","-epub-"],v={};function y(t,e){if("writing-mode"===e){var n=document.createElement("span");return"-ms-"===t?(n.style.setProperty(t+e,"tb-rl"),"tb-rl"===n.style["writing-mode"]):(n.style.setProperty(t+e,"vertical-rl"),"vertical-rl"===n.style[t+e])}return"string"==typeof document.documentElement.style[function(t,e){return t&&(e="-"+e,"moz"===(t=t.replace(/-/g,""))&&(t="Moz")),t+e.replace(/-[a-z]/g,function(t){return t.substr(1).toUpperCase()})}(t,e)]}function b(t){var e=v[t];if(e||null===e)return e;switch(t){case"text-combine-upright":if(y("-webkit-","text-combine")&&!y("","text-combine-upright"))return v[t]=["-webkit-text-combine"],["-webkit-text-combine"];break;case"writing-mode":if(y("-ms-","writing-mode"))return v[t]=["-ms-writing-mode"],["-ms-writing-mode"];break;case"filter":if(y("-webkit-","filter"))return v[t]=["-webkit-filter"],["-webkit-filter"];break;case"clip-path":if(y("-webkit-","clip-path"))return v[t]=["-webkit-clip-path","clip-path"];break;case"margin-inline-start":if(y("-webkit-","margin-start"))return v[t]=["-webkit-margin-start"],["-webkit-margin-start"];break;case"margin-inline-end":if(y("-webkit-","margin-end"))return v[t]=["-webkit-margin-end"],["-webkit-margin-end"];break;case"padding-inline-start":if(y("-webkit-","padding-start"))return v[t]=["-webkit-padding-start"],["-webkit-padding-start"];break;case"padding-inline-end":if(y("-webkit-","padding-end"))return v[t]=["-webkit-padding-end"],["-webkit-padding-end"]}for(var n=0,o=m;n<o.length;n++){var r=o[n];if(y(r,t))return e=r+t,v[t]=[e],[e]}return i.b.warn("Property not supported by the browser: ",t),v[t]=null,null}function w(t,e,n){try{var o=b(e);if(!o)return;o.forEach(function(e){if("-ms-writing-mode"===e)switch(n){case"horizontal-tb":n="lr-tb";break;case"vertical-rl":n="tb-rl";break;case"vertical-lr":n="tb-lr"}else if("-webkit-text-combine"===e)switch(n){case"all":n="horizontal"}t&&t.style&&t.style.setProperty(e,n)})}catch(t){i.b.warn(t)}}function E(t,e,n){try{var i=v[e];return t.style.getPropertyValue(i?i[0]:e)}catch(t){}return n||""}function S(t){var e=t.getAttributeNS(u.XML,"lang");return e||t.namespaceURI!=u.XHTML||(e=t.getAttribute("lang")),e}var N=function(){function t(){this.list=[]}return t.prototype.append=function(t){return this.list.push(t),this},t.prototype.clear=function(){this.list=[]},t.prototype.toString=function(){var t=this.list.join("");return this.list=[t],t},t}();function C(t){return"\\"+t.charCodeAt(0).toString(16)+" "}function T(t){return t.replace(/[^-_a-zA-Z0-9\u0080-\uFFFF]/g,C)}function x(t){return t.replace(/[\u0000-\u001F"\\]/g,C)}function I(t){return t.replace(/[\s+&?=#\u007F-\uFFFF]+/g,encodeURIComponent)}function P(t){return!!t.match(/^[a-zA-Z\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u024F\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]$/)}function O(t,e){return t.replace(/[^-a-zA-Z0-9_]/g,function(t){return function(t,e){return(e="string"==typeof e?e:"\\u")+(65536|t.charCodeAt(0)).toString(16).substr(1)}(t,e)})}function k(t){return O(t)}function A(t,e){e="string"==typeof e?e:"\\u";var n=new RegExp(k(e)+"[0-9a-fA-F]{4}","g");return t.replace(n,function(t){return function(t,e){return e="string"==typeof e?e:"\\u",0===t.indexOf(e)?String.fromCharCode(parseInt(t.substring(e.length),16)):t}(t,e)})}function R(t,e){for(var n=0,i=t;;){if(n==i)return n;var o=n+i>>1;e(o)?i=o:n=o+1}}function L(t,e){return t-e}var _="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function F(t,e){for(var n=e.length,i=3*Math.floor(n/3),o=0;o<i;o+=3){var r=255&e.charCodeAt(o),a=255&e.charCodeAt(o+1),s=255&e.charCodeAt(o+2);t.append(_.charAt(r>>2)),t.append(_.charAt(63&(r<<4|a>>4))),t.append(_.charAt(63&(a<<2|s>>6))),t.append(_.charAt(63&s))}switch(n-i){case 1:var l=255&e.charCodeAt(i);t.append(_.charAt(l>>2)),t.append(_.charAt(l<<4&63)),t.append("==");break;case 2:var u=255&e.charCodeAt(i),c=255&e.charCodeAt(i+1);t.append(_.charAt(u>>2)),t.append(_.charAt(63&(u<<4|c>>4))),t.append(_.charAt(c<<2&63)),t.append("=")}}function D(t,e){for(var n={},i=0,o=t;i<o.length;i++){var r=o[i],a=e(r);a&&!n[a]&&(n[a]=r)}return n}function B(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=!0;return e}function M(t,e){for(var n={},i=0,o=t;i<o.length;i++){var r=o[i],a=e(r);a&&(n[a]?n[a].push(r):n[a]=[r])}return n}function U(t,e){var n={};for(var i in t)n[i]=e(t[i],i);return n}var z=function(){function t(){this.listeners={}}return t.prototype.dispatchEvent=function(t){var e=this.listeners[t.type];if(e){t.target=this,t.currentTarget=this;for(var n=0;n<e.length;n++)e[n](t)}},t.prototype.addEventListener=function(t,e,n){if(!n){var i=this.listeners[t];i?i.push(e):this.listeners[t]=[e]}},t.prototype.removeEventListener=function(t,e,n){if(!n){var i=this.listeners[t];if(i){var o=i.indexOf(e);o>=0&&i.splice(o,1)}}},t}(),V=null;function H(t){if(null==V){var e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="100px",n.style.height="100px",n.style.overflow="hidden",n.style.lineHeight="16px",n.style.fontSize="16px",w(n,"writing-mode","vertical-rl"),t.appendChild(n);var i=e.createTextNode("a a a a a a a a a a a a a a a a");n.appendChild(i);var o=e.createRange();o.setStart(i,0),o.setEnd(i,1);var r=o.getBoundingClientRect();V=r.right-r.left<10,t.removeChild(n)}return V}var G=null;function W(t){if(null===G){var e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="30px",n.style.height="100px",n.style.lineHeight="16px",n.style.fontSize="16px",n.style.textAlign="justify",t.appendChild(n);var i=e.createTextNode("a | ");n.appendChild(i);var o=e.createElement("span");o.style.display="inline-block",o.style.width="30px",n.appendChild(o);var r=e.createRange();r.setStart(i,0),r.setEnd(i,3);var a=r.getBoundingClientRect();G=a.right<27,t.removeChild(n)}return G}var j=null;function X(t){if(null===j){var e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="40px",n.style.height="100px",n.style.lineHeight="16px",n.style.fontSize="16px",n.style.textAlign="justify",t.appendChild(n);var i=e.createTextNode("a a-");n.appendChild(i);var o=e.createElement("span");o.style.display="inline-block",o.style.width="40px",n.appendChild(o);var r=e.createRange();r.setStart(i,2),r.setEnd(i,4);var a=r.getBoundingClientRect();j=a.right<37,t.removeChild(n)}return j}var K=null;function q(t){if(null===K){var e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="40px",n.style.height="100px",n.style.lineHeight="16px",n.style.fontSize="16px",n.style.textAlign="justify",t.appendChild(n);var i=e.createTextNode("a a-");n.appendChild(i),n.appendChild(e.createElement("wbr"));var o=e.createElement("span");o.style.display="inline-block",o.style.width="40px",n.appendChild(o);var r=e.createRange();r.setStart(i,2),r.setEnd(i,4);var a=r.getBoundingClientRect();K=a.right<37,t.removeChild(n)}return K}},function(t,e,n){"use strict";function i(t){if((t=t.substr(1)).match(/^[^0-9a-fA-F\n\r]$/))return t;var e=parseInt(t,16);return isNaN(e)?"":e<=65535?String.fromCharCode(e):e<=1114111?String.fromCharCode(55296|e>>10&1023,56320|1023&e):"�"}function o(t){return t.replace(/\\([0-9a-fA-F]{0,6}(\r\n|[ \n\r\t\f])?|[^0-9a-fA-F\n\r])/g,i)}var r;n.d(e,"a",function(){return r}),n.d(e,"b",function(){return M}),function(t){t[t.EOF=0]="EOF",t[t.IDENT=1]="IDENT",t[t.STR=2]="STR",t[t.NUMERIC=3]="NUMERIC",t[t.NUM=4]="NUM",t[t.INT=5]="INT",t[t.FUNC=6]="FUNC",t[t.HASH=7]="HASH",t[t.URL=8]="URL",t[t.CLASS=9]="CLASS",t[t.O_PAR=10]="O_PAR",t[t.C_PAR=11]="C_PAR",t[t.O_BRC=12]="O_BRC",t[t.C_BRC=13]="C_BRC",t[t.O_BRK=14]="O_BRK",t[t.C_BRK=15]="C_BRK",t[t.COMMA=16]="COMMA",t[t.SEMICOL=17]="SEMICOL",t[t.COLON=18]="COLON",t[t.SLASH=19]="SLASH",t[t.AT=20]="AT",t[t.PERCENT=21]="PERCENT",t[t.QMARK=22]="QMARK",t[t.PLUS=23]="PLUS",t[t.MINUS=24]="MINUS",t[t.BAR_BAR=25]="BAR_BAR",t[t.AMP_AMP=26]="AMP_AMP",t[t.BANG=31]="BANG",t[t.DOLLAR=32]="DOLLAR",t[t.HAT=33]="HAT",t[t.BAR=34]="BAR",t[t.TILDE=35]="TILDE",t[t.STAR=36]="STAR",t[t.GT=37]="GT",t[t.LT=38]="LT",t[t.EQ=39]="EQ",t[t.BANG_EQ=41]="BANG_EQ",t[t.DOLLAR_EQ=42]="DOLLAR_EQ",t[t.HAT_EQ=43]="HAT_EQ",t[t.BAR_EQ=44]="BAR_EQ",t[t.TILDE_EQ=45]="TILDE_EQ",t[t.STAR_EQ=46]="STAR_EQ",t[t.GT_EQ=47]="GT_EQ",t[t.LT_EQ=48]="LT_EQ",t[t.EQ_EQ=49]="EQ_EQ",t[t.COL_COL=50]="COL_COL",t[t.INVALID=51]="INVALID",t[t.LAST=51]="LAST"}(r||(r={}));var a,s=function(){this.precededBySpace=!1,this.num=0,this.text="",this.position=0,this.type=r.EOF};function l(t,e){var n,i=Array(128);for(n=0;n<128;n++)i[n]=t;for(i.NaN=t==a.END?a.END:a.INVALID,n=0;n<e.length;n+=2)i[e[n]]=e[n+1];return i}!function(t){t[t.SPACE=1]="SPACE",t[t.INT=2]="INT",t[t.IDENT=3]="IDENT",t[t.BANG=4]="BANG",t[t.HASH=6]="HASH",t[t.DOLLAR=7]="DOLLAR",t[t.PERCENT=8]="PERCENT",t[t.AMP=9]="AMP",t[t.O_PAR=10]="O_PAR",t[t.C_PAR=11]="C_PAR",t[t.STAR=12]="STAR",t[t.PLUS=13]="PLUS",t[t.COMMA=14]="COMMA",t[t.MINUS=15]="MINUS",t[t.DOT=16]="DOT",t[t.SLASH=17]="SLASH",t[t.COLON=18]="COLON",t[t.SEMICOL=19]="SEMICOL",t[t.LT=20]="LT",t[t.EQ=21]="EQ",t[t.GT=22]="GT",t[t.QMARK=23]="QMARK",t[t.AT=24]="AT",t[t.O_BRK=25]="O_BRK",t[t.C_BRK=26]="C_BRK",t[t.O_BRC=27]="O_BRC",t[t.C_BRC=28]="C_BRC",t[t.BSLASH=29]="BSLASH",t[t.HAT=30]="HAT",t[t.BAR=31]="BAR",t[t.TILDE=32]="TILDE",t[t.STR1=33]="STR1",t[t.STR2=34]="STR2",t[t.END=35]="END",t[t.EQTAIL=36]="EQTAIL",t[t.ENDINT=37]="ENDINT",t[t.ENDNUM=38]="ENDNUM",t[t.CONT=39]="CONT",t[t.UNIT=40]="UNIT",t[t.PCUNIT=41]="PCUNIT",t[t.NUMBER=42]="NUMBER",t[t.ENDIDNT=43]="ENDIDNT",t[t.IDNTESC=44]="IDNTESC",t[t.ENDIDES=45]="ENDIDES",t[t.ENDSTR=46]="ENDSTR",t[t.ENDESTR=47]="ENDESTR",t[t.STR1ESC=48]="STR1ESC",t[t.STR2ESC=49]="STR2ESC",t[t.BAR_BAR=50]="BAR_BAR",t[t.AMP_AMP=51]="AMP_AMP",t[t.FUNC=52]="FUNC",t[t.FUNCES=53]="FUNCES",t[t.COMMENT=54]="COMMENT",t[t.COMMST=55]="COMMST",t[t.ENDNOTK=56]="ENDNOTK",t[t.MINMIN=57]="MINMIN",t[t.TOINT=58]="TOINT",t[t.TONUM=59]="TONUM",t[t.TOIDENT=60]="TOIDENT",t[t.TOIDES=61]="TOIDES",t[t.KILL1=62]="KILL1",t[t.KILL2=63]="KILL2",t[t.URL=64]="URL",t[t.URL1=65]="URL1",t[t.URL2=66]="URL2",t[t.ENDURL=67]="ENDURL",t[t.TERMURL=68]="TERMURL",t[t.FINURL=69]="FINURL",t[t.LT_BG=70]="LT_BG",t[t.LT_BG_M=71]="LT_BG_M",t[t.INVALID=72]="INVALID",t[t.CHKPOSS=73]="CHKPOSS",t[t.CHKPOSN=74]="CHKPOSN",t[t.URLESC=75]="URLESC",t[t.IDESCH=76]="IDESCH",t[t.COL_COL=77]="COL_COL",t[t.TOCLASS=78]="TOCLASS",t[t.CHKSP=79]="CHKSP",t[t.EOF=80]="EOF"}(a||(a={}));var u=[a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.SPACE,a.SPACE,a.INVALID,a.SPACE,a.SPACE,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.SPACE,a.BANG,a.STR2,a.HASH,a.DOLLAR,a.PERCENT,a.AMP,a.STR1,a.O_PAR,a.C_PAR,a.STAR,a.PLUS,a.COMMA,a.MINUS,a.DOT,a.SLASH,a.INT,a.INT,a.INT,a.INT,a.INT,a.INT,a.INT,a.INT,a.INT,a.INT,a.COLON,a.SEMICOL,a.LT,a.EQ,a.GT,a.QMARK,a.AT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.O_BRK,a.BSLASH,a.C_BRK,a.HAT,a.IDENT,a.INVALID,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.IDENT,a.O_BRC,a.BAR,a.C_BRC,a.TILDE,a.INVALID];u.NaN=a.EOF;var c=[a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.FUNC,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.CONT,a.ENDIDNT,a.ENDIDNT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDIDNT,a.IDNTESC,a.ENDIDNT,a.ENDIDNT,a.CONT,a.ENDIDNT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT,a.ENDIDNT];c.NaN=a.ENDIDNT;var h=[a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.TOCLASS,a.TONUM,a.INVALID,a.TONUM,a.TONUM,a.TONUM,a.TONUM,a.TONUM,a.TONUM,a.TONUM,a.TONUM,a.TONUM,a.TONUM,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.INVALID,a.TOIDES,a.INVALID,a.INVALID,a.TOCLASS,a.INVALID,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.TOCLASS,a.INVALID,a.INVALID,a.INVALID,a.INVALID,a.INVALID];c.NaN=a.ENDIDNT;var p=[a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.MINMIN,a.TONUM,a.END,a.TOINT,a.TOINT,a.TOINT,a.TOINT,a.TOINT,a.TOINT,a.TOINT,a.TOINT,a.TOINT,a.TOINT,a.END,a.END,a.END,a.END,a.END,a.END,a.END,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.END,a.TOIDES,a.END,a.END,a.TOIDENT,a.END,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.TOIDENT,a.END,a.END,a.END,a.END,a.END];p.NaN=a.END;var f=[a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.CHKPOSS,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.CHKPOSS,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.FUNCES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDIDES,a.IDNTESC,a.ENDIDES,a.ENDIDES,a.CONT,a.ENDIDES,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES,a.ENDIDES];f.NaN=a.ENDIDES;var d=[a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.PCUNIT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.NUMBER,a.ENDINT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.UNIT,a.ENDINT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT,a.ENDINT];d.NaN=a.ENDINT;var g=[a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.PCUNIT,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.CONT,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.UNIT,a.ENDNUM,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.UNIT,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM,a.ENDNUM];g.NaN=a.ENDNUM;var m=l(a.END,[61,a.EQTAIL]),v=l(a.END,[58,a.COL_COL]),y=l(a.END,[61,a.EQTAIL,124,a.BAR_BAR]),b=l(a.END,[38,a.AMP_AMP]),w=l(a.END,[42,a.COMMENT]),E=l(a.CONT,[42,a.COMMST]),S=l(a.COMMENT,[42,a.COMMST,47,a.ENDNOTK]),N=l(a.KILL1,[62,a.ENDNOTK]),C=l(a.END,[61,a.EQTAIL,33,a.LT_BG]),T=l(a.KILL1,[45,a.LT_BG_M]),x=l(a.KILL2,[45,a.ENDNOTK]),I=l(a.IDESCH,[9,a.INVALID,10,a.INVALID,13,a.INVALID,32,a.INVALID]),P=l(a.CONT,[39,a.ENDSTR,10,a.INVALID,13,a.INVALID,92,a.STR1ESC]),O=l(a.CONT,[34,a.ENDSTR,10,a.INVALID,13,a.INVALID,92,a.STR2ESC]),k=l(a.CONT,[39,a.ENDESTR,10,a.CHKPOSN,13,a.CHKPOSN,92,a.STR1ESC]),A=l(a.CONT,[34,a.ENDESTR,10,a.CHKPOSN,13,a.CHKPOSN,92,a.STR2ESC]),R=l(a.URL,[9,a.CONT,32,a.CONT,34,a.URL2,39,a.URL1,41,a.INVALID,10,a.CONT,13,a.CONT]),L=l(a.CONT,[41,a.ENDURL,9,a.CHKSP,10,a.CHKSP,13,a.CHKSP,32,a.CHKSP,92,a.URLESC,40,a.INVALID,91,a.INVALID,93,a.INVALID,123,a.INVALID,125,a.INVALID,NaN,a.ENDURL]),_=l(a.CONT,[39,a.TERMURL,10,a.CHKPOSN,13,a.CHKPOSN,92,a.URLESC,NaN,a.ENDURL]),F=l(a.CONT,[34,a.TERMURL,10,a.CHKPOSN,13,a.CHKPOSN,92,a.URLESC,NaN,a.ENDURL]),D=l(a.INVALID,[9,a.CONT,10,a.CONT,13,a.CONT,32,a.CONT,41,a.FINURL]),B=15,M=function(){function t(t,e){this.input=t,this.handler=e,this.head=-1,this.tail=0,this.curr=0,this.position=0,this.indexMask=B,this.buffer=Array(this.indexMask+1);for(var n=0;n<=this.indexMask;n++)this.buffer[n]=new s}return t.prototype.token=function(){return this.tail==this.curr&&this.fillBuffer(),this.buffer[this.curr]},t.prototype.nthToken=function(t){return(this.tail-this.curr&this.indexMask)<=t&&this.fillBuffer(),this.buffer[this.curr+t&this.indexMask]},t.prototype.consume=function(){this.curr=this.curr+1&this.indexMask},t.prototype.mark=function(){if(this.head>=0)throw new Error("F_CSSTOK_BAD_CALL mark");this.head=this.curr},t.prototype.reset=function(){if(this.head<0)throw new Error("F_CSSTOK_BAD_CALL reset");this.curr=this.head,this.head=-1},t.prototype.unmark=function(){this.head=-1},t.prototype.hasMark=function(){return this.head>=0},t.prototype.reallocate=function(){for(var t=2*(this.indexMask+1)-1,e=Array(t+1),n=this.head,i=0;n!=this.tail;)e[i]=this.buffer[n],n==this.curr&&(this.curr=i),n=n+1&this.indexMask,i++;for(this.head=0,this.tail=i,this.indexMask=t,this.buffer=e;i<=t;)e[i++]=new s},t.prototype.error=function(t,e,n){this.handler&&this.handler.error(n,e)},t.prototype.fillBuffer=function(){var t=this.tail,e=this.head>=0?this.head:this.curr,n=this.indexMask;if(t>=e?e+=n:e--,e==t){if(this.head<0)throw new Error("F_CSSTOK_INTERNAL");this.reallocate(),t=this.tail,e=n=this.indexMask}for(var i=u,s=this.input,l=this.position,B=this.buffer,M=r.EOF,U=0,z="",V=0,H=!1,G=B[t],W=-9;;){var j=s.charCodeAt(l);switch(i[j]||i[65]){case a.INVALID:M=r.INVALID,z=isNaN(j)?"E_CSS_UNEXPECTED_EOF":"E_CSS_UNEXPECTED_CHAR",i=u,l++;break;case a.SPACE:l++,H=!0;continue;case a.INT:U=l++,i=d;continue;case a.IDENT:M=r.IDENT,U=l++,i=c;continue;case a.BANG:U=l++,M=r.BANG,i=m;continue;case a.STR1:M=r.STR,U=++l,i=P;continue;case a.STR2:M=r.STR,U=++l,i=O;continue;case a.HASH:U=++l,M=r.HASH,i=c;continue;case a.DOLLAR:U=l++,M=r.DOLLAR,i=m;continue;case a.PERCENT:U=l++,M=r.PERCENT;break;case a.AMP:U=l++,M=r.DOLLAR,i=b;continue;case a.O_PAR:U=l++,M=r.O_PAR;break;case a.C_PAR:U=l++,M=r.C_PAR;break;case a.STAR:U=l++,M=r.STAR,i=m;continue;case a.PLUS:U=l++,M=r.PLUS;break;case a.COMMA:U=l++,M=r.COMMA;break;case a.MINUS:M=r.MINUS,U=l++,i=p;continue;case a.DOT:U=l++,i=h;continue;case a.TOCLASS:U=l++,M=r.CLASS,i=c;continue;case a.SLASH:U=l++,M=r.SLASH,i=w;continue;case a.COLON:U=l++,M=r.COLON,i=v;continue;case a.COL_COL:l++,M=r.COL_COL;break;case a.SEMICOL:U=l++,M=r.SEMICOL;break;case a.LT:U=l++,M=r.LT,i=C;continue;case a.EQ:U=l++,M=r.EQ,i=m;continue;case a.GT:U=l++,M=r.GT,i=m;continue;case a.QMARK:U=l++,M=r.QMARK;break;case a.AT:U=++l,M=r.AT,i=c;continue;case a.O_BRK:U=l++,M=r.O_BRK;break;case a.C_BRK:U=l++,M=r.C_BRK;break;case a.O_BRC:U=l++,M=r.O_BRC;break;case a.C_BRC:U=l++,M=r.C_BRC;break;case a.BSLASH:W=U=l++,M=r.IDENT,i=I;continue;case a.HAT:U=l++,M=r.HAT,i=m;continue;case a.BAR:U=l++,M=r.BAR,i=y;continue;case a.TILDE:U=l++,M=r.TILDE,i=m;continue;case a.END:break;case a.EQTAIL:l++,M=M+r.BANG_EQ-r.BANG;break;case a.ENDINT:M=r.INT,V=parseInt(s.substring(U,l),10);break;case a.ENDNUM:M=r.NUM,V=parseFloat(s.substring(U,l));break;case a.CONT:l++;continue;case a.UNIT:M=r.NUMERIC,V=parseFloat(s.substring(U,l)),U=l++,i=c;continue;case a.PCUNIT:M=r.NUMERIC,V=parseFloat(s.substring(U,l)),z="%",U=l++;break;case a.NUMBER:l++,i=g;continue;case a.ENDIDNT:z=s.substring(U,l);break;case a.IDNTESC:W=l++,i=I;continue;case a.ENDIDES:z=o(s.substring(U,l));break;case a.ENDSTR:z=s.substring(U,l),l++;break;case a.ENDESTR:z=o(s.substring(U,l)),l++;break;case a.STR1ESC:W=l,l+=2,i=k;continue;case a.STR2ESC:W=l,l+=2,i=A;continue;case a.BAR_BAR:l++,M=r.BAR_BAR;break;case a.AMP_AMP:l++,M=r.AMP_AMP;break;case a.FUNC:if(z=s.substring(U,l),M==r.IDENT){if(l++,"url"==z.toLowerCase()){i=R;continue}M=r.FUNC}break;case a.FUNCES:if(z=o(s.substring(U,l)),M==r.IDENT){if(l++,"url"==z.toLowerCase()){i=R;continue}M=r.FUNC}break;case a.COMMENT:i=E,l++;continue;case a.COMMST:i=S,l++;continue;case a.ENDNOTK:i=u,l++;continue;case a.MINMIN:i=N,l++;continue;case a.TOINT:M=r.INT,i=d,l++;continue;case a.TONUM:M=r.NUM,i=g,l++;continue;case a.TOIDENT:M=r.IDENT,i=c,l++;continue;case a.TOIDES:M=r.IDENT,i=I,W=l++;continue;case a.KILL1:l--;break;case a.KILL2:l-=2;break;case a.URL:U=l++,i=L;continue;case a.URL1:U=++l,i=_;continue;case a.URL2:U=++l,i=F;continue;case a.ENDURL:M=r.URL,z=o(s.substring(U,l)),l++;break;case a.FINURL:l++;break;case a.LT_BG:i=T,l++;continue;case a.LT_BG_M:i=x,l++;continue;case a.CHKSP:if(l-W<8&&s.substring(W+1,l+1).match(/^[0-9a-fA-F]{0,6}(\r\n|[\n\r])|[ \t]$/)){l++;continue}case a.TERMURL:M=r.URL,z=o(s.substring(U,l)),l++,i=D;continue;case a.CHKPOSN:if(++l-W<9&&s.substring(W+1,l).match(/^[0-9a-fA-F]{0,6}(\r\n|[\n\r])$/))continue;M=r.INVALID,z="E_CSS_UNEXPECTED_NEWLINE",i=u;break;case a.CHKPOSS:if(l-W<9&&s.substring(W+1,l+1).match(/^[0-9a-fA-F]{0,6}[ \t]$/)){l++;continue}z=o(s.substring(U,l));break;case a.URLESC:W=l++;continue;case a.IDESCH:l++,i=f;continue;default:if(i!==u){M=r.INVALID,z="E_CSS_UNEXPECTED_STATE";break}U=l,M=r.EOF}if(G.type=M,G.precededBySpace=H,G.num=V,G.text=z,G.position=U,++t>=e)break;i=u,H=!1,G=B[t&n]}this.position=l,this.tail=t&n},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return c}),n.d(e,"c",function(){return h}),n.d(e,"d",function(){return p}),n.d(e,"b",function(){return f}),n.d(e,"e",function(){return d});var i,o,r=n(1),a=n(6),s=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=null,u=null;function c(){return l}function h(t){if(!l)throw new Error("E_TASK_NO_CONTEXT");l.name||(l.name=t);var e=l,n=new E(e,e.top,t);return e.top=n,n.state=o.ACTIVE,n}function p(t){return new b(t)}function f(t,e,n){var i=h(t);i.handler=n;try{e(i)}catch(t){i.task.raise(t,i)}return i.result()}function d(t,e){return(l?l.getScheduler():u||new m(new g)).run(t,e)}!function(t){t[t.INIT=0]="INIT",t[t.ACTIVE=1]="ACTIVE",t[t.FINISHED=2]="FINISHED",t[t.DEAD=3]="DEAD"}(o||(o={}));var g=function(){function t(){}return t.prototype.currentTime=function(){return(new Date).valueOf()},t.prototype.setTimeout=function(t,e){return setTimeout(t,e)},t.prototype.clearTimeout=function(t){clearTimeout(t)},t}(),m=function(){function t(t){this.timer=t,this.timeout=1,this.slice=25,this.sliceOverTime=0,this.wakeupTime=null,this.timeoutToken=null,this.inTimeSlice=!1,this.order=0,this.queue=new r.b,u||(u=this)}return t.prototype.setSlice=function(t){this.slice=t},t.prototype.setTimeout=function(t){this.timeout=t},t.prototype.isTimeSliceOver=function(){return this.timer.currentTime()>=this.sliceOverTime},t.prototype.arm=function(){if(!this.inTimeSlice){var t=this.queue.peek().scheduledTime,e=this.timer.currentTime();if(null!=this.timeoutToken){if(e+this.timeout>this.wakeupTime)return;this.timer.clearTimeout(this.timeoutToken)}var n=t-e;n<=this.timeout&&(n=this.timeout),this.wakeupTime=e+n;var i=this;this.timeoutToken=this.timer.setTimeout(function(){i.timeoutToken=null,i.doTimeSlice()},n)}},t.prototype.schedule=function(t,e){var n=t,i=this.timer.currentTime();n.order=this.order++,n.scheduledTime=i+(e||0),this.queue.add(n),this.arm()},t.prototype.doTimeSlice=function(){null!=this.timeoutToken&&(this.timer.clearTimeout(this.timeoutToken),this.timeoutToken=null),this.inTimeSlice=!0;try{var t=this.timer.currentTime();for(this.sliceOverTime=t+this.slice;this.queue.length();){var e=this.queue.peek();if(e.scheduledTime>t)break;if(this.queue.remove(),e.canceled||e.resumeInternal(),(t=this.timer.currentTime())>=this.sliceOverTime)break}}catch(t){a.b.error(t)}this.inTimeSlice=!1,this.queue.length()&&this.arm()},t.prototype.run=function(t,e){var n=new y(this,e||"");n.top=new E(n,null,"bootstrap"),n.top.state=o.ACTIVE,n.top.then(function(){var e=function(){n.running=!1;for(var t=0,e=n.callbacks;t<e.length;t++){var i=e[t];try{i()}catch(t){a.b.error(t)}}};try{t().then(function(t){n.result=t,e()})}catch(t){n.raise(t),e()}});var i=l;return l=n,this.schedule(n.top.suspend("bootstrap")),l=i,n},t}(),v=function(){function t(t){this.task=t,this.scheduledTime=0,this.order=0,this.result=null,this.canceled=!1}return t.prototype.compare=function(t){var e=t;return e.scheduledTime-this.scheduledTime||e.order-this.order},t.prototype.getTask=function(){return this.task},t.prototype.schedule=function(t,e){this.result=t,this.task.scheduler.schedule(this,e)},t.prototype.resumeInternal=function(){var t=this.task;if(this.task=null,t&&t.continuation==this){t.continuation=null;var e=l;return l=t,t.top.finish(this.result),l=e,!0}return!1},t.prototype.cancel=function(){this.canceled=!0},t}(),y=function(){function t(t,e){this.scheduler=t,this.name=e,this.callbacks=[],this.exception=null,this.running=!0,this.result=null,this.waitTarget=null,this.top=null,this.continuation=null}return t.prototype.getName=function(){return this.name},t.prototype.interrupt=function(t){if(this.raise(t||new Error("E_TASK_INTERRUPT")),this!==l&&this.continuation){this.continuation.cancel();var e=new v(this);this.waitTarget="interrupt",this.continuation=e,this.scheduler.schedule(e)}},t.prototype.getScheduler=function(){return this.scheduler},t.prototype.isRunning=function(){return this.running},t.prototype.whenDone=function(t){this.callbacks.push(t)},t.prototype.join=function(){var t=h("Task.join");if(this.running){var e=t.suspend(this),n=this;this.whenDone(function(){e.schedule(n.result)})}else t.finish(this.result);return t.result()},t.prototype.unwind=function(){for(;this.top&&!this.top.handler;)this.top=this.top.parent;if(this.top&&this.top.handler&&this.exception){var t=this.exception;this.exception=null,this.top.handler(this.top,t)}else this.exception&&a.b.error(this.exception,"Unhandled exception in task",this.name)},t.prototype.raise=function(t,e){if(this.fillStack(t),e){for(var n=this.top;n&&n!=e;)n=n.parent;n==e&&(this.top=n)}this.exception=t,this.unwind()},t.prototype.fillStack=function(t){var e=t.frameTrace;if(!e){e=t.stack?t.stack+"\n\t---- async ---\n":"";for(var n=this.top;n;n=n.parent)e+="\t",e+=n.getName(),e+="\n";t.frameTrace=e}},t}(),b=function(){function t(t){this.value=t}return t.prototype.then=function(t){t(this.value)},t.prototype.thenAsync=function(t){return t(this.value)},t.prototype.thenReturn=function(e){return new t(e)},t.prototype.thenFinish=function(t){t.finish(this.value)},t.prototype.isPending=function(){return!1},t.prototype.get=function(){return this.value},t}(),w=function(){function t(t){this.frame=t}return t.prototype.then=function(t){this.frame.then(t)},t.prototype.thenAsync=function(t){if(this.isPending()){var e=new E(this.frame.task,this.frame.parent,"AsyncResult.thenAsync");return e.state=o.ACTIVE,this.frame.parent=e,this.frame.then(function(n){t(n).then(function(t){e.finish(t)})}),e.result()}return t(this.frame.res)},t.prototype.thenReturn=function(t){return this.isPending()?this.thenAsync(function(){return new b(t)}):new b(t)},t.prototype.thenFinish=function(t){this.isPending()?this.then(function(e){t.finish(e)}):t.finish(this.frame.res)},t.prototype.isPending=function(){return this.frame.state==o.ACTIVE},t.prototype.get=function(){if(this.isPending())throw new Error("Result is pending");return this.frame.res},t}(),E=function(){function t(t,e,n){this.task=t,this.parent=e,this.name=n,this.res=null,this.callback=null,this.handler=null,this.state=o.INIT}return t.prototype.checkEnvironment=function(){if(!l)throw new Error("F_TASK_NO_CONTEXT");if(this!==l.top)throw new Error("F_TASK_NOT_TOP_FRAME")},t.prototype.result=function(){return new w(this)},t.prototype.finish=function(t){this.checkEnvironment(),l&&!l.exception&&(this.res=t),this.state=o.FINISHED;var e=this.parent;if(l&&(l.top=e),this.callback){try{this.callback(t)}catch(t){this.task.raise(t,e)}this.state=o.DEAD}},t.prototype.getTask=function(){return this.task},t.prototype.getName=function(){return this.name},t.prototype.getScheduler=function(){return this.task.scheduler},t.prototype.then=function(t){switch(this.state){case o.ACTIVE:if(this.callback)throw new Error("F_TASK_FRAME_ALREADY_HAS_CALLBACK");this.callback=t;break;case o.FINISHED:var e=this.task,n=this.parent;try{t(this.res),this.state=o.DEAD}catch(t){this.state=o.DEAD,e.raise(t,n)}break;case o.DEAD:throw new Error("F_TASK_DEAD_FRAME");default:throw new Error("F_TASK_UNEXPECTED_FRAME_STATE "+this.state)}},t.prototype.timeSlice=function(){var t=h("Frame.timeSlice");return t.getScheduler().isTimeSliceOver()?(a.b.debug("-- time slice --"),t.suspend().schedule(!0)):t.finish(!0),t.result()},t.prototype.sleep=function(t){var e=h("Frame.sleep");return e.suspend().schedule(!0,t),e.result()},t.prototype.loop=function(t){var e=h("Frame.loop"),n=function(i){try{for(;i;){var o=t();if(o.isPending())return void o.then(n);o.then(function(t){i=t})}e.finish(!0)}catch(t){e.task.raise(t,e)}};return n(!0),e.result()},t.prototype.loopWithFrame=function(t){var e=l;if(!e)throw new Error("E_TASK_NO_CONTEXT");return this.loop(function(){var n;do{var i=new S(e,e.top);e.top=i,i.state=o.ACTIVE,t(i),n=i.result()}while(!n.isPending()&&n.get());return n})},t.prototype.suspend=function(t){if(this.checkEnvironment(),this.task.continuation)throw new Error("E_TASK_ALREADY_SUSPENDED");var e=new v(this.task);return this.task.continuation=e,l=null,this.task.waitTarget=t||null,e},t}(),S=function(t){function e(e,n){return t.call(this,e,n,"loop")||this}return s(e,t),e.prototype.continueLoop=function(){this.finish(!0)},e.prototype.breakLoop=function(){this.finish(!1)},e}(E),N=function(t){this.event=t,this.next=null};!function(){function t(){this.continuation=null,this.listeners=[],this.head=new N(null),this.tail=this.head}t.prototype.attach=function(t,e,n){var i=this,o=function(t){if(n&&t.preventDefault(),i.tail.event)i.tail.next=new N(t),i.tail=i.tail.next;else{i.tail.event=t;var e=i.continuation;e&&(i.continuation=null,e.schedule(!0))}};t.addEventListener(e,o,!1),this.listeners.push({target:t,type:e,listener:o})},t.prototype.detach=function(t,e){for(var n=0,i=null;n<this.listeners.length;){if((i=this.listeners[n]).type==e&&i.target===t)return this.listeners.splice(n,1),void i.target.removeEventListener(i.type,i.listener,!1);n++}throw new Error("E_TASK_EVENT_SOURCE_NOT_ATTACHED")},t.prototype.nextEvent=function(){var t=h("EventSource.nextEvent"),e=this,n=function(){if(e.head.event){var i=e.head.event;e.head.next?e.head=e.head.next:e.head.event=null,t.finish(i)}else{if(e.continuation)throw new Error("E_TASK_EVENT_SOURCE_OTHER_TASK_WAITING");var o=h("EventSource.nextEventInternal");e.continuation=o.suspend(e),o.result().then(n)}};return n(),t.result()}}()},function(t,e,n){"use strict";n.d(e,"F",function(){return a}),n.d(e,"E",function(){return s}),n.d(e,"L",function(){return c}),n.d(e,"M",function(){return f}),n.d(e,"m",function(){return g}),n.d(e,"I",function(){return m}),n.d(e,"K",function(){return v}),n.d(e,"J",function(){return y}),n.d(e,"G",function(){return b}),n.d(e,"O",function(){return w}),n.d(e,"g",function(){return E}),n.d(e,"w",function(){return O}),n.d(e,"v",function(){return k}),n.d(e,"b",function(){return A}),n.d(e,"c",function(){return R}),n.d(e,"y",function(){return L}),n.d(e,"z",function(){return _}),n.d(e,"n",function(){return F}),n.d(e,"l",function(){return D}),n.d(e,"k",function(){return B}),n.d(e,"j",function(){return M}),n.d(e,"i",function(){return U}),n.d(e,"u",function(){return z}),n.d(e,"a",function(){return V}),n.d(e,"B",function(){return H}),n.d(e,"r",function(){return G}),n.d(e,"h",function(){return W}),n.d(e,"q",function(){return j}),n.d(e,"x",function(){return X}),n.d(e,"s",function(){return K}),n.d(e,"o",function(){return q}),n.d(e,"t",function(){return Y}),n.d(e,"d",function(){return $}),n.d(e,"e",function(){return Z}),n.d(e,"f",function(){return Q}),n.d(e,"p",function(){return J}),n.d(e,"A",function(){return tt}),n.d(e,"D",function(){return et}),n.d(e,"C",function(){return nt}),n.d(e,"P",function(){return it}),n.d(e,"N",function(){return ot}),n.d(e,"H",function(){return rt});var i,o=n(1),r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});function a(){return{fontFamily:"serif",lineHeight:1.25,margin:8,hyphenate:!1,columnWidth:25,horizontal:!1,nightMode:!1,spreadView:!1,pageBorder:1,enabledMediaTypes:{vivliostyle:!0,print:!0},defaultPaperSize:void 0}}function s(t){return{fontFamily:t.fontFamily,lineHeight:t.lineHeight,margin:t.margin,hyphenate:t.hyphenate,columnWidth:t.columnWidth,horizontal:t.horizontal,nightMode:t.nightMode,spreadView:t.spreadView,pageBorder:t.pageBorder,enabledMediaTypes:Object.assign({},t.enabledMediaTypes),defaultPaperSize:t.defaultPaperSize?Object.assign({},t.defaultPaperSize):void 0}}var l={fontFamily:"serif",lineHeight:1.25,margin:8,hyphenate:!1,columnWidth:25,horizontal:!1,nightMode:!1,spreadView:!1,pageBorder:1,enabledMediaTypes:{vivliostyle:!0,print:!0},defaultPaperSize:void 0},u={};function c(t,e,n,i){var o=Math.min((t-0)/n,(e-0)/i);return"matrix("+o+",0,0,"+o+",0,0)"}function h(t){return'"'+o.q(""+t)+'"'}function p(t){return o.p(""+t)}function f(t,e){return t?o.p(t)+"."+o.p(e):o.p(e)}var d=0,g=function(){function t(t,e){if(this.parent=t,this.resolver=e,this.children=[],this.values={},this.funcs={},this.builtIns={},this.scopeKey="S"+d++,this.zero=new Q(this,0),this.one=new Q(this,1),this._true=new Q(this,!0),this._false=new Q(this,!1),t&&t.children.push(this),!t){var n=this.builtIns;n.floor=Math.floor,n.ceil=Math.ceil,n.round=Math.round,n.sqrt=Math.sqrt,n.min=Math.min,n.max=Math.max,n.letterbox=c,n["css-string"]=h,n["css-name"]=p,n.typeof=function(t){return typeof t},this.defineBuiltInName("page-width",function(){return this.pageWidth()}),this.defineBuiltInName("page-height",function(){return this.pageHeight()}),this.defineBuiltInName("pref-font-family",function(){return this.pref.fontFamily}),this.defineBuiltInName("pref-night-mode",function(){return this.pref.nightMode}),this.defineBuiltInName("pref-hyphenate",function(){return this.pref.hyphenate}),this.defineBuiltInName("pref-margin",function(){return this.pref.margin}),this.defineBuiltInName("pref-line-height",function(){return this.pref.lineHeight}),this.defineBuiltInName("pref-column-width",function(){return this.pref.columnWidth*this.fontSize}),this.defineBuiltInName("pref-horizontal",function(){return this.pref.horizontal}),this.defineBuiltInName("pref-spread-view",function(){return this.pref.spreadView}),this.defineBuiltInName("pub-title",function(){return h(this.pubTitle?this.pubTitle:"")}),this.defineBuiltInName("doc-title",function(){return h(this.docTitle?this.docTitle:"")})}}return t.prototype.defineBuiltInName=function(t,e){this.values[t]=new Y(this,e,t)},t.prototype.defineName=function(t,e){this.values[t]=e},t.prototype.defineFunc=function(t,e){this.funcs[t]=e},t.prototype.defineBuiltIn=function(t,e){this.builtIns[t]=e},t}();function m(t){switch(t.toLowerCase()){case"px":case"in":case"pt":case"pc":case"cm":case"mm":case"q":return!0;default:return!1}}function v(t){switch(t.toLowerCase()){case"vw":case"vh":case"vi":case"vb":case"vmin":case"vmax":case"pvw":case"pvh":case"pvi":case"pvb":case"pvmin":case"pvmax":return!0;default:return!1}}function y(t){switch(t.toLowerCase()){case"em":case"ex":case"rem":return!0;default:return!1}}var b={px:1,in:96,pt:4/3,pc:16,cm:96/2.54,mm:96/25.4,q:96/2.54/40,em:16,rem:16,ex:8,dppx:1,dpi:1/96,dpcm:2.54/96};function w(t){switch(t){case"q":case"rem":return!0;default:return!1}}var E=function(){function t(t,e,n,i){this.rootScope=t,this.viewportWidth=e,this.viewportHeight=n,this.actualPageWidth=null,this.actualPageHeight=null,this.rootFontSize=null,this.scopes={},this.pageAreaWidth=null,this.pageAreaHeight=null,this.pageVertical=null,this.pubTitle=null,this.docTitle=null,this.pageWidth=function(){return this.actualPageWidth?this.actualPageWidth:this.pref.spreadView?Math.floor(e/2)-this.pref.pageBorder:e},this.pageHeight=function(){return this.actualPageHeight?this.actualPageHeight:n},this.initialFontSize=i,this.fontSize=function(){return this.rootFontSize?this.rootFontSize:i},this.pref=l}return t.prototype.getScopeContext=function(t){var e=this.scopes[t.scopeKey];return e||(e={},this.scopes[t.scopeKey]=e),e},t.prototype.clearScope=function(t){this.scopes[t.scopeKey]={};for(var e=0;e<t.children.length;e++)this.clearScope(t.children[e])},t.prototype.queryUnitSize=function(t,e){if(v(t)){var n=this.pageWidth()/100,i=this.pageHeight()/100,o=null!=this.pageAreaWidth?this.pageAreaWidth/100:n,r=null!=this.pageAreaHeight?this.pageAreaHeight/100:i;switch(t){case"vw":return o;case"vh":return r;case"vi":return this.pageVertical?r:o;case"vb":return this.pageVertical?o:r;case"vmin":return o<r?o:r;case"vmax":return o>r?o:r;case"pvw":return n;case"pvh":return i;case"pvi":return this.pageVertical?i:n;case"pvb":return this.pageVertical?n:i;case"pvmin":return n<i?n:i;case"pvmax":return n>i?n:i}}return"em"==t||"rem"==t?e?this.initialFontSize:this.fontSize():"ex"==t?b.ex*(e?this.initialFontSize:this.fontSize())/b.em:b[t]},t.prototype.evalName=function(t,e){do{var n=t.values[e];if(n)return n;if(t.resolver&&(n=t.resolver.call(this,e,!1)))return n;t=t.parent}while(t);throw new Error("Name '"+e+"' is undefined")},t.prototype.evalCall=function(t,e,n,i){do{var o=t.funcs[e];if(o)return o;if(t.resolver&&(o=t.resolver.call(this,e,!0)))return o;var r=t.builtIns[e];if(r){if(i)return t.zero;for(var a=Array(n.length),s=0;s<n.length;s++)a[s]=n[s].evaluate(this);return new Q(t,r.apply(this,a))}t=t.parent}while(t);throw new Error("Function '"+e+"' is undefined")},t.prototype.evalMediaName=function(t,e){var n="all"===t||!!this.pref.enabledMediaTypes[t];return e?!n:n},t.prototype.evalMediaTest=function(t,e){var n="",i=t.match(/^(min|max)-(.*)$/);i&&(n=i[1],t=i[2]);var o=null,r=null;switch(t){case"width":case"height":case"device-width":case"device-height":case"color":e&&(o=e.evaluate(this))}switch(t){case"width":r=this.pageWidth();break;case"height":r=this.pageHeight();break;case"device-width":r=window.screen.availWidth;break;case"device-height":r=window.screen.availHeight;break;case"color":r=window.screen.pixelDepth}if(null!=r&&null!=o)switch(n){case"min":return r>=o;case"max":return r<=o;default:return r==o}else if(null!=r&&null==e)return 0!==r;return!1},t.prototype.queryVal=function(t,e){var n=this.scopes[t.scopeKey];return n?n[e]:void 0},t.prototype.storeVal=function(t,e,n){this.getScopeContext(t)[e]=n},t}(),S=function(){function t(t){this.scope=t,this.scope=t,this.key="_"+d++}return t.prototype.toString=function(){var t=new o.d;return this.appendTo(t,0),t.toString()},t.prototype.appendTo=function(t,e){throw new Error("F_ABSTRACT")},t.prototype.evaluateCore=function(t){throw new Error("F_ABSTRACT")},t.prototype.expand=function(t,e){return this},t.prototype.dependCore=function(t,e,n){return t===this},t.prototype.dependOuter=function(t,e,n){var i=n[this.key];if(null!=i)return i!==u&&i;n[this.key]=u;var o=this.dependCore(t,e,n);return n[this.key]=o,o},t.prototype.depend=function(t,e){return this.dependOuter(t,e,{})},t.prototype.evaluate=function(t){var e=t.queryVal(this.scope,this.key);return void 0!==e?e:(e=this.evaluateCore(t),t.storeVal(this.scope,this.key,e),e)},t.prototype.isMediaName=function(){return!1},t}(),N=function(t){function e(e,n){var i=t.call(this,e)||this;return i.val=n,i}return r(e,t),e.prototype.getOp=function(){throw new Error("F_ABSTRACT")},e.prototype.evalPrefix=function(t){throw new Error("F_ABSTRACT")},e.prototype.evaluateCore=function(t){var e=this.val.evaluate(t);return this.evalPrefix(e)},e.prototype.dependCore=function(t,e,n){return t===this||this.val.dependOuter(t,e,n)},e.prototype.appendTo=function(t,e){10<e&&t.append("("),t.append(this.getOp()),this.val.appendTo(t,10),10<e&&t.append(")")},e.prototype.expand=function(t,e){var n=this.val.expand(t,e);return n===this.val?this:new this.constructor(this.scope,n)},e}(S),C=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.lhs=n,o.rhs=i,o}return r(e,t),e.prototype.getPriority=function(){throw new Error("F_ABSTRACT")},e.prototype.getOp=function(){throw new Error("F_ABSTRACT")},e.prototype.evalInfix=function(t,e){throw new Error("F_ABSTRACT")},e.prototype.evaluateCore=function(t){var e=this.lhs.evaluate(t),n=this.rhs.evaluate(t);return this.evalInfix(e,n)},e.prototype.dependCore=function(t,e,n){return t===this||this.lhs.dependOuter(t,e,n)||this.rhs.dependOuter(t,e,n)},e.prototype.appendTo=function(t,e){var n=this.getPriority();n<=e&&t.append("("),this.lhs.appendTo(t,n),t.append(this.getOp()),this.rhs.appendTo(t,n),n<=e&&t.append(")")},e.prototype.expand=function(t,e){var n=this.lhs.expand(t,e),i=this.rhs.expand(t,e);return n===this.lhs&&i===this.rhs?this:new this.constructor(this.scope,n,i)},e}(S),T=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getPriority=function(){return 1},e}(C),x=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getPriority=function(){return 2},e}(C),I=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getPriority=function(){return 3},e}(C),P=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getPriority=function(){return 4},e}(C),O=function(t){function e(e,n){return t.call(this,e,n)||this}return r(e,t),e.prototype.getOp=function(){return"!"},e.prototype.evalPrefix=function(t){return!t},e}(N),k=function(t){function e(e,n){return t.call(this,e,n)||this}return r(e,t),e.prototype.getOp=function(){return"-"},e.prototype.evalPrefix=function(t){return-t},e}(N),A=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"&&"},e.prototype.evaluateCore=function(t){return this.lhs.evaluate(t)&&this.rhs.evaluate(t)},e}(T),R=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return" and "},e}(A),L=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"||"},e.prototype.evaluateCore=function(t){return this.lhs.evaluate(t)||this.rhs.evaluate(t)},e}(T),_=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return", "},e}(L),F=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"<"},e.prototype.evalInfix=function(t,e){return t<e},e}(x),D=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"<="},e.prototype.evalInfix=function(t,e){return t<=e},e}(x),B=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return">"},e.prototype.evalInfix=function(t,e){return t>e},e}(x),M=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return">="},e.prototype.evalInfix=function(t,e){return t>=e},e}(x),U=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"=="},e.prototype.evalInfix=function(t,e){return t==e},e}(x),z=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"!="},e.prototype.evalInfix=function(t,e){return t!=e},e}(x),V=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"+"},e.prototype.evalInfix=function(t,e){return t+e},e}(I),H=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return" - "},e.prototype.evalInfix=function(t,e){return t-e},e}(I),G=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"*"},e.prototype.evalInfix=function(t,e){return t*e},e}(P),W=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"/"},e.prototype.evalInfix=function(t,e){return t/e},e}(P),j=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),e.prototype.getOp=function(){return"%"},e.prototype.evalInfix=function(t,e){return t%e},e}(P),X=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.num=n,o.unit=i.toLowerCase(),o}return r(e,t),e.prototype.appendTo=function(t,e){t.append(this.num.toString()),t.append(o.p(this.unit))},e.prototype.evaluateCore=function(t){return this.num*t.queryUnitSize(this.unit,!1)},e}(S),K=function(t){function e(e,n){var i=t.call(this,e)||this;return i.qualifiedName=n,i}return r(e,t),e.prototype.appendTo=function(t,e){t.append(this.qualifiedName)},e.prototype.evaluateCore=function(t){return t.evalName(this.scope,this.qualifiedName).evaluate(t)},e.prototype.dependCore=function(t,e,n){return t===this||e.evalName(this.scope,this.qualifiedName).dependOuter(t,e,n)},e}(S),q=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.not=n,o.name=i,o}return r(e,t),e.prototype.appendTo=function(t,e){this.not&&t.append("not "),t.append(o.p(this.name))},e.prototype.evaluateCore=function(t){return t.evalMediaName(this.name,this.not)},e.prototype.dependCore=function(t,e,n){return t===this||this.value.dependOuter(t,e,n)},e.prototype.isMediaName=function(){return!0},e}(S),Y=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.fn=n,o.str=i,o}return r(e,t),e.prototype.appendTo=function(t,e){t.append(this.str)},e.prototype.evaluateCore=function(t){return this.fn.call(t)},e}(S),$=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.qualifiedName=n,o.params=i,o}return r(e,t),e.prototype.appendTo=function(t,e){t.append(this.qualifiedName),function(t,e){t.append("(");for(var n=0;n<e.length;n++)n&&t.append(","),e[n].appendTo(t,0);t.append(")")}(t,this.params)},e.prototype.evaluateCore=function(t){return t.evalCall(this.scope,this.qualifiedName,this.params,!1).expand(t,this.params).evaluate(t)},e.prototype.dependCore=function(t,e,n){if(t===this)return!0;for(var i=0;i<this.params.length;i++)if(this.params[i].dependOuter(t,e,n))return!0;return e.evalCall(this.scope,this.qualifiedName,this.params,!0).dependOuter(t,e,n)},e.prototype.expand=function(t,n){var i=function(t,e,n){for(var i=e,o=0;o<e.length;o++){var r=e[o].expand(t,n);if(e!==i)i[o]=r;else if(r!==e[o]){i=Array(e.length);for(var a=0;a<o;a++)i[a]=e[a];i[o]=r}}return i}(t,this.params,n);return i===this.params?this:new e(this.scope,this.qualifiedName,i)},e}(S),Z=function(t){function e(e,n,i,o){var r=t.call(this,e)||this;return r.cond=n,r.ifTrue=i,r.ifFalse=o,r}return r(e,t),e.prototype.appendTo=function(t,e){e>0&&t.append("("),this.cond.appendTo(t,0),t.append("?"),this.ifTrue.appendTo(t,0),t.append(":"),this.ifFalse.appendTo(t,0),e>0&&t.append(")")},e.prototype.evaluateCore=function(t){return this.cond.evaluate(t)?this.ifTrue.evaluate(t):this.ifFalse.evaluate(t)},e.prototype.dependCore=function(t,e,n){return t===this||this.cond.dependOuter(t,e,n)||this.ifTrue.dependOuter(t,e,n)||this.ifFalse.dependOuter(t,e,n)},e.prototype.expand=function(t,n){var i=this.cond.expand(t,n),o=this.ifTrue.expand(t,n),r=this.ifFalse.expand(t,n);return i===this.cond&&o===this.ifTrue&&r===this.ifFalse?this:new e(this.scope,i,o,r)},e}(S),Q=function(t){function e(e,n){var i=t.call(this,e)||this;return i.val=n,i}return r(e,t),e.prototype.appendTo=function(t,e){switch(typeof this.val){case"number":case"boolean":t.append(this.val.toString());break;case"string":t.append('"'),t.append(o.q(this.val)),t.append('"');break;default:throw new Error("F_UNEXPECTED_STATE")}},e.prototype.evaluateCore=function(t){return this.val},e}(S),J=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.name=n,o.value=i,o}return r(e,t),e.prototype.appendTo=function(t,e){t.append("("),t.append(o.q(this.name.name)),t.append(":"),this.value.appendTo(t,0),t.append(")")},e.prototype.evaluateCore=function(t){return t.evalMediaTest(this.name.name,this.value)},e.prototype.dependCore=function(t,e,n){return t===this||this.value.dependOuter(t,e,n)},e.prototype.expand=function(t,n){var i=this.value.expand(t,n);return i===this.value?this:new e(this.scope,this.name,i)},e}(S),tt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.index=n,i}return r(e,t),e.prototype.appendTo=function(t,e){t.append("$"),t.append(this.index.toString())},e.prototype.expand=function(t,e){var n=e[this.index];if(!n)throw new Error("Parameter missing: "+this.index);return n},e}(S);function et(t,e,n){return e===t._false||e===t.zero||n==t._false||n==t.zero?t._false:e===t._true||e===t.one?n:n===t._true||n===t.one?e:new A(t,e,n)}function nt(t,e,n){return e===t.zero?n:n===t.zero?e:new V(t,e,n)}function it(t,e,n){return e===t.zero?new k(t,n):n===t.zero?e:new H(t,e,n)}function ot(t,e,n){return e===t.zero||n===t.zero?t.zero:e===t.one?n:n===t.one?e:new G(t,e,n)}function rt(t,e,n){return e===t.zero?t.zero:n===t.one?e:new W(t,e,n)}},function(t,e,n){"use strict";n.d(e,"v",function(){return g}),n.d(e,"r",function(){return v}),n.d(e,"H",function(){return y}),n.d(e,"m",function(){return N}),n.d(e,"l",function(){return C}),n.d(e,"c",function(){return I}),n.d(e,"i",function(){return O}),n.d(e,"x",function(){return R}),n.d(e,"w",function(){return L}),n.d(e,"s",function(){return _}),n.d(e,"F",function(){return F}),n.d(e,"u",function(){return D}),n.d(e,"q",function(){return B}),n.d(e,"t",function(){return U}),n.d(e,"B",function(){return V}),n.d(e,"A",function(){return H}),n.d(e,"g",function(){return W}),n.d(e,"j",function(){return j}),n.d(e,"a",function(){return Y}),n.d(e,"d",function(){return $}),n.d(e,"e",function(){return At}),n.d(e,"G",function(){return Gt}),n.d(e,"b",function(){return Wt}),n.d(e,"f",function(){return qt}),n.d(e,"h",function(){return Yt}),n.d(e,"p",function(){return Zt}),n.d(e,"D",function(){return Qt}),n.d(e,"E",function(){return Jt}),n.d(e,"z",function(){return te}),n.d(e,"y",function(){return ee}),n.d(e,"n",function(){return ne}),n.d(e,"o",function(){return ie}),n.d(e,"C",function(){return oe}),n.d(e,"k",function(){return re});var i,o=n(7),r=n(1),a=n(0),s=n(10),l=n(20),u=n(2),c=n(4),h=n(6),p=n(25),f=n(9),d=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),g={azimuth:!0,"border-collapse":!0,"border-spacing":!0,"caption-side":!0,"clip-rule":!0,color:!0,"color-interpolation":!0,"color-rendering":!0,cursor:!0,direction:!0,elevation:!0,"empty-cells":!0,fill:!0,"fill-opacity":!0,"fill-rule":!0,"font-kerning":!0,"font-size":!0,"font-size-adjust":!0,"font-family":!0,"font-feature-settings":!0,"font-style":!0,"font-stretch":!0,"font-variant":!0,"font-weight":!0,"glyph-orientation-vertical":!0,hyphens:!0,"hyphenate-character":!0,"hyphenate-limit-chars":!0,"hyphenate-limit-last":!0,"image-rendering":!0,"image-resolution":!0,"letter-spacing":!0,"line-break":!0,"line-height":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,marker:!0,"marker-end":!0,"marker-mid":!0,"marker-start":!0,orphans:!0,"overflow-wrap":!0,"paint-order":!0,"pointer-events":!0,"pitch-range":!0,quotes:!0,richness:!0,"ruby-align":!0,"ruby-position":!0,"speak-header":!0,"speak-numeral":!0,"speak-punctuation":!0,"speech-rate":!0,"shape-rendering":!0,stress:!0,stroke:!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-miterlimit":!0,"stroke-opacity":!0,"stroke-width":!0,"tab-size":!0,"text-align":!0,"text-align-last":!0,"text-anchor":!0,"text-decoration-skip":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-combine-upright":!0,"text-indent":!0,"text-justify":!0,"text-rendering":!0,"text-size-adjust":!0,"text-transform":!0,"text-underline-position":!0,visibility:!0,"voice-family":!0,volume:!0,"white-space":!0,widows:!0,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"writing-mode":!0},m=["box-decoration-break","image-resolution","orphans","widows"];function v(){return f.b(f.a.POLYFILLED_INHERITED_PROPS).reduce(function(t,e){return t.concat(e())},[].concat(m))}var y={"http://www.idpf.org/2007/ops":!0,"http://www.w3.org/1999/xhtml":!0,"http://www.w3.org/2000/svg":!0},b=["margin-%","padding-%","border-%-width","border-%-style","border-%-color","%"],w=["max-%","min-%","%"],E=function(){for(var t=["left","right","top","bottom"],e={width:!0,height:!0,"max-width":!0,"max-height":!0,"min-width":!0,"min-height":!0},n=0;n<b.length;n++)for(var i=0;i<t.length;i++)e[b[n].replace("%",t[i])]=!0;return e}();function S(t,e){for(var n={},i=0,o=b;i<o.length;i++){var r=o[i];for(var a in t){var s=r.replace("%",a),l=r.replace("%",t[a]);n[s]=l,n[l]=s}}for(var u=0,c=w;u<c.length;u++){var h=c[u];for(var p in e)s=h.replace("%",p),l=h.replace("%",e[p]),n[s]=l,n[l]=s}return n}var N=S({"block-start":"right","block-end":"left","inline-start":"top","inline-end":"bottom"},{"block-size":"width","inline-size":"height"}),C=S({"block-start":"top","block-end":"bottom","inline-start":"left","inline-end":"right"},{"block-size":"height","inline-size":"width"}),T=S({"block-start":"right","block-end":"left","inline-start":"bottom","inline-end":"top"},{"block-size":"width","inline-size":"height"}),x=S({"block-start":"top","block-end":"bottom","inline-start":"right","inline-end":"left"},{"block-size":"height","inline-size":"width"}),I=function(){function t(t,e){this.value=t,this.priority=e}return t.prototype.getBaseValue=function(){return this},t.prototype.filterValue=function(e){var n=this.value.visit(e);return n===this.value?this:new t(n,this.priority)},t.prototype.increaseSpecificity=function(e){return 0==e?this:new t(this.value,this.priority+e)},t.prototype.evaluate=function(t,e){return s.i(t,this.value,e)},t.prototype.isEnabled=function(t){return!0},t}(),P=function(t){function e(e,n,i){var o=t.call(this,e,n)||this;return o.condition=i,o}return d(e,t),e.prototype.getBaseValue=function(){return new I(this.value,this.priority)},e.prototype.filterValue=function(t){var n=this.value.visit(t);return n===this.value?this:new e(n,this.priority,this.condition)},e.prototype.increaseSpecificity=function(t){return 0==t?this:new e(this.value,this.priority+t,this.condition)},e.prototype.isEnabled=function(t){return!!this.condition.evaluate(t)},e}(I);function O(t,e,n){return(null==e||n.priority>e.priority)&&n.isEnabled(t)?n.getBaseValue():e}var k={"region-id":!0,"fragment-selector-id":!0};function A(t){return!!k[t]}function R(t){return"_"!=t.charAt(0)&&!k[t]}function L(t){return!!g[t]}function _(t,e){return t[e]}function F(t,e,n){n?t[e]=n:delete t[e]}function D(t,e){return t[e]}function B(t,e){var n=t[e];return n||(n={},t[e]=n),n}var M=function(t){var e=t._viewConditionalStyles;return e||(e=[],t._viewConditionalStyles=e),e};function U(t,e){return t[e]}function z(t,e){var n=t[e];return n||(n=[],t[e]=n),n}function V(t,e,n,i,o,r,a){if([{id:o,styleKey:"_pseudos"},{id:r,styleKey:"_regions"}].forEach(function(t){if(t.id){var n=B(e,t.styleKey);(e=n[t.id])||(e={},n[t.id]=e)}}),a){var s=M(e);e={},s.push({styles:e,matcher:a})}for(var l in n)if("_"!=l.charAt(0))if(A(l)){var u=U(n,l),c=z(e,l);Array.prototype.push.apply(c,u)}else{var h=_(n,l).increaseSpecificity(i),p=_(e,l);F(e,l,O(t,p,h))}}function H(t,e){for(var n={},i=0;i<e.length;i++)V(t,n,e[i],0,null,null,null);return n}function G(t,e){if(t.length>0){t.sort(function(t,e){return e.getPriority()-t.getPriority()});for(var n=null,i=t.length-1;i>=0;i--)(n=t[i]).chained=e,e=n;return n}return e}var W=function(t){function e(e,n){var i=t.call(this)||this;return i.props=e,i.context=n,i.propName="",i}return d(e,t),e.prototype.setPropName=function(t){this.propName=t},e.prototype.getFontSize=function(){var t=_(this.props,"font-size").value;if(!c.I(t.unit))throw new Error("Unexpected state");return t.num*c.G[t.unit]},e.prototype.visitNumeric=function(t){if(o.a(this.context),"font-size"===this.propName)return function(t,e,n){var i=(t=j(t,e,n)).unit,o=t.num;return"px"===i?t:"%"===i?new a.i(o/100*e,"px"):new a.i(o*n.queryUnitSize(i,!1),"px")}(t,this.getFontSize(),this.context);if("em"==t.unit||"ex"==t.unit||"rem"==t.unit)return j(t,this.getFontSize(),this.context);if("%"==t.unit){if("line-height"===this.propName)return t;var e=this.propName.match(/height|^(top|bottom)$/)?"vh":"vw";return new a.i(t.num,e)}return t},e.prototype.visitExpr=function(t){return"font-size"==this.propName?s.i(this.context,t,this.propName).visit(this):t},e}(a.d);function j(t,e,n){var i=t.unit,o=t.num;if("em"===i||"ex"===i){var r=c.G[i]/c.G.em;return new a.i(o*r*e,"px")}return"rem"===i?new a.i(o*n.fontSize(),"px"):t}var X=function(){function t(){}return t.prototype.apply=function(t){},t.prototype.mergeWith=function(t){return new q([this,t])},t.prototype.clone=function(){return this},t}(),K=function(t){function e(e){var n=t.call(this)||this;return n.conditionItem=e,n}return d(e,t),e.prototype.apply=function(t){t.pushConditionItem(this.conditionItem.fresh(t))},e}(X),q=function(t){function e(e){var n=t.call(this)||this;return n.list=e,n}return d(e,t),e.prototype.apply=function(t){for(var e=0;e<this.list.length;e++)this.list[e].apply(t)},e.prototype.mergeWith=function(t){return this.list.push(t),this},e.prototype.clone=function(){return new e([].concat(this.list))},e}(X),Y=function(t){function e(e,n,i,o,r){var a=t.call(this)||this;return a.style=e,a.specificity=n,a.pseudoelement=i,a.regionId=o,a.viewConditionId=r,a}return d(e,t),e.prototype.apply=function(t){V(t.context,t.currentStyle,this.style,this.specificity,this.pseudoelement,this.regionId,t.buildViewConditionMatcher(this.viewConditionId))},e}(X),$=function(t){function e(){var e=t.call(this)||this;return e.chained=null,e}return d(e,t),e.prototype.apply=function(t){this.chained.apply(t)},e.prototype.getPriority=function(){return 0},e.prototype.makePrimary=function(t){return!1},e}(X),Z=function(t){function e(e){var n=t.call(this)||this;return n.className=e,n}return d(e,t),e.prototype.apply=function(t){t.currentClassNames.includes(this.className)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 10},e.prototype.makePrimary=function(t){return this.chained&&t.insertInTable(t.classes,this.className,this.chained),!0},e}($),Q=function(t){function e(e){var n=t.call(this)||this;return n.id=e,n}return d(e,t),e.prototype.apply=function(t){t.currentId!=this.id&&t.currentXmlId!=this.id||this.chained.apply(t)},e.prototype.getPriority=function(){return 11},e.prototype.makePrimary=function(t){return this.chained&&t.insertInTable(t.ids,this.id,this.chained),!0},e}($),J=function(t){function e(e){var n=t.call(this)||this;return n.localName=e,n}return d(e,t),e.prototype.apply=function(t){t.currentLocalName==this.localName&&this.chained.apply(t)},e.prototype.getPriority=function(){return 8},e.prototype.makePrimary=function(t){return this.chained&&t.insertInTable(t.tags,this.localName,this.chained),!0},e}($),tt=function(t){function e(e,n){var i=t.call(this)||this;return i.ns=e,i.localName=n,i}return d(e,t),e.prototype.apply=function(t){t.currentLocalName==this.localName&&t.currentNamespace==this.ns&&this.chained.apply(t)},e.prototype.getPriority=function(){return 8},e.prototype.makePrimary=function(t){if(this.chained){var e=t.nsPrefix[this.ns];e||(e="ns"+t.nsCount+++":",t.nsPrefix[this.ns]=e);var n=e+this.localName;t.insertInTable(t.nstags,n,this.chained)}return!0},e}($),et=function(t){function e(e){var n=t.call(this)||this;return n.epubTypePatt=e,n}return d(e,t),e.prototype.apply=function(t){var e=t.currentElement;if(e&&"a"==t.currentLocalName){var n=e.getAttribute("href");if(n&&n.match(/^#/)){var i=n.substring(1),o=e.ownerDocument.getElementById(i);if(o){var a=o.getAttributeNS(r.a.epub,"type");a&&a.match(this.epubTypePatt)&&this.chained.apply(t)}}}},e}($),nt=function(t){function e(e){var n=t.call(this)||this;return n.ns=e,n}return d(e,t),e.prototype.apply=function(t){t.currentNamespace==this.ns&&this.chained.apply(t)},e}($),it=function(t){function e(e,n){var i=t.call(this)||this;return i.ns=e,i.name=n,i}return d(e,t),e.prototype.apply=function(t){t.currentElement&&t.currentElement.hasAttributeNS(this.ns,this.name)&&this.chained.apply(t)},e}($),ot=function(t){function e(e,n,i){var o=t.call(this)||this;return o.ns=e,o.name=n,o.value=i,o}return d(e,t),e.prototype.apply=function(t){t.currentElement&&t.currentElement.getAttributeNS(this.ns,this.name)==this.value&&this.chained.apply(t)},e.prototype.getPriority=function(){return"type"==this.name&&this.ns==r.a.epub?9:0},e.prototype.makePrimary=function(t){return"type"==this.name&&this.ns==r.a.epub&&(this.chained&&t.insertInTable(t.epubtypes,this.value,this.chained),!0)},e}($),rt=function(t){function e(e,n){var i=t.call(this)||this;return i.ns=e,i.name=n,i}return d(e,t),e.prototype.apply=function(t){if(t.currentElement){var e=t.currentElement.getAttributeNS(this.ns,this.name);e&&y[e]&&this.chained.apply(t)}},e.prototype.getPriority=function(){return 0},e.prototype.makePrimary=function(t){return!1},e}($),at=function(t){function e(e,n,i){var o=t.call(this)||this;return o.ns=e,o.name=n,o.regexp=i,o}return d(e,t),e.prototype.apply=function(t){if(t.currentElement){var e=t.currentElement.getAttributeNS(this.ns,this.name);e&&e.match(this.regexp)&&this.chained.apply(t)}},e}($),st=function(t){function e(e){var n=t.call(this)||this;return n.langRegExp=e,n}return d(e,t),e.prototype.apply=function(t){t.lang.match(this.langRegExp)&&this.chained.apply(t)},e}($),lt=function(t){function e(){return t.call(this)||this}return d(e,t),e.prototype.apply=function(t){t.isFirst&&this.chained.apply(t)},e.prototype.getPriority=function(){return 6},e}($),ut=function(t){function e(){return t.call(this)||this}return d(e,t),e.prototype.apply=function(t){t.isRoot&&this.chained.apply(t)},e.prototype.getPriority=function(){return 12},e}($),ct=function(t){function e(e,n){var i=t.call(this)||this;return i.a=e,i.b=n,i}return d(e,t),e.prototype.matchANPlusB=function(t){return p.c(t,this.a,this.b)},e}($),ht=function(t){function e(e,n){return t.call(this,e,n)||this}return d(e,t),e.prototype.apply=function(t){this.matchANPlusB(t.currentSiblingOrder)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 5},e}(ct),pt=function(t){function e(e,n){return t.call(this,e,n)||this}return d(e,t),e.prototype.apply=function(t){var e=t.currentSiblingTypeCounts[t.currentNamespace][t.currentLocalName];this.matchANPlusB(e)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 5},e}(ct),ft=function(t){function e(e,n){return t.call(this,e,n)||this}return d(e,t),e.prototype.apply=function(t){var e=t.currentFollowingSiblingOrder;null===e&&(e=t.currentFollowingSiblingOrder=t.currentElement.parentNode.childElementCount-t.currentSiblingOrder+1),this.matchANPlusB(e)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 4},e}(ct),dt=function(t){function e(e,n){return t.call(this,e,n)||this}return d(e,t),e.prototype.apply=function(t){var e=t.currentFollowingSiblingTypeCounts;if(!e[t.currentNamespace]){var n=t.currentElement;do{var i=n.namespaceURI,o=n.localName,r=e[i];r||(r=e[i]={}),r[o]=(r[o]||0)+1}while(n=n.nextElementSibling)}this.matchANPlusB(e[t.currentNamespace][t.currentLocalName])&&this.chained.apply(t)},e.prototype.getPriority=function(){return 4},e}(ct),gt=function(t){function e(){return t.call(this)||this}return d(e,t),e.prototype.apply=function(t){for(var e=t.currentElement.firstChild;e;){switch(e.nodeType){case Node.ELEMENT_NODE:return;case Node.TEXT_NODE:if(e.length>0)return}e=e.nextSibling}this.chained.apply(t)},e.prototype.getPriority=function(){return 4},e}($),mt=function(t){function e(){return t.call(this)||this}return d(e,t),e.prototype.apply=function(t){!1===t.currentElement.disabled&&this.chained.apply(t)},e.prototype.getPriority=function(){return 5},e}($),vt=function(t){function e(){return t.call(this)||this}return d(e,t),e.prototype.apply=function(t){!0===t.currentElement.disabled&&this.chained.apply(t)},e.prototype.getPriority=function(){return 5},e}($),yt=function(t){function e(){return t.call(this)||this}return d(e,t),e.prototype.apply=function(t){var e=t.currentElement;!0!==e.selected&&!0!==e.checked||this.chained.apply(t)},e.prototype.getPriority=function(){return 5},e}($),bt=function(t){function e(e){var n=t.call(this)||this;return n.condition=e,n}return d(e,t),e.prototype.apply=function(t){if(t.conditions[this.condition])try{t.dependentConditions.push(this.condition),this.chained.apply(t)}finally{t.dependentConditions.pop()}},e.prototype.getPriority=function(){return 5},e}($),wt=function(t){function e(){var e=t.call(this)||this;return e.applied=!1,e}return d(e,t),e.prototype.apply=function(t){this.applied=!0},e.prototype.clone=function(){var t=new e;return t.applied=this.applied,t},e}(X),Et=function(t){function e(e){var n=t.call(this)||this;return n.checkAppliedAction=new wt,n.firstAction=G(e,n.checkAppliedAction),n}return d(e,t),e.prototype.apply=function(t){this.firstAction.apply(t),this.checkAppliedAction.applied||this.chained.apply(t),this.checkAppliedAction.applied=!1},e.prototype.getPriority=function(){return this.firstAction.getPriority()},e}($),St=function(){function t(t,e,n){this.condition=t,this.viewConditionId=e,this.viewCondition=n}return t.prototype.increment=function(t){t.increment(this.condition,this.viewCondition)},t.prototype.decrement=function(t){t.decrement(this.condition,this.viewCondition)},t.prototype.buildViewConditionMatcher=function(t){return t.buildViewConditionMatcher(this.viewConditionId)},t}(),Nt=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return d(e,t),e.prototype.fresh=function(t){return new e(this.condition,this.viewConditionId,this.buildViewConditionMatcher(t))},e.prototype.push=function(t,e){return 0==e&&this.increment(t),!1},e.prototype.pop=function(t,e){return 0==e&&(this.decrement(t),!0)},e}(St),Ct=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return d(e,t),e.prototype.fresh=function(t){return new e(this.condition,this.viewConditionId,this.buildViewConditionMatcher(t))},e.prototype.push=function(t,e){return 0==e?this.increment(t):1==e&&this.decrement(t),!1},e.prototype.pop=function(t,e){return 0==e?(this.decrement(t),!0):(1==e&&this.increment(t),!1)},e}(St),Tt=function(t){function e(e,n,i){var o=t.call(this,e,n,i)||this;return o.fired=!1,o}return d(e,t),e.prototype.fresh=function(t){return new e(this.condition,this.viewConditionId,this.buildViewConditionMatcher(t))},e.prototype.push=function(t,e){return!!this.fired&&(this.decrement(t),!0)},e.prototype.pop=function(t,e){return this.fired?(this.decrement(t),!0):(0==e&&(this.fired=!0,this.increment(t)),!1)},e}(St),xt=function(t){function e(e,n,i){var o=t.call(this,e,n,i)||this;return o.fired=!1,o}return d(e,t),e.prototype.fresh=function(t){return new e(this.condition,this.viewConditionId,this.buildViewConditionMatcher(t))},e.prototype.push=function(t,e){return this.fired&&(-1==e?this.increment(t):0==e&&this.decrement(t)),!1},e.prototype.pop=function(t,e){if(this.fired){if(-1==e)return this.decrement(t),!0;0==e&&this.increment(t)}else 0==e&&(this.fired=!0,this.increment(t));return!1},e}(St),It=function(){function t(t,e){this.afterprop=t,this.element=e}return t.prototype.fresh=function(t){return this},t.prototype.push=function(t,e){return!1},t.prototype.pop=function(t,e){return 0==e&&(t.processPseudoelementProps(this.afterprop,this.element),!0)},t}(),Pt=function(){function t(t){this.lang=t}return t.prototype.fresh=function(t){return this},t.prototype.push=function(t,e){return!1},t.prototype.pop=function(t,e){return 0==e&&(t.lang=this.lang,!0)},t}(),Ot=function(){function t(t){this.oldQuotes=t}return t.prototype.fresh=function(t){return this},t.prototype.push=function(t,e){return!1},t.prototype.pop=function(t,e){return 0==e&&(t.quotes=this.oldQuotes,!0)},t}(),kt=function(t){function e(e){var n=t.call(this)||this;return n.element=e,n}return d(e,t),e.prototype.createValueFromString=function(t,e){switch(e){case"url":return t?new a.l(t):new a.l("about:invalid");case"string":default:return t?new a.k(t):new a.k("")}},e.prototype.visitFunc=function(e){if("attr"!==e.name)return t.prototype.visitFunc.call(this,e);var n,i="string",o=null;if(e.values[0]instanceof a.j){var r=e.values[0].values;r.length>=2&&(i=r[1].stringValue()),o=r[0].stringValue()}else o=e.values[0].stringValue();return n=e.values.length>1?this.createValueFromString(e.values[1].stringValue(),i):this.createValueFromString(null,i),this.element&&this.element.hasAttribute(o)?this.createValueFromString(this.element.getAttribute(o),i):n},e}(a.d),At=function(t){function e(e,n,i){var o=t.call(this)||this;return o.cascade=e,o.element=n,o.counterResolver=i,o}return d(e,t),e.prototype.visitIdent=function(t){var e=this.cascade,n=e.quotes,i=Math.floor(n.length/2)-1;switch(t.name){case"open-quote":var o=n[2*Math.min(i,e.quoteDepth)];return e.quoteDepth++,o;case"close-quote":return e.quoteDepth>0&&e.quoteDepth--,n[2*Math.min(i,e.quoteDepth)+1];case"no-open-quote":return e.quoteDepth++,new a.k("");case"no-close-quote":return e.quoteDepth>0&&e.quoteDepth--,new a.k("")}return t},e.prototype.format=function(t,e){var n,i=!1,o=!1;null!=(n=e.match(/^upper-(.*)/))?(i=!0,e=n[1]):null!=(n=e.match(/^lower-(.*)/))&&(o=!0,e=n[1]);var a="";return Rt[e]?a=function(t,e){if(e>t[0]||e<=0||e!=Math.round(e))return"";for(var n="",i=1;i<t.length;i+=2){var o=t[i],r=Math.floor(e/o);if(r>20)return"";for(e-=r*o;r>0;)n+=t[i+1],r--}return n}(Rt[e],t):Lt[e]?a=function(t,e){if(e<=0||e!=Math.round(e))return"";var n=function(t){for(var e=[],n=0;n<t.length;)if("-"==t.substr(n+1,1)){var i=t.charCodeAt(n),o=t.charCodeAt(n+2);n+=3;for(var r=i;r<=o;r++)e.push(String.fromCharCode(r))}else e.push(t.substr(n++,1));return e}(t),i="";do{var o=--e%n.length;i=n[o]+i,e=(e-o)/n.length}while(e>0);return i}(Lt[e],t):null!=_t[e]?a=_t[e]:"decimal-leading-zero"==e?1==(a=""+t).length&&(a="0"+a):a="cjk-ideographic"==e||"trad-chinese-informal"==e?function(t,e){if(t>9999||t<-9999)return""+t;if(0==t)return e.digits.charAt(0);var n=new r.d;if(t<0&&(n.append(e.negative),t=-t),t<10)n.append(e.digits.charAt(t));else if(!e.formal&&t<=19)n.append(e.markers.charAt(0)),0!=t&&n.append(e.digits.charAt(t-10));else{var i=Math.floor(t/1e3);i&&(n.append(e.digits.charAt(i)),n.append(e.markers.charAt(2)));var o=Math.floor(t/100)%10;o&&(n.append(e.digits.charAt(o)),n.append(e.markers.charAt(1)));var a=Math.floor(t/10)%10;a&&(n.append(e.digits.charAt(a)),n.append(e.markers.charAt(0)));var s=t%10;s&&n.append(e.digits.charAt(s))}return n.toString()}(t,Ft):""+t,i?a.toUpperCase():o?a.toLowerCase():a},e.prototype.visitFuncCounter=function(t){var e=t[0].toString(),n=t.length>1?t[1].stringValue():"decimal",i=this.cascade.counters[e];if(i&&i.length){var o=i&&i.length&&i[i.length-1]||0;return new a.k(this.format(o,n))}var r=this,s=new a.c(this.counterResolver.getPageCounterVal(e,function(t){return r.format(t||0,n)}));return new a.j([s])},e.prototype.visitFuncCounters=function(t){var e=t[0].toString(),n=t[1].stringValue(),i=t.length>2?t[2].stringValue():"decimal",o=this.cascade.counters[e],s=new r.d;if(o&&o.length)for(var l=0;l<o.length;l++)l>0&&s.append(n),s.append(this.format(o[l],i));var u=this,c=new a.c(this.counterResolver.getPageCountersVal(e,function(t){var e=[];if(t.length)for(var o=0;o<t.length;o++)e.push(u.format(t[o],i));var r=s.toString();return r.length&&e.push(r),e.length?e.join(n):u.format(0,i)}));return new a.j([c])},e.prototype.visitFuncTargetCounter=function(t){var e,n=t[0];e=n instanceof a.l?n.url:n.stringValue();var i=t[1].toString(),o=t.length>2?t[2].stringValue():"decimal",r=this,s=new a.c(this.counterResolver.getTargetCounterVal(e,i,function(t){return r.format(t||0,o)}));return new a.j([s])},e.prototype.visitFuncTargetCounters=function(t){var e,n=t[0];e=n instanceof a.l?n.url:n.stringValue();var i=t[1].toString(),o=t[2].stringValue(),r=t.length>3?t[3].stringValue():"decimal",s=this,l=new a.c(this.counterResolver.getTargetCountersVal(e,i,function(t){var e=t.map(function(t){return s.format(t,r)});return e.length?e.join(o):s.format(0,r)}));return new a.j([l])},e.prototype.visitFunc=function(t){switch(t.name){case"counter":if(t.values.length<=2)return this.visitFuncCounter(t.values);break;case"counters":if(t.values.length<=3)return this.visitFuncCounters(t.values);break;case"target-counter":if(t.values.length<=3)return this.visitFuncTargetCounter(t.values);break;case"target-counters":if(t.values.length<=4)return this.visitFuncTargetCounters(t.values)}return h.b.warn("E_CSS_CONTENT_PROP:",t.toString()),new a.k("")},e}(a.d),Rt={roman:[4999,1e3,"M",900,"CM",500,"D",400,"CD",100,"C",90,"XC",50,"L",40,"XL",10,"X",9,"IX",5,"V",4,"IV",1,"I"],armenian:[9999,9e3,"ք",8e3,"փ",7e3,"ւ",6e3,"ց",5e3,"ր",4e3,"տ",3e3,"վ",2e3,"ս",1e3,"ռ",900,"ջ",800,"պ",700,"չ",600,"ո",500,"շ",400,"ն",300,"յ",200,"մ",100,"ճ",90,"ղ",80,"ձ",70,"հ",60,"կ",50,"ծ",40,"խ",30,"լ",20,"ի",10,"ժ",9,"թ",8,"ը",7,"է",6,"զ",5,"ե",4,"դ",3,"գ",2,"բ",1,"ա"],georgian:[19999,1e4,"ჵ",9e3,"ჰ",8e3,"ჯ",7e3,"ჴ",6e3,"ხ",5e3,"ჭ",4e3,"წ",3e3,"ძ",2e3,"ც",1e3,"ჩ",900,"შ",800,"ყ",700,"ღ",600,"ქ",500,"ფ",400,"ჳ",300,"ტ",200,"ს",100,"რ",90,"ჟ",80,"პ",70,"ო",60,"ჲ",50,"ნ",40,"მ",30,"ლ",20,"კ",10,"ი",9,"თ",8,"ჱ",7,"ზ",6,"ვ",5,"ე",4,"დ",3,"გ",2,"ბ",1,"ა"],hebrew:[999,400,"ת",300,"ש",200,"ר",100,"ק",90,"צ",80,"פ",70,"ע",60,"ס",50,"נ",40,"מ",30,"ל",20,"כ",19,"יט",18,"יח",17,"יז",16,"טז",15,"טו",10,"י",9,"ט",8,"ח",7,"ז",6,"ו",5,"ה",4,"ד",3,"ג",2,"ב",1,"א"]},Lt={latin:"a-z",alpha:"a-z",greek:"α-ρσ-ω",russian:"а-ик-щэ-я"},_t={square:"■",disc:"•",circle:"◦",none:""},Ft={formal:!1,digits:"零一二三四五六七八九",markers:"十百千",negative:"負"};function Dt(t,e){for(var n in t)e[n]=t[n].clone()}var Bt,Mt=function(){function t(){this.nsCount=0,this.nsPrefix={},this.tags={},this.nstags={},this.epubtypes={},this.classes={},this.ids={},this.pagetypes={},this.order=0}return t.prototype.clone=function(){var e=new t;for(var n in e.nsCount=this.nsCount,this.nsPrefix)e.nsPrefix[n]=this.nsPrefix[n];return Dt(this.tags,e.tags),Dt(this.nstags,e.nstags),Dt(this.epubtypes,e.epubtypes),Dt(this.classes,e.classes),Dt(this.ids,e.ids),Dt(this.pagetypes,e.pagetypes),e.order=this.order,e},t.prototype.insertInTable=function(t,e,n){var i=t[e];i&&(n=i.mergeWith(n)),t[e]=n},t.prototype.createInstance=function(t,e,n,i){return new Ut(this,t,e,n,i)},t.prototype.nextOrder=function(){return this.order+=1/1048576},t}(),Ut=function(){function t(t,e,n,i,o){this.context=e,this.counterListener=n,this.counterResolver=i,this.stack=[[],[]],this.conditions={},this.currentElement=null,this.currentElementOffset=null,this.currentStyle=null,this.currentClassNames=null,this.currentLocalName="",this.currentNamespace="",this.currentId="",this.currentXmlId="",this.currentNSTag="",this.currentEpubTypes=null,this.currentPageType=null,this.isFirst=!0,this.isRoot=!0,this.counters={},this.counterScoping=[{}],this.quoteDepth=0,this.lang="",this.siblingOrderStack=[0],this.currentSiblingOrder=0,this.siblingTypeCountsStack=[{}],this.currentFollowingSiblingOrder=null,this.followingSiblingTypeCountsStack=[{}],this.viewConditions={},this.dependentConditions=[],this.code=t,this.quotes=[new a.k("“"),new a.k("”"),new a.k("‘"),new a.k("’")],this.currentSiblingTypeCounts=this.siblingTypeCountsStack[0],this.followingSiblingOrderStack=[this.currentFollowingSiblingOrder],this.currentFollowingSiblingTypeCounts=this.siblingTypeCountsStack[0]}return t.prototype.pushConditionItem=function(t){this.stack[this.stack.length-1].push(t)},t.prototype.increment=function(t,e){this.conditions[t]=(this.conditions[t]||0)+1,e&&(this.viewConditions[t]?this.viewConditions[t].push(e):this.viewConditions[t]=[e])},t.prototype.decrement=function(t,e){this.conditions[t]--,this.viewConditions[t]&&(this.viewConditions[t]=this.viewConditions[t].filter(function(t){return t!==e}),0===this.viewConditions[t].length&&delete this.viewConditions[t])},t.prototype.buildViewConditionMatcher=function(t){var e=this,n=null;t&&(o.a(this.currentElementOffset),n=p.a.buildViewConditionMatcher(this.currentElementOffset,t));var i=this.dependentConditions.map(function(t){var n=e.viewConditions[t];return n&&n.length>0?1===n.length?n[0]:p.a.buildAnyMatcher([].concat(n)):null}).filter(function(t){return t});return i.length<=0?n:null===n?1===i.length?i[0]:p.a.buildAllMatcher(i):p.a.buildAllMatcher([n].concat(i))},t.prototype.applyAction=function(t,e){var n=t[e];n&&n.apply(this)},t.prototype.pushRule=function(t,e,n){this.currentElement=null,this.currentElementOffset=null,this.currentStyle=n,this.currentNamespace="",this.currentLocalName="",this.currentId="",this.currentXmlId="",this.currentClassNames=t,this.currentNSTag="",this.currentEpubTypes=zt,this.currentPageType=e,this.applyActions()},t.prototype.defineCounter=function(t,e){this.counters[t]?this.counters[t].push(e):this.counters[t]=[e];var n=this.counterScoping[this.counterScoping.length-1];n||(n={},this.counterScoping[this.counterScoping.length-1]=n),n[t]=!0},t.prototype.pushCounters=function(t){var e=a.t.inline,n=t.display;n&&(e=n.evaluate(this.context));var i=null,o=null,s=null,u=t["counter-reset"];if(u){var c=u.evaluate(this.context);c&&(i=l.b(c,!0))}var h=t["counter-set"];if(h){var p=h.evaluate(this.context);p&&(s=l.b(p,!1))}var f=t["counter-increment"];if(f){var d=f.evaluate(this.context);d&&(o=l.b(d,!1))}if("ol"!=this.currentLocalName&&"ul"!=this.currentLocalName||this.currentNamespace!=r.a.XHTML||(i||(i={}),i["ua-list-item"]=0),e===a.t.list_item&&(o||(o={}),o["ua-list-item"]=1),i)for(var g in i)this.defineCounter(g,i[g]);if(s)for(var m in s)this.counters[m]?(y=this.counters[m])[y.length-1]=s[m]:this.defineCounter(m,s[m]);if(o)for(var v in o){var y;this.counters[v]||this.defineCounter(v,0),(y=this.counters[v])[y.length-1]+=o[v]}if(e===a.t.list_item){var b=this.counters["ua-list-item"],w=b[b.length-1];t["ua-list-item-count"]=new I(new a.h(w),0)}this.counterScoping.push(null)},t.prototype.popCounters=function(){var t=this.counterScoping.pop();if(t)for(var e in t){var n=this.counters[e];n&&(1==n.length?delete this.counters[e]:n.pop())}},t.prototype.processPseudoelementProps=function(t,e){this.pushCounters(t),t.content&&(t.content=t.content.filterValue(new At(this,e,this.counterResolver))),this.popCounters()},t.prototype.pushElement=function(t,e,n){var i=this;this.currentPageType=null,this.currentElement=t,this.currentElementOffset=n,this.currentStyle=e,this.currentNamespace=t.namespaceURI,this.currentLocalName=t.localName;var o=this.code.nsPrefix[this.currentNamespace];this.currentNSTag=o?o+this.currentLocalName:"",this.currentId=t.getAttribute("id"),this.currentXmlId=t.getAttributeNS(r.a.XML,"id");var s=t.getAttribute("class");this.currentClassNames=s?s.split(/\s+/):zt;var l=t.getAttributeNS(r.a.epub,"type");if(this.currentEpubTypes=l?l.split(/\s+/):zt,"style"==this.currentLocalName&&this.currentNamespace==r.a.FB2){var u=t.getAttribute("name")||"";this.currentClassNames=[u]}var c=r.u(t);c&&(this.stack[this.stack.length-1].push(new Pt(this.lang)),this.lang=c.toLowerCase());var h=this.isRoot,p=this.siblingOrderStack;this.currentSiblingOrder=++p[p.length-1],p.push(0);var f=this.siblingTypeCountsStack,d=this.currentSiblingTypeCounts=f[f.length-1],g=d[this.currentNamespace];g||(g=d[this.currentNamespace]={}),g[this.currentLocalName]=(g[this.currentLocalName]||0)+1,f.push({});var m=this.followingSiblingOrderStack;null!==m[m.length-1]?this.currentFollowingSiblingOrder=--m[m.length-1]:this.currentFollowingSiblingOrder=null,m.push(null);var v=this.followingSiblingTypeCountsStack,y=this.currentFollowingSiblingTypeCounts=v[v.length-1];y&&y[this.currentNamespace]&&y[this.currentNamespace][this.currentLocalName]--,v.push({}),this.applyActions(),this.applyAttrFilter(t);var b=e.quotes,w=null;if(b){var E=b.evaluate(this.context);E&&(w=new Ot(this.quotes),E===a.t.none?this.quotes=[new a.k(""),new a.k("")]:E instanceof a.j&&(this.quotes=E.values))}this.pushCounters(this.currentStyle);var S=this.currentId||this.currentXmlId||t.getAttribute("name")||"";if(h||S){var N={};Object.keys(this.counters).forEach(function(t){N[t]=Array.from(i.counters[t])}),this.counterListener.countersOfId(S,N)}var C=D(this.currentStyle,"_pseudos");if(C)for(var T=!0,x=0,I=Vt;x<I.length;x++){var P=I[x];P||(T=!1);var O=C[P];O&&(T?this.processPseudoelementProps(O,t):this.stack[this.stack.length-2].push(new It(O,t)))}w&&this.stack[this.stack.length-2].push(w)},t.prototype.applyAttrFilterInner=function(t,e){for(var n in e)R(n)&&(e[n]=e[n].filterValue(t))},t.prototype.applyAttrFilter=function(t){var e=new kt(t),n=this.currentStyle,i=D(n,"_pseudos");for(var o in i)this.applyAttrFilterInner(e,i[o]);this.applyAttrFilterInner(e,n)},t.prototype.applyActions=function(){var t;for(t=0;t<this.currentClassNames.length;t++)this.applyAction(this.code.classes,this.currentClassNames[t]);for(t=0;t<this.currentEpubTypes.length;t++)this.applyAction(this.code.epubtypes,this.currentEpubTypes[t]);this.applyAction(this.code.ids,this.currentId),this.applyAction(this.code.tags,this.currentLocalName),""!=this.currentLocalName&&this.applyAction(this.code.tags,"*"),this.applyAction(this.code.nstags,this.currentNSTag),null!==this.currentPageType&&(this.applyAction(this.code.pagetypes,this.currentPageType),this.applyAction(this.code.pagetypes,"*")),this.currentElement=null,this.currentDoc=null,this.stack.push([]);for(var e=1;e>=-1;--e){var n=this.stack[this.stack.length-e-2];for(t=0;t<n.length;)n[t].push(this,e)?n.splice(t,1):t++}this.isFirst=!0,this.isRoot=!1},t.prototype.pop=function(){for(var t=1;t>=-1;--t)for(var e=this.stack[this.stack.length-t-2],n=0;n<e.length;)e[n].pop(this,t)?e.splice(n,1):n++;this.stack.pop(),this.isFirst=!1},t.prototype.popRule=function(){this.pop()},t.prototype.popElement=function(t){this.siblingOrderStack.pop(),this.siblingTypeCountsStack.pop(),this.followingSiblingOrderStack.pop(),this.followingSiblingTypeCountsStack.pop(),this.pop(),this.popCounters()},t}(),zt=[],Vt=["before","transclusion-before","footnote-call","footnote-marker","inner","first-letter","first-line","","transclusion-after","after"];!function(t){t[t.TOP=0]="TOP",t[t.SELECTOR=1]="SELECTOR",t[t.RULE=2]="RULE"}(Bt||(Bt={}));var Ht=null;function Gt(t){Ht=t}var Wt=function(t){function e(e,n,i,o,r,a,s){var l=t.call(this,e,n,s)||this;return l.condition=i,l.regionId=r,l.validatorSet=a,l.chain=null,l.specificity=0,l.elementStyle=null,l.conditionCount=0,l.pseudoelement=null,l.footnoteContent=!1,l.viewConditionId=null,l.cascade=o?o.cascade:Ht?Ht.clone():new Mt,l.state=Bt.TOP,l}return d(e,t),e.prototype.insertNonPrimary=function(t){this.cascade.insertInTable(this.cascade.tags,"*",t)},e.prototype.processChain=function(t){var e=G(this.chain,t);e!==t&&e.makePrimary(this.cascade)||this.insertNonPrimary(e)},e.prototype.isInsideSelectorRule=function(t){return this.state!=Bt.TOP&&(this.reportAndSkip(t),!0)},e.prototype.tagSelector=function(t,e){(e||t)&&(this.specificity+=1,e&&t?this.chain.push(new tt(t,e.toLowerCase())):e?this.chain.push(new J(e.toLowerCase())):this.chain.push(new nt(t)))},e.prototype.classSelector=function(t){if(this.pseudoelement)return h.b.warn("::"+this.pseudoelement,"followed by ."+t),void this.chain.push(new bt(""));this.specificity+=256,this.chain.push(new Z(t))},e.prototype.pseudoclassSelector=function(t,e){if(this.pseudoelement)return h.b.warn("::"+this.pseudoelement,"followed by :"+t),void this.chain.push(new bt(""));switch(t.toLowerCase()){case"enabled":this.chain.push(new mt);break;case"disabled":this.chain.push(new vt);break;case"checked":this.chain.push(new yt);break;case"root":this.chain.push(new ut);break;case"link":this.chain.push(new J("a")),this.chain.push(new it("","href"));break;case"-adapt-href-epub-type":case"href-epub-type":if(e&&1==e.length&&"string"==typeof e[0]){var n=e[0],i=new RegExp("(^|s)"+r.s(n)+"($|s)");this.chain.push(new et(i))}else this.chain.push(new bt(""));break;case"-adapt-footnote-content":case"footnote-content":this.footnoteContent=!0;break;case"visited":case"active":case"hover":case"focus":this.chain.push(new bt(""));break;case"lang":if(e&&1==e.length&&"string"==typeof e[0]){var o=e[0];this.chain.push(new st(new RegExp("^"+r.s(o.toLowerCase())+"($|-)")))}else this.chain.push(new bt(""));break;case"nth-child":case"nth-last-child":case"nth-of-type":case"nth-last-of-type":var a=jt[t.toLowerCase()];e&&2==e.length?this.chain.push(new a(e[0],e[1])):this.chain.push(new bt(""));break;case"first-child":this.chain.push(new lt);break;case"last-child":this.chain.push(new ft(0,1));break;case"first-of-type":this.chain.push(new pt(0,1));break;case"last-of-type":this.chain.push(new dt(0,1));break;case"only-child":this.chain.push(new lt),this.chain.push(new ft(0,1));break;case"only-of-type":this.chain.push(new pt(0,1)),this.chain.push(new dt(0,1));break;case"empty":this.chain.push(new gt);break;case"before":case"after":case"first-line":case"first-letter":return void this.pseudoelementSelector(t,e);default:h.b.warn("unknown pseudo-class selector: "+t),this.chain.push(new bt(""))}this.specificity+=256},e.prototype.pseudoelementSelector=function(t,e){switch(t){case"before":case"after":case"first-line":case"first-letter":case"footnote-call":case"footnote-marker":case"inner":case"after-if-continues":this.pseudoelement?(h.b.warn("Double pseudoelement ::"+this.pseudoelement+"::"+t),this.chain.push(new bt(""))):this.pseudoelement=t;break;case"first-n-lines":if(e&&1==e.length&&"number"==typeof e[0]){var n=Math.round(e[0]);if(n>0&&n==e[0]){this.pseudoelement?(h.b.warn("Double pseudoelement ::"+this.pseudoelement+"::"+t),this.chain.push(new bt(""))):this.pseudoelement="first-"+n+"-lines";break}}this.chain.push(new bt(""));break;case"nth-fragment":e&&2==e.length?this.viewConditionId="NFS_"+e[0]+"_"+e[1]:this.chain.push(new bt(""));break;default:h.b.warn("Unrecognized pseudoelement: ::"+t),this.chain.push(new bt(""))}this.specificity+=1},e.prototype.idSelector=function(t){this.specificity+=65536,this.chain.push(new Q(t))},e.prototype.attributeSelector=function(t,e,n,i){var o;switch(this.specificity+=256,e=e.toLowerCase(),i=i||"",n){case u.a.EOF:o=new it(t,e);break;case u.a.EQ:o=new ot(t,e,i);break;case u.a.TILDE_EQ:o=!i||i.match(/\s/)?new bt(""):new at(t,e,new RegExp("(^|\\s)"+r.s(i)+"($|\\s)"));break;case u.a.BAR_EQ:o=new at(t,e,new RegExp("^"+r.s(i)+"($|-)"));break;case u.a.HAT_EQ:o=i?new at(t,e,new RegExp("^"+r.s(i))):new bt("");break;case u.a.DOLLAR_EQ:o=i?new at(t,e,new RegExp(r.s(i)+"$")):new bt("");break;case u.a.STAR_EQ:o=i?new at(t,e,new RegExp(r.s(i))):new bt("");break;case u.a.COL_COL:"supported"==i?o=new rt(t,e):(h.b.warn("Unsupported :: attr selector op:",i),o=new bt(""));break;default:h.b.warn("Unsupported attr selector:",n),o=new bt("")}this.chain.push(o)},e.prototype.descendantSelector=function(){var t="d"+Xt++;this.processChain(new K(new Nt(t,this.viewConditionId,null))),this.chain=[new bt(t)],this.viewConditionId=null},e.prototype.childSelector=function(){var t="c"+Xt++;this.processChain(new K(new Ct(t,this.viewConditionId,null))),this.chain=[new bt(t)],this.viewConditionId=null},e.prototype.adjacentSiblingSelector=function(){var t="a"+Xt++;this.processChain(new K(new Tt(t,this.viewConditionId,null))),this.chain=[new bt(t)],this.viewConditionId=null},e.prototype.followingSiblingSelector=function(){var t="f"+Xt++;this.processChain(new K(new xt(t,this.viewConditionId,null))),this.chain=[new bt(t)],this.viewConditionId=null},e.prototype.nextSelector=function(){this.finishChain(),this.pseudoelement=null,this.footnoteContent=!1,this.specificity=0,this.chain=[]},e.prototype.startSelectorRule=function(){this.isInsideSelectorRule("E_CSS_UNEXPECTED_SELECTOR")||(this.state=Bt.SELECTOR,this.elementStyle={},this.pseudoelement=null,this.specificity=0,this.footnoteContent=!1,this.chain=[])},e.prototype.error=function(e,n){t.prototype.error.call(this,e,n),this.state==Bt.SELECTOR&&(this.state=Bt.TOP)},e.prototype.startStylesheet=function(e){t.prototype.startStylesheet.call(this,e),this.state=Bt.TOP},e.prototype.startRuleBody=function(){this.finishChain(),t.prototype.startRuleBody.call(this),this.state==Bt.SELECTOR&&(this.state=Bt.TOP)},e.prototype.endRule=function(){t.prototype.endRule.call(this),this.insideSelectorRule=Bt.TOP},e.prototype.finishChain=function(){if(this.chain){var t=this.specificity+this.cascade.nextOrder();this.processChain(this.makeApplyRuleAction(t)),this.chain=null,this.pseudoelement=null,this.viewConditionId=null,this.footnoteContent=!1,this.specificity=0}},e.prototype.makeApplyRuleAction=function(t){var e=this.regionId;return this.footnoteContent&&(e=e?"xxx-bogus-xxx":"footnote"),new Y(this.elementStyle,t,this.pseudoelement,e,this.viewConditionId)},e.prototype.special=function(t,e){var n;n=this.condition?new P(e,0,this.condition):new I(e,0),z(this.elementStyle,t).push(n)},e.prototype.property=function(t,e,n){this.validatorSet.validatePropertyAndHandleShorthand(t,e,n,this)},e.prototype.invalidPropertyValue=function(t,e){this.report("E_INVALID_PROPERTY_VALUE "+t+": "+e.toString())},e.prototype.unknownProperty=function(t,e){this.report("E_INVALID_PROPERTY "+t+": "+e.toString())},e.prototype.simpleProperty=function(t,e,n){"display"!=t||e!==a.t.oeb_page_head&&e!==a.t.oeb_page_foot||(this.simpleProperty("flow-options",new a.j([a.t.exclusive,a.t._static]),n),this.simpleProperty("flow-into",e,n),e=a.t.block),f.b("SIMPLE_PROPERTY").forEach(function(i){var o=i({name:t,value:e,important:n});t=o.name,e=o.value,n=o.important});var i=n?this.getImportantSpecificity():this.getBaseSpecificity(),o=this.condition?new P(e,i,this.condition):new I(e,i);F(this.elementStyle,t,o)},e.prototype.finish=function(){return this.cascade},e.prototype.startFuncWithSelector=function(t){switch(t){case"not":var e=new Kt(this);e.startSelectorRule(),this.owner.pushHandler(e)}},e}(s.f),jt={"nth-child":ht,"nth-of-type":pt,"nth-last-child":ft,"nth-last-of-type":dt},Xt=0,Kt=function(t){function e(e){var n=t.call(this,e.scope,e.owner,e.condition,e,e.regionId,e.validatorSet,!1)||this;return n.parent=e,n.parentChain=e.chain,n}return d(e,t),e.prototype.startFuncWithSelector=function(t){"not"==t&&this.reportAndSkip("E_CSS_UNEXPECTED_NOT")},e.prototype.startRuleBody=function(){this.reportAndSkip("E_CSS_UNEXPECTED_RULE_BODY")},e.prototype.nextSelector=function(){this.reportAndSkip("E_CSS_UNEXPECTED_NEXT_SELECTOR")},e.prototype.endFuncWithSelector=function(){this.chain&&this.chain.length>0&&this.parentChain.push(new Et(this.chain)),this.parent.specificity+=this.specificity,this.owner.popHandler()},e.prototype.error=function(e,n){t.prototype.error.call(this,e,n),this.owner.popHandler()},e}(Wt),qt=function(t){function e(e,n){return t.call(this,e,n,!1)||this}return d(e,t),e.prototype.property=function(t,e,n){if(this.scope.values[t])this.error("E_CSS_NAME_REDEFINED "+t,this.getCurrentToken());else{var i=t.match(/height|^(top|bottom)$/)?"vh":"vw",o=new c.x(this.scope,100,i);this.scope.defineName(t,e.toExpr(this.scope,o))}},e}(s.f),Yt=function(t){function e(e,n,i,o,r){var a=t.call(this,e,n,!1)||this;return a.condition=i,a.elementStyle=o,a.validatorSet=r,a.order=0,a}return d(e,t),e.prototype.property=function(t,e,n){n?h.b.warn("E_IMPORTANT_NOT_ALLOWED"):this.validatorSet.validatePropertyAndHandleShorthand(t,e,n,this)},e.prototype.invalidPropertyValue=function(t,e){h.b.warn("E_INVALID_PROPERTY_VALUE",t+":",e.toString())},e.prototype.unknownProperty=function(t,e){h.b.warn("E_INVALID_PROPERTY",t+":",e.toString())},e.prototype.simpleProperty=function(t,e,n){var i=n?this.getImportantSpecificity():this.getBaseSpecificity();i+=this.order,this.order+=1/1048576;var o=this.condition?new P(e,i,this.condition):new I(e,i);F(this.elementStyle,t,o)},e}(s.f),$t=function(t){function e(e,n){var i=t.call(this,e)||this;return i.validatorSet=n,i.elementStyle={},i.order=0,i}return d(e,t),e.prototype.property=function(t,e,n){this.validatorSet.validatePropertyAndHandleShorthand(t,e,n,this)},e.prototype.invalidPropertyValue=function(t,e){h.b.warn("E_INVALID_PROPERTY_VALUE",t+":",e.toString())},e.prototype.unknownProperty=function(t,e){h.b.warn("E_INVALID_PROPERTY",t+":",e.toString())},e.prototype.simpleProperty=function(t,e,n){var i=n?s.e:s.d;i+=this.order,this.order+=1/1048576;var o=new I(e,i);F(this.elementStyle,t,o)},e}(s.b);function Zt(t,e){var n=M(t);n&&n.forEach(function(t){t.matcher.matches()&&e(t.styles)})}function Qt(t,e,n){Zt(n,function(n){oe(t,n,e)})}function Jt(t,e,n,i){var o=new $t(t,e),r=new u.b(i,o);try{s.j(r,o,n)}catch(t){h.b.warn(t,"Style attribute parse error:")}return o.elementStyle}function te(t,e,n){var i=t["writing-mode"];if(i){var o=i.evaluate(e,"writing-mode");if(o&&o!==a.t.inherit)return o===a.t.vertical_rl}return n}function ee(t,e,n){var i=t.direction;if(i){var o=i.evaluate(e,"direction");if(o&&o!==a.t.inherit)return o===a.t.rtl}return n}function ne(t,e,n,i,o){var r={};for(var a in t)R(a)&&(r[a]=_(t,a));return Qt(r,e,t),ie(t,n,i,function(t,n){oe(r,n,e),Qt(r,e,n)}),r}function ie(t,e,n,i){var o=D(t,"_regions");if((e||n)&&o){if(n){var r=["footnote"];e=e?e.concat(r):r}for(var a=0,s=e;a<s.length;a++){var l=s[a],u=o[l];u&&i(l,u)}}}function oe(t,e,n){for(var i in e)if(R(i)){var o=_(e,i),r=t[i];t[i]=O(n,r,o)}}var re=function(t,e,n,i,o){var r=n?i?T:N:i?x:C;for(var a in t)if(t.hasOwnProperty(a)){var s=t[a];if(!s)continue;var l=r[a],u=void 0;if(l){var c=t[l];if(c&&c.priority>s.priority)continue;u=E[l]?l:a}else u=a;e[u]=o(a,s)}}},function(t,e,n){"use strict";var i;function o(t){var e=Array.from(t),n=null;return e[0]instanceof Error&&(n=e.shift()),{error:n,messages:e}}function r(t){var e=t.error,n=e&&(e.frameTrace||e.stack),i=[].concat(t.messages);return e&&(i.length>0&&(i=i.concat(["\n"])),i=i.concat([e.toString()]),n&&(i=i.concat(["\n"]).concat(n))),i}n.d(e,"a",function(){return i}),n.d(e,"b",function(){return a}),function(t){t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR"}(i||(i={}));var a=new(function(){function t(t){this.opt_console=t,this.listeners={}}return t.prototype.consoleDebug=function(t){var e,n;this.opt_console?this.opt_console.debug?(e=this.opt_console).debug.apply(e,t):(n=this.opt_console).log.apply(n,t):console.debug.apply(console,t)},t.prototype.consoleInfo=function(t){var e,n;this.opt_console?this.opt_console.info?(e=this.opt_console).info.apply(e,t):(n=this.opt_console).log.apply(n,t):console.info.apply(console,t)},t.prototype.consoleWarn=function(t){var e,n;this.opt_console?this.opt_console.warn?(e=this.opt_console).warn.apply(e,t):(n=this.opt_console).log.apply(n,t):console.warn.apply(console,t)},t.prototype.consoleError=function(t){var e,n;this.opt_console?this.opt_console.error?(e=this.opt_console).error.apply(e,t):(n=this.opt_console).log.apply(n,t):console.error.apply(console,t)},t.prototype.triggerListeners=function(t,e){var n=this.listeners[t];n&&n.forEach(function(t){t(e)})},t.prototype.addListener=function(t,e){var n=this.listeners[t];n||(n=this.listeners[t]=[]),n.push(e)},t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=o(arguments);this.consoleDebug(r(n)),this.triggerListeners(i.DEBUG,n)},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=o(arguments);this.consoleInfo(r(n)),this.triggerListeners(i.INFO,n)},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=o(arguments);this.consoleWarn(r(n)),this.triggerListeners(i.WARN,n)},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=o(arguments);this.consoleError(r(n)),this.triggerListeners(i.ERROR,n)},t}())},function(t,e,n){"use strict";function i(t){}function o(t){}n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o})},function(t,e,n){"use strict";n.d(e,"s",function(){return g}),n.d(e,"t",function(){return m}),n.d(e,"d",function(){return v}),n.d(e,"l",function(){return w}),n.d(e,"m",function(){return E}),n.d(e,"z",function(){return N}),n.d(e,"p",function(){return C}),n.d(e,"f",function(){return T}),n.d(e,"g",function(){return x}),n.d(e,"r",function(){return I}),n.d(e,"q",function(){return P}),n.d(e,"u",function(){return k}),n.d(e,"w",function(){return A}),n.d(e,"x",function(){return R}),n.d(e,"v",function(){return L}),n.d(e,"o",function(){return _}),n.d(e,"n",function(){return F}),n.d(e,"e",function(){return B}),n.d(e,"k",function(){return M}),n.d(e,"a",function(){return U}),n.d(e,"h",function(){return z}),n.d(e,"i",function(){return V}),n.d(e,"j",function(){return H}),n.d(e,"b",function(){return G}),n.d(e,"c",function(){return W}),n.d(e,"y",function(){return j});var i,o=n(7),r=n(1),a=n(0),s=n(10),l=n(20),u=n(2),c=n(27),h=n(4),p=n(11),f=n(15),d=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),g={transform:!0,"transform-origin":!0},m={top:!0,bottom:!0,left:!0,right:!0},v=function(t,e,n){this.target=t,this.name=e,this.value=n},y={show:function(t){t.style.visibility="visible"},hide:function(t){t.style.visibility="hidden"},play:function(t){t.currentTime=0,t.play()},pause:function(t){t.pause()},resume:function(t){t.play()},mute:function(t){t.muted=!0},unmute:function(t){t.muted=!1}};function b(t,e){var n=y[e];return n?function(){for(var e=0;e<t.length;e++)try{n(t[e])}catch(t){}}:null}var w=function(t){function e(e,n){var i=t.call(this)||this;i.container=e,i.bleedBox=n,i.pageAreaElement=null,i.delayedItems=[],i.elementsById={},i.dimensions={width:0,height:0},i.isFirstPage=!1,i.isLastPage=!1,i.isAutoPageWidth=!0,i.isAutoPageHeight=!0,i.spineIndex=0,i.position=null,i.offset=-1,i.side=null,i.fetchers=[],i.marginBoxes={top:{},bottom:{},left:{},right:{}};var o=i;return i.hrefHandler=function(t){var e=t.currentTarget,n=e.getAttribute("href")||e.getAttributeNS(r.a.XLINK,"href");if(n){var i={type:"hyperlink",target:null,currentTarget:null,anchorElement:e,href:n,preventDefault:function(){t.preventDefault()}};o.dispatchEvent(i)}},i}return d(e,t),e.prototype.setAutoPageWidth=function(t){this.isAutoPageWidth=t,t?this.container.setAttribute(e.AUTO_PAGE_WIDTH_ATTRIBUTE,"true"):this.container.removeAttribute(e.AUTO_PAGE_WIDTH_ATTRIBUTE)},e.prototype.setAutoPageHeight=function(t){this.isAutoPageHeight=t,t?this.container.setAttribute(e.AUTO_PAGE_HEIGHT_ATTRIBUTE,"true"):this.container.removeAttribute(e.AUTO_PAGE_HEIGHT_ATTRIBUTE)},e.prototype.registerElementWithId=function(t,e){var n=this.elementsById[e];n?n.push(t):this.elementsById[e]=[t]},e.prototype.finish=function(t,e){var n=this;Object.keys(this.elementsById).forEach(function(t){for(var e=n.elementsById[t],i=0;i<e.length;)n.container.contains(e[i])?i++:e.splice(i,1);0===e.length&&delete n.elementsById[t]});for(var i=this.delayedItems,o=0;o<i.length;o++){var a=i[o];(a.target!==this.container||"transform"!==a.name||this.isAutoPageWidth||this.isAutoPageHeight)&&r.F(a.target,a.name,a.value.toString())}var s=e.getElementClientRect(this.container);for(this.dimensions.width=s.width,this.dimensions.height=s.height,o=0;o<t.length;o++){var l=t[o],u=this.elementsById[l.ref],c=this.elementsById[l.observer];if(u&&c){var h=b(u,l.action);if(h)for(var p=0;p<c.length;p++)c[p].addEventListener(l.event,h,!1)}}},e.prototype.zoom=function(t){r.F(this.container,"transform","scale("+t+")")},e.prototype.getPageAreaElement=function(){return this.pageAreaElement||this.container},e.AUTO_PAGE_WIDTH_ATTRIBUTE="data-vivliostyle-auto-page-width",e.AUTO_PAGE_HEIGHT_ATTRIBUTE="data-vivliostyle-auto-page-height",e}(r.c),E="data-adapt-spec",S=f.f.Whitespace;function N(t){switch(t){case"normal":case"nowrap":return S.IGNORE;case"pre-line":return S.NEWLINE;case"pre":case"pre-wrap":return S.PRESERVE;default:return null}}function C(t,e){if(1==t.nodeType)return!1;var n=t.textContent;switch(e){case S.IGNORE:return!!n.match(/^\s*$/);case S.NEWLINE:return!!n.match(/^[ \t\f]*$/);case S.PRESERVE:return 0==n.length}throw new Error("Unexpected whitespace: "+e)}var T=function(t,e){this.flowName=t,this.parentFlowName=e,this.forcedBreakOffsets=[],this.formattingContext=null},x=function(){function t(t,e,n,i,o,r,a,s,l){this.flowName=t,this.element=e,this.startOffset=n,this.priority=i,this.linger=o,this.exclusive=r,this.repeated=a,this.last=s,this.breakBefore=l,this.startPage=-1}return t.prototype.isBetter=function(t){return!!this.exclusive&&(!t.exclusive||this.priority>t.priority||this.last)},t}();function I(t,e){return t.top-e.top}function P(t,e){return e.right-t.right}function O(t,e){return t===e||!(!t||!e)&&t.node===e.node&&t.shadowType===e.shadowType&&D(t.shadowContext,e.shadowContext)&&D(t.nodeShadow,e.nodeShadow)&&O(t.shadowSibling,e.shadowSibling)}function k(t,e){if(t===e)return!0;if(!t||!e)return!1;if(t.offsetInNode!==e.offsetInNode||t.after!==e.after||t.steps.length!==e.steps.length)return!1;for(var n=0;n<t.steps.length;n++)if(!O(t.steps[n],e.steps[n]))return!1;return!0}function A(t){return{steps:[{node:t,shadowType:_.NONE,shadowContext:null,nodeShadow:null,shadowSibling:null,formattingContext:null,fragmentIndex:0}],offsetInNode:0,after:!1,preprocessedTextContent:null}}function R(t,e){return{steps:[{node:t.sourceNode,shadowType:_.NONE,shadowContext:t.shadowContext,nodeShadow:null,shadowSibling:null,formattingContext:null,fragmentIndex:null!=e?e:t.fragmentIndex}],offsetInNode:0,after:!1,preprocessedTextContent:t.preprocessedTextContent}}function L(t,e){var n=new M(t.node,e,0);return n.shadowType=t.shadowType,n.shadowContext=t.shadowContext,n.nodeShadow=t.nodeShadow,n.shadowSibling=t.shadowSibling?L(t.shadowSibling,e.copy()):null,n.formattingContext=t.formattingContext,n.fragmentIndex=t.fragmentIndex+1,n}var _=f.f.ShadowType,F=function(){function t(t,e,n,i,o,r,a){this.owner=t,this.root=e,this.xmldoc=n,this.parentShadow=i,this.type=r,this.styler=a,this.subShadow=null,o&&(o.subShadow=this)}return t.prototype.equals=function(t){return!!t&&this.owner===t.owner&&this.xmldoc===t.xmldoc&&this.type===t.type&&D(this.parentShadow,t.parentShadow)},t}();function D(t,e){return t===e||!!t&&!!e&&t.equals(e)}var B=function(t,e){this.outer=t,this.count=e},M=function(){function t(t,e,n){this.sourceNode=t,this.parent=e,this.boxOffset=n,this.offsetInNode=0,this.after=!1,this.nodeShadow=null,this.shadowSibling=null,this.shared=!1,this.inline=!0,this.overflow=!1,this.display=null,this.floatSide=null,this.clearSide=null,this.floatMinWrapBlock=null,this.columnSpan=null,this.verticalAlign="baseline",this.captionSide="top",this.inlineBorderSpacing=0,this.blockBorderSpacing=0,this.flexContainer=!1,this.establishesBFC=!1,this.containingBlockForAbsolute=!1,this.breakBefore=null,this.breakAfter=null,this.viewNode=null,this.clearSpacer=null,this.lang=null,this.preprocessedTextContent=null,this.repeatOnBreak=null,this.pluginProps={},this.fragmentIndex=1,this.afterIfContinues=null,this.footnotePolicy=null,this.shadowType=_.NONE,this.shadowContext=e?e.shadowContext:null,this.breakPenalty=e?e.breakPenalty:0,this.floatReference=f.b.FloatReference.INLINE,this.whitespace=e?e.whitespace:S.IGNORE,this.hyphenateCharacter=e?e.hyphenateCharacter:null,this.breakWord=!!e&&e.breakWord,this.inheritedProps=e?e.inheritedProps:{},this.vertical=!!e&&e.vertical,this.direction=e?e.direction:"ltr",this.firstPseudo=e?e.firstPseudo:null,this.formattingContext=e?e.formattingContext:null}return t.prototype.resetView=function(){this.inline=!0,this.breakPenalty=this.parent?this.parent.breakPenalty:0,this.viewNode=null,this.clearSpacer=null,this.offsetInNode=0,this.after=!1,this.display=null,this.floatReference=f.b.FloatReference.INLINE,this.floatSide=null,this.clearSide=null,this.floatMinWrapBlock=null,this.columnSpan=null,this.verticalAlign="baseline",this.flexContainer=!1,this.whitespace=this.parent?this.parent.whitespace:S.IGNORE,this.hyphenateCharacter=this.parent?this.parent.hyphenateCharacter:null,this.breakWord=!!this.parent&&this.parent.breakWord,this.breakBefore=null,this.breakAfter=null,this.nodeShadow=null,this.establishesBFC=!1,this.containingBlockForAbsolute=!1,this.vertical=!!this.parent&&this.parent.vertical,this.nodeShadow=null,this.preprocessedTextContent=null,this.formattingContext=this.parent?this.parent.formattingContext:null,this.repeatOnBreak=null,this.pluginProps={},this.fragmentIndex=1,this.afterIfContinues=null,this.footnotePolicy=null},t.prototype.cloneItem=function(){var e=new t(this.sourceNode,this.parent,this.boxOffset);return e.offsetInNode=this.offsetInNode,e.after=this.after,e.nodeShadow=this.nodeShadow,e.shadowType=this.shadowType,e.shadowContext=this.shadowContext,e.shadowSibling=this.shadowSibling,e.inline=this.inline,e.breakPenalty=this.breakPenalty,e.display=this.display,e.floatReference=this.floatReference,e.floatSide=this.floatSide,e.clearSide=this.clearSide,e.floatMinWrapBlock=this.floatMinWrapBlock,e.columnSpan=this.columnSpan,e.verticalAlign=this.verticalAlign,e.captionSide=this.captionSide,e.inlineBorderSpacing=this.inlineBorderSpacing,e.blockBorderSpacing=this.blockBorderSpacing,e.establishesBFC=this.establishesBFC,e.containingBlockForAbsolute=this.containingBlockForAbsolute,e.flexContainer=this.flexContainer,e.whitespace=this.whitespace,e.hyphenateCharacter=this.hyphenateCharacter,e.breakWord=this.breakWord,e.breakBefore=this.breakBefore,e.breakAfter=this.breakAfter,e.viewNode=this.viewNode,e.clearSpacer=this.clearSpacer,e.firstPseudo=this.firstPseudo,e.vertical=this.vertical,e.overflow=this.overflow,e.preprocessedTextContent=this.preprocessedTextContent,e.formattingContext=this.formattingContext,e.repeatOnBreak=this.repeatOnBreak,e.pluginProps=Object.create(this.pluginProps),e.fragmentIndex=this.fragmentIndex,e.afterIfContinues=this.afterIfContinues,e.footnotePolicy=this.footnotePolicy,e},t.prototype.modify=function(){return this.shared?this.cloneItem():this},t.prototype.copy=function(){var t=this;do{if(t.shared)break;t.shared=!0,t=t.parent}while(t);return this},t.prototype.clone=function(){for(var t,e=this.cloneItem(),n=e;null!=(t=n.parent);)t=t.cloneItem(),n.parent=t,n=t;return e},t.prototype.toNodePositionStep=function(){return{node:this.sourceNode,shadowType:this.shadowType,shadowContext:this.shadowContext,nodeShadow:this.nodeShadow,shadowSibling:this.shadowSibling?this.shadowSibling.toNodePositionStep():null,formattingContext:this.formattingContext,fragmentIndex:this.fragmentIndex}},t.prototype.toNodePosition=function(){var t=this,e=[];do{t.firstPseudo&&t.parent&&t.parent.firstPseudo!==t.firstPseudo||e.push(t.toNodePositionStep()),t=t.parent}while(t);return{steps:e,offsetInNode:this.preprocessedTextContent?c.c(this.preprocessedTextContent,this.offsetInNode):this.offsetInNode,after:this.after,preprocessedTextContent:this.preprocessedTextContent}},t.prototype.isInsideBFC=function(){for(var t=this.parent;t;){if(t.establishesBFC)return!0;t=t.parent}return!1},t.prototype.getContainingBlockForAbsolute=function(){for(var t=this.parent;t;){if(t.containingBlockForAbsolute)return t;t=t.parent}return null},t.prototype.walkUpBlocks=function(t){for(var e=this;e;)e.inline||t(e),e=e.parent},t.prototype.belongsTo=function(t){return this.formattingContext===t&&!!this.parent&&this.parent.formattingContext===t},t}(),U=function(){function t(t){this.primary=t,this.floats=null}return t.prototype.clone=function(){var e=new t(this.primary);if(this.floats){e.floats=[];for(var n=0;n<this.floats.length;++n)e.floats[n]=this.floats[n]}return e},t.prototype.isSamePosition=function(t){if(!t)return!1;if(this===t)return!0;if(!k(this.primary,t.primary))return!1;if(this.floats){if(!t.floats||this.floats.length!==t.floats.length)return!1;for(var e=0;e<this.floats.length;e++)if(!k(this.floats[e],t.floats[e]))return!1}else if(t.floats)return!1;return!0},t}(),z=function(){function t(t,e){this.chunkPosition=t,this.flowChunk=e}return t.prototype.clone=function(){return new t(this.chunkPosition.clone(),this.flowChunk)},t.prototype.isSamePosition=function(t){return!!t&&(this===t||this.chunkPosition.isSamePosition(t.chunkPosition))},t}(),V=function(){function t(){this.positions=[],this.startSide="any",this.breakAfter=null}return t.prototype.clone=function(){for(var e=new t,n=this.positions,i=e.positions,o=0;o<n.length;o++)i[o]=n[o].clone();return e.startSide=this.startSide,e.breakAfter=this.breakAfter,e},t.prototype.isSamePosition=function(t){if(this===t)return!0;if(!t||this.positions.length!==t.positions.length)return!1;for(var e=0;e<this.positions.length;e++)if(!this.positions[e].isSamePosition(t.positions[e]))return!1;return!0},t.prototype.hasContent=function(t){return this.positions.length>0&&this.positions[0].flowChunk.startOffset<=t},t}(),H=function(){function t(){this.page=0,this.flows={},this.flowPositions={},this.highestSeenOffset=0}return t.prototype.clone=function(){var e=new t;for(var n in e.page=this.page,e.highestSeenNode=this.highestSeenNode,e.highestSeenOffset=this.highestSeenOffset,e.lookupPositionOffset=this.lookupPositionOffset,e.flows=this.flows,this.flowPositions)e.flowPositions[n]=this.flowPositions[n].clone();return e},t.prototype.isSamePosition=function(t){if(this===t)return!0;if(!t||this.page!==t.page||this.highestSeenOffset!==t.highestSeenOffset)return!1;var e=Object.keys(this.flowPositions),n=Object.keys(t.flowPositions);if(e.length!==n.length)return!1;for(var i=0,o=e;i<o.length;i++){var r=o[i];if(!this.flowPositions[r].isSamePosition(t.flowPositions[r]))return!1}return!0},t.prototype.hasContent=function(t,e){var n=this.flowPositions[t];return!!n&&n.hasContent(e)},t.prototype.startSideOfFlow=function(t){var e=this.flowPositions[t];return e?e.startSide:"any"},t.prototype.firstFlowChunkOfFlow=function(t){var e=this.flowPositions[t];if(!e)return null;var n=e.positions[0];return n?n.flowChunk:null},t}(),G=function(){function t(t){this.element=t,this.left=0,this.top=0,this.marginLeft=0,this.marginRight=0,this.marginTop=0,this.marginBottom=0,this.borderLeft=0,this.borderRight=0,this.borderTop=0,this.borderBottom=0,this.paddingLeft=0,this.paddingRight=0,this.paddingTop=0,this.paddingBottom=0,this.width=0,this.height=0,this.originX=0,this.originY=0,this.exclusions=null,this.innerShape=null,this.computedBlockSize=0,this.snapWidth=0,this.snapHeight=0,this.snapOffsetX=0,this.snapOffsetY=0,this.vertical=!1}return t.prototype.getInsetTop=function(){return this.marginTop+this.borderTop+this.paddingTop},t.prototype.getInsetBottom=function(){return this.marginBottom+this.borderBottom+this.paddingBottom},t.prototype.getInsetLeft=function(){return this.marginLeft+this.borderLeft+this.paddingLeft},t.prototype.getInsetRight=function(){return this.marginRight+this.borderRight+this.paddingRight},t.prototype.getInsetBefore=function(){return this.vertical?this.getInsetRight():this.getInsetTop()},t.prototype.getInsetAfter=function(){return this.vertical?this.getInsetLeft():this.getInsetBottom()},t.prototype.getInsetStart=function(){return this.vertical?this.getInsetTop():this.getInsetLeft()},t.prototype.getInsetEnd=function(){return this.vertical?this.getInsetBottom():this.getInsetRight()},t.prototype.getBeforeEdge=function(t){return this.vertical?t.right:t.top},t.prototype.getAfterEdge=function(t){return this.vertical?t.left:t.bottom},t.prototype.getStartEdge=function(t){return this.vertical?t.top:t.left},t.prototype.getEndEdge=function(t){return this.vertical?t.bottom:t.right},t.prototype.getInlineSize=function(t){return this.vertical?t.bottom-t.top:t.right-t.left},t.prototype.getBoxSize=function(t){return this.vertical?t.right-t.left:t.bottom-t.top},t.prototype.getBoxDir=function(){return this.vertical?-1:1},t.prototype.getInlineDir=function(){return 1},t.prototype.copyFrom=function(t){this.element=t.element,this.left=t.left,this.top=t.top,this.marginLeft=t.marginLeft,this.marginRight=t.marginRight,this.marginTop=t.marginTop,this.marginBottom=t.marginBottom,this.borderLeft=t.borderLeft,this.borderRight=t.borderRight,this.borderTop=t.borderTop,this.borderBottom=t.borderBottom,this.paddingLeft=t.paddingLeft,this.paddingRight=t.paddingRight,this.paddingTop=t.paddingTop,this.paddingBottom=t.paddingBottom,this.width=t.width,this.height=t.height,this.originX=t.originX,this.originY=t.originY,this.innerShape=t.innerShape,this.exclusions=t.exclusions,this.computedBlockSize=t.computedBlockSize,this.snapWidth=t.snapWidth,this.snapHeight=t.snapHeight,this.vertical=t.vertical},t.prototype.setVerticalPosition=function(t,e){this.top=t,this.height=e,r.F(this.element,"top",t+"px"),r.F(this.element,"height",e+"px")},t.prototype.setHorizontalPosition=function(t,e){this.left=t,this.width=e,r.F(this.element,"left",t+"px"),r.F(this.element,"width",e+"px")},t.prototype.setBlockPosition=function(t,e){this.vertical?this.setHorizontalPosition(t+e*this.getBoxDir(),e):this.setVerticalPosition(t,e)},t.prototype.setInlinePosition=function(t,e){this.vertical?this.setVerticalPosition(t,e):this.setHorizontalPosition(t,e)},t.prototype.clear=function(){for(var t,e=this.element;t=e.lastChild;)e.removeChild(t)},t.prototype.getInnerShape=function(){var t=this.getInnerRect();return this.innerShape?this.innerShape.withOffset(t.x1,t.y1):p.k(t.x1,t.y1,t.x2,t.y2)},t.prototype.getInnerRect=function(){var t=this.originX+this.left+this.getInsetLeft(),e=this.originY+this.top+this.getInsetTop();return new p.c(t,e,t+this.width,e+this.height)},t.prototype.getPaddingRect=function(){var t=this.originX+this.left+this.marginLeft+this.borderLeft,e=this.originY+this.top+this.marginTop+this.borderTop,n=this.paddingLeft+this.width+this.paddingRight,i=this.paddingTop+this.height+this.paddingBottom;return new p.c(t,e,t+n,e+i)},t.prototype.getOuterShape=function(t,e){var n=this.getOuterRect();return l.e(t,n.x1,n.y1,n.x2-n.x1,n.y2-n.y1,e)},t.prototype.getOuterRect=function(){var t=this.originX+this.left,e=this.originY+this.top,n=this.getInsetLeft()+this.width+this.getInsetRight(),i=this.getInsetTop()+this.height+this.getInsetBottom();return new p.c(t,e,t+n,e+i)},t}(),W=function(t){function e(e,n,i,o){var r=t.call(this)||this;return r.elem=e,r.context=n,r.rootContentValue=i,r.exprContentListener=o,r}return d(e,t),e.prototype.visitStrInner=function(t,e){e||(e=this.elem.ownerDocument.createTextNode(t)),this.elem.appendChild(e)},e.prototype.visitStr=function(t){return this.visitStrInner(t.str),null},e.prototype.visitURL=function(t){if(this.rootContentValue.url)this.elem.setAttribute("src",t.url);else{var e=this.elem.ownerDocument.createElementNS(r.a.XHTML,"img");e.setAttribute("src",t.url),this.elem.appendChild(e)}return null},e.prototype.visitSpaceList=function(t){return this.visitValues(t.values),null},e.prototype.visitExpr=function(t){var e=t.toExpr(),n=e.evaluate(this.context);if("string"==typeof n){e instanceof h.s&&(n=s.m(e.scope,new u.b(n,null),"").stringValue()),o.a(this.elem.ownerDocument);var i=this.exprContentListener(e,n,this.elem.ownerDocument);this.visitStrInner(n,i)}return null},e}(a.m);function j(t){return null!=t&&t!==a.t.normal&&t!==a.t.none&&t!==a.t.inherit}},function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"d",function(){return a}),n.d(e,"b",function(){return s}),n.d(e,"c",function(){return l});var i,o=n(6);!function(t){t.SIMPLE_PROPERTY="SIMPLE_PROPERTY",t.PREPROCESS_SINGLE_DOCUMENT="PREPROCESS_SINGLE_DOCUMENT",t.PREPROCESS_TEXT_CONTENT="PREPROCESS_TEXT_CONTENT",t.PREPROCESS_ELEMENT_STYLE="PREPROCESS_ELEMENT_STYLE",t.POLYFILLED_INHERITED_PROPS="POLYFILLED_INHERITED_PROPS",t.CONFIGURATION="CONFIGURATION",t.RESOLVE_TEXT_NODE_BREAKER="RESOLVE_TEXT_NODE_BREAKER",t.RESOLVE_FORMATTING_CONTEXT="RESOLVE_FORMATTING_CONTEXT",t.RESOLVE_LAYOUT_PROCESSOR="RESOLVE_LAYOUT_PROCESSOR",t.POST_LAYOUT_BLOCK="POST_LAYOUT_BLOCK"}(i||(i={}));var r={};function a(t,e){if(i[t]){var n=r[t];n||(n=r[t]=[]),n.push(e)}else o.b.warn(new Error("Skipping unknown plugin hook '"+t+"'."))}function s(t){return r[t]||[]}var l={registerHook:a,removeHook:function(t,e){if(i[t]){var n=r[t];if(n){var a=n.indexOf(e);a>=0&&n.splice(a,1)}}else o.b.warn(new Error("Ignoring unknown plugin hook '"+t+"'."))}}},function(t,e,n){"use strict";n.d(e,"c",function(){return f}),n.d(e,"d",function(){return d}),n.d(e,"e",function(){return g}),n.d(e,"g",function(){return o}),n.d(e,"h",function(){return m}),n.d(e,"a",function(){return b}),n.d(e,"f",function(){return E}),n.d(e,"b",function(){return M}),n.d(e,"k",function(){return z}),n.d(e,"l",function(){return V}),n.d(e,"m",function(){return H}),n.d(e,"j",function(){return G}),n.d(e,"i",function(){return j});var i,o,r=n(1),a=n(0),s=n(2),l=n(4),u=n(6),c=n(16),h=n(3),p=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),f=33554432,d=50331648,g=67108864;function m(t){var e=parseInt(t,16);if(isNaN(e))throw new Error("E_CSS_COLOR");if(6==t.length)return new a.a(e);if(3==t.length)return e=15&e|(15&e)<<4|(240&e)<<4|(240&e)<<8|(3840&e)<<8|(3840&e)<<12,new a.a(e);throw new Error("E_CSS_COLOR")}!function(t){t.USER_AGENT="UA",t.USER="User",t.AUTHOR="Author"}(o||(o={}));var v,y=function(){function t(t){this.scope=t,this.flavor=o.AUTHOR}return t.prototype.getCurrentToken=function(){return null},t.prototype.getScope=function(){return this.scope},t.prototype.error=function(t,e){},t.prototype.startStylesheet=function(t){this.flavor=t},t.prototype.tagSelector=function(t,e){},t.prototype.classSelector=function(t){},t.prototype.pseudoclassSelector=function(t,e){},t.prototype.pseudoelementSelector=function(t,e){},t.prototype.idSelector=function(t){},t.prototype.attributeSelector=function(t,e,n,i){},t.prototype.descendantSelector=function(){},t.prototype.childSelector=function(){},t.prototype.adjacentSiblingSelector=function(){},t.prototype.followingSiblingSelector=function(){},t.prototype.nextSelector=function(){},t.prototype.startSelectorRule=function(){},t.prototype.startFontFaceRule=function(){},t.prototype.startFootnoteRule=function(t){},t.prototype.startViewportRule=function(){},t.prototype.startDefineRule=function(){},t.prototype.startRegionRule=function(){},t.prototype.startPageRule=function(){},t.prototype.startPageMarginBoxRule=function(t){},t.prototype.startWhenRule=function(t){},t.prototype.startMediaRule=function(t){this.startWhenRule(t)},t.prototype.startFlowRule=function(t){},t.prototype.startPageTemplateRule=function(){},t.prototype.startPageMasterRule=function(t,e,n){},t.prototype.startPartitionRule=function(t,e,n){},t.prototype.startPartitionGroupRule=function(t,e,n){},t.prototype.startRuleBody=function(){},t.prototype.property=function(t,e,n){},t.prototype.endRule=function(){},t.prototype.startFuncWithSelector=function(t){},t.prototype.endFuncWithSelector=function(){},t.prototype.getImportantSpecificity=function(){switch(this.flavor){case o.USER_AGENT:return 0;case o.USER:return 100663296;default:return 83886080}},t.prototype.getBaseSpecificity=function(){switch(this.flavor){case o.USER_AGENT:return 0;case o.USER:return 16777216;default:return f}},t}(),b=function(t){function e(){var e=t.call(this,null)||this;return e.stack=[],e.tokenizer=null,e.slave=null,e}return p(e,t),e.prototype.pushHandler=function(t){this.stack.push(this.slave),this.slave=t},e.prototype.popHandler=function(){this.slave=this.stack.pop()},e.prototype.getCurrentToken=function(){return this.tokenizer?this.tokenizer.token():null},e.prototype.getScope=function(){return this.slave.getScope()},e.prototype.error=function(t,e){this.slave.error(t,e)},e.prototype.errorMsg=function(t,e){u.b.warn(t)},e.prototype.startStylesheet=function(e){t.prototype.startStylesheet.call(this,e),this.stack.length>0&&(this.slave=this.stack[0],this.stack=[]),this.slave.startStylesheet(e)},e.prototype.tagSelector=function(t,e){this.slave.tagSelector(t,e)},e.prototype.classSelector=function(t){this.slave.classSelector(t)},e.prototype.pseudoclassSelector=function(t,e){this.slave.pseudoclassSelector(t,e)},e.prototype.pseudoelementSelector=function(t,e){this.slave.pseudoelementSelector(t,e)},e.prototype.idSelector=function(t){this.slave.idSelector(t)},e.prototype.attributeSelector=function(t,e,n,i){this.slave.attributeSelector(t,e,n,i)},e.prototype.descendantSelector=function(){this.slave.descendantSelector()},e.prototype.childSelector=function(){this.slave.childSelector()},e.prototype.adjacentSiblingSelector=function(){this.slave.adjacentSiblingSelector()},e.prototype.followingSiblingSelector=function(){this.slave.followingSiblingSelector()},e.prototype.nextSelector=function(){this.slave.nextSelector()},e.prototype.startSelectorRule=function(){this.slave.startSelectorRule()},e.prototype.startFontFaceRule=function(){this.slave.startFontFaceRule()},e.prototype.startFootnoteRule=function(t){this.slave.startFootnoteRule(t)},e.prototype.startViewportRule=function(){this.slave.startViewportRule()},e.prototype.startDefineRule=function(){this.slave.startDefineRule()},e.prototype.startRegionRule=function(){this.slave.startRegionRule()},e.prototype.startPageRule=function(){this.slave.startPageRule()},e.prototype.startPageMarginBoxRule=function(t){this.slave.startPageMarginBoxRule(t)},e.prototype.startWhenRule=function(t){this.slave.startWhenRule(t)},e.prototype.startFlowRule=function(t){this.slave.startFlowRule(t)},e.prototype.startPageTemplateRule=function(){this.slave.startPageTemplateRule()},e.prototype.startPageMasterRule=function(t,e,n){this.slave.startPageMasterRule(t,e,n)},e.prototype.startPartitionRule=function(t,e,n){this.slave.startPartitionRule(t,e,n)},e.prototype.startPartitionGroupRule=function(t,e,n){this.slave.startPartitionGroupRule(t,e,n)},e.prototype.startRuleBody=function(){this.slave.startRuleBody()},e.prototype.property=function(t,e,n){this.slave.property(t,e,n)},e.prototype.endRule=function(){this.slave.endRule()},e.prototype.startFuncWithSelector=function(t){this.slave.startFuncWithSelector(t)},e.prototype.endFuncWithSelector=function(){this.slave.endFuncWithSelector()},e}(y),w=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.owner=n,o.topLevel=i,o.depth=0,n&&(o.flavor=n.flavor),o}return p(e,t),e.prototype.getCurrentToken=function(){return this.owner.getCurrentToken()},e.prototype.error=function(t,e){this.owner.errorMsg(t,e)},e.prototype.startRuleBody=function(){this.depth++},e.prototype.endRule=function(){0!=--this.depth||this.topLevel||this.owner.popHandler()},e}(y),E=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return p(e,t),e.prototype.report=function(t){this.error(t,this.getCurrentToken())},e.prototype.reportAndSkip=function(t){this.report(t),this.owner.pushHandler(new w(this.scope,this.owner,!1))},e.prototype.startSelectorRule=function(){this.reportAndSkip("E_CSS_UNEXPECTED_SELECTOR")},e.prototype.startFontFaceRule=function(){this.reportAndSkip("E_CSS_UNEXPECTED_FONT_FACE")},e.prototype.startFootnoteRule=function(t){this.reportAndSkip("E_CSS_UNEXPECTED_FOOTNOTE")},e.prototype.startViewportRule=function(){this.reportAndSkip("E_CSS_UNEXPECTED_VIEWPORT")},e.prototype.startDefineRule=function(){this.reportAndSkip("E_CSS_UNEXPECTED_DEFINE")},e.prototype.startRegionRule=function(){this.reportAndSkip("E_CSS_UNEXPECTED_REGION")},e.prototype.startPageRule=function(){this.reportAndSkip("E_CSS_UNEXPECTED_PAGE")},e.prototype.startWhenRule=function(t){this.reportAndSkip("E_CSS_UNEXPECTED_WHEN")},e.prototype.startFlowRule=function(t){this.reportAndSkip("E_CSS_UNEXPECTED_FLOW")},e.prototype.startPageTemplateRule=function(){this.reportAndSkip("E_CSS_UNEXPECTED_PAGE_TEMPLATE")},e.prototype.startPageMasterRule=function(t,e,n){this.reportAndSkip("E_CSS_UNEXPECTED_PAGE_MASTER")},e.prototype.startPartitionRule=function(t,e,n){this.reportAndSkip("E_CSS_UNEXPECTED_PARTITION")},e.prototype.startPartitionGroupRule=function(t,e,n){this.reportAndSkip("E_CSS_UNEXPECTED_PARTITION_GROUP")},e.prototype.startFuncWithSelector=function(t){this.reportAndSkip("E_CSS_UNEXPECTED_SELECTOR_FUNC")},e.prototype.endFuncWithSelector=function(){this.reportAndSkip("E_CSS_UNEXPECTED_END_SELECTOR_FUNC")},e.prototype.property=function(t,e,n){this.error("E_CSS_UNEXPECTED_PROPERTY",this.getCurrentToken())},e}(w),S=[],N=[],C=[],T=[],x=[],I=[],P=[],O=[],k=[],A=[],R=[],L=[],_=[];!function(t){t[t.SELECTOR_NAME_1=1]="SELECTOR_NAME_1",t[t.SELECTOR_NAME=2]="SELECTOR_NAME",t[t.SELECTOR_ANY_1=3]="SELECTOR_ANY_1",t[t.SELECTOR_ANY=4]="SELECTOR_ANY",t[t.SELECTOR_ID_1=5]="SELECTOR_ID_1",t[t.SELECTOR_ID=6]="SELECTOR_ID",t[t.SELECTOR_CLASS_1=7]="SELECTOR_CLASS_1",t[t.SELECTOR_CLASS=8]="SELECTOR_CLASS",t[t.SELECTOR_ATTR_1=9]="SELECTOR_ATTR_1",t[t.SELECTOR_ATTR=10]="SELECTOR_ATTR",t[t.SELECTOR_CHILD=11]="SELECTOR_CHILD",t[t.SELECTOR_SIBLING=12]="SELECTOR_SIBLING",t[t.SELECTOR_BODY=13]="SELECTOR_BODY",t[t.SELECTOR_PSEUDOCLASS=14]="SELECTOR_PSEUDOCLASS",t[t.VAL_IDENT=15]="VAL_IDENT",t[t.VAL_HASH=16]="VAL_HASH",t[t.VAL_NUM=17]="VAL_NUM",t[t.VAL_INT=18]="VAL_INT",t[t.VAL_NUMERIC=19]="VAL_NUMERIC",t[t.VAL_STR=20]="VAL_STR",t[t.VAL_URL=21]="VAL_URL",t[t.VAL_COMMA=22]="VAL_COMMA",t[t.VAL_SLASH=23]="VAL_SLASH",t[t.VAL_FUNC=24]="VAL_FUNC",t[t.VAL_C_PAR=25]="VAL_C_PAR",t[t.VAL_END=26]="VAL_END",t[t.RULE_END=27]="RULE_END",t[t.IDENT=28]="IDENT",t[t.SELECTOR_START=29]="SELECTOR_START",t[t.AT=30]="AT",t[t.EXPR_IDENT=31]="EXPR_IDENT",t[t.EXPR_NUM=32]="EXPR_NUM",t[t.EXPR_NUMERIC=33]="EXPR_NUMERIC",t[t.EXPR_STR=34]="EXPR_STR",t[t.EXPR_PARAM=35]="EXPR_PARAM",t[t.EXPR_PREFIX=36]="EXPR_PREFIX",t[t.EXPR_INFIX=37]="EXPR_INFIX",t[t.EXPR_FUNC=38]="EXPR_FUNC",t[t.EXPR_C_PAR=39]="EXPR_C_PAR",t[t.EXPR_O_PAR=40]="EXPR_O_PAR",t[t.SELECTOR_NEXT=41]="SELECTOR_NEXT",t[t.SELECTOR_PSEUDOELEM=42]="SELECTOR_PSEUDOELEM",t[t.EXPR_O_BRC=43]="EXPR_O_BRC",t[t.VAL_FINISH=44]="VAL_FINISH",t[t.EXPR_INFIX_NAME=45]="EXPR_INFIX_NAME",t[t.PROP=46]="PROP",t[t.VAL_BANG=47]="VAL_BANG",t[t.VAL_BRC=48]="VAL_BRC",t[t.EXPR_SEMICOL=49]="EXPR_SEMICOL",t[t.ERROR_PUSH=50]="ERROR_PUSH",t[t.ERROR_POP=51]="ERROR_POP",t[t.ERROR_POP_DECL=52]="ERROR_POP_DECL",t[t.ERROR_SEMICOL=53]="ERROR_SEMICOL",t[t.VAL_PLUS=54]="VAL_PLUS",t[t.SELECTOR_PSEUDOCLASS_1=55]="SELECTOR_PSEUDOCLASS_1",t[t.SELECTOR_FOLLOWING_SIBLING=56]="SELECTOR_FOLLOWING_SIBLING",t[t.DONE=200]="DONE"}(v||(v={}));var F,D=s.a.LAST+1;S[s.a.IDENT]=v.IDENT,S[s.a.STAR]=v.SELECTOR_START,S[s.a.HASH]=v.SELECTOR_START,S[s.a.CLASS]=v.SELECTOR_START,S[s.a.O_BRK]=v.SELECTOR_START,S[s.a.COLON]=v.SELECTOR_START,S[s.a.AT]=v.AT,S[s.a.C_BRC]=v.RULE_END,S[s.a.EOF]=v.DONE,N[s.a.IDENT]=v.PROP,N[s.a.EOF]=v.DONE,I[s.a.IDENT]=v.SELECTOR_NAME,I[s.a.STAR]=v.SELECTOR_ANY,I[s.a.HASH]=v.SELECTOR_ID,I[s.a.CLASS]=v.SELECTOR_CLASS,I[s.a.O_BRK]=v.SELECTOR_ATTR,I[s.a.COLON]=v.SELECTOR_PSEUDOCLASS,C[s.a.GT]=v.SELECTOR_CHILD,C[s.a.PLUS]=v.SELECTOR_SIBLING,C[s.a.TILDE]=v.SELECTOR_FOLLOWING_SIBLING,C[s.a.IDENT]=v.SELECTOR_NAME_1,C[s.a.STAR]=v.SELECTOR_ANY_1,C[s.a.HASH]=v.SELECTOR_ID_1,C[s.a.CLASS]=v.SELECTOR_CLASS_1,C[s.a.O_BRK]=v.SELECTOR_ATTR_1,C[s.a.O_BRC]=v.SELECTOR_BODY,C[s.a.COLON]=v.SELECTOR_PSEUDOCLASS_1,C[s.a.COL_COL]=v.SELECTOR_PSEUDOELEM,C[s.a.COMMA]=v.SELECTOR_NEXT,T[s.a.IDENT]=v.SELECTOR_NAME_1,T[s.a.STAR]=v.SELECTOR_ANY_1,T[s.a.HASH]=v.SELECTOR_ID_1,T[s.a.CLASS]=v.SELECTOR_CLASS_1,T[s.a.O_BRK]=v.SELECTOR_ATTR_1,T[s.a.C_PAR]=v.DONE,T[s.a.COLON]=v.SELECTOR_PSEUDOCLASS_1,x[s.a.IDENT]=v.SELECTOR_NAME,x[s.a.STAR]=v.SELECTOR_ANY,x[s.a.HASH]=v.SELECTOR_ID,x[s.a.CLASS]=v.SELECTOR_CLASS,x[s.a.COLON]=v.SELECTOR_PSEUDOCLASS,x[s.a.COL_COL]=v.SELECTOR_PSEUDOELEM,x[s.a.O_BRK]=v.SELECTOR_ATTR,x[s.a.O_BRC]=v.SELECTOR_BODY,P[s.a.IDENT]=v.VAL_IDENT,P[s.a.HASH]=v.VAL_HASH,P[s.a.NUM]=v.VAL_NUM,P[s.a.INT]=v.VAL_INT,P[s.a.NUMERIC]=v.VAL_NUMERIC,P[s.a.STR]=v.VAL_STR,P[s.a.URL]=v.VAL_URL,P[s.a.COMMA]=v.VAL_COMMA,P[s.a.SLASH]=v.VAL_SLASH,P[s.a.FUNC]=v.VAL_FUNC,P[s.a.C_PAR]=v.VAL_C_PAR,P[s.a.SEMICOL]=v.VAL_END,P[s.a.C_BRC]=v.VAL_BRC,P[s.a.BANG]=v.VAL_BANG,P[s.a.PLUS]=v.VAL_PLUS,P[s.a.EOF]=v.VAL_FINISH,O[s.a.IDENT]=v.EXPR_IDENT,O[s.a.NUM]=v.EXPR_NUM,O[s.a.INT]=v.EXPR_NUM,O[s.a.NUMERIC]=v.EXPR_NUMERIC,O[s.a.STR]=v.EXPR_STR,O[s.a.O_PAR]=v.EXPR_O_PAR,O[s.a.FUNC]=v.EXPR_FUNC,O[s.a.BANG]=v.EXPR_PREFIX,O[s.a.MINUS]=v.EXPR_PREFIX,O[s.a.DOLLAR]=v.EXPR_PARAM,k[s.a.IDENT]=v.EXPR_INFIX_NAME,k[s.a.COMMA]=v.EXPR_INFIX,k[s.a.GT]=v.EXPR_INFIX,k[s.a.LT]=v.EXPR_INFIX,k[s.a.GT_EQ]=v.EXPR_INFIX,k[s.a.LT_EQ]=v.EXPR_INFIX,k[s.a.EQ]=v.EXPR_INFIX,k[s.a.EQ_EQ]=v.EXPR_INFIX,k[s.a.BANG_EQ]=v.EXPR_INFIX,k[s.a.AMP_AMP]=v.EXPR_INFIX,k[s.a.BAR_BAR]=v.EXPR_INFIX,k[s.a.PLUS]=v.EXPR_INFIX,k[s.a.MINUS]=v.EXPR_INFIX,k[s.a.SLASH]=v.EXPR_INFIX,k[s.a.PERCENT]=v.EXPR_INFIX,k[s.a.STAR]=v.EXPR_INFIX,k[s.a.COLON]=v.EXPR_INFIX,k[s.a.QMARK]=v.EXPR_INFIX,k[s.a.C_PAR]=v.EXPR_C_PAR,k[s.a.O_BRC]=v.EXPR_O_BRC,k[s.a.SEMICOL]=v.EXPR_SEMICOL,A[s.a.EOF]=v.DONE,A[s.a.O_BRC]=v.ERROR_PUSH,A[s.a.C_BRC]=v.ERROR_POP,A[s.a.O_BRK]=v.ERROR_PUSH,A[s.a.C_BRK]=v.ERROR_POP,A[s.a.O_PAR]=v.ERROR_PUSH,A[s.a.C_PAR]=v.ERROR_POP,A[s.a.SEMICOL]=v.ERROR_SEMICOL,R[s.a.EOF]=v.DONE,R[s.a.O_BRC]=v.ERROR_PUSH,R[s.a.C_BRC]=v.ERROR_POP_DECL,R[s.a.O_BRK]=v.ERROR_PUSH,R[s.a.C_BRK]=v.ERROR_POP,R[s.a.O_PAR]=v.ERROR_PUSH,R[s.a.C_PAR]=v.ERROR_POP,R[s.a.SEMICOL]=v.ERROR_SEMICOL,L[s.a.EOF]=v.DONE,L[s.a.O_BRC]=v.ERROR_PUSH,L[s.a.C_BRC]=v.ERROR_POP,L[s.a.O_BRK]=v.ERROR_PUSH,L[s.a.C_BRK]=v.ERROR_POP,L[s.a.O_PAR]=v.ERROR_PUSH,L[s.a.C_PAR]=v.ERROR_POP,_[s.a.C_PAR]=0,_[s.a.COMMA]=0,_[s.a.QMARK]=1,_[s.a.COLON]=1,_[s.a.AMP_AMP]=2,_[s.a.BAR_BAR]=2,_[s.a.LT]=3,_[s.a.GT]=3,_[s.a.LT_EQ]=3,_[s.a.GT_EQ]=3,_[s.a.EQ]=3,_[s.a.EQ_EQ]=3,_[s.a.BANG_EQ]=3,_[s.a.PLUS]=4,_[s.a.MINUS]=4,_[s.a.STAR]=5,_[s.a.SLASH]=5,_[s.a.PERCENT]=5,_[s.a.EOF]=6,_[D]=2,function(t){t[t.PROP=0]="PROP",t[t.WHEN=1]="WHEN",t[t.MEDIA=2]="MEDIA",t[t.IMPORT=3]="IMPORT"}(F||(F={}));var B=function(){function t(t,e,n,i){this.actions=t,this.tokenizer=e,this.handler=n,this.baseURL=i,this.valStack=[],this.namespacePrefixToURI={},this.defaultNamespaceURI=null,this.propName=null,this.propImportant=!1,this.result=null,this.importReady=!1,this.importURL=null,this.importCondition=null,this.errorBrackets=[],this.ruleStack=[],this.regionRule=!1,this.pageRule=!1,this.exprContext=F.MEDIA}return t.prototype.extractVals=function(t,e){for(var n=[],i=this.valStack;n.push(i[e++]),e!=i.length;)if(i[e++]!=t)throw new Error("Unexpected state");return n},t.prototype.valStackReduce=function(t,e){var n,i=this.valStack,o=i.length;do{n=i[--o]}while(void 0!==n&&"string"!=typeof n);var r=i.length-(o+1);if(r>1&&i.splice(o+1,r,new a.j(i.slice(o+1,i.length))),","==t)return null;o++;do{n=i[--o]}while(void 0!==n&&("string"!=typeof n||","==n));if(r=i.length-(o+1),"("==n){if(")"!=t)return this.handler.error("E_CSS_MISMATCHED_C_PAR",e),this.actions=R,null;var s=new a.e(i[o-1],this.extractVals(",",o+1));return i.splice(o-1,r+2,s),null}return";"!=t||o>=0?(this.handler.error("E_CSS_UNEXPECTED_VAL_END",e),this.actions=R,null):r>1?new a.b(this.extractVals(",",o+1)):i[0]},t.prototype.exprError=function(t,e){this.actions=this.propName?R:A,this.handler.error(t,e)},t.prototype.exprStackReduce=function(t,e){for(var n,i=this.valStack,o=this.handler,r=i.pop();;){var u=i.pop();if(t==s.a.C_PAR){for(var c=[r];u==s.a.COMMA;)c.unshift(i.pop()),u=i.pop();if("string"==typeof u){if("{"==u){for(;c.length>=2;){var h=c.shift(),p=c.shift(),f=new l.z(o.getScope(),h,p);c.unshift(f)}return i.push(new a.c(c[0])),!0}if("("==u){var d=i.pop(),g=i.pop();r=new l.d(o.getScope(),l.M(g,d),c),t=s.a.EOF;continue}}if(u==s.a.O_PAR){r.isMediaName()&&(r=new l.p(o.getScope(),r,null)),t=s.a.EOF;continue}}else if("string"==typeof u){i.push(u);break}if(u<0)if(u==-s.a.BANG)r=new l.w(o.getScope(),r);else{if(u!=-s.a.MINUS)return this.exprError("F_UNEXPECTED_STATE",e),!1;r=new l.v(o.getScope(),r)}else{if(_[t]>_[u]){i.push(u);break}switch(n=i.pop(),u){case s.a.AMP_AMP:r=new l.b(o.getScope(),n,r);break;case D:r=new l.c(o.getScope(),n,r);break;case s.a.BAR_BAR:r=new l.y(o.getScope(),n,r);break;case s.a.LT:r=new l.n(o.getScope(),n,r);break;case s.a.GT:r=new l.k(o.getScope(),n,r);break;case s.a.LT_EQ:r=new l.l(o.getScope(),n,r);break;case s.a.GT_EQ:r=new l.j(o.getScope(),n,r);break;case s.a.EQ:case s.a.EQ_EQ:r=new l.i(o.getScope(),n,r);break;case s.a.BANG_EQ:r=new l.u(o.getScope(),n,r);break;case s.a.PLUS:r=new l.a(o.getScope(),n,r);break;case s.a.MINUS:r=new l.B(o.getScope(),n,r);break;case s.a.STAR:r=new l.r(o.getScope(),n,r);break;case s.a.SLASH:r=new l.h(o.getScope(),n,r);break;case s.a.PERCENT:r=new l.q(o.getScope(),n,r);break;case s.a.COLON:if(!(i.length>1))return this.exprError("E_CSS_EXPR_COND",e),!1;switch(i[i.length-1]){case s.a.QMARK:i.pop(),r=new l.e(o.getScope(),i.pop(),n,r);break;case s.a.O_PAR:if(!n.isMediaName())return this.exprError("E_CSS_MEDIA_TEST",e),!1;r=new l.p(o.getScope(),n,r)}break;case s.a.QMARK:if(t!=s.a.COLON)return this.exprError("E_CSS_EXPR_COND",e),!1;case s.a.O_PAR:return i.push(n),i.push(u),i.push(r),!1;default:return this.exprError("F_UNEXPECTED_STATE",e),!1}}}return i.push(r),!1},t.prototype.readPseudoParams=function(){for(var t=[];;){var e=this.tokenizer.token();switch(e.type){case s.a.IDENT:t.push(e.text);break;case s.a.PLUS:t.push("+");break;case s.a.NUM:case s.a.INT:t.push(e.num);break;default:return t}this.tokenizer.consume()}},t.prototype.readNthPseudoParams=function(){var t=!1,e=this.tokenizer.token();if(e.type===s.a.PLUS)t=!0,this.tokenizer.consume(),e=this.tokenizer.token();else if(e.type===s.a.IDENT&&("even"===e.text||"odd"===e.text))return this.tokenizer.consume(),[2,"odd"===e.text?1:0];switch(e.type){case s.a.NUMERIC:if(t&&e.num<0)return null;case s.a.IDENT:if(t&&"-"===e.text.charAt(0))return null;if("n"===e.text||"-n"===e.text){if(t&&e.precededBySpace)return null;var n="-n"===e.text?-1:1;e.type===s.a.NUMERIC&&(n=e.num);var i=0;this.tokenizer.consume();var o=(e=this.tokenizer.token()).type===s.a.MINUS,r=e.type===s.a.PLUS||o;if(r&&(this.tokenizer.consume(),e=this.tokenizer.token()),e.type===s.a.INT){if(1/(i=e.num)==-1/0){if(i=0,r)return null}else if(i<0){if(r)return null}else if(i>=0&&!r)return null;this.tokenizer.consume()}else if(r)return null;return[n,o&&i>0?-i:i]}if("n-"===e.text||"-n-"===e.text){if(t&&e.precededBySpace)return null;if(n="-n-"===e.text?-1:1,e.type===s.a.NUMERIC&&(n=e.num),this.tokenizer.consume(),(e=this.tokenizer.token()).type===s.a.INT)return e.num<0||1/e.num==-1/0?null:(this.tokenizer.consume(),[n,e.num])}else{var a=e.text.match(/^n(-[0-9]+)$/);if(a)return t&&e.precededBySpace?null:(this.tokenizer.consume(),[e.type===s.a.NUMERIC?e.num:1,parseInt(a[1],10)]);if(a=e.text.match(/^-n(-[0-9]+)$/))return this.tokenizer.consume(),[-1,parseInt(a[1],10)]}return null;case s.a.INT:return t&&(e.precededBySpace||e.num<0)?null:(this.tokenizer.consume(),[0,e.num])}return null},t.prototype.makeCondition=function(t,e){var n=this.handler.getScope();if(!n)return null;if(e=e||n._true,t)for(var i=0,o=t.split(/\s+/);i<o.length;i++)switch(o[i]){case"vertical":e=l.D(n,e,new l.w(n,new l.s(n,"pref-horizontal")));break;case"horizontal":e=l.D(n,e,new l.s(n,"pref-horizontal"));break;case"day":e=l.D(n,e,new l.w(n,new l.s(n,"pref-night-mode")));break;case"night":e=l.D(n,e,new l.s(n,"pref-night-mode"));break;default:e=n._false}return e===n._true?null:new a.c(e)},t.prototype.isInsidePropertyOnlyRule=function(){switch(this.ruleStack[this.ruleStack.length-1]){case"[selector]":case"font-face":case"-epubx-flow":case"-epubx-viewport":case"-epubx-define":case"-adapt-footnote-area":return!0}return!1},t.prototype.runParser=function(t,e,n,i,o){var u,c,h,p,f,d,g,y=this.handler,b=this.tokenizer,w=this.valStack;i&&(this.exprContext=F.MEDIA,this.valStack.push("{"));t:for(;t>0;--t)switch(u=b.token(),this.actions[u.type]){case v.IDENT:if(b.nthToken(1).type!=s.a.COLON){this.isInsidePropertyOnlyRule()?(y.error("E_CSS_COLON_EXPECTED",b.nthToken(1)),this.actions=R):(this.actions=I,y.startSelectorRule());continue}(c=b.nthToken(2)).precededBySpace||c.type!=s.a.IDENT&&c.type!=s.a.FUNC||b.mark(),this.propName=u.text,this.propImportant=!1,b.consume(),b.consume(),this.actions=P,w.splice(0,w.length);continue;case v.PROP:if(b.nthToken(1).type!=s.a.COLON){this.actions=R,y.error("E_CSS_COLON_EXPECTED",b.nthToken(1));continue}this.propName=u.text,this.propImportant=!1,b.consume(),b.consume(),this.actions=P,w.splice(0,w.length);continue;case v.SELECTOR_START:this.actions=I,y.startSelectorRule();continue;case v.SELECTOR_NAME_1:if(!u.precededBySpace){this.actions=L,y.error("E_CSS_SPACE_EXPECTED",u);continue}y.descendantSelector();case v.SELECTOR_NAME:if(b.nthToken(1).type==s.a.BAR)if(b.consume(),b.consume(),null!=(h=this.namespacePrefixToURI[u.text]))switch((u=b.token()).type){case s.a.IDENT:y.tagSelector(h,u.text),this.actions=o?T:C,b.consume();break;case s.a.STAR:y.tagSelector(h,null),this.actions=o?T:C,b.consume();break;default:this.actions=A,y.error("E_CSS_NAMESPACE",u)}else this.actions=A,y.error("E_CSS_UNDECLARED_PREFIX",u);else y.tagSelector(this.defaultNamespaceURI,u.text),this.actions=o?T:C,b.consume();continue;case v.SELECTOR_ANY_1:if(!u.precededBySpace){this.actions=L,y.error("E_CSS_SPACE_EXPECTED",u);continue}y.descendantSelector();case v.SELECTOR_ANY:if(b.nthToken(1).type==s.a.BAR)switch(b.consume(),b.consume(),(u=b.token()).type){case s.a.IDENT:y.tagSelector(null,u.text),this.actions=o?T:C,b.consume();break;case s.a.STAR:y.tagSelector(null,null),this.actions=o?T:C,b.consume();break;default:this.actions=A,y.error("E_CSS_NAMESPACE",u)}else y.tagSelector(this.defaultNamespaceURI,null),this.actions=o?T:C,b.consume();continue;case v.SELECTOR_ID_1:u.precededBySpace&&y.descendantSelector();case v.SELECTOR_ID:y.idSelector(u.text),this.actions=o?T:C,b.consume();continue;case v.SELECTOR_CLASS_1:u.precededBySpace&&y.descendantSelector();case v.SELECTOR_CLASS:y.classSelector(u.text),this.actions=o?T:C,b.consume();continue;case v.SELECTOR_PSEUDOCLASS_1:u.precededBySpace&&y.descendantSelector();case v.SELECTOR_PSEUDOCLASS:b.consume();e:switch((u=b.token()).type){case s.a.IDENT:y.pseudoclassSelector(u.text,null),b.consume(),this.actions=o?T:C;continue;case s.a.FUNC:switch(p=u.text,b.consume(),p){case"not":this.actions=I,y.startFuncWithSelector("not"),this.runParser(Number.POSITIVE_INFINITY,!1,!1,!1,!0)?this.actions=C:this.actions=L;break t;case"lang":case"href-epub-type":if((u=b.token()).type===s.a.IDENT){g=[u.text],b.consume();break}break e;case"nth-child":case"nth-of-type":case"nth-last-child":case"nth-last-of-type":if(g=this.readNthPseudoParams())break;break e;default:g=this.readPseudoParams()}if((u=b.token()).type==s.a.C_PAR){y.pseudoclassSelector(p,g),b.consume(),this.actions=o?T:C;continue}}y.error("E_CSS_PSEUDOCLASS_SYNTAX",u),this.actions=A;continue;case v.SELECTOR_PSEUDOELEM:switch(b.consume(),(u=b.token()).type){case s.a.IDENT:y.pseudoelementSelector(u.text,null),this.actions=o?T:C,b.consume();continue;case s.a.FUNC:if(p=u.text,b.consume(),"nth-fragment"==p){if(null===(g=this.readNthPseudoParams()))break}else g=this.readPseudoParams();if((u=b.token()).type==s.a.C_PAR){y.pseudoelementSelector(p,g),this.actions=o?T:C,b.consume();continue}}y.error("E_CSS_PSEUDOELEM_SYNTAX",u),this.actions=A;continue;case v.SELECTOR_ATTR_1:u.precededBySpace&&y.descendantSelector();case v.SELECTOR_ATTR:if(b.consume(),(u=b.token()).type==s.a.IDENT)p=u.text,b.consume();else if(u.type==s.a.STAR)p=null,b.consume();else{if(u.type!=s.a.BAR){this.actions=L,y.error("E_CSS_ATTR",u),b.consume();continue}p=""}if((u=b.token()).type==s.a.BAR){if(null==(h=p?this.namespacePrefixToURI[p]:p)){this.actions=L,y.error("E_CSS_UNDECLARED_PREFIX",u),b.consume();continue}if(b.consume(),(u=b.token()).type!=s.a.IDENT){this.actions=L,y.error("E_CSS_ATTR_NAME_EXPECTED",u);continue}p=u.text,b.consume(),u=b.token()}else h="";switch(u.type){case s.a.EQ:case s.a.TILDE_EQ:case s.a.BAR_EQ:case s.a.HAT_EQ:case s.a.DOLLAR_EQ:case s.a.STAR_EQ:case s.a.COL_COL:f=u.type,b.consume(),u=b.token();break;case s.a.C_BRK:y.attributeSelector(h,p,s.a.EOF,null),this.actions=o?T:C,b.consume();continue;default:this.actions=L,y.error("E_CSS_ATTR_OP_EXPECTED",u);continue}switch(u.type){case s.a.IDENT:case s.a.STR:y.attributeSelector(h,p,f,u.text),b.consume(),u=b.token();break;default:this.actions=L,y.error("E_CSS_ATTR_VAL_EXPECTED",u);continue}if(u.type!=s.a.C_BRK){this.actions=L,y.error("E_CSS_ATTR",u);continue}this.actions=o?T:C,b.consume();continue;case v.SELECTOR_CHILD:y.childSelector(),this.actions=x,b.consume();continue;case v.SELECTOR_SIBLING:y.adjacentSiblingSelector(),this.actions=x,b.consume();continue;case v.SELECTOR_FOLLOWING_SIBLING:y.followingSiblingSelector(),this.actions=x,b.consume();continue;case v.SELECTOR_BODY:this.regionRule?(this.ruleStack.push("-epubx-region"),this.regionRule=!1):this.pageRule?(this.ruleStack.push("page"),this.pageRule=!1):this.ruleStack.push("[selector]"),y.startRuleBody(),this.actions=S,b.consume();continue;case v.SELECTOR_NEXT:y.nextSelector(),this.actions=I,b.consume();continue;case v.VAL_IDENT:w.push(a.r(u.text)),b.consume();continue;case v.VAL_HASH:f=parseInt(u.text,16);try{w.push(m(u.text))}catch(t){y.error("E_CSS_COLOR",u),this.actions=A}b.consume();continue;case v.VAL_NUM:w.push(new a.h(u.num)),b.consume();continue;case v.VAL_INT:w.push(new a.g(u.num)),b.consume();continue;case v.VAL_NUMERIC:l.K(u.text)?w.push(new a.c(new l.x(y.getScope(),u.num,u.text))):w.push(new a.i(u.num,u.text)),b.consume();continue;case v.VAL_STR:w.push(new a.k(u.text)),b.consume();continue;case v.VAL_URL:w.push(new a.l(r.C(u.text,this.baseURL))),b.consume();continue;case v.VAL_COMMA:this.valStackReduce(",",u),w.push(","),b.consume();continue;case v.VAL_SLASH:w.push(a.w),b.consume();continue;case v.VAL_FUNC:"-epubx-expr"==(p=u.text.toLowerCase())||"calc"==p||"env"==p?(this.actions=O,this.exprContext=F.PROP,w.push("{")):(w.push(p),w.push("(")),b.consume();continue;case v.VAL_C_PAR:this.valStackReduce(")",u),b.consume();continue;case v.VAL_BANG:if(b.consume(),u=b.token(),c=b.nthToken(1),u.type==s.a.IDENT&&"important"==u.text.toLowerCase()&&(c.type==s.a.SEMICOL||c.type==s.a.EOF||c.type==s.a.C_BRC)){b.consume(),this.propImportant=!0;continue}this.exprError("E_CSS_SYNTAX",u);continue;case v.VAL_PLUS:switch((c=b.nthToken(1)).type){case s.a.NUM:case s.a.NUMERIC:case s.a.INT:if(!c.precededBySpace){b.consume();continue}}if(this.actions===P&&b.hasMark()){b.reset(),this.actions=I,y.startSelectorRule();continue}this.exprError("E_CSS_UNEXPECTED_PLUS",u);continue;case v.VAL_END:b.consume();case v.VAL_BRC:b.unmark(),(d=this.valStackReduce(";",u))&&this.propName&&y.property(this.propName,d,this.propImportant),this.actions=n?N:S;continue;case v.VAL_FINISH:if(b.consume(),b.unmark(),d=this.valStackReduce(";",u),e)return this.result=d,!0;if(this.propName&&d&&y.property(this.propName,d,this.propImportant),n)return!0;this.exprError("E_CSS_SYNTAX",u);continue;case v.EXPR_IDENT:(c=b.nthToken(1)).type==s.a.CLASS?(b.nthToken(2).type!=s.a.O_PAR||b.nthToken(2).precededBySpace?(w.push(new l.s(y.getScope(),l.M(u.text,c.text))),this.actions=k):(w.push(u.text,c.text,"("),b.consume()),b.consume()):(this.exprContext==F.MEDIA||this.exprContext==F.IMPORT?"not"==u.text.toLowerCase()?(b.consume(),w.push(new l.o(y.getScope(),!0,c.text))):("only"==u.text.toLowerCase()&&(b.consume(),u=c),w.push(new l.o(y.getScope(),!1,u.text))):w.push(new l.s(y.getScope(),u.text)),this.actions=k),b.consume();continue;case v.EXPR_FUNC:w.push(null,u.text,"("),b.consume();continue;case v.EXPR_NUM:w.push(new l.f(y.getScope(),u.num)),b.consume(),this.actions=k;continue;case v.EXPR_NUMERIC:"%"==(p=u.text)&&(p=this.propName&&this.propName.match(/height|^(top|bottom)$/)?"vh":"vw"),w.push(new l.x(y.getScope(),u.num,p)),b.consume(),this.actions=k;continue;case v.EXPR_STR:w.push(new l.f(y.getScope(),u.text)),b.consume(),this.actions=k;continue;case v.EXPR_PARAM:b.consume(),(u=b.token()).type!=s.a.INT||u.precededBySpace?this.exprError("E_CSS_SYNTAX",u):(w.push(new l.A(y.getScope(),u.num)),b.consume(),this.actions=k);continue;case v.EXPR_PREFIX:w.push(-u.type),b.consume();continue;case v.EXPR_INFIX:this.actions=O,this.exprStackReduce(u.type,u),w.push(u.type),b.consume();continue;case v.EXPR_INFIX_NAME:"and"==u.text.toLowerCase()?(this.actions=O,this.exprStackReduce(D,u),w.push(D),b.consume()):this.exprError("E_CSS_SYNTAX",u);continue;case v.EXPR_C_PAR:this.exprStackReduce(u.type,u)&&(this.propName?this.actions=P:this.exprError("E_CSS_UNBALANCED_PAR",u)),b.consume();continue;case v.EXPR_O_BRC:this.exprStackReduce(s.a.C_PAR,u)&&(this.propName||this.exprContext==F.IMPORT?this.exprError("E_CSS_UNEXPECTED_BRC",u):(this.exprContext==F.WHEN?y.startWhenRule(w.pop()):y.startMediaRule(w.pop()),this.ruleStack.push("media"),y.startRuleBody(),this.actions=S)),b.consume();continue;case v.EXPR_SEMICOL:if(this.exprStackReduce(s.a.C_PAR,u)){if(!this.propName&&this.exprContext==F.IMPORT)return this.importCondition=w.pop(),this.importReady=!0,this.actions=S,b.consume(),!1;this.exprError("E_CSS_UNEXPECTED_SEMICOL",u)}b.consume();continue;case v.EXPR_O_PAR:w.push(u.type),b.consume();continue;case v.RULE_END:this.actions=S,b.consume(),y.endRule(),this.ruleStack.length&&this.ruleStack.pop();continue;case v.AT:switch(p=u.text.toLowerCase()){case"import":if(b.consume(),(u=b.token()).type==s.a.STR||u.type==s.a.URL){if(this.importURL=u.text,b.consume(),(u=b.token()).type==s.a.SEMICOL||u.type==s.a.EOF)return this.importReady=!0,b.consume(),!1;this.propName=null,this.exprContext=F.IMPORT,this.actions=O,w.push("{");continue}y.error("E_CSS_IMPORT_SYNTAX",u),this.actions=A;continue;case"namespace":switch(b.consume(),(u=b.token()).type){case s.a.IDENT:if(p=u.text,b.consume(),((u=b.token()).type==s.a.STR||u.type==s.a.URL)&&b.nthToken(1).type==s.a.SEMICOL){this.namespacePrefixToURI[p]=u.text,b.consume(),b.consume();continue}break;case s.a.STR:case s.a.URL:if(b.nthToken(1).type==s.a.SEMICOL){this.defaultNamespaceURI=u.text,b.consume(),b.consume();continue}}y.error("E_CSS_NAMESPACE_SYNTAX",u),this.actions=A;continue;case"charset":if(b.consume(),(u=b.token()).type==s.a.STR&&b.nthToken(1).type==s.a.SEMICOL){"utf-8"!=(p=u.text.toLowerCase())&&"utf-16"!=p&&y.error("E_CSS_UNEXPECTED_CHARSET "+p,u),b.consume(),b.consume();continue}y.error("E_CSS_CHARSET_SYNTAX",u),this.actions=A;continue;case"font-face":case"-epubx-page-template":case"-epubx-define":case"-epubx-viewport":if(b.nthToken(1).type==s.a.O_BRC){switch(b.consume(),b.consume(),p){case"font-face":y.startFontFaceRule();break;case"-epubx-page-template":y.startPageTemplateRule();break;case"-epubx-define":y.startDefineRule();break;case"-epubx-viewport":y.startViewportRule()}this.ruleStack.push(p),y.startRuleBody();continue}break;case"-adapt-footnote-area":switch(b.consume(),(u=b.token()).type){case s.a.O_BRC:b.consume(),y.startFootnoteRule(null),this.ruleStack.push(p),y.startRuleBody();continue;case s.a.COL_COL:if(b.consume(),(u=b.token()).type==s.a.IDENT&&b.nthToken(1).type==s.a.O_BRC){p=u.text,b.consume(),b.consume(),y.startFootnoteRule(p),this.ruleStack.push("-adapt-footnote-area"),y.startRuleBody();continue}}break;case"-epubx-region":b.consume(),y.startRegionRule(),this.regionRule=!0,this.actions=I;continue;case"page":b.consume(),y.startPageRule(),this.pageRule=!0,this.actions=x;continue;case"top-left-corner":case"top-left":case"top-center":case"top-right":case"top-right-corner":case"right-top":case"right-middle":case"right-bottom":case"bottom-right-corner":case"bottom-right":case"bottom-center":case"bottom-left":case"bottom-left-corner":case"left-bottom":case"left-middle":case"left-top":if(b.consume(),(u=b.token()).type==s.a.O_BRC){b.consume(),y.startPageMarginBoxRule(p),this.ruleStack.push(p),y.startRuleBody();continue}break;case"-epubx-when":b.consume(),this.propName=null,this.exprContext=F.WHEN,this.actions=O,w.push("{");continue;case"media":b.consume(),this.propName=null,this.exprContext=F.MEDIA,this.actions=O,w.push("{");continue;case"-epubx-flow":if(b.nthToken(1).type==s.a.IDENT&&b.nthToken(2).type==s.a.O_BRC){y.startFlowRule(b.nthToken(1).text),b.consume(),b.consume(),b.consume(),this.ruleStack.push(p),y.startRuleBody();continue}break;case"-epubx-page-master":case"-epubx-partition":case"-epubx-partition-group":b.consume();var E=null,_=null,B=[];for((u=b.token()).type==s.a.IDENT&&(E=u.text,b.consume(),u=b.token()),u.type==s.a.COLON&&b.nthToken(1).type==s.a.IDENT&&(_=b.nthToken(1).text,b.consume(),b.consume(),u=b.token());u.type==s.a.FUNC&&"class"==u.text.toLowerCase()&&b.nthToken(1).type==s.a.IDENT&&b.nthToken(2).type==s.a.C_PAR;)B.push(b.nthToken(1).text),b.consume(),b.consume(),b.consume(),u=b.token();if(u.type==s.a.O_BRC){switch(b.consume(),p){case"-epubx-page-master":y.startPageMasterRule(E,_,B);break;case"-epubx-partition":y.startPartitionRule(E,_,B);break;case"-epubx-partition-group":y.startPartitionGroupRule(E,_,B)}this.ruleStack.push(p),y.startRuleBody();continue}break;case"":y.error("E_CSS_UNEXPECTED_AT"+p,u),this.actions=L;continue;default:y.error("E_CSS_AT_UNKNOWN "+p,u),this.actions=A;continue}y.error("E_CSS_AT_SYNTAX "+p,u),this.actions=A;continue;case v.ERROR_PUSH:if(e||n)return!0;this.errorBrackets.push(u.type+1),b.consume();continue;case v.ERROR_POP_DECL:if(e||n)return!0;if(0==this.errorBrackets.length){this.actions=S;continue}case v.ERROR_POP:this.errorBrackets.length>0&&this.errorBrackets[this.errorBrackets.length-1]==u.type&&this.errorBrackets.pop(),0==this.errorBrackets.length&&u.type==s.a.C_BRC&&(this.actions=S),b.consume();continue;case v.ERROR_SEMICOL:if(e||n)return!0;0==this.errorBrackets.length&&(this.actions=S),b.consume();continue;case v.DONE:return o&&(b.consume(),y.endFuncWithSelector()),!0;default:if(e||n)return!0;if(i)return!!this.exprStackReduce(s.a.C_PAR,u)&&(this.result=w.pop(),!0);if(o)return u.type==s.a.INVALID?y.error(u.text,u):y.error("E_CSS_SYNTAX",u),!1;if(this.actions===P&&b.hasMark()){b.reset(),this.actions=I,y.startSelectorRule();continue}if(this.actions!==A&&this.actions!==L&&this.actions!==R){u.type==s.a.INVALID?y.error(u.text,u):y.error("E_CSS_SYNTAX",u),this.isInsidePropertyOnlyRule()?this.actions=R:this.actions=L;continue}b.consume();continue}return!1},t}(),M=function(t){function e(e){var n=t.call(this,null)||this;return n.scope=e,n}return p(e,t),e.prototype.error=function(t,e){throw new Error(t)},e.prototype.getScope=function(){return this.scope},e}(y);function U(t,e,n,i,o){var a=h.c("parseStylesheet"),l=new B(S,t,e,n),u=null;return o&&(u=function(t,e,n){var i=new B(O,t,e,n);return i.runParser(Number.POSITIVE_INFINITY,!1,!1,!0,!1),i.result}(new s.b(o,e),e,n)),(u=l.makeCondition(i,u&&u.toExpr()))&&(e.startMediaRule(u),e.startRuleBody()),a.loop(function(){for(var t=function(){if(l.importReady){var t=r.C(l.importURL,n);l.importCondition&&(e.startMediaRule(l.importCondition),e.startRuleBody());var i=h.c("parseStylesheet.import");return V(t,e,null,null).then(function(){l.importCondition&&e.endRule(),l.importReady=!1,l.importURL=null,l.importCondition=null,i.finish(!0)}),{value:i.result()}}var o=a.timeSlice();if(o.isPending)return{value:o}};!l.runParser(100,!1,!1,!1,!1);){var i=t();if("object"==typeof i)return i.value}return h.d(!1)}).then(function(){u&&e.endRule(),a.finish(!0)}),a.result()}function z(t,e,n,i,o){return h.b("parseStylesheetFromText",function(r){U(new s.b(t,e),e,n,i,o).thenFinish(r)},function(e,n){u.b.warn(n,"Failed to parse stylesheet text: "+t),e.finish(!1)})}function V(t,e,n,i){return h.b("parseStylesheetFromURL",function(o){c.c(t).then(function(r){r.responseText?z(r.responseText,e,t,n,i).then(function(e){e||u.b.warn("Failed to parse stylesheet from "+t),o.finish(!0)}):o.finish(!0)})},function(e,n){u.b.warn(n,"Exception while fetching and parsing:",t),e.finish(!0)})}function H(t,e,n){var i=new B(P,e,new M(t),n);return i.runParser(Number.POSITIVE_INFINITY,!0,!1,!1,!1),i.result}function G(t,e,n){new B(N,t,e,n).runParser(Number.POSITIVE_INFINITY,!1,!0,!1,!1)}var W={"z-index":!0,"column-count":!0,"flow-linger":!0,opacity:!0,page:!0,"flow-priority":!0,utilization:!0};function j(t,e,n){return e.isExpr()?function(t,e,n){var i=e.evaluate(t);switch(typeof i){case"number":return W[n]?i==Math.round(i)?new a.g(i):new a.h(i):new a.i(i,"px");case"string":return i?H(e.scope,new s.b(i,null),""):a.o;case"boolean":return i?a.t._true:a.t._false;case"undefined":return a.o}throw new Error("E_UNEXPECTED")}(t,e.expr,n):e}},function(t,e,n){"use strict";n.d(e,"c",function(){return o}),n.d(e,"b",function(){return r}),n.d(e,"a",function(){return a}),n.d(e,"d",function(){return c}),n.d(e,"j",function(){return h}),n.d(e,"k",function(){return p}),n.d(e,"i",function(){return y}),n.d(e,"m",function(){return b}),n.d(e,"l",function(){return E}),n.d(e,"g",function(){return C}),n.d(e,"f",function(){return T}),n.d(e,"h",function(){return x}),n.d(e,"e",function(){return I});var i=n(6),o=function(t,e,n,i){this.x1=t,this.y1=e,this.x2=n,this.y2=i},r=function(t,e){this.x=t,this.y=e},a=function(t,e,n,i){this.left=t,this.top=e,this.right=n,this.bottom=i},s=function(t,e,n,i){this.low=t,this.high=e,this.winding=n,this.shapeId=i},l=function(t,e,n,i){this.y1=t,this.y2=e,this.x1=n,this.x2=i,this.left=null,this.right=null};function u(t,e){return t.low.y-e.low.y||t.low.x-e.low.x}var c=function(){function t(t){this.points=t}return t.prototype.addSegments=function(t,e){for(var n=this.points,i=n.length,o=n[i-1],r=0;r<i;r++){var a,l=n[r];a=o.y<l.y?new s(o,l,1,e):new s(l,o,-1,e),t.push(a),o=l}},t.prototype.withOffset=function(e,n){for(var i=[],o=0,a=this.points;o<a.length;o++){var s=a[o];i.push(new r(s.x+e,s.y+n))}return new t(i)},t}();function h(t,e,n,i){for(var o=[],a=0;a<20;a++){var s=2*a*Math.PI/20;o.push(new r(t+n*Math.sin(s),e+i*Math.cos(s)))}return new c(o)}function p(t,e,n,i){return new c([new r(t,e),new r(n,e),new r(n,i),new r(t,i)])}var f=function(t,e,n,i){this.x=t,this.winding=e,this.shapeId=n,this.lowOrHigh=i};function d(t,e){var n=t.low.x+(t.high.x-t.low.x)*(e-t.low.y)/(t.high.y-t.low.y);if(isNaN(n))throw new Error("Bad intersection");return n}function g(t,e,n,o){var r,a,s,l;e.high.y<n&&i.b.warn("Error: inconsistent segment (1)"),e.low.y<=n?(r=d(e,n),a=e.winding):(r=e.low.x,a=0),e.high.y>=o?(s=d(e,o),l=e.winding):(s=e.high.x,l=0),r<s?(t.push(new f(r,a,e.shapeId,-1)),t.push(new f(s,l,e.shapeId,1))):(t.push(new f(s,l,e.shapeId,-1)),t.push(new f(r,a,e.shapeId,1)))}function m(t,e,n){var i,o=e+n,r=Array(o),a=Array(o);for(i=0;i<=o;i++)r[i]=0,a[i]=0;for(var s=[],l=!1,u=t.length,c=0;c<u;c++){var h=t[c];r[h.shapeId]+=h.winding,a[h.shapeId]+=h.lowOrHigh;var p=!1;for(i=0;i<e;i++)if(r[i]&&!a[i]){p=!0;break}if(p)for(i=e;i<=o;i++)if(r[i]||a[i]){p=!1;break}l!=p&&(s.push(h.x),l=p)}return s}function v(t,e){return e?Math.floor(t/e)*e:t}function y(t){return new o(t.y1,-t.x2,t.y2,-t.x1)}function b(t){return new o(-t.y2,t.x1,-t.y1,t.x2)}function w(t){return new c(t.points.map(function(t){return function(t){return new r(t.y,-t.x)}(t)}))}function E(t,e,n,i,o,r){r&&(t=y(t),e=e.map(function(t){return w(t)}),n=n.map(function(t){return w(t)}));var a,s,c,h=e.length,p=n?n.length:0,f=[],d=[];for(a=0;a<h;a++)e[a].addSegments(d,a);for(a=0;a<p;a++)n[a].addSegments(d,a+h);var b=d.length;d.sort(u);for(var E=0;d[E].shapeId>=h;)E++;var N=d[E].low.y;N>t.y1&&f.push(new l(t.y1,N,t.x2,t.x2));for(var C,T,x=0,I=[];x<b&&(c=d[x]).low.y<N;)c.high.y>N&&I.push(c),x++;for(;x<b||I.length>0;){var P=t.y2,O=Math.min((C=Math.ceil(N+i),(T=o)?Math.ceil(C/T)*T:C),t.y2);for(s=0;s<I.length&&P>O;s++)(c=I[s]).low.x==c.high.x?c.high.y<P&&(P=Math.max(v(c.high.y,o),O)):c.low.x!=c.high.x&&(P=O);for(P>t.y2&&(P=t.y2);x<b&&(c=d[x]).low.y<P;)if(c.high.y<N)x++;else{if(!(c.low.y<O)){var k=v(c.low.y,o);k<P&&(P=k);break}c.low.y==c.high.y&&c.low.y==N||(I.push(c),P=O),x++}var A=[];for(s=0;s<I.length;s++)g(A,I[s],N,P);A.sort(function(t,e){return t.x-e.x||t.lowOrHigh-e.lowOrHigh});var R=m(A,h,p);if(0==R.length)f.push(new l(N,P,t.x2,t.x2));else{var L=0,_=t.x1;for(s=0;s<R.length;s+=2){var F=Math.max(t.x1,R[s]),D=Math.min(t.x2,R[s+1])-F;D>L&&(L=D,_=F)}0==L?f.push(new l(N,P,t.x2,t.x2)):f.push(new l(N,P,Math.max(_,t.x1),Math.min(_+L,t.x2)))}if(P==t.y2)break;for(N=P,s=I.length-1;s>=0;s--)I[s].high.y<=P&&I.splice(s,1)}return S(t,f),f}function S(t,e){for(var n=e.length-1,i=new l(t.y2,t.y2,t.x1,t.x2);n>=0;){var o=i;((i=e[n]).y2-i.y1<1||i.x1==o.x1&&i.x2==o.x2)&&(o.y1=i.y1,e.splice(n,1),i=o),n--}}function N(t,e){for(var n=0,i=t.length;n<i;){var o=Math.floor((n+i)/2);e>=t[o].y2?n=o+1:i=o}return n}function C(t,e){if(!t.length)return e;var n,i,r=e.y1;for(i=0;i<t.length&&!((n=t[i]).y2>e.y1&&n.x1-.1<=e.x1&&n.x2+.1>=e.x2);i++)r=Math.max(r,n.y2);for(var a=r;i<t.length&&!((n=t[i]).y1>=e.y2||n.x1-.1>e.x1||n.x2+.1<e.x2);i++)a=n.y2;return(a=i===t.length?e.y2:Math.min(a,e.y2))<=r?null:new o(e.x1,r,e.x2,a)}function T(t,e){if(!t.length)return e;var n,i,r=e.y2;for(i=t.length-1;i>=0&&(n=t[i],!(i===t.length-1&&n.y2<e.y2))&&!(n.y1<e.y2&&n.x1-.1<=e.x1&&n.x2+.1>=e.x2);i--)r=Math.min(r,n.y1);for(var a=Math.min(r,n.y2);i>=0&&!((n=t[i]).y2<=e.y1||n.x1-.1>e.x1||n.x2+.1<e.x2);i--)a=n.y1;return r<=(a=Math.max(a,e.y1))?null:new o(e.x1,a,e.x2,r)}function x(t,e,n,i){for(var o=n.y1,r=n.x2-n.x1,a=n.y2-n.y1,s=N(e,o);;){var l=o+a;if(l>t.y2)return!1;for(var u=t.x1,c=t.x2,h=s;h<e.length&&e[h].y1<l;h++){var p=e[h];p.x1>u&&(u=p.x1),p.x2<c&&(c=p.x2)}if(u+r<=c||s>=e.length)return"left"==i?(n.x1=u,n.x2=u+r):(n.x1=c-r,n.x2=c),n.y2+=o-n.y1,n.y1=o,!0;o=e[s].y2,s++}}function I(t,e,n,i,o){for(i||(i=[new l(n.y1,n.y2,n.x1,n.x2)]);i.length>0&&i[0].y2<=t.y1;)i.shift();if(0!=i.length){var r;i[0].y1<t.y1&&(i[0].y1=t.y1);var a=0==e.length?t.y1:e[e.length-1].y2;a<t.y2&&e.push(new l(a,t.y2,t.x1,t.x2));for(var s=N(e,i[0].y1),u=0,c=i;u<c.length;u++){var h=c[u];if(s==e.length)break;for(e[s].y1<h.y1&&(r=e[s],s++,e.splice(s,0,new l(h.y1,r.y2,r.x1,r.x2)),r.y2=h.y1);s<e.length&&((r=e[s++]).y2>h.y2&&(e.splice(s,0,new l(h.y2,r.y2,r.x1,r.x2)),r.y2=h.y2),h.x1!=h.x2&&("left"==o?r.x1=Math.min(h.x2,t.x2):r.x2=Math.max(h.x1,t.x1)),r.y2!=h.y2););}S(t,e)}}},function(t,e,n){"use strict";var i=n(7),o=n(0),r=n(11);function a(t,e){var n={};return Object.keys(t).forEach(function(i){var o=n[i]={},r=t[i];Object.keys(r).forEach(function(t){o[t]=r[t].map(function(t){var n=e?t.logical:t.physical,i=e?t.physical:t.logical;return{regexp:new RegExp("(-?)"+n+"(-?)"),to:"$1"+i+"$2"}})})}),n}function s(t,e,n,i){var o=i[e];if(!o)throw new Error("unknown writing-mode: "+e);var r=o[n||"ltr"];if(!r)throw new Error("unknown direction: "+n);for(var a=0,s=r;a<s.length;a++){var l=s[a],u=t.replace(l.regexp,l.to);if(u!==t)return u}return t}n(6);var l={"horizontal-tb":{ltr:[{logical:"inline-start",physical:"left"},{logical:"inline-end",physical:"right"},{logical:"block-start",physical:"top"},{logical:"block-end",physical:"bottom"},{logical:"inline-size",physical:"width"},{logical:"block-size",physical:"height"}],rtl:[{logical:"inline-start",physical:"right"},{logical:"inline-end",physical:"left"},{logical:"block-start",physical:"top"},{logical:"block-end",physical:"bottom"},{logical:"inline-size",physical:"width"},{logical:"block-size",physical:"height"}]},"vertical-rl":{ltr:[{logical:"inline-start",physical:"top"},{logical:"inline-end",physical:"bottom"},{logical:"block-start",physical:"right"},{logical:"block-end",physical:"left"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}],rtl:[{logical:"inline-start",physical:"bottom"},{logical:"inline-end",physical:"top"},{logical:"block-start",physical:"right"},{logical:"block-end",physical:"left"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}]},"vertical-lr":{ltr:[{logical:"inline-start",physical:"top"},{logical:"inline-end",physical:"bottom"},{logical:"block-start",physical:"left"},{logical:"block-end",physical:"right"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}],rtl:[{logical:"inline-start",physical:"bottom"},{logical:"inline-end",physical:"top"},{logical:"block-start",physical:"left"},{logical:"block-end",physical:"right"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}]}},u=a(l,!0);var c=a(l,!1);var h=n(19),p=n(3),f=n(8),d=n(15);n.d(e,"a",function(){return g}),n.d(e,"g",function(){return m}),n.d(e,"h",function(){return v}),n.d(e,"b",function(){return y}),n.d(e,"d",function(){return w}),n.d(e,"c",function(){return E}),n.d(e,"e",function(){return S}),n.d(e,"f",function(){return C});var g=d.b.FloatReference;function m(t){switch(t){case"inline":return g.INLINE;case"column":return g.COLUMN;case"region":return g.REGION;case"page":return g.PAGE;default:throw new Error("Unknown float-reference: "+t)}}function v(t){switch(t){case g.INLINE:return!1;case g.COLUMN:case g.REGION:case g.PAGE:return!0;default:throw new Error("Unknown float-reference: "+t)}}var y=function(){function t(t,e,n,i,o,r){this.nodePosition=t,this.floatReference=e,this.floatSide=n,this.clearSide=i,this.flowName=o,this.floatMinWrapBlock=r,this.order=null,this.id=null}return t.prototype.getOrder=function(){if(null===this.order)throw new Error("The page float is not yet added");return this.order},t.prototype.getId=function(){if(!this.id)throw new Error("The page float is not yet added");return this.id},t.prototype.isAllowedOnContext=function(t){return t.isAnchorAlreadyAppeared(this.getId())},t.prototype.isAllowedToPrecede=function(t){return!1},t}(),b=function(){function t(){this.floats=[],this.nextPageFloatIndex=0}return t.prototype.nextOrder=function(){return this.nextPageFloatIndex++},t.prototype.createPageFloatId=function(t){return"pf"+t},t.prototype.addPageFloat=function(t){if(this.floats.findIndex(function(e){return f.u(e.nodePosition,t.nodePosition)})>=0)throw new Error("A page float with the same source node is already registered");var e=t.order=this.nextOrder();t.id=this.createPageFloatId(e),this.floats.push(t)},t.prototype.findPageFloatByNodePosition=function(t){var e=this.floats.findIndex(function(e){return f.u(e.nodePosition,t)});return e>=0?this.floats[e]:null},t.prototype.findPageFloatById=function(t){var e=this.floats.findIndex(function(e){return e.id===t});return e>=0?this.floats[e]:null},t}(),w=function(){function t(t,e,n,i,o){this.floatReference=t,this.floatSide=e,this.continuations=n,this.area=i,this.continues=o}return t.prototype.hasFloat=function(t){return this.continuations.some(function(e){return e.float===t})},t.prototype.findNotAllowedFloat=function(t){for(var e=this.continuations.length-1;e>=0;e--){var n=this.continuations[e].float;if(!n.isAllowedOnContext(t))return n}return null},t.prototype.getOuterShape=function(){return this.area.getOuterShape(null,null)},t.prototype.getOuterRect=function(){return this.area.getOuterRect()},t.prototype.getOrder=function(){var t=this.continuations.map(function(t){return t.float});return Math.min.apply(null,t.map(function(t){return t.getOrder()}))},t.prototype.shouldBeStashedBefore=function(t){return this.getOrder()<t.getOrder()},t.prototype.addContinuations=function(t){var e=this;t.forEach(function(t){e.continuations.push(t)})},t.prototype.getFlowName=function(){var t=this.continuations[0].float.flowName;return i.a(this.continuations.every(function(e){return e.float.flowName===t})),t},t}(),E=function(){function t(t,e){this.float=t,this.nodePosition=e}return t.prototype.equals=function(t){return!!t&&(this===t||this.float===t.float&&f.u(this.nodePosition,t.nodePosition))},t}(),S=function(){function t(t,e,n,i,r,a,s){this.parent=t,this.floatReference=e,this.container=n,this.flowName=i,this.generatingNodePosition=r,this.children=[],this.invalidated=!1,this.forbiddenFloats=[],this.floatFragments=[],this.stashedFloatFragments=[],this.floatAnchors={},this.floatsDeferredToNext=[],this.layoutConstraints=[],this.locked=!1,t&&t.children.push(this),this.writingMode=a||t&&t.writingMode||o.t.horizontal_tb,this.direction=s||t&&t.direction||o.t.ltr,this.floatStore=t?t.floatStore:new b;var l=this.getPreviousSibling();this.floatsDeferredFromPrevious=l?[].concat(l.floatsDeferredToNext):[]}return t.prototype.getParent=function(t){if(!this.parent)throw new Error("No PageFloatLayoutContext for "+t);return this.parent},t.prototype.getPreviousSiblingOf=function(t,e,n,i){var o=this.children.indexOf(t);o<0&&(o=this.children.length);for(var r=o-1;r>=0;r--){var a=this.children[r];if(a.floatReference===e&&a.flowName===n&&f.u(a.generatingNodePosition,i))return a;if(a=a.getPreviousSiblingOf(null,e,n,i))return a}return null},t.prototype.getPreviousSibling=function(){for(var t,e=this,n=this.parent;n;){if(t=n.getPreviousSiblingOf(e,this.floatReference,this.flowName,this.generatingNodePosition))return t;e=n,n=n.parent}return null},t.prototype.getContainer=function(t){return t&&t!==this.floatReference?this.getParent(t).getContainer(t):this.container},t.prototype.setContainer=function(t){this.container=t,this.reattachFloatFragments()},t.prototype.addPageFloat=function(t){this.floatStore.addPageFloat(t)},t.prototype.getPageFloatLayoutContext=function(t){return t===this.floatReference?this:this.getParent(t).getPageFloatLayoutContext(t)},t.prototype.findPageFloatByNodePosition=function(t){return this.floatStore.findPageFloatByNodePosition(t)},t.prototype.forbid=function(t){var e=t.getId(),n=t.floatReference;n===this.floatReference?this.forbiddenFloats.includes(e)||(this.forbiddenFloats.push(e),(new C).findByFloat(t).forbid(t,this)):this.getParent(n).forbid(t)},t.prototype.isForbidden=function(t){var e=t.getId(),n=t.floatReference;return n===this.floatReference?this.forbiddenFloats.includes(e):this.getParent(n).isForbidden(t)},t.prototype.addPageFloatFragment=function(t,e){var n=t.floatReference;n!==this.floatReference?this.getParent(n).addPageFloatFragment(t,e):this.floatFragments.includes(t)||(this.floatFragments.push(t),this.floatFragments.sort(function(t,e){return t.getOrder()-e.getOrder()})),e||this.invalidate()},t.prototype.removePageFloatFragment=function(t,e){var n=t.floatReference;if(n!==this.floatReference)this.getParent(n).removePageFloatFragment(t,e);else{var i=this.floatFragments.indexOf(t);if(i>=0){var o=this.floatFragments.splice(i,1)[0],r=o.area&&o.area.element;r&&r.parentNode&&r.parentNode.removeChild(r),e||this.invalidate()}}},t.prototype.findPageFloatFragment=function(t){if(t.floatReference!==this.floatReference)return this.getParent(t.floatReference).findPageFloatFragment(t);var e=this.floatFragments.findIndex(function(e){return e.hasFloat(t)});return e>=0?this.floatFragments[e]:null},t.prototype.hasFloatFragments=function(t){return!(!(this.floatFragments.length>0)||t&&!this.floatFragments.some(t))||!!this.parent&&this.parent.hasFloatFragments(t)},t.prototype.hasContinuingFloatFragmentsInFlow=function(t){return this.hasFloatFragments(function(e){return e.continues&&e.getFlowName()===t})},t.prototype.registerPageFloatAnchor=function(t,e){this.floatAnchors[t.getId()]=e},t.prototype.collectPageFloatAnchors=function(){var t=Object.assign({},this.floatAnchors);return this.children.reduce(function(t,e){return Object.assign(t,e.collectPageFloatAnchors())},t)},t.prototype.isAnchorAlreadyAppeared=function(t){if(this.getDeferredPageFloatContinuations().some(function(e){return e.float.getId()===t}))return!0;var e=this.collectPageFloatAnchors()[t];return!!e&&!(!this.container||!this.container.element)&&this.container.element.contains(e)},t.prototype.deferPageFloat=function(t){var e=t.float;if(e.floatReference===this.floatReference){var n=this.floatsDeferredToNext.findIndex(function(t){return t.float===e});n>=0?this.floatsDeferredToNext.splice(n,1,t):this.floatsDeferredToNext.push(t)}else this.getParent(e.floatReference).deferPageFloat(t)},t.prototype.hasPrecedingFloatsDeferredToNext=function(t,e){if(!e&&t.floatReference!==this.floatReference)return this.getParent(t.floatReference).hasPrecedingFloatsDeferredToNext(t,!1);var n=t.getOrder();return!!this.floatsDeferredToNext.some(function(e){return e.float.getOrder()<n&&!t.isAllowedToPrecede(e.float)})||!!this.parent&&this.parent.hasPrecedingFloatsDeferredToNext(t,!0)},t.prototype.getLastFollowingFloatInFragments=function(t){var e=t.getOrder(),n=null;if(this.floatFragments.forEach(function(t){t.continuations.forEach(function(t){var i=t.float,o=i.getOrder();o>e&&(!n||o>n.getOrder())&&(n=i)})}),this.parent){var i=this.parent.getLastFollowingFloatInFragments(t);i&&(!n||i.getOrder()>n.getOrder())&&(n=i)}return n},t.prototype.getDeferredPageFloatContinuations=function(t){t=t||this.flowName;var e=this.floatsDeferredFromPrevious.filter(function(e){return!t||e.float.flowName===t});return this.parent&&(e=this.parent.getDeferredPageFloatContinuations(t).concat(e)),e.sort(function(t,e){return t.float.getOrder()-e.float.getOrder()})},t.prototype.getPageFloatContinuationsDeferredToNext=function(t){t=t||this.flowName;var e=this.floatsDeferredToNext.filter(function(e){return!t||e.float.flowName===t});return this.parent?this.parent.getPageFloatContinuationsDeferredToNext(t).concat(e):e},t.prototype.getFloatsDeferredToNextInChildContexts=function(){for(var t=[],e=[],n=this.children.length-1;n>=0;n--){var i=this.children[n];e.includes(i.flowName)||(e.push(i.flowName),t=(t=t.concat(i.floatsDeferredToNext.map(function(t){return t.float}))).concat(i.getFloatsDeferredToNextInChildContexts()))}return t},t.prototype.checkAndForbidNotAllowedFloat=function(){if(this.checkAndForbidFloatFollowingDeferredFloat())return!0;for(var t=this.floatFragments.length-1;t>=0;t--){var e=this.floatFragments[t],n=e.findNotAllowedFloat(this);if(n)return this.locked?this.invalidate():(this.removePageFloatFragment(e),this.forbid(n),this.removeEndFloatFragments(e.floatSide)),!0}return!(this.floatReference!==g.REGION||!this.parent.locked)&&this.parent.checkAndForbidNotAllowedFloat()},t.prototype.checkAndForbidFloatFollowingDeferredFloat=function(){var t=this.getFloatsDeferredToNextInChildContexts(),e=this.floatFragments.reduce(function(t,e){return t.concat(e.continuations.map(function(t){return t.float}))},[]);e.sort(function(t,e){return e.getOrder()-t.getOrder()});for(var n=function(e){var n=e.getOrder();if(t.some(function(t){return!e.isAllowedToPrecede(t)&&n>t.getOrder()})){if(o.locked)o.invalidate();else{o.forbid(e);var r=o.findPageFloatFragment(e);i.a(r),o.removePageFloatFragment(r)}return{value:!0}}},o=this,r=0,a=e;r<a.length;r++){var s=n(a[r]);if("object"==typeof s)return s.value}return!1},t.prototype.finish=function(){var t=this;if(!this.checkAndForbidNotAllowedFloat()){for(var e=this.floatsDeferredToNext.length-1;e>=0;e--)if(!this.floatsDeferredToNext[e].float.isAllowedOnContext(this)){if(this.locked)return void this.invalidate();this.floatsDeferredToNext.splice(e,1)}this.floatsDeferredFromPrevious.forEach(function(e){t.floatsDeferredToNext.findIndex(function(t){return e.equals(t)})>=0||t.floatFragments.some(function(t){return t.hasFloat(e.float)})||t.floatsDeferredToNext.push(e)})}},t.prototype.hasSameContainerAs=function(t){return!!this.container&&!!t.container&&this.container.element===t.container.element},t.prototype.invalidate=function(){var t=this;this.invalidated=!0,this.locked||(this.container&&(this.children.forEach(function(e){t.hasSameContainerAs(e)&&e.floatFragments.forEach(function(t){var e=t.area.element;e&&e.parentNode&&e.parentNode.removeChild(e)})}),this.container.clear()),this.children.forEach(function(t){t.layoutConstraints.splice(0)}),this.children.splice(0),Object.keys(this.floatAnchors).forEach(function(e){delete t.floatAnchors[e]}))},t.prototype.detachChildren=function(){var t=this.children.splice(0);return t.forEach(function(t){t.floatFragments.forEach(function(t){var e=t.area.element;e&&e.parentNode&&e.parentNode.removeChild(e)})}),t},t.prototype.attachChildren=function(t){var e=this;t.forEach(function(t){e.children.push(t),t.reattachFloatFragments()})},t.prototype.isInvalidated=function(){return this.invalidated||!!this.parent&&this.parent.isInvalidated()},t.prototype.validate=function(){this.invalidated=!1},t.prototype.toLogical=function(t){return function(t,e,n){return s(t,e,n||null,c)}(t,this.writingMode.toString(),this.direction.toString())},t.prototype.toPhysical=function(t){return function(t,e,n){return s(t,e,n||null,u)}(t,this.writingMode.toString(),this.direction.toString())},t.prototype.removeEndFloatFragments=function(t){var e=this.toLogical(t);if("block-end"===e||"inline-end"===e)for(var n=0;n<this.floatFragments.length;){var i=this.floatFragments[n];this.toLogical(i.floatSide)===e?this.removePageFloatFragment(i):n++}},t.prototype.stashEndFloatFragments=function(t){var e=t.floatReference;if(e===this.floatReference){var n=this.toLogical(t.floatSide);if("block-end"===n||"snap-block"===n||"inline-end"===n)for(var i=0;i<this.floatFragments.length;){var o=this.floatFragments[i],r=this.toLogical(o.floatSide);(r===n||"snap-block"===n&&"block-end"===r)&&o.shouldBeStashedBefore(t)?(this.stashedFloatFragments.push(o),this.floatFragments.splice(i,1)):i++}}else this.getParent(e).stashEndFloatFragments(t)},t.prototype.restoreStashedFragments=function(t){var e=this;t===this.floatReference?(this.stashedFloatFragments.forEach(function(t){e.addPageFloatFragment(t,!0)}),this.stashedFloatFragments.splice(0)):this.getParent(t).restoreStashedFragments(t)},t.prototype.discardStashedFragments=function(t){t===this.floatReference?this.stashedFloatFragments.splice(0):this.getParent(t).discardStashedFragments(t)},t.prototype.getStashedFloatFragments=function(t){return t===this.floatReference?this.stashedFloatFragments.concat().sort(function(t,e){return e.getOrder()-t.getOrder()}):this.getParent(t).getStashedFloatFragments(t)},t.prototype.getLimitValue=function(t,e,n,o){i.a(this.container);var r=this.toLogical(t),a=this.toPhysical(t),s=this.getLimitValueInner(r,e,n,o);if(this.parent&&this.parent.container){var l=this.parent.getLimitValue(a,e,n,o);switch(a){case"top":case"left":return Math.max(s,l);case"bottom":case"right":return Math.min(s,l);default:i.b("Should be unreachable")}}return s},t.prototype.getLimitValueInner=function(t,e,n,o){i.a(this.container);var r=this.getLimitValuesInner(e,n,o);switch(t){case"block-start":return this.container.vertical?r.right:r.top;case"block-end":return this.container.vertical?r.left:r.bottom;case"inline-start":return this.container.vertical?r.top:r.left;case"inline-end":return this.container.vertical?r.bottom:r.right;default:throw new Error("Unknown logical side: "+t)}},t.prototype.getLimitValuesInner=function(t,e,n){var o=this;i.a(this.container);var r=this.container.originX,a=this.container.originY,s=this.container.getPaddingRect(),l={top:s.y1-a,left:s.x1-r,bottom:s.y2-a,right:s.x2-r,floatMinWrapBlockStart:0,floatMinWrapBlockEnd:0};function u(n,i,o){return"%"===n.unit?o*n.num/100:t.convertLengthToPx(n,i,e)}var c=this.floatFragments;return c.length>0&&(l=c.reduce(function(t,e){if(n&&!n(e,o))return t;var i=o.toLogical(e.floatSide),r=e.area,a=e.continuations[0].float.floatMinWrapBlock,l=t.top,c=t.left,h=t.bottom,p=t.right,f=t.floatMinWrapBlockStart,d=t.floatMinWrapBlockEnd;switch(i){case"inline-start":r.vertical?l=Math.max(l,r.top+r.height):c=Math.max(c,r.left+r.width);break;case"block-start":r.vertical?(a&&r.left<p&&(f=u(a,r.rootViewNodes[0],s.x2-s.x1)),p=Math.min(p,r.left)):(a&&r.top+r.height>l&&(f=u(a,r.rootViewNodes[0],s.y2-s.y1)),l=Math.max(l,r.top+r.height));break;case"inline-end":r.vertical?h=Math.min(h,r.top):p=Math.min(p,r.left);break;case"block-end":r.vertical?(a&&r.left+r.width>c&&(d=u(a,r.rootViewNodes[0],s.x2-s.x1)),c=Math.max(c,r.left+r.width)):(a&&r.top<h&&(d=u(a,r.rootViewNodes[0],s.y2-s.y1)),h=Math.min(h,r.top));break;default:throw new Error("Unknown logical float side: "+i)}return{top:l,left:c,bottom:h,right:p,floatMinWrapBlockStart:f,floatMinWrapBlockEnd:d}},l)),l.left+=r,l.right+=r,l.top+=a,l.bottom+=a,l},t.prototype.setFloatAreaDimensions=function(t,e,n,o,a,s,l){if(e!==this.floatReference)return this.getParent(e).setFloatAreaDimensions(t,e,n,o,a,s,l);var u=this.toLogical(n);if("snap-block"===u){if(!l["block-start"]&&!l["block-end"])return null}else if(!l[u])return null;i.a(t.clientLayout);var c,p,f,d,g=this.getLimitValue("block-start",t.layoutContext,t.clientLayout),m=this.getLimitValue("block-end",t.layoutContext,t.clientLayout),v=this.getLimitValue("inline-start",t.layoutContext,t.clientLayout),y=this.getLimitValue("inline-end",t.layoutContext,t.clientLayout),b=t.vertical?t.originX:t.originY,w=t.vertical?t.originY:t.originX;function E(e,n){var i=e(t.bands,n);return i?(t.vertical&&(i=r.m(i)),g=t.vertical?Math.min(g,i.x2):Math.max(g,i.y1),m=t.vertical?Math.max(m,i.x1):Math.min(m,i.y2),!0):s}if(g=t.vertical?Math.min(g,t.left+t.getInsetLeft()+t.width+t.getInsetRight()+b):Math.max(g,t.top+b),m=t.vertical?Math.max(m,t.left+b):Math.min(m,t.top+t.getInsetTop()+t.height+t.getInsetBottom()+b),a){var S=t.vertical?r.i(new r.c(m,v,g,y)):new r.c(v,g,y,m);if(("block-start"===u||"snap-block"===u||"inline-start"===u)&&!E(r.g,S))return null;if(("block-end"===u||"snap-block"===u||"inline-end"===u)&&!E(r.f,S))return null;if(c=(f=(m-g)*t.getBoxDir())-t.getInsetBefore()-t.getInsetAfter(),p=(d=y-v)-t.getInsetStart()-t.getInsetEnd(),!s&&(c<=0||p<=0))return null}else{f=(c=t.computedBlockSize)+t.getInsetBefore()+t.getInsetAfter();var N=(m-g)*t.getBoxDir();if("snap-block"===u){if(null===o)u="block-start";else{var C=this.container.getPaddingRect();u=this.container.getBoxDir()*(o-(this.container.vertical?C.x2:C.y1))<=this.container.getBoxDir()*((this.container.vertical?C.x1:C.y2)-o-f)?"block-start":"block-end"}if(!l[u]){if(!l["block-end"])return null;u="block-end"}}if(!s&&N<f)return null;if(d=(p="inline-start"===u||"inline-end"===u?h.b(t.clientLayout,t.element,[h.a.FIT_CONTENT_INLINE_SIZE])[h.a.FIT_CONTENT_INLINE_SIZE]:t.adjustContentRelativeSize?t.getContentInlineSize():t.vertical?t.height:t.width)+t.getInsetStart()+t.getInsetEnd(),!s&&y-v<d)return null}switch(g-=b,m-=b,v-=w,y-=w,u){case"inline-start":case"block-start":case"snap-block":t.setInlinePosition(v,p),t.setBlockPosition(g,c);break;case"inline-end":case"block-end":t.setInlinePosition(y-d,p),t.setBlockPosition(m-f*t.getBoxDir(),c);break;default:throw new Error("unknown float direction: "+n)}return u},t.prototype.getFloatFragmentExclusions=function(){var t=this.floatFragments.map(function(t){return t.getOuterShape()});return this.parent?this.parent.getFloatFragmentExclusions().concat(t):t},t.prototype.reattachFloatFragments=function(){var t=this.container.element&&this.container.element.parentNode;t&&this.floatFragments.forEach(function(e){t.appendChild(e.area.element)})},t.prototype.getMaxReachedAfterEdge=function(){var t=this.getContainer().vertical;return this.floatFragments.reduce(function(e,n){var i=n.getOuterRect();return t?Math.min(e,i.x1):Math.max(e,i.y2)},t?1/0:0)},t.prototype.getBlockStartEdgeOfBlockEndFloats=function(){var t=this.getContainer().vertical;return this.floatFragments.filter(function(t){return"block-end"===t.floatSide}).reduce(function(e,n){var i=n.getOuterRect();return t?Math.max(e,i.x2):Math.min(e,i.y1)},t?0:1/0)},t.prototype.getPageFloatClearEdge=function(t,e){function n(t){return function(e){return t.isAnchorAlreadyAppeared(e.float.getId())}}function o(t,e){return t.continuations.some(n(e))}for(var r=e.getPaddingRect(),a=e.vertical?r.x1:r.y2,s=this;s;){if(s.floatsDeferredToNext.some(n(s)))return a;s=s.parent}i.a(e.clientLayout);var l=this.getLimitValue("block-start",e.layoutContext,e.clientLayout,o);return this.getLimitValue("block-end",e.layoutContext,e.clientLayout,o)*e.getBoxDir()<a*e.getBoxDir()?a:l},t.prototype.getPageFloatPlacementCondition=function(t,e,n){var i=this;if(t.floatReference!==this.floatReference)return this.getParent(t.floatReference).getPageFloatPlacementCondition(t,e,n);var o={"block-start":!0,"block-end":!0,"inline-start":!0,"inline-end":!0};if(!n)return o;var r,a=this.toLogical(e),s=this.toLogical(n);r="all"===s?["block-start","block-end","inline-start","inline-end"]:"both"===s?["inline-start","inline-end"]:"same"===s?"snap-block"===a?["block-start","block-end"]:[a]:[s];var l=t.getOrder();function u(t){return function(e){return e.floatSide===t&&e.getOrder()<l}}return r.forEach(function(t){switch(t){case"block-start":case"inline-start":o[t]=!function t(e,n){return e.children.some(function(e){return e.floatFragments.some(u(n))||t(e,n)})}(i,t);break;case"block-end":case"inline-end":o[t]=!function t(e,n){var i=e.parent;return!!i&&(i.floatFragments.some(u(n))||t(i,n))}(i,t);break;default:throw new Error("Unexpected side: "+t)}}),o},t.prototype.getLayoutConstraints=function(){return(this.parent?this.parent.getLayoutConstraints():[]).concat(this.layoutConstraints)},t.prototype.addLayoutConstraint=function(t,e){e===this.floatReference?this.layoutConstraints.push(t):this.getParent(e).addLayoutConstraint(t,e)},t.prototype.isColumnFullWithPageFloats=function(t){var e=t.layoutContext,n=t.clientLayout;i.a(n);for(var o=this,r=null;o&&o.container;){var a=o.getLimitValuesInner(e,n);r?t.vertical?(a.right<r.right&&(r.right=a.right,r.floatMinWrapBlockStart=a.floatMinWrapBlockStart),a.left>r.left&&(r.left=a.left,r.floatMinWrapBlockEnd=a.floatMinWrapBlockEnd)):(a.top>r.top&&(r.top=a.top,r.floatMinWrapBlockStart=a.floatMinWrapBlockStart),a.bottom<r.bottom&&(r.bottom=a.bottom,r.floatMinWrapBlockEnd=a.floatMinWrapBlockEnd)):r=a,o=o.parent}var s=Math.max(r.floatMinWrapBlockStart,r.floatMinWrapBlockEnd);return(t.vertical?r.right-r.left:r.bottom-r.top)<=s},t.prototype.getMaxBlockSizeOfPageFloats=function(){var t=this.getContainer().vertical;return this.floatFragments.length?Math.max.apply(null,this.floatFragments.map(function(e){var n=e.area;return t?n.width:n.height})):0},t.prototype.lock=function(){this.locked=!0},t.prototype.unlock=function(){this.locked=!1},t.prototype.isLocked=function(){return this.locked},t}(),N=[],C=function(){function t(){}return t.register=function(t){N.push(t)},t.prototype.findByNodeContext=function(t){for(var e=N.length-1;e>=0;e--){var n=N[e];if(n.appliesToNodeContext(t))return n}throw new Error("No PageFloatLayoutStrategy found for "+t)},t.prototype.findByFloat=function(t){for(var e=N.length-1;e>=0;e--){var n=N[e];if(n.appliesToFloat(t))return n}throw new Error("No PageFloatLayoutStrategy found for "+t)},t}(),T=function(){function t(){}return t.prototype.appliesToNodeContext=function(t){return v(t.floatReference)},t.prototype.appliesToFloat=function(t){return!0},t.prototype.createPageFloat=function(t,e,n){var o=t.floatReference;i.a(t.floatSide);var r=t.floatSide,a=t.toNodePosition();return n.resolveFloatReferenceFromColumnSpan(o,t.columnSpan,t).thenAsync(function(n){o=n,i.a(e.flowName);var s=new y(a,o,r,t.clearSide,e.flowName,t.floatMinWrapBlock);return e.addPageFloat(s),p.d(s)})},t.prototype.createPageFloatFragment=function(t,e,n,i){var o=t[0].float;return new w(o.floatReference,e,t,n,i)},t.prototype.findPageFloatFragment=function(t,e){return e.findPageFloatFragment(t)},t.prototype.adjustPageFloatArea=function(t,e,n){},t.prototype.forbid=function(t,e){},t}();C.register(new T)},function(t,e,n){"use strict";n.d(e,"c",function(){return a}),n.d(e,"b",function(){return l}),n.d(e,"d",function(){return u}),n.d(e,"a",function(){return c}),n.d(e,"e",function(){return h});var i=n(0),o=n(9),r={page:!0,left:!0,right:!0,recto:!0,verso:!0,column:!0,region:!0};function a(t){return!!r[t]}var s={avoid:!0,"avoid-page":!0,"avoid-column":!0,"avoid-region":!0};function l(t){return!!s[t]}function u(t,e){if(!t)return e;if(!e)return t;var n=a(t),i=a(e);if(!n||!i)return i?e:n?t:l(e)?e:l(t)?t:e;switch(e){case"column":return t;case"region":return"column"===t?e:t;default:return e}}function c(t){switch(t){case"left":case"right":case"recto":case"verso":return t;default:return"any"}}function h(t){switch(t){case"left":case"right":case"recto":case"verso":return t;default:return null}}o.c.registerHook("SIMPLE_PROPERTY",function(t){var e=t.name,n=t.value;switch(e){case"page-break-before":case"page-break-after":case"page-break-inside":return{name:e.replace(/^page-/,""),value:n===i.t.always?i.t.page:n,important:t.important};default:return t}})},function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return s}),n.d(e,"c",function(){return l}),n.d(e,"f",function(){return u}),n.d(e,"d",function(){return c}),n.d(e,"e",function(){return h});var i=n(1),o=n(6),r=n(8);function a(t,e,n,r){var a=t.viewNode;if(!a)return NaN;if(1==a.nodeType){if(t.after||!t.inline){var s=e.getElementClientRect(a);if(s.right>=s.left&&s.bottom>=s.top)return t.after?r?s.left:s.bottom:r?s.right:s.top}return NaN}var l=NaN,u=a.ownerDocument.createRange(),c=a.textContent.length;if(!c)return NaN;t.after&&(n+=c),n>=c&&(n=c-1),u.setStart(a,n),u.setEnd(a,n+1);var h=e.getRangeClientRects(u);r&&i.m(document.body)&&(h=function(t,e,n){var i=n.ownerDocument.createRange();i.setStart(n,0),i.setEnd(n,n.textContent.length);for(var r=t.getRangeClientRects(i),a=[],s=0,l=e;s<l.length;s++){var u=l[s],c=void 0;for(c=0;c<r.length;c++){var h=r[c];if(u.top>=h.top&&u.bottom<=h.bottom&&Math.abs(u.left-h.left)<1){a.push({top:u.top,left:h.left,bottom:u.bottom,right:h.right});break}}c==r.length&&(o.b.warn("Could not fix character box"),a.push(u))}return a}(e,h,a));for(var p=0,f=0,d=h;f<d.length;f++){var g=d[f],m=r?g.bottom-g.top:g.right-g.left;g.right>g.left&&g.bottom>g.top&&(isNaN(l)||m>p)&&(l=r?g.left:g.bottom,p=m)}return l}function s(t,e,n){var i=e.clientLayout.getElementClientRect(t),o=e.getComputedMargin(t);return n?i.width+o.left+o.right:i.height+o.top+o.bottom}function l(t){for(;t;){if(t.parentNode===t.ownerDocument)return!1;t=t.parentNode}return!0}function u(t,e){if(t)for(var n;(n=t.lastChild)!=e;)t.removeChild(n)}function c(t){return!!t.getAttribute(r.m)}function h(t){if(!t)return!1;var e=t.viewNode;return!(!e||1!==e.nodeType)&&c(e)}},function(t,e,n){"use strict";var i,o,r,a,s,l;n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o}),n.d(e,"d",function(){return r}),n.d(e,"c",function(){return a}),n.d(e,"e",function(){return s}),n.d(e,"f",function(){return l}),(i||(i={})).isInstanceOfBlockFormattingContext=function(t){return t&&"Block"===t.formattingContextType},function(t){!function(t){t.INLINE="inline",t.COLUMN="column",t.REGION="region",t.PAGE="page"}(t.FloatReference||(t.FloatReference={}))}(o||(o={})),(r||(r={})).isInstanceOfAfterIfContinuesLayoutConstraint=function(t){return t&&"AfterIfContinue"==t.flagmentLayoutConstraintType},function(t){t.isInstanceOfRepetitiveElementsOwnerFormattingContext=function(t){return!!t&&("RepetitiveElementsOwner"===t.formattingContextType||s.isInstanceOfTableFormattingContext(t))},t.isInstanceOfRepetitiveElementsOwnerLayoutConstraint=function(t){return!!t&&("RepetitiveElementsOwner"===t.flagmentLayoutConstraintType||s.isInstanceOfTableRowLayoutConstraint(t))}}(a||(a={})),function(t){t.isInstanceOfTableFormattingContext=function(t){return t&&"Table"===t.formattingContextType},t.isInstanceOfTableRowLayoutConstraint=function(t){return t&&"TableRow"===t.flagmentLayoutConstraintType}}(s||(s={})),function(t){!function(t){t[t.IGNORE=0]="IGNORE",t[t.NEWLINE=1]="NEWLINE",t[t.PRESERVE=2]="PRESERVE"}(t.Whitespace||(t.Whitespace={})),function(t){t[t.NONE=0]="NONE",t[t.CONTENT=1]="CONTENT",t[t.ROOTLESS=2]="ROOTLESS",t[t.ROOTED=3]="ROOTED"}(t.ShadowType||(t.ShadowType={}))}(l||(l={}))},function(t,e,n){"use strict";var i,o=n(1),r=n(6),a=n(3),s=n(17);function l(t,e,n,o,s){var l=a.c("ajax"),c=new XMLHttpRequest,h=l.suspend(c),p={status:0,statusText:"",url:t,contentType:null,responseText:null,responseXML:null,responseBlob:null};c.open(n||"GET",t,!0),e&&(c.responseType=e),c.onreadystatechange=function(){if(4===c.readyState){if(p.status=c.status,p.statusText=c.statusText||404==c.status&&"Not Found"||"",200==p.status||0==p.status)if(e&&e!==i.DOCUMENT||!c.responseXML||"parsererror"==c.responseXML.documentElement.localName)if((!e||e===i.DOCUMENT)&&c.response instanceof HTMLDocument)p.responseXML=c.response,p.contentType=c.response.contentType;else{var n=c.response;e&&e!==i.TEXT||"string"!=typeof n?n?p.responseBlob="string"==typeof n?u([n]):n:r.b.warn("Unexpected empty success response for",t):p.responseText=n;var o=c.getResponseHeader("Content-Type");o&&(p.contentType=o.replace(/(.*);.*$/,"$1"))}else p.responseXML=c.responseXML,p.contentType=c.responseXML.contentType;h.schedule(p)}};try{o?(c.setRequestHeader("Content-Type",s||"text/plain; charset=UTF-8"),c.send(o)):(/^file:|^https?:\/\/[^\/]+\.githubusercontent\.com|\.opf$/.test(t)?/\/aozorabunko\/[^\/]+\/cards\/[^\/]+\/files\/[^\/.]+\.html$/.test(t)?c.overrideMimeType("text/html; charset=Shift_JIS"):/\.(html|htm)$/.test(t)?c.overrideMimeType("text/html; charset=UTF-8"):/\.(xhtml|xht|xml|opf)$/.test(t)?c.overrideMimeType("application/xml; charset=UTF-8"):/\.(txt|css)$/.test(t)?c.overrideMimeType("text/plain; charset=UTF-8"):c.overrideMimeType("text/html; charset=UTF-8"):/^data:,(<|%3C|%3c)/.test(t)?c.overrideMimeType("text/html; charset=UTF-8"):/^data:,/.test(t)&&c.overrideMimeType("text/plain; charset=UTF-8"),c.send(null))}catch(e){r.b.warn(e,"Error fetching "+t),h.schedule(p)}return l.result()}function u(t,e){var n=e||"application/octet-stream",i=window.WebKitBlobBuilder||window.MSBlobBuilder;if(i){for(var o=new i,r=0;r<t.length;r++)o.append(t[r]);return o.getBlob(n)}return new Blob(t,{type:n})}function c(t){var e=a.c("readBlob"),n=new FileReader,i=e.suspend(n);return n.addEventListener("load",function(){i.schedule(n.result)},!1),n.readAsArrayBuffer(t),e.result()}function h(t){return(window.URL||window.webkitURL).createObjectURL(t)}n.d(e,"b",function(){return i}),n.d(e,"c",function(){return l}),n.d(e,"e",function(){return u}),n.d(e,"g",function(){return c}),n.d(e,"d",function(){return h}),n.d(e,"a",function(){return p}),n.d(e,"f",function(){return d}),function(t){t.DEFAULT="",t.ARRAYBUFFER="arraybuffer",t.BLOB="blob",t.DOCUMENT="document",t.JSON="json",t.TEXT="text"}(i||(i={}));var p=function(){function t(t,e){this.parser=t,this.type=e,this.resources={},this.fetchers={}}return t.prototype.load=function(t,e,n){t=o.I(t);var i=this.resources[t];return void 0!==i?a.d(i):this.fetch(t,e,n).get()},t.prototype.fetchInner=function(t,e,n){var i=this,r=a.c("fetch"),s=t.endsWith("?viv-toc-box");s&&(t=t.replace("?viv-toc-box",""));var u=o.C("user-agent.xml",o.D),c=!s&&t===u;return c&&(t="data:application/xml,"+encodeURIComponent('<!DOCTYPE html>\n<html xmlns="http://www.w3.org/1999/xhtml" xmlns:s="http://www.pyroxy.com/ns/shadow">\n<head>\n<style><![CDATA[\n\n.footnote-content {\n  float: footnote;\n}\n\n.table-cell-container {\n  display: block;\n}\n\n]]></style>\n</head>\n<body>\n\n<s:template id="footnote"><s:content/><s:include class="footnote-content"/></s:template>\n\n<s:template id="table-cell"><div data-vivliostyle-flow-root="true" class="table-cell-container"><s:content/></div></s:template>\n\n</body>\n</html>\n')),l(t,i.type).then(function(o){if(o.status>=400&&e)throw new Error((n||"Failed to fetch required resource: "+t)+" ("+o.status+(o.statusText?" "+o.statusText:"")+")");s?(t+="?viv-toc-box",o.url+="?viv-toc-box"):c&&(o.url=t=u),i.parser(o,i).then(function(e){delete i.fetchers[t],i.resources[t]=e,r.finish(e)})}),r.result()},t.prototype.fetch=function(t,e,n){if(t=o.I(t),this.resources[t])return null;var i=this.fetchers[t];if(!i){var r=this;i=new s.a(function(){return r.fetchInner(t,e,n)},"Fetch "+t),r.fetchers[t]=i,i.start()}return i},t.prototype.get=function(t){return this.resources[o.I(t)]},t.prototype.delete=function(t){delete this.resources[o.I(t)]},t}();function f(t,e){var n=t.responseText;return a.d(n?o.H(n):null)}function d(){return new p(f,i.TEXT)}},function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"c",function(){return s}),n.d(e,"b",function(){return l});var i=n(1),o=n(6),r=n(3),a=function(){function t(t,e){this.fetch=t,this.arrived=!1,this.resource=null,this.task=null,this.piggybacks=[],this.name=e}return t.prototype.start=function(){if(!this.task){var t=this;this.task=r.a().getScheduler().run(function(){var e=r.c("Fetcher.run");return t.fetch().then(function(n){var i=t.piggybacks;if(t.arrived=!0,t.resource=n,t.task=null,t.piggybacks=[],i)for(var r=0;r<i.length;r++)try{i[r](n)}catch(t){o.b.error(t,"Error:")}e.finish(n)}),e.result()},this.name)}},t.prototype.piggyback=function(t){this.arrived?t(this.resource):this.piggybacks.push(t)},t.prototype.get=function(){return this.arrived?r.d(this.resource):(this.start(),this.task.join())},t.prototype.hasArrived=function(){return this.arrived},t}(),s=function(t){if(0==t.length)return r.d(!0);if(1==t.length)return t[0].get().thenReturn(!0);var e=r.c("waitForFetches"),n=0;return e.loop(function(){for(;n<t.length;){var e=t[n++];if(!e.hasArrived())return e.get().thenReturn(!0)}return r.d(!1)}).then(function(){e.finish(!0)}),e.result()};function l(t,e){var n=null,o=null;"img"==t.localName&&(n=t.getAttribute("width"),o=t.getAttribute("height"));var s=new a(function(){var a=r.c("loadImage"),s=a.suspend(t),l=!1,u=function(e){l||(l=!0,"img"==t.localName&&(n||t.removeAttribute("width"),o||t.removeAttribute("height")),s.schedule(e?e.type:"timeout"))};return t.addEventListener("load",u,!1),t.addEventListener("error",u,!1),t.addEventListener("abort",u,!1),t.namespaceURI==i.a.SVG?(t.setAttributeNS(i.a.XLINK,"xlink:href",e),setTimeout(u,300)):t.src=e,a.result()},"loadElement "+e);return s.start(),s}},function(t,e,n){"use strict";n.d(e,"c",function(){return u}),n.d(e,"b",function(){return c}),n.d(e,"a",function(){return h}),n.d(e,"d",function(){return p}),n.d(e,"e",function(){return f});var i=n(22),o=n(24),r=n(14),a=n(9),s=n(3),l=n(15),u=function(){function t(){}return t.prototype.find=function(t){for(var e=a.b(a.a.RESOLVE_LAYOUT_PROCESSOR),n=0;n<e.length;n++){var i=e[n](t);if(i)return i}throw new Error("No processor found for a formatting context: "+t.getName())},t}(),c=function(){function t(){}return t.prototype.layout=function(t,e,n){return e.isFloatNodeContext(t)?e.layoutFloatOrFootnote(t):e.isBreakable(t)?e.layoutBreakableBlock(t):e.layoutUnbreakable(t)},t.prototype.createEdgeBreakPosition=function(t,e,n,o){return new i.b(t.copy(),e,n,o)},t.prototype.startNonInlineElementNode=function(t){return!1},t.prototype.afterNonInlineElementNode=function(t,e){return!1},t.prototype.clearOverflownViewNodes=function(t,e,n,i){if(n.viewNode&&n.viewNode.parentNode){var o=n.viewNode.parentNode;r.f(o,n.viewNode),i&&o.removeChild(n.viewNode)}},t.prototype.finishBreak=function(t,e,n,i){var o=n||null!=e.viewNode&&1==e.viewNode.nodeType&&!e.after;return t.clearOverflownViewNodes(e,o),i&&(t.fixJustificationIfNeeded(e,!0),t.layoutContext.processFragmentedBlockEdge(o?e:e.parent)),s.d(!0)},t}(),h=function(){function t(t){this.parent=t,this.formattingContextType="Block"}return t.prototype.getName=function(){return"Block formatting context (BlockFormattingContext)"},t.prototype.isFirstTime=function(t,e){return e},t.prototype.getParent=function(){return this.parent},t.prototype.saveState=function(){},t.prototype.restoreState=function(t){},t}(),p=new c,f=l.a.isInstanceOfBlockFormattingContext;a.d(a.a.RESOLVE_FORMATTING_CONTEXT,function(t,e,n,i,r,a){var s=t.parent;return!s&&t.formattingContext?null:s&&t.formattingContext!==s.formattingContext?null:t.establishesBFC||!t.formattingContext&&o.d(n,i,r,a)?new h(s?s.formattingContext:null):null}),a.d(a.a.RESOLVE_LAYOUT_PROCESSOR,function(t){return t instanceof h?p:null})},function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return r});var i,o=n(1);function r(t,e,n){var r={display:e.style.display,position:e.style.position,width:e.style.width,maxWidth:e.style.maxWidth,minWidth:e.style.minWidth,height:e.style.height,maxHeight:e.style.maxHeight,minHeight:e.style.minHeight},a=e.ownerDocument,s=e.parentNode,l=a.createElement("div");function u(n){return t.getElementComputedStyle(e).getPropertyValue(n)}o.F(l,"position",r.position),s.insertBefore(l,e),l.appendChild(e),o.F(e,"width","auto"),o.F(e,"max-width","none"),o.F(e,"min-width","0"),o.F(e,"height","auto"),o.F(e,"max-height","none"),o.F(e,"min-height","0");var c=o.v("writing-mode"),h=(c?u(c[0]):null)||u("writing-mode"),p="vertical-rl"===h||"tb-rl"===h||"vertical-lr"===h||"tb-lr"===h,f=p?"height":"width",d=p?"width":"height";function g(){return o.F(e,"display","block"),o.F(e,"position","static"),u(f)}function m(){o.F(e,"display","inline-block"),o.F(l,f,"99999999px");var t=u(f);return o.F(l,f,""),t}function v(){o.F(e,"display","inline-block"),o.F(l,f,"0");var t=u(f);return o.F(l,f,""),t}function y(){var t=g(),e=v(),n=parseFloat(t);if(n<=parseFloat(e))return e;var i=m();return n<=parseFloat(i)?t:i}function b(){return u(d)}function w(){throw new Error("Getting fill-available block size is not implemented")}var E={};return n.forEach(function(t){var n;switch(t){case i.FILL_AVAILABLE_INLINE_SIZE:n=g();break;case i.MAX_CONTENT_INLINE_SIZE:n=m();break;case i.MIN_CONTENT_INLINE_SIZE:n=v();break;case i.FIT_CONTENT_INLINE_SIZE:n=y();break;case i.FILL_AVAILABLE_BLOCK_SIZE:n=w();break;case i.MAX_CONTENT_BLOCK_SIZE:case i.MIN_CONTENT_BLOCK_SIZE:case i.FIT_CONTENT_BLOCK_SIZE:n=b();break;case i.FILL_AVAILABLE_WIDTH:n=p?w():g();break;case i.FILL_AVAILABLE_HEIGHT:n=p?g():w();break;case i.MAX_CONTENT_WIDTH:n=p?b():m();break;case i.MAX_CONTENT_HEIGHT:n=p?m():b();break;case i.MIN_CONTENT_WIDTH:n=p?b():v();break;case i.MIN_CONTENT_HEIGHT:n=p?v():b();break;case i.FIT_CONTENT_WIDTH:n=p?b():y();break;case i.FIT_CONTENT_HEIGHT:n=p?y():b()}E[t]=parseFloat(n),o.F(e,"position",r.position),o.F(e,"display",r.display)}),o.F(e,"width",r.width),o.F(e,"max-width",r.maxWidth),o.F(e,"min-width",r.minWidth),o.F(e,"height",r.height),o.F(e,"max-height",r.maxHeight),o.F(e,"min-height",r.minHeight),s.insertBefore(e,l),s.removeChild(l),E}!function(t){t.FILL_AVAILABLE_INLINE_SIZE="fill-available inline size",t.FILL_AVAILABLE_BLOCK_SIZE="fill-available block size",t.FILL_AVAILABLE_WIDTH="fill-available width",t.FILL_AVAILABLE_HEIGHT="fill-available height",t.MAX_CONTENT_INLINE_SIZE="max-content inline size",t.MAX_CONTENT_BLOCK_SIZE="max-content block size",t.MAX_CONTENT_WIDTH="max-content width",t.MAX_CONTENT_HEIGHT="max-content height",t.MIN_CONTENT_INLINE_SIZE="min-content inline size",t.MIN_CONTENT_BLOCK_SIZE="min-content block size",t.MIN_CONTENT_WIDTH="min-content width",t.MIN_CONTENT_HEIGHT="min-content height",t.FIT_CONTENT_INLINE_SIZE="fit-content inline size",t.FIT_CONTENT_BLOCK_SIZE="fit-content block size",t.FIT_CONTENT_WIDTH="fit-content width",t.FIT_CONTENT_HEIGHT="fit-content height"}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"d",function(){return u}),n.d(e,"c",function(){return h}),n.d(e,"e",function(){return f}),n.d(e,"b",function(){return g}),n.d(e,"a",function(){return m});var i,o=n(0),r=n(11),a=n(6),s=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t){function e(){var e=t.call(this)||this;return e.propSet={},e}return s(e,t),e.prototype.visitIdent=function(t){return this.propSet[t.name]=!0,t},e.prototype.visitSpaceList=function(t){return this.visitValues(t.values),t},e}(o.m);function u(t){if(t){var e=new l;try{return t.visit(e),e.propSet}catch(t){a.b.warn(t,"toSet:")}}return{}}var c=function(t){function e(e){var n=t.call(this)||this;return n.value=e,n}return s(e,t),e.prototype.visitInt=function(t){return this.value=t.num,t},e}(o.m);function h(t,e){if(t){var n=new c(e);try{return t.visit(n),n.value}catch(t){a.b.warn(t,"toInt: ")}}return e}var p=function(t){function e(){var e=t.call(this)||this;return e.collect=!1,e.coords=[],e.name=null,e}return s(e,t),e.prototype.visitNumeric=function(t){return this.collect&&this.coords.push(t),null},e.prototype.visitNum=function(t){return this.collect&&0==t.num&&this.coords.push(new o.i(0,"px")),null},e.prototype.visitSpaceList=function(t){return this.visitValues(t.values),null},e.prototype.visitFunc=function(t){return this.collect||(this.collect=!0,this.visitValues(t.values),this.collect=!1,this.name=t.name.toLowerCase()),null},e.prototype.getShape=function(t,e,n,i,o){var a=this;if(this.coords.length>0){var s=[];switch(this.coords.forEach(function(t,e){if("%"==t.unit){var r=e%2==0?n:i;3==e&&"circle"==a.name&&(r=Math.sqrt((n*n+i*i)/2)),s.push(t.num*r/100)}else s.push(t.num*o.queryUnitSize(t.unit,!1))}),this.name){case"polygon":if(s.length%2==0){for(var l=[],u=0;u<s.length;u+=2)l.push(new r.b(t+s[u],e+s[u+1]));return new r.d(l)}break;case"rectangle":if(4==s.length)return r.k(t+s[0],e+s[1],t+s[0]+s[2],e+s[1]+s[3]);break;case"ellipse":if(4==s.length)return r.j(t+s[0],e+s[1],s[2],s[3]);break;case"circle":if(3==s.length)return r.j(t+s[0],e+s[1],s[2],s[2])}}return null},e}(o.m);function f(t,e,n,i,o,s){if(t){var l=new p;try{return t.visit(l),l.getShape(e,n,i,o,s)}catch(t){a.b.warn(t,"toShape:")}}return r.k(e,n,e+i,n+o)}var d=function(t){function e(e){var n=t.call(this)||this;return n.reset=e,n.counters={},n.name=null,n}return s(e,t),e.prototype.visitIdent=function(t){return this.name=t.toString(),this.reset?this.counters[this.name]=0:this.counters[this.name]=(this.counters[this.name]||0)+1,t},e.prototype.visitInt=function(t){return this.name&&(this.counters[this.name]+=t.num-(this.reset?0:1)),t},e.prototype.visitSpaceList=function(t){return this.visitValues(t.values),t},e}(o.m);function g(t,e){var n=new d(e);try{t.visit(n)}catch(t){a.b.warn(t,"toCounters:")}return n.counters}var m=function(t){function e(e,n){var i=t.call(this)||this;return i.baseUrl=e,i.transformer=n,i}return s(e,t),e.prototype.visitURL=function(t){return new o.l(this.transformer.transformURL(t.url,this.baseUrl))},e}(o.d)},function(t,e,n){"use strict";n.d(e,"c",function(){return s}),n.d(e,"e",function(){return l}),n.d(e,"a",function(){return u}),n.d(e,"d",function(){return c}),n.d(e,"f",function(){return h}),n.d(e,"b",function(){return p});var i=n(1),o=n(0),r=n(5),a=n(8),s=(new DOMParser).parseFromString('<root xmlns="'+i.a.SHADOW+'"/>',"text/xml"),l=["footnote-marker","first-5-lines","first-4-lines","first-3-lines","first-2-lines","first-line","first-letter","before","","after"],u="data-adapt-pseudo";function c(t){return t.getAttribute(u)||""}function h(t,e){t.setAttribute(u,e)}var p=function(){function t(t,e,n,i,o){this.element=t,this.style=e,this.styler=n,this.context=i,this.exprContentListener=o,this.contentProcessed={}}return t.prototype.getStyle=function(t,e){var n=c(t);this.styler&&n&&n.match(/after$/)&&(this.style=this.styler.getStyle(this.element,!0),this.styler=null);var i=r.u(this.style,"_pseudos")[n]||{};if(n.match(/^first-/)&&!i["x-first-pseudo"]){var a=1,s=void 0;"first-letter"==n?a=0:null!=(s=n.match(/^first-([0-9]+)-lines$/))&&(a=s[1]-0),i["x-first-pseudo"]=new r.c(new o.g(a),0)}return i},t.prototype.processContent=function(t,e){var n=c(t);if(!this.contentProcessed[n]){this.contentProcessed[n]=!0;var i=e.content;i&&a.y(i)&&i.visit(new a.c(t,this.context,i,this.exprContentListener))}},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return l}),n.d(e,"c",function(){return u}),n.d(e,"b",function(){return c});var i,o=n(13),r=n(14),a=n(15),s=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(){function t(){}return t.prototype.calculateOffset=function(t){return u(this.getNodeContext(),t.collectElementsOffset())},t.prototype.breakPositionChosen=function(t){},t.prototype.getNodeContext=function(){return null},t}();function u(t,e){return{current:e.reduce(function(e,n){return e+n.calculateOffset(t)},0),minimum:e.reduce(function(e,n){return e+n.calculateMinimumOffset(t)},0)}}var c=function(t){function e(e,n,i,o){var r=t.call(this)||this;return r.position=e,r.breakOnEdge=n,r.overflows=i,r.computedBlockSize=o,r.isEdgeUpdated=!1,r.edge=0,r.overflowIfRepetitiveElementsDropped=i,r}return s(e,t),e.prototype.findAcceptableBreak=function(t,e){return this.updateOverflows(t),e<this.getMinBreakPenalty()?null:t.findEdgeBreakPosition(this)},e.prototype.getMinBreakPenalty=function(){if(!this.isEdgeUpdated)throw new Error("EdgeBreakPosition.prototype.updateEdge not called");var t=this.isFirstContentOfRepetitiveElementsOwner()&&!this.overflowIfRepetitiveElementsDropped;return(o.b(this.breakOnEdge)?1:0)+(this.overflows&&!t?3:0)+(this.position.parent?this.position.parent.breakPenalty:0)},e.prototype.updateEdge=function(t){var e=t.calculateClonedPaddingBorder(this.position);this.edge=r.a(this.position,t.clientLayout,0,t.vertical)+e,this.isEdgeUpdated=!0},e.prototype.updateOverflows=function(t){this.isEdgeUpdated||this.updateEdge(t);var e=this.edge,n=this.calculateOffset(t);this.overflowIfRepetitiveElementsDropped=t.isOverflown(e+(t.vertical?-1:1)*n.minimum),this.overflows=this.position.overflow=t.isOverflown(e+(t.vertical?-1:1)*n.current)},e.prototype.getNodeContext=function(){return this.position},e.prototype.isFirstContentOfRepetitiveElementsOwner=function(){var t=this.getNodeContext();if(!t||!t.parent)return!1;var e=t.parent.formattingContext;if(!a.c.isInstanceOfRepetitiveElementsOwnerFormattingContext(e))return!1;var n=e.getRepetitiveElements();return!!n&&n.isFirstContentNode(t)},e}(l)},function(t,e,n){"use strict";n.r(e),n.d(e,"LayoutIteratorStrategy",function(){return c}),n.d(e,"LayoutIterator",function(){return h}),n.d(e,"EdgeSkipper",function(){return p}),n.d(e,"PseudoColumn",function(){return f});var i,o=n(13),r=n(22),a=n(30),s=n(3),l=n(8),u=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(){function t(){}return t.prototype.initialState=function(t){return{nodeContext:t,atUnforcedBreak:!1,break:!1}},t.prototype.startNonDisplayableNode=function(t){},t.prototype.afterNonDisplayableNode=function(t){},t.prototype.startIgnoredTextNode=function(t){},t.prototype.afterIgnoredTextNode=function(t){},t.prototype.startNonElementNode=function(t){},t.prototype.afterNonElementNode=function(t){},t.prototype.startInlineElementNode=function(t){},t.prototype.afterInlineElementNode=function(t){},t.prototype.startNonInlineElementNode=function(t){},t.prototype.afterNonInlineElementNode=function(t){},t.prototype.finish=function(t){},t}(),h=function(){function t(t,e){this.strategy=t,this.layoutContext=e}return t.prototype.iterate=function(t){var e=this,n=this.strategy,i=n.initialState(t),o=s.c("LayoutIterator");return o.loopWithFrame(function(t){for(var o;i.nodeContext;){var r=((o=i.nodeContext.viewNode?1!==i.nodeContext.viewNode.nodeType?l.p(i.nodeContext.viewNode,i.nodeContext.whitespace)?i.nodeContext.after?n.afterIgnoredTextNode(i):n.startIgnoredTextNode(i):i.nodeContext.after?n.afterNonElementNode(i):n.startNonElementNode(i):i.nodeContext.inline?i.nodeContext.after?n.afterInlineElementNode(i):n.startInlineElementNode(i):i.nodeContext.after?n.afterNonInlineElementNode(i):n.startNonInlineElementNode(i):i.nodeContext.after?n.afterNonDisplayableNode(i):n.startNonDisplayableNode(i))&&o.isPending()?o:s.d(!0)).thenAsync(function(){return i.break?s.d(null):e.layoutContext.nextInTree(i.nodeContext,i.atUnforcedBreak)});if(r.isPending())return void r.then(function(e){i.break?t.breakLoop():(i.nodeContext=e,t.continueLoop())});if(i.break)return void t.breakLoop();i.nodeContext=r.get()}n.finish(i),t.breakLoop()}).then(function(){o.finish(i.nodeContext)}),o.result()},t}(),p=function(t){function e(e){var n=t.call(this)||this;return n.leadingEdge=e,n}return u(e,t),e.prototype.startNonInlineBox=function(t){},e.prototype.endEmptyNonInlineBox=function(t){},e.prototype.endNonInlineBox=function(t){},e.prototype.initialState=function(t){return{nodeContext:t,atUnforcedBreak:!!this.leadingEdge&&t.after,break:!1,leadingEdge:this.leadingEdge,breakAtTheEdge:null,onStartEdges:!1,leadingEdgeContexts:[],lastAfterNodeContext:null}},e.prototype.processForcedBreak=function(t,e){var n=!t.leadingEdge&&o.c(t.breakAtTheEdge);if(n){var i=t.nodeContext=t.leadingEdgeContexts[0]||t.nodeContext;i.viewNode.parentNode.removeChild(i.viewNode),e.pageBreakType=t.breakAtTheEdge}return n},e.prototype.saveEdgeAndProcessOverflow=function(t,e){var n=e.checkOverflowAndSaveEdgeAndBreakPosition(t.lastAfterNodeContext,null,!0,t.breakAtTheEdge);return n&&(t.nodeContext=(t.lastAfterNodeContext||t.nodeContext).modify(),t.nodeContext.overflow=!0),n},e.prototype.processLayoutConstraint=function(t,e,n){var i=t.nodeContext,o=!e.allowLayout(i);return o&&(n.checkOverflowAndSaveEdgeAndBreakPosition(t.lastAfterNodeContext,null,!1,t.breakAtTheEdge),(i=t.nodeContext=i.modify()).overflow=!0),o},e.prototype.startNonElementNode=function(t){t.onStartEdges=!1},e.prototype.startNonInlineElementNode=function(t){return t.leadingEdgeContexts.push(t.nodeContext.copy()),t.breakAtTheEdge=o.d(t.breakAtTheEdge,t.nodeContext.breakBefore),t.onStartEdges=!0,this.startNonInlineBox(t)},e.prototype.afterNonInlineElementNode=function(t){var e;return(t.onStartEdges?((e=this.endEmptyNonInlineBox(t))&&e.isPending()?e:s.d(!0)).thenAsync(function(){return t.break||(t.leadingEdgeContexts=[],t.leadingEdge=!1,t.atUnforcedBreak=!1,t.breakAtTheEdge=null),s.d(!0)}):(e=this.endNonInlineBox(t))&&e.isPending()?e:s.d(!0)).thenAsync(function(){return t.break||(t.onStartEdges=!1,t.lastAfterNodeContext=t.nodeContext.copy(),t.breakAtTheEdge=o.d(t.breakAtTheEdge,t.nodeContext.breakAfter)),s.d(!0)})},e}(c),f=function(){function t(t,e,n){this.startNodeContexts=[],this.column=Object.create(t),this.column.element=e,this.column.layoutContext=t.layoutContext.clone(),this.column.stopAtOverflow=!1,this.column.flowRootFormattingContext=n.formattingContext,this.column.pseudoParent=t;var i=this.column.calculateClonedPaddingBorder(n);this.column.footnoteEdge=this.column.footnoteEdge-i;var o=this;this.column.openAllViews=function(t){return a.b.prototype.openAllViews.call(this,t).thenAsync(function(t){return o.startNodeContexts.push(t.copy()),s.d(t)})}}return t.prototype.layout=function(t,e){return this.column.layout(t,e)},t.prototype.findAcceptableBreakPosition=function(t){var e=this.column.findAcceptableBreakPosition();if(t){var n=this.startNodeContexts[0].copy(),i=new r.b(n,null,n.overflow,0);if(i.findAcceptableBreak(this.column,0),!e.nodeContext)return{breakPosition:i,nodeContext:n}}return e},t.prototype.finishBreak=function(t,e,n){return this.column.finishBreak(t,e,n)},t.prototype.doFinishBreakOfFragmentLayoutConstraints=function(t){this.column.doFinishBreakOfFragmentLayoutConstraints(t)},t.prototype.isStartNodeContext=function(t){var e=this.startNodeContexts[0];return e.viewNode===t.viewNode&&e.after===t.after&&e.offsetInNode===t.offsetInNode},t.prototype.isLastAfterNodeContext=function(t){return l.u(t.toNodePosition(),this.column.lastAfterPosition)},t.prototype.getColumnElement=function(){return this.column.element},t.prototype.getColumn=function(){return this.column},t}()},function(t,e,n){"use strict";n.d(e,"e",function(){return r}),n.d(e,"c",function(){return l}),n.d(e,"d",function(){return u}),n.d(e,"f",function(){return c}),n.d(e,"g",function(){return h}),n.d(e,"a",function(){return p}),n.d(e,"b",function(){return f});var i=n(0),o="data-vivliostyle-flow-root";function r(t){return"true"===t.getAttribute(o)}function a(t){var e,n=t.toString();switch(n){case"inline-flex":e="flex";break;case"inline-grid":e="grid";break;case"inline-table":e="table";break;case"inline":case"table-row-group":case"table-column":case"table-column-group":case"table-header-group":case"table-footer-group":case"table-row":case"table-cell":case"table-caption":case"inline-block":e="block";break;default:e=n}return i.r(e)}function s(t){return t===i.t.absolute||t===i.t.fixed}function l(t,e,n,o){return t===i.t.none||(s(e)?(n=i.t.none,t=a(t)):(n&&n!==i.t.none||o)&&(t=a(t))),{display:t,position:e,float:n}}function u(t,e,n,o){return l(t,e,n,o).display===i.t.block}function c(t){switch(t.toString()){case"inline":case"inline-block":case"inline-list-item":case"inline-flex":case"inline-grid":case"ruby":case"inline-table":return!0;default:return!1}}function h(t){switch(t.toString()){case"ruby-base":case"ruby-text":case"ruby-base-container":case"ruby-text-container":return!0;default:return!1}}function p(t,e,n,o,r,a,l){return r=r||a||i.t.horizontal_tb,!!l||!!n&&n!==i.t.none||s(e)||t===i.t.inline_block||t===i.t.table_cell||t===i.t.table_caption||t==i.t.flex||(t===i.t.block||t===i.t.list_item)&&!!o&&o!==i.t.visible||!!a&&r!==a}function f(t){return t===i.t.relative||t===i.t.absolute||t===i.t.fixed}},function(t,e,n){"use strict";n.d(e,"c",function(){return o}),n.d(e,"b",function(){return s}),n.d(e,"a",function(){return l});var i=n(7);function o(t,e,n){return t-=n,0===e?0===t:t%e==0&&t/e>=0}var r=function(){function t(t){this.matchers=t}return t.prototype.matches=function(){return this.matchers.some(function(t){return t.matches()})},t}(),a=function(){function t(t){this.matchers=t}return t.prototype.matches=function(){return this.matchers.every(function(t){return t.matches()})},t}(),s=function(){function t(t,e,n){this.elementOffset=t,this.a=e,this.b=n}return t.registerFragmentIndex=function(e,n,i){var o=t.fragmentIndices;(!o[e]||o[e].priority<=i)&&(o[e]={fragmentIndex:n,priority:i})},t.clearFragmentIndices=function(){t.fragmentIndices={}},t.prototype.matches=function(){var e=t.fragmentIndices[this.elementOffset];return null!=e&&null!=e.fragmentIndex&&o(e.fragmentIndex,this.a,this.b)},t.fragmentIndices={},t}(),l=function(){function t(){}return t.buildViewConditionMatcher=function(t,e){var n=e.split("_");return"NFS"==n[0]?new s(t,parseInt(n[1],10),parseInt(n[2],10)):(i.b("unknown view condition. condition="+e),null)},t.buildAllMatcher=function(t){return new a(t)},t.buildAnyMatcher=function(t){return new r(t)},t}()},function(t,e,n){"use strict";n.d(e,"b",function(){return p}),n.d(e,"e",function(){return f}),n.d(e,"a",function(){return d}),n.d(e,"c",function(){return y}),n.d(e,"d",function(){return b});var i,o=n(7),r=n(1),a=n(14),s=n(25),l=n(21),u=n(3),c=n(8),h=n(15),p=h.d.isInstanceOfAfterIfContinuesLayoutConstraint,f=s.b.registerFragmentIndex;s.b.clearFragmentIndices,Promise.resolve().then(n.bind(null,23)).then(function(t){i=t});var d=function(){function t(t,e){this.sourceNode=t,this.styler=e}return t.prototype.createElement=function(t,e){var n=this;if(!i)throw new Error("layoututil module is required but not be imported.");var o=e.viewNode.ownerDocument.createElement("div"),a=new i.PseudoColumn(t,o,e),s=a.getColumn().pageBreakType;return a.getColumn().pageBreakType=null,a.layout(this.createNodePositionForPseudoElement(),!0).thenAsync(function(){n.styler.contentProcessed["after-if-continues"]=!1,a.getColumn().pageBreakType=s;var t=o.firstChild;return r.F(t,"display","block"),u.d(t)})},t.prototype.createNodePositionForPseudoElement=function(){var t=l.c.createElementNS(r.a.XHTML,"div");l.f(t,"after-if-continues");var e=this.createShadowContext(t),n={steps:[{node:t,shadowType:e.type,shadowContext:e,nodeShadow:null,shadowSibling:null}],offsetInNode:0,after:!1,preprocessedTextContent:null};return new c.a(n)},t.prototype.createShadowContext=function(t){return new c.n(this.sourceNode,t,null,null,null,h.f.ShadowType.ROOTED,this.styler)},t}(),g=function(){function t(t,e,n){this.nodeContext=t,this.afterIfContinues=e,this.pseudoElementHeight=n,this.flagmentLayoutConstraintType="AfterIfContinue"}return t.prototype.allowLayout=function(t,e,n){return!(e&&!t||t&&t.overflow)},t.prototype.nextCandidate=function(t){return!1},t.prototype.postLayout=function(t,e,n,i){},t.prototype.finishBreak=function(t,e){var n=this;return this.getRepetitiveElements().affectTo(t)?this.afterIfContinues.createElement(e,this.nodeContext).thenAsync(function(t){return n.nodeContext.viewNode.appendChild(t),u.d(!0)}):u.d(!0)},t.prototype.getRepetitiveElements=function(){return new m(this.nodeContext,this.pseudoElementHeight)},t.prototype.equalsTo=function(e){return e instanceof t&&this.afterIfContinues==e.afterIfContinues},t.prototype.getPriorityOfFinishBreak=function(){return 9},t}(),m=function(){function t(t,e){this.nodeContext=t,this.pseudoElementHeight=e}return t.prototype.calculateOffset=function(t){return this.affectTo(t)?this.pseudoElementHeight:0},t.prototype.calculateMinimumOffset=function(t){return this.calculateOffset(t)},t.prototype.affectTo=function(t){if(!t)return!1;var e=t.shadowContext?t.shadowContext.owner:t.sourceNode;if(e===this.nodeContext.sourceNode)return!!t.after;for(var n=e.parentNode;n;n=n.parentNode)if(n===this.nodeContext.sourceNode)return!0;return!1},t}();function v(t,e){if(!t||!t.afterIfContinues||t.after||e.isFloatNodeContext(t))return u.d(t);var n=t.afterIfContinues;return n.createElement(e,t).thenAsync(function(i){o.a(null!==t);var r=function(t,e,n){var i=t.viewNode;i.appendChild(n);var o=a.b(n,e,t.vertical);return i.removeChild(n),o}(t,e,i);return e.fragmentLayoutConstraints.push(new g(t,n,r)),u.d(t)})}function y(t,e){return t.thenAsync(function(t){return v(t,e)})}function b(t,e){var n=u.c("processAfterIfContinuesOfAncestors"),i=t;return n.loop(function(){if(null!==i){var t=v(i,e);return i=i.parent,t.thenReturn(!0)}return u.d(!1)}).then(function(){n.finish(!0)}),n.result()}},function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"d",function(){return a}),n.d(e,"b",function(){return s}),n.d(e,"c",function(){return l});var i=n(28),o=n.n(i);function r(t,e){return o()(t,e,0)}function a(t){return t.reduce(function(t,e){return e[0]===o.a.DELETE?t:t+e[1]},"")}function s(t,e){return u(t,e,1)}function l(t,e){return u(t,e,-1)}function u(t,e,n){var i=0,r=0;return t.some(function(t){for(var a=0;a<t[1].length;a++){switch(t[0]*n){case o.a.INSERT:i++;break;case o.a.DELETE:i--,r++;break;case o.a.EQUAL:r++}if(r>e)return!0}return!1}),Math.max(Math.min(e,r-1)+i,0)}},function(t,e){var n=-1,i=1,o=0;function r(t,e,u,c){if(t===e)return t?[[o,t]]:[];if(null!=u){var d=function(t,e,n){var i="number"==typeof n?{index:n,length:0}:n.oldRange,o="number"==typeof n?null:n.newRange,r=t.length,a=e.length;if(0===i.length&&(null===o||0===o.length)){var s=i.index,l=t.slice(0,s),u=t.slice(s),c=o?o.index:null,h=s+a-r;if((null===c||c===h)&&!(h<0||h>a)){var p=e.slice(0,h);if((w=e.slice(h))===u){var d=Math.min(s,h),g=l.slice(0,d),m=p.slice(0,d);if(g===m){var v=l.slice(d),y=p.slice(d);return f(g,v,y,u)}}}if(null===c||c===s){var b=s,w=(p=e.slice(0,b),e.slice(b));if(p===l){var E=Math.min(r-b,a-b),S=u.slice(u.length-E),N=w.slice(w.length-E);if(S===N)return f(l,v=u.slice(0,u.length-E),y=w.slice(0,w.length-E),S)}}}return i.length>0&&o&&0===o.length&&(g=t.slice(0,i.index),S=t.slice(i.index+i.length),!(a<(d=g.length)+(E=S.length))&&(m=e.slice(0,d),N=e.slice(a-E),g===m&&S===N))?f(g,v=t.slice(d,r-E),y=e.slice(d,a-E),S):null}(t,e,u);if(d)return d}var g=s(t,e),m=t.substring(0,g);g=l(t=t.substring(g),e=e.substring(g));var v=t.substring(t.length-g),y=function(t,e){var u;if(!t)return[[i,e]];if(!e)return[[n,t]];var c=t.length>e.length?t:e,h=t.length>e.length?e:t,p=c.indexOf(h);if(-1!==p)return u=[[i,c.substring(0,p)],[o,h],[i,c.substring(p+h.length)]],t.length>e.length&&(u[0][0]=u[2][0]=n),u;if(1===h.length)return[[n,t],[i,e]];var f=function(t,e){var n=t.length>e.length?t:e,i=t.length>e.length?e:t;if(n.length<4||2*i.length<n.length)return null;function o(t,e,n){for(var i,o,r,a,u=t.substring(n,n+Math.floor(t.length/4)),c=-1,h="";-1!==(c=e.indexOf(u,c+1));){var p=s(t.substring(n),e.substring(c)),f=l(t.substring(0,n),e.substring(0,c));h.length<f+p&&(h=e.substring(c-f,c)+e.substring(c,c+p),i=t.substring(0,n-f),o=t.substring(n+p),r=e.substring(0,c-f),a=e.substring(c+p))}return 2*h.length>=t.length?[i,o,r,a,h]:null}var r,a,u,c,h,p=o(n,i,Math.ceil(n.length/4)),f=o(n,i,Math.ceil(n.length/2));return p||f?(r=f?p&&p[4].length>f[4].length?p:f:p,t.length>e.length?(a=r[0],u=r[1],c=r[2],h=r[3]):(c=r[0],h=r[1],a=r[2],u=r[3]),[a,u,c,h,r[4]]):null}(t,e);if(f){var d=f[0],g=f[1],m=f[2],v=f[3],y=f[4],b=r(d,m),w=r(g,v);return b.concat([[o,y]],w)}return function(t,e){for(var o=t.length,r=e.length,s=Math.ceil((o+r)/2),l=s,u=2*s,c=new Array(u),h=new Array(u),p=0;p<u;p++)c[p]=-1,h[p]=-1;c[l+1]=0,h[l+1]=0;for(var f=o-r,d=f%2!=0,g=0,m=0,v=0,y=0,b=0;b<s;b++){for(var w=-b+g;w<=b-m;w+=2){for(var E=l+w,S=(I=w===-b||w!==b&&c[E-1]<c[E+1]?c[E+1]:c[E-1]+1)-w;I<o&&S<r&&t.charAt(I)===e.charAt(S);)I++,S++;if(c[E]=I,I>o)m+=2;else if(S>r)g+=2;else if(d&&(T=l+f-w)>=0&&T<u&&-1!==h[T]){var N=o-h[T];if(I>=N)return a(t,e,I,S)}}for(var C=-b+v;C<=b-y;C+=2){for(var T=l+C,x=(N=C===-b||C!==b&&h[T-1]<h[T+1]?h[T+1]:h[T-1]+1)-C;N<o&&x<r&&t.charAt(o-N-1)===e.charAt(r-x-1);)N++,x++;if(h[T]=N,N>o)y+=2;else if(x>r)v+=2;else if(!d&&(E=l+f-C)>=0&&E<u&&-1!==c[E]){var I=c[E];if(S=l+I-E,I>=(N=o-N))return a(t,e,I,S)}}}return[[n,t],[i,e]]}(t,e)}(t=t.substring(0,t.length-g),e=e.substring(0,e.length-g));return m&&y.unshift([o,m]),v&&y.push([o,v]),function t(e,r){e.push([o,""]);for(var a,u=0,c=0,f=0,d="",g="";u<e.length;)if(u<e.length-1&&!e[u][1])e.splice(u,1);else switch(e[u][0]){case i:f++,g+=e[u][1],u++;break;case n:c++,d+=e[u][1],u++;break;case o:var m=u-f-c-1;if(r){if(m>=0&&p(e[m][1])){var v=e[m][1].slice(-1);if(e[m][1]=e[m][1].slice(0,-1),d=v+d,g=v+g,!e[m][1]){e.splice(m,1),u--;var y=m-1;e[y]&&e[y][0]===i&&(f++,g=e[y][1]+g,y--),e[y]&&e[y][0]===n&&(c++,d=e[y][1]+d,y--),m=y}}if(h(e[u][1])){v=e[u][1].charAt(0);e[u][1]=e[u][1].slice(1),d+=v,g+=v}}if(u<e.length-1&&!e[u][1]){e.splice(u,1);break}if(d.length>0||g.length>0){d.length>0&&g.length>0&&(0!==(a=s(g,d))&&(m>=0?e[m][1]+=g.substring(0,a):(e.splice(0,0,[o,g.substring(0,a)]),u++),g=g.substring(a),d=d.substring(a)),0!==(a=l(g,d))&&(e[u][1]=g.substring(g.length-a)+e[u][1],g=g.substring(0,g.length-a),d=d.substring(0,d.length-a)));var b=f+c;0===d.length&&0===g.length?(e.splice(u-b,b),u-=b):0===d.length?(e.splice(u-b,b,[i,g]),u=u-b+1):0===g.length?(e.splice(u-b,b,[n,d]),u=u-b+1):(e.splice(u-b,b,[n,d],[i,g]),u=u-b+2)}0!==u&&e[u-1][0]===o?(e[u-1][1]+=e[u][1],e.splice(u,1)):u++,f=0,c=0,d="",g=""}""===e[e.length-1][1]&&e.pop();var w=!1;for(u=1;u<e.length-1;)e[u-1][0]===o&&e[u+1][0]===o&&(e[u][1].substring(e[u][1].length-e[u-1][1].length)===e[u-1][1]?(e[u][1]=e[u-1][1]+e[u][1].substring(0,e[u][1].length-e[u-1][1].length),e[u+1][1]=e[u-1][1]+e[u+1][1],e.splice(u-1,1),w=!0):e[u][1].substring(0,e[u+1][1].length)==e[u+1][1]&&(e[u-1][1]+=e[u+1][1],e[u][1]=e[u][1].substring(e[u+1][1].length)+e[u+1][1],e.splice(u+1,1),w=!0)),u++;w&&t(e,r)}(y,c),y}function a(t,e,n,i){var o=t.substring(0,n),a=e.substring(0,i),s=t.substring(n),l=e.substring(i),u=r(o,a),c=r(s,l);return u.concat(c)}function s(t,e){if(!t||!e||t.charAt(0)!==e.charAt(0))return 0;for(var n=0,i=Math.min(t.length,e.length),o=i,r=0;n<o;)t.substring(r,o)==e.substring(r,o)?r=n=o:i=o,o=Math.floor((i-n)/2+n);return u(t.charCodeAt(o-1))&&o--,o}function l(t,e){if(!t||!e||t.slice(-1)!==e.slice(-1))return 0;for(var n=0,i=Math.min(t.length,e.length),o=i,r=0;n<o;)t.substring(t.length-o,t.length-r)==e.substring(e.length-o,e.length-r)?r=n=o:i=o,o=Math.floor((i-n)/2+n);return c(t.charCodeAt(t.length-o))&&o--,o}function u(t){return t>=55296&&t<=56319}function c(t){return t>=56320&&t<=57343}function h(t){return c(t.charCodeAt(0))}function p(t){return u(t.charCodeAt(t.length-1))}function f(t,e,r,a){return p(t)||h(a)?null:function(t){for(var e=[],n=0;n<t.length;n++)t[n][1].length>0&&e.push(t[n]);return e}([[o,t],[n,e],[i,r],[o,a]])}function d(t,e,n){return r(t,e,n,!0)}d.INSERT=i,d.DELETE=n,d.EQUAL=o,t.exports=d},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(7),o=n(3),r=function(){function t(){this.initialBreakPositions=null,this.initialStateOfFormattingContext=null}return t.prototype.layout=function(t,e){return this.prepareLayout(t,e),this.tryLayout(t,e)},t.prototype.tryLayout=function(t,e){var n=this,r=o.c("AbstractLayoutRetryer.tryLayout");this.saveState(t,e);var a=this.resolveLayoutMode(t);return a.doLayout(t,e).then(function(o){var s=a.accept(o,e);(s=a.postLayout(o,n.initialPosition,e,s))?r.finish(o):(i.a(n.initialPosition),n.clearNodes(n.initialPosition),n.restoreState(t,e),n.tryLayout(n.initialPosition,e).thenFinish(r))}),r.result()},t.prototype.prepareLayout=function(t,e){},t.prototype.clearNodes=function(t){for(var e,n,i=t.viewNode||t.parent.viewNode;e=i.lastChild;)i.removeChild(e);for(;n=i.nextSibling;)n.parentNode.removeChild(n)},t.prototype.saveState=function(t,e){this.initialPosition=t.copy(),this.initialBreakPositions=[].concat(e.breakPositions),this.initialFragmentLayoutConstraints=[].concat(e.fragmentLayoutConstraints),t.formattingContext&&(this.initialStateOfFormattingContext=t.formattingContext.saveState())},t.prototype.restoreState=function(t,e){e.breakPositions=this.initialBreakPositions,e.fragmentLayoutConstraints=this.initialFragmentLayoutConstraints,t.formattingContext&&t.formattingContext.restoreState(this.initialStateOfFormattingContext)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return T}),n.d(e,"b",function(){return P});var i,o=n(7),r=n(1),a=n(13),s=n(22),l=n(0),u=n(27),c=n(11),h=n(14),p=n(18),f=n(29),d=n(6),g=n(12),m=n(9),v=n(26),y=n(31),b=n(19),w=n(3),E=n(8),S=n(15),N=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),C={img:!0,svg:!0,audio:!0,video:!0},T=function(){function t(t){this.constraints=t}return t.prototype.allowLayout=function(t){return this.constraints.every(function(e){return e.allowLayout(t)})},t}(),x=function(t){function e(e,n){var i=t.call(this)||this;return i.checkPoints=e,i.penalty=n,i.alreadyEvaluated=!1,i.breakNodeContext=null,i}return N(e,t),e.prototype.findAcceptableBreak=function(t,e){return e<this.getMinBreakPenalty()?null:(this.alreadyEvaluated||(this.breakNodeContext=t.findBoxBreakPosition(this,e>0),this.alreadyEvaluated=!0),this.breakNodeContext)},e.prototype.getMinBreakPenalty=function(){return this.penalty},e.prototype.getNodeContext=function(){return this.alreadyEvaluated?this.breakNodeContext:this.checkPoints[this.checkPoints.length-1]},e}(s.a);function I(t){switch(t){case"ruby":case"inline-block":case"inline-flex":case"inline-grid":case"inline-list-item":case"inline-table":return!0}return!1}var P=function(t){function e(e,n,i,o,r){var a=t.call(this,e)||this;return a.layoutContext=n,a.clientLayout=i,a.layoutConstraint=o,a.pageFloatLayoutContext=r,a.flowRootFormattingContext=null,a.isFloat=!1,a.isFootnote=!1,a.startEdge=0,a.endEdge=0,a.beforeEdge=0,a.afterEdge=0,a.footnoteEdge=0,a.box=null,a.chunkPositions=null,a.bands=null,a.overflown=!1,a.breakPositions=null,a.pageBreakType=null,a.forceNonfitting=!0,a.leftFloatEdge=0,a.rightFloatEdge=0,a.bottommostFloatTop=0,a.stopAtOverflow=!0,a.lastAfterPosition=null,a.fragmentLayoutConstraints=[],a.pseudoParent=null,a.nodeContextOverflowingDueToRepetitiveElements=null,a.blockDistanceToBlockEndFloats=NaN,a.last=e.lastChild,a.viewDocument=e.ownerDocument,r.setContainer(a),a}return N(e,t),e.prototype.getTopEdge=function(){return this.vertical?this.startEdge:this.beforeEdge},e.prototype.getBottomEdge=function(){return this.vertical?this.endEdge:this.afterEdge},e.prototype.getLeftEdge=function(){return this.vertical?this.afterEdge:this.startEdge},e.prototype.getRightEdge=function(){return this.vertical?this.beforeEdge:this.endEdge},e.prototype.isFloatNodeContext=function(t){return!(!t.floatSide||this.isFloat&&!t.parent)},e.prototype.stopByOverflow=function(t){return this.stopAtOverflow&&!!t&&t.overflow},e.prototype.isOverflown=function(t){return this.vertical?t<this.footnoteEdge:t>this.footnoteEdge},e.prototype.getExclusions=function(){var t=this.pageFloatLayoutContext.getFloatFragmentExclusions();return this.exclusions.concat(t)},e.prototype.openAllViews=function(t){var e=this,n=w.c("openAllViews"),i=t.steps;e.layoutContext.setViewRoot(e.element,e.isFootnote);var r=i.length-1,a=null;return n.loop(function(){for(;r>=0;){var n=a,o=i[r];if(a=E.v(o,n),r!==i.length-1||a.formattingContext||(a.formattingContext=e.flowRootFormattingContext),0==r&&(a.offsetInNode=e.calculateOffsetInNodeForNodeContext(t),a.after=t.after,a.preprocessedTextContent=t.preprocessedTextContent,a.after))break;var s=e.layoutContext.setCurrent(a,0==r&&0==a.offsetInNode);if(r--,s.isPending())return s}return w.d(!1)}).then(function(){o.a(a),n.finish(a)}),n.result()},e.prototype.calculateOffsetInNodeForNodeContext=function(t){return t.preprocessedTextContent?u.b(t.preprocessedTextContent,t.offsetInNode):t.offsetInNode},e.prototype.maybePeelOff=function(t,e){if(t.firstPseudo&&t.inline&&!t.after&&0==t.firstPseudo.count&&1!=t.viewNode.nodeType){var n=t.viewNode.textContent.match(O);return this.layoutContext.peelOff(t,n[0].length)}return w.d(t)},e.prototype.buildViewToNextBlockEdge=function(t,e){var n=this,i=!1,o=w.c("buildViewToNextBlockEdge");return o.loopWithFrame(function(o){t.viewNode&&!h.e(t)&&e.push(t.copy()),n.maybePeelOff(t,0).then(function(r){r!==t&&(t=r,h.e(t)||e.push(t.copy())),n.nextInTree(t).then(function(e){(t=e)?(!i&&n.layoutConstraint.allowLayout(t)||(i=!0,(t=t.modify()).overflow=!0),n.isFloatNodeContext(t)&&!n.vertical?n.layoutFloatOrFootnote(t).then(function(e){t=e,n.pageFloatLayoutContext.isInvalidated()&&(t=null),t?o.continueLoop():o.breakLoop()}):t.inline?o.continueLoop():o.breakLoop()):o.breakLoop()})})}).then(function(){o.finish(t)}),o.result()},e.prototype.nextInTree=function(t,e){var n=this.layoutContext.nextInTree(t,e);return v.c(n,this)},e.prototype.buildDeepElementView=function(t){if(!t.viewNode)return w.d(t);var e=[],n=t.sourceNode,i=this,o=w.c("buildDeepElementView");return o.loopWithFrame(function(o){t.viewNode&&t.inline&&!h.e(t)?e.push(t.copy()):(e.length>0&&i.postLayoutBlock(t,e),e=[]),i.maybePeelOff(t,0).then(function(r){var a=r;if(a!==t){for(var s=a;s&&s.sourceNode!=n;)s=s.parent;if(null==s)return t=a,void o.breakLoop();h.e(a)||e.push(a.copy())}i.nextInTree(a).then(function(e){(t=e)&&t.sourceNode!=n?i.layoutConstraint.allowLayout(t)?o.continueLoop():((t=t.modify()).overflow=!0,i.stopAtOverflow?o.breakLoop():o.continueLoop()):o.breakLoop()})})}).then(function(){e.length>0&&i.postLayoutBlock(t,e),o.finish(t)}),o.result()},e.prototype.createFloat=function(t,e,n,i){var o=this.viewDocument.createElement("div");return this.vertical?(i>=this.height&&(i-=.1),r.F(o,"height",n+"px"),r.F(o,"width",i+"px")):(n>=this.width&&(n-=.1),r.F(o,"width",n+"px"),r.F(o,"height",i+"px")),r.F(o,"float",e),r.F(o,"clear",e),this.element.insertBefore(o,t),o},e.prototype.killFloats=function(){for(var t=this.element.firstChild;t;){var e=t.nextSibling;if(1==t.nodeType){var n=t,i=n.style.cssFloat;if("left"!=i&&"right"!=i)break;this.element.removeChild(n)}t=e}},e.prototype.createFloats=function(){for(var t=this.element.firstChild,e=this.bands,n=this.vertical?this.getTopEdge():this.getLeftEdge(),i=this.vertical?this.getBottomEdge():this.getRightEdge(),o=0,r=e;o<r.length;o++){var a=r[o],s=a.y2-a.y1;a.left=this.createFloat(t,"left",a.x1-n,s),a.right=this.createFloat(t,"right",i-a.x2,s)}},e.prototype.calculateEdge=function(t,e,n,i){var o;if(t&&h.c(t.viewNode))return NaN;if(t&&t.after&&!t.inline&&(o=h.a(t,this.clientLayout,0,this.vertical),!isNaN(o)))return o;for(var r=i-(t=e[n]).boxOffset;;){if(o=h.a(t,this.clientLayout,r,this.vertical),!isNaN(o))return o;if(r>0)r--;else{if(--n<0)return this.beforeEdge;1!=(t=e[n]).viewNode.nodeType&&(r=t.viewNode.textContent.length)}}},e.prototype.parseComputedLength=function(t){if("number"==typeof t)return t;var e=t.match(/^(-?[0-9]*(\.[0-9]*)?)px$/);return e?parseFloat(e[0]):0},e.prototype.getComputedMargin=function(t){var e=this.clientLayout.getElementComputedStyle(t),n=new c.a(0,0,0,0);return e&&(n.left=this.parseComputedLength(e.marginLeft),n.top=this.parseComputedLength(e.marginTop),n.right=this.parseComputedLength(e.marginRight),n.bottom=this.parseComputedLength(e.marginBottom)),n},e.prototype.getComputedPaddingBorder=function(t){var e=this.clientLayout.getElementComputedStyle(t),n=new c.a(0,0,0,0);return e&&(n.left=this.parseComputedLength(e.borderLeftWidth)+this.parseComputedLength(e.paddingLeft),n.top=this.parseComputedLength(e.borderTopWidth)+this.parseComputedLength(e.paddingTop),n.right=this.parseComputedLength(e.borderRightWidth)+this.parseComputedLength(e.paddingRight),n.bottom=this.parseComputedLength(e.borderBottomWidth)+this.parseComputedLength(e.paddingBottom)),n},e.prototype.getComputedInsets=function(t){var e=this.clientLayout.getElementComputedStyle(t),n=new c.a(0,0,0,0);if(e){if("border-box"==e.boxSizing)return this.getComputedMargin(t);n.left=this.parseComputedLength(e.marginLeft)+this.parseComputedLength(e.borderLeftWidth)+this.parseComputedLength(e.paddingLeft),n.top=this.parseComputedLength(e.marginTop)+this.parseComputedLength(e.borderTopWidth)+this.parseComputedLength(e.paddingTop),n.right=this.parseComputedLength(e.marginRight)+this.parseComputedLength(e.borderRightWidth)+this.parseComputedLength(e.paddingRight),n.bottom=this.parseComputedLength(e.marginBottom)+this.parseComputedLength(e.borderBottomWidth)+this.parseComputedLength(e.paddingBottom)}return n},e.prototype.setComputedInsets=function(t,e){var n=this.clientLayout.getElementComputedStyle(t);n&&(e.marginLeft=this.parseComputedLength(n.marginLeft),e.borderLeft=this.parseComputedLength(n.borderLeftWidth),e.paddingLeft=this.parseComputedLength(n.paddingLeft),e.marginTop=this.parseComputedLength(n.marginTop),e.borderTop=this.parseComputedLength(n.borderTopWidth),e.paddingTop=this.parseComputedLength(n.paddingTop),e.marginRight=this.parseComputedLength(n.marginRight),e.borderRight=this.parseComputedLength(n.borderRightWidth),e.paddingRight=this.parseComputedLength(n.paddingRight),e.marginBottom=this.parseComputedLength(n.marginBottom),e.borderBottom=this.parseComputedLength(n.borderBottomWidth),e.paddingBottom=this.parseComputedLength(n.paddingBottom))},e.prototype.setComputedWidthAndHeight=function(t,e){var n=this.clientLayout.getElementComputedStyle(t);n&&(e.width=this.parseComputedLength(n.width),e.height=this.parseComputedLength(n.height))},e.prototype.layoutUnbreakable=function(t){return this.buildDeepElementView(t)},e.prototype.layoutFloat=function(t){var e=this,n=w.c("layoutFloat"),i=t.viewNode,a=t.floatSide;return r.F(i,"float","none"),r.F(i,"display","inline-block"),r.F(i,"vertical-align","top"),e.buildDeepElementView(t).then(function(s){for(var l=e.clientLayout.getElementClientRect(i),u=e.getComputedMargin(i),h=new c.c(l.left-u.left,l.top-u.top,l.right+u.right,l.bottom+u.bottom),p=e.startEdge,f=e.endEdge,d=t.parent;d&&d.inline;)d=d.parent;if(d){(N=d.viewNode.ownerDocument.createElement("div")).style.left="0px",N.style.top="0px",e.vertical?(N.style.bottom="0px",N.style.width="1px"):(N.style.right="0px",N.style.height="1px"),d.viewNode.appendChild(N);var g=e.clientLayout.getElementClientRect(N);p=Math.max(e.getStartEdge(g),p),f=Math.min(e.getEndEdge(g),f),d.viewNode.removeChild(N);var m=e.vertical?h.y2-h.y1:h.x2-h.x1;"left"==a?f=Math.max(f,p+m):p=Math.min(p,f-m),d.viewNode.appendChild(t.viewNode)}var v=new c.c(p,e.getBoxDir()*e.beforeEdge,f,e.getBoxDir()*e.afterEdge),y=h;e.vertical&&(y=c.i(h));var b=e.getBoxDir();if(y.y1<e.bottommostFloatTop*b){var w=y.y2-y.y1;y.y1=e.bottommostFloatTop*b,y.y2=y.y1+w}c.h(v,e.bands,y,a),e.vertical&&(h=c.m(y));var E,S=e.getComputedInsets(i);r.F(i,"width",h.x2-h.x1-S.left-S.right+"px"),r.F(i,"height",h.y2-h.y1-S.top-S.bottom+"px"),r.F(i,"position","absolute"),o.a(t.display),r.F(i,"display",t.display);var N,C=null;d&&(C=d.containingBlockForAbsolute?d:d.getContainingBlockForAbsolute()),C?((N=C.viewNode.ownerDocument.createElement("div")).style.position="absolute",C.vertical?N.style.right="0":N.style.left="0",N.style.top="0",C.viewNode.appendChild(N),E=e.clientLayout.getElementClientRect(N),C.viewNode.removeChild(N)):E={left:e.getLeftEdge()-e.paddingLeft,right:e.getRightEdge()+e.paddingRight,top:e.getTopEdge()-e.paddingTop},(C?C.vertical:e.vertical)?r.F(i,"right",E.right-h.x2+"px"):r.F(i,"left",h.x1-E.left+"px"),r.F(i,"top",h.y1-E.top+"px"),t.clearSpacer&&(t.clearSpacer.parentNode.removeChild(t.clearSpacer),t.clearSpacer=null);var T=e.vertical?h.x1:h.y2,x=e.vertical?h.x2:h.y1;e.isOverflown(T)&&0!=e.breakPositions.length?((t=t.modify()).overflow=!0,n.finish(t)):(e.killFloats(),v=new c.c(e.getLeftEdge(),e.getTopEdge(),e.getRightEdge(),e.getBottomEdge()),e.vertical&&(v=c.i(v)),c.e(v,e.bands,y,null,a),e.createFloats(),"left"==a?e.leftFloatEdge=T:e.rightFloatEdge=T,e.bottommostFloatTop=x,e.updateMaxReachedAfterEdge(T),n.finish(s))}),n.result()},e.prototype.setupFloatArea=function(t,e,n,i,o,r){var a=this.pageFloatLayoutContext,s=a.getContainer(e),l=t.element;s.element.parentNode.appendChild(l),t.isFloat=!0,t.originX=s.originX,t.originY=s.originY,t.vertical=s.vertical,t.marginLeft=t.marginRight=t.marginTop=t.marginBottom=0,t.borderLeft=t.borderRight=t.borderTop=t.borderBottom=0,t.paddingLeft=t.paddingRight=t.paddingTop=t.paddingBottom=0,t.exclusions=(s.exclusions||[]).concat(),t.forceNonfitting=!a.hasFloatFragments(),t.innerShape=null;var u=s.getPaddingRect();t.setHorizontalPosition(u.x1-s.originX,u.x2-u.x1),t.setVerticalPosition(u.y1-s.originY,u.y2-u.y1),o.adjustPageFloatArea(t,s,this),t.init();var c=!!a.setFloatAreaDimensions(t,e,n,i,!0,!a.hasFloatFragments(),r);return c?(t.killFloats(),t.init()):s.element.parentNode.removeChild(l),c},e.prototype.createPageFloatArea=function(t,e,n,i,o){var a=this.element.ownerDocument.createElement("div");r.F(a,"position","absolute");var s=this.pageFloatLayoutContext.getPageFloatLayoutContext(t.floatReference),l=new g.e(null,g.a.COLUMN,null,this.pageFloatLayoutContext.flowName,t.nodePosition,null,null),u=s.getContainer(),c=new _(e,a,this.layoutContext.clone(),this.clientLayout,this.layoutConstraint,l,u);return l.setContainer(c),this.setupFloatArea(c,t.floatReference,e,n,i,o)?c:null},e.prototype.layoutSinglePageFloatFragment=function(t,e,n,i,r,a,s){var l=this.pageFloatLayoutContext,u=s?s.continuations:[],c=(t=u.concat(t))[0].float,h=l.getPageFloatPlacementCondition(c,e,n),p=this.createPageFloatArea(c,e,a,r,h),f={floatArea:p,pageFloatFragment:null,newPosition:null};if(!p)return w.d(f);var d=w.c("layoutSinglePageFloatFragment"),g=!1,m=0;return d.loopWithFrame(function(e){if(m>=t.length)e.breakLoop();else{var n=t[m],o=new E.a(n.nodePosition);p.layout(o,!0).then(function(t){f.newPosition=t,!t||i?(m++,e.continueLoop()):(g=!0,e.breakLoop())})}}).then(function(){if(!g){o.a(p);var n=l.setFloatAreaDimensions(p,c.floatReference,e,a,!1,i,h);if(n){var s=r.createPageFloatFragment(t,n,p,!!f.newPosition);l.addPageFloatFragment(s,!0),f.pageFloatFragment=s}else g=!0}d.finish(f)}),d.result()},e.prototype.layoutPageFloatInner=function(t,e,n,i){var r=this.pageFloatLayoutContext,a=t.float;function s(e,n){n?r.removePageFloatFragment(n,!0):e&&e.element.parentNode.removeChild(e.element),r.restoreStashedFragments(a.floatReference),r.deferPageFloat(t)}r.stashEndFloatFragments(a);var l=w.c("layoutPageFloatInner"),u=this;return this.layoutSinglePageFloatFragment([t],a.floatSide,a.clearSide,!r.hasFloatFragments(),e,n,i).then(function(t){var e=t.floatArea,n=t.pageFloatFragment,c=t.newPosition;n?u.layoutStashedPageFloats(a.floatReference,[i]).then(function(t){if(t){if(o.a(n),r.addPageFloatFragment(n),r.discardStashedFragments(a.floatReference),c){var i=new g.c(a,c.primary);r.deferPageFloat(i)}l.finish(!0)}else s(e,n),l.finish(!1)}):(s(e,n),l.finish(!1))}),l.result()},e.prototype.layoutStashedPageFloats=function(t,e){var n=this.pageFloatLayoutContext,i=n.getStashedFloatFragments(t),o=[],r=[],a=!1,s=w.c("layoutStashedPageFloats"),l=this,u=0;return s.loopWithFrame(function(t){if(u>=i.length)t.breakLoop();else{var n=i[u];if(e.includes(n))return u++,void t.continueLoop();var s=(new g.f).findByFloat(n.continuations[0].float);l.layoutSinglePageFloatFragment(n.continuations,n.floatSide,null,!1,s,null).then(function(e){var n=e.floatArea;n&&o.push(n);var i=e.pageFloatFragment;i?(r.push(i),u++,t.continueLoop()):(a=!0,t.breakLoop())})}}).then(function(){a?(r.forEach(function(t){n.removePageFloatFragment(t,!0)}),o.forEach(function(t){var e=t.element;e&&e.parentNode&&e.parentNode.removeChild(e)})):i.forEach(function(t){var e=t.area.element;e&&e.parentNode&&e.parentNode.removeChild(e)}),s.finish(!a)}),s.result()},e.prototype.setFloatAnchorViewNode=function(t){var e=t.viewNode.parentNode,n=e.ownerDocument.createElement("span");n.setAttribute(E.m,"1"),"footnote"===t.floatSide&&this.layoutContext.applyPseudoelementStyle(t,"footnote-call",n),e.appendChild(n),e.removeChild(t.viewNode);var i=t.modify();return i.after=!0,i.viewNode=n,i},e.prototype.resolveFloatReferenceFromColumnSpan=function(t,e,n){var i=this,o=w.c("resolveFloatReferenceFromColumnSpan"),r=this.pageFloatLayoutContext,a=r.getPageFloatLayoutContext(g.a.REGION);return r.getContainer().width<a.getContainer().width&&t===g.a.COLUMN?e===l.t.auto?this.buildDeepElementView(n.copy()).then(function(e){var n=e.viewNode,r=b.b(i.clientLayout,n,[b.a.MIN_CONTENT_INLINE_SIZE])[b.a.MIN_CONTENT_INLINE_SIZE],a=i.getComputedMargin(n);i.vertical?r+=a.top+a.bottom:r+=a.left+a.right,r>i.width?o.finish(g.a.REGION):o.finish(t)}):e===l.t.all?o.finish(g.a.REGION):o.finish(t):o.finish(t),o.result()},e.prototype.layoutPageFloat=function(t){var e=this,n=this.pageFloatLayoutContext,i=(new g.f).findByNodeContext(t),r=n.findPageFloatByNodePosition(t.toNodePosition());return(r?w.d(r):i.createPageFloat(t,n,this)).thenAsync(function(r){var a=E.x(t,0),s=e.setFloatAnchorViewNode(t),l=i.findPageFloatFragment(r,n),u=new g.c(r,a);if(l&&l.hasFloat(r))return n.registerPageFloatAnchor(r,s.viewNode),w.d(s);if(n.isForbidden(r)||n.hasPrecedingFloatsDeferredToNext(r))return n.deferPageFloat(u),n.registerPageFloatAnchor(r,s.viewNode),w.d(s);if(e.nodeContextOverflowingDueToRepetitiveElements)return w.d(null);var c=h.a(s,e.clientLayout,0,e.vertical);return e.isOverflown(c)?w.d(s):e.layoutPageFloatInner(u,i,c,l).thenAsync(function(t){return o.a(r),t?w.d(null):(n.registerPageFloatAnchor(r,s.viewNode),w.d(s))})})},e.prototype.createJustificationAdjustmentElement=function(t,e,n,i){var o=e.createElement("span");o.style.visibility="hidden",o.style.verticalAlign="top",o.setAttribute(E.m,"1");var a=e.createElement("span");a.style.fontSize="0",a.style.lineHeight="0",a.textContent=" #",o.appendChild(a),o.style.display="block",o.style.textIndent="0",o.style.textAlign="left",n.insertBefore(o,t);var s=this.clientLayout.getElementClientRect(a);o.style.textAlign="right";var l=this.clientLayout.getElementClientRect(a);o.style.textAlign="",r.j(document.body)?o.style.display="inline":o.style.display="inline-block";var u=i?l.top-s.top:l.left-s.left,c=u>=1?u-1+"px":"100%";return i?o.style.paddingTop=c:o.style.paddingLeft=c,o},e.prototype.addAndAdjustJustificationElement=function(t,e,n,i,o,a){return function(t,e,n,i){if(r.k(document.body)){var o=A(t),a=e?n:n.previousSibling,s=a?a.textContent:"";if(s.charAt(s.length-1)===o){var l=n.ownerDocument,u=n.parentNode;r.l(document.body)?u.insertBefore(l.createTextNode(" "),i):u.insertBefore(l.createElement("wbr"),i)}}}(t,e,n,i),this.createJustificationAdjustmentElement(i,o,a,t.vertical)},e.prototype.compensateJustificationLineHeight=function(t,e,n){var i=this.clientLayout.getElementClientRect(t),o=this.clientLayout.getElementClientRect(e);n.vertical?(e.style.marginRight=o.right-i.right+"px",e.style.width="0px"):(e.style.marginTop=i.top-o.top+"px",e.style.height="0px"),e.setAttribute(E.m,"1")},e.prototype.fixJustificationIfNeeded=function(t,e){if(!t.after||t.inline){if(e){for(var n="",i=t.parent;i&&!n;i=i.parent)!i.inline&&i.viewNode&&(n=i.viewNode.style.textAlign);if("justify"!==n)return}var o=t.viewNode,r=o.ownerDocument,a=e&&(t.after||1!=o.nodeType),s=a?o.nextSibling:o;s&&!s.parentNode&&(s=null);var l=o.parentNode||t.parent&&t.parent.viewNode;if(l){var u=this.addAndAdjustJustificationElement(t,a,o,s,r,l);if(!e){var c=r.createElement("div");l.insertBefore(c,s),this.compensateJustificationLineHeight(u,c,t)}}}},e.prototype.processLineStyling=function(t,e,n){var i=this,o=w.c("processLineStyling"),r=n.concat([]);n.splice(0,n.length);var a=0,s=t.firstPseudo;return 0==s.count&&(s=s.outer),o.loopWithFrame(function(n){if(s){var o=i.findLinePositions(r),l=s.count-a;if(o.length<=l)n.breakLoop();else{var u=i.findAcceptableBreakInside(r,o[l-1],!0);null!=u?i.finishBreak(u,!1,!1).then(function(){a+=l,i.layoutContext.peelOff(u,0).then(function(o){t=o,i.fixJustificationIfNeeded(t,!1),s=t.firstPseudo,r=[],i.buildViewToNextBlockEdge(t,r).then(function(t){e=t,n.continueLoop()})})}):n.breakLoop()}}else n.breakLoop()}).then(function(){Array.prototype.push.apply(n,r),o.finish(e)}),o.result()},e.prototype.isLoneImage=function(t){return!(2!=t.length&&this.breakPositions.length>0)&&t[0].sourceNode==t[1].sourceNode&&C[t[0].sourceNode.localName]},e.prototype.getTrailingMarginEdgeAdjustment=function(t){for(var e=0,n=0,i=t.length-1;i>=0;i--){var o=t[i];if(!o.after||!o.viewNode||1!=o.viewNode.nodeType)break;var r=this.getComputedMargin(o.viewNode),a=this.vertical?-r.left:r.bottom;a>0?e=Math.max(e,a):n=Math.min(n,a)}return e-n},e.prototype.layoutBreakableBlock=function(t){var e=this,n=w.c("layoutBreakableBlock"),i=[];return e.buildViewToNextBlockEdge(t,i).then(function(o){var r=i.length-1;if(r<0)n.finish(o);else{var a=e.calculateEdge(o,i,r,i[r].boxOffset),l=!1;if(!o||!h.c(o.viewNode)){var u=s.c(o,e.collectElementsOffset());l=e.isOverflown(a+(e.vertical?-1:1)*u.minimum),e.isOverflown(a+(e.vertical?-1:1)*u.current)&&!e.nodeContextOverflowingDueToRepetitiveElements&&(e.nodeContextOverflowingDueToRepetitiveElements=o)}null==o&&(a+=e.getTrailingMarginEdgeAdjustment(i)),e.updateMaxReachedAfterEdge(a),(t.firstPseudo?e.processLineStyling(t,o,i):w.d(o)).then(function(t){e.postLayoutBlock(t,i),i.length>0&&(e.saveBoxBreakPosition(i),l&&!e.isLoneImage(i)&&t&&((t=t.modify()).overflow=!0)),n.finish(t)})}}),n.result()},e.prototype.postLayoutBlock=function(t,e){var n=this;m.b(m.a.POST_LAYOUT_BLOCK).forEach(function(i){i(t,e,n)})},e.prototype.findEndOfLine=function(t,e,n){for(var i,o=this.vertical?t-1:t+1,r=0,a=e[0].boxOffset,s=r,l=e.length-1,u=e[l].boxOffset;a<u;){i=a+Math.ceil((u-a)/2),s=r;for(var c=l;s<c;){var h=s+Math.ceil((c-s)/2);e[h].boxOffset>i?c=h-1:s=h}var p=this.calculateEdge(null,e,s,i);if(this.vertical?p<=o:p>=o){for(u=i-1;e[s].boxOffset==i;)s--;l=s}else n&&this.updateMaxReachedAfterEdge(p),a=i,r=s}return{nodeContext:e[s],index:a,checkPointIndex:s}},e.prototype.findAcceptableBreakInside=function(t,e,n){var i=this.findEndOfLine(e,t,!0),o=i.nodeContext,r=o.viewNode;if(1!=r.nodeType){var a=r;o=this.resolveTextNodeBreaker(o).breakTextNode(a,o,i.index,t,i.checkPointIndex,n)}return this.clearOverflownViewNodes(o,!1),o},e.prototype.resolveTextNodeBreaker=function(t){return m.b(m.a.RESOLVE_TEXT_NODE_BREAKER).reduce(function(e,n){return n(t)||e},k.instance)},e.prototype.getRangeBoxes=function(t,e){for(var n=[],i=t.ownerDocument.createRange(),o=!1,r=t,a=null,s=!1,l=!0;l;){var u=!0;do{var c=null;r==e&&(l=1===e.nodeType&&!(!e.firstChild||o)),1!=r.nodeType?(s||(i.setStartBefore(r),s=!0),a=r):o?o=!1:h.d(r)?u=!s:"ruby"==r.localName||I(this.clientLayout.getElementComputedStyle(r).display)?((u=!s)&&(i.setStartBefore(r),s=!0,a=r),r.contains(e)&&(l=!1)):c=r.firstChild,c||(c=r.nextSibling)||(o=!0,c=r.parentNode),r=c}while(u&&l);if(s){i.setEndAfter(a);for(var p=this.clientLayout.getRangeClientRects(i),f=0;f<p.length;f++)n.push(p[f]);s=!1}}return n},e.prototype.findLinePositions=function(t){var e=[],n=this.getRangeBoxes(t[0].viewNode,t[t.length-1].viewNode);n.sort(this.vertical?E.q:E.r);for(var i=0,o=0,a=0,s=0,l=0,u=this.getBoxDir();;){if(l<n.length){var c=n[l],h=1;if(s>0){var p=Math.max(this.getBoxSize(c),1);h=u*this.getBeforeEdge(c)<u*i?u*(this.getAfterEdge(c)-i)/p:u*this.getAfterEdge(c)>u*o?u*(o-this.getBeforeEdge(c))/p:1}if(0==s||h>=.6||h>=.2&&this.getStartEdge(c)>=a-1){a=this.getEndEdge(c),this.vertical?(i=0==s?c.right:Math.max(i,c.right),o=0==s?c.left:Math.min(o,c.left)):(i=0==s?c.top:Math.min(i,c.top),o=0==s?c.bottom:Math.max(o,c.bottom)),s++,l++;continue}}if(s>0&&(e.push(o),s=0),l>=n.length)break}return e.sort(r.B),this.vertical&&e.reverse(),e},e.prototype.calculateClonedPaddingBorder=function(t){var e=this,n=0;return t.walkUpBlocks(function(t){if("clone"===t.inheritedProps["box-decoration-break"]){o.a(t.viewNode instanceof Element);var i=e.getComputedPaddingBorder(t.viewNode);n+=t.vertical?-i.left:i.bottom,"table"===t.display&&(n+=t.blockBorderSpacing)}}),n},e.prototype.getOffsetByRepetitiveElements=function(t){return(t?t.calculateOffset(this):s.c(null,this.collectElementsOffset())).current},e.prototype.findBoxBreakPosition=function(t,e){for(var n,i,o=this,a=t.checkPoints,s=a[0];s.parent&&s.inline;)s=s.parent;e?(n=1,i=1):(n=Math.max((s.inheritedProps.widows||2)-0,1),i=Math.max((s.inheritedProps.orphans||2)-0,1));var l=o.calculateClonedPaddingBorder(s),u=this.findLinePositions(a),c=this.footnoteEdge-l,h=this.getBoxDir(),p=this.getOffsetByRepetitiveElements(t);c-=h*p;var f=this.findFirstOverflowingEdgeAndCheckPoint(a);isNaN(f.edge)&&(f.edge=h*(1/0));var d,g=r.i(u.length,function(t){var e=u[t];return o.vertical?e<c||e<=f.edge:e>c||e>=f.edge}),m=g<=0;if(m&&(g=r.i(u.length,function(t){return o.vertical?u[t]<c:u[t]>c})),(g=Math.min(u.length-n,g))<i)return null;if(c=u[g-1],d=m?f.checkPoint:this.findAcceptableBreakInside(t.checkPoints,c,e)){var v=this.getAfterEdgeOfBlockContainer(d);!isNaN(v)&&v<c&&(c=v),this.computedBlockSize=h*(c-this.beforeEdge)+p}return d},e.prototype.getAfterEdgeOfBlockContainer=function(t){var e=t;do{e=e.parent}while(e&&e.inline);return e?((e=e.copy().modify()).after=!0,h.a(e,this.clientLayout,0,this.vertical)):NaN},e.prototype.findFirstOverflowingEdgeAndCheckPoint=function(t){var e=t.findIndex(function(t){return t.overflow});if(e<0)return{edge:NaN,checkPoint:null};var n=t[e];return{edge:this.calculateEdge(null,t,e,n.boxOffset),checkPoint:n}},e.prototype.findEdgeBreakPosition=function(t){return this.computedBlockSize=t.computedBlockSize+this.getOffsetByRepetitiveElements(t),t.position},e.prototype.finishBreak=function(t,e,n){o.a(t.formattingContext);var i=(new p.c).find(t.formattingContext).finishBreak(this,t,e,n);return i||(i=p.d.finishBreak(this,t,e,n)),i},e.prototype.findAcceptableBreakPosition=function(){var t=null,e=null,n=0,i=0;do{n=i,i=Number.MAX_VALUE;for(var o=this.breakPositions.length-1;o>=0&&!e;--o){e=(t=this.breakPositions[o]).findAcceptableBreak(this,n);var r=t.getMinBreakPenalty();r>n&&(i=Math.min(i,r))}}while(i>n&&!e&&this.forceNonfitting);return{breakPosition:e?t:null,nodeContext:e}},e.prototype.doFinishBreak=function(t,e,n,i){if(this.pageFloatLayoutContext.isInvalidated()||this.pageBreakType||!e)return w.d(t);var o=this,r=w.c("doFinishBreak"),a=!1;if(!t){if(this.forceNonfitting)return d.b.warn("Could not find any page breaks?!!"),o.skipTailEdges(e).then(function(t){t?((t=t.modify()).overflow=!1,o.finishBreak(t,a,!0).then(function(){r.finish(t)})):r.finish(t)}),r.result();t=n,a=!0,o.computedBlockSize=i}return this.finishBreak(t,a,!0).then(function(){r.finish(t)}),r.result()},e.prototype.isBreakable=function(t){if(t.after)return!0;switch(t.sourceNode.namespaceURI){case r.a.SVG:return!1}return!t.flexContainer},e.prototype.zeroIndent=function(t){var e=t.toString();return""==e||"auto"==e||!!e.match(/^0+(.0*)?[^0-9]/)},e.prototype.checkOverflowAndSaveEdge=function(t,e){if(!t)return!1;if(h.c(t.viewNode))return!1;var n=h.a(t,this.clientLayout,0,this.vertical),i=s.c(t,this.collectElementsOffset()),o=this.isOverflown(n+(this.vertical?-1:1)*i.minimum);if(this.isOverflown(n+(this.vertical?-1:1)*i.current)&&!this.nodeContextOverflowingDueToRepetitiveElements)this.nodeContextOverflowingDueToRepetitiveElements=t;else if(e){var r=n+this.getTrailingMarginEdgeAdjustment(e),a=this.footnoteEdge-this.getBoxDir()*i.current;n=this.vertical?Math.min(n,Math.max(r,a)):Math.max(n,Math.min(r,a))}return this.updateMaxReachedAfterEdge(n),o},e.prototype.checkOverflowAndSaveEdgeAndBreakPosition=function(t,e,n,i){if(!t)return!1;if(h.c(t.viewNode))return!1;var o=this.checkOverflowAndSaveEdge(t,e);return!n&&o||this.saveEdgeBreakPosition(t,i,o),o},e.prototype.applyClearance=function(t){if(!t.viewNode.parentNode)return!1;var e=this.getComputedMargin(t.viewNode),n=t.viewNode.ownerDocument.createElement("div");this.vertical?(n.style.bottom="0px",n.style.width="1px",n.style.marginRight=e.right+"px"):(n.style.right="0px",n.style.height="1px",n.style.marginTop=e.top+"px"),t.viewNode.parentNode.insertBefore(n,t.viewNode);var i=this.clientLayout.getElementClientRect(n),o=this.getBeforeEdge(i),r=this.getBoxDir(),a=t.clearSide,s=-this.getBoxDir()*(1/0);switch("all"===a&&(s=this.pageFloatLayoutContext.getPageFloatClearEdge(a,this)),a){case"left":s=r*Math.max(s*r,this.leftFloatEdge*r);break;case"right":s=r*Math.max(s*r,this.rightFloatEdge*r);break;default:s=r*Math.max(s*r,Math.max(this.rightFloatEdge*r,this.leftFloatEdge*r))}if(o*r>=s*r)return t.viewNode.parentNode.removeChild(n),!1;var l=Math.max(1,(s-o)*r);this.vertical?n.style.width=l+"px":n.style.height=l+"px",i=this.clientLayout.getElementClientRect(n);var u=this.getAfterEdge(i);if(this.vertical){var c=u+e.right-s;c>0==e.right>=0&&(c+=e.right),n.style.marginLeft=c+"px"}else{var h=s-(u+e.top);h>0==e.top>=0&&(h+=e.top),n.style.marginBottom=h+"px"}return t.clearSpacer=n,!0},e.prototype.isBFC=function(t){return!!p.e(t)||!!S.c.isInstanceOfRepetitiveElementsOwnerFormattingContext(t)},e.prototype.skipEdges=function(t,e,n){var i=t.after?t.parent&&t.parent.formattingContext:t.formattingContext;if(i&&!this.isBFC(i))return w.d(t);var r=this,s=w.c("skipEdges"),l=!n&&e&&t&&t.after,u=n,c=null,h=[],f=[],d=!1;function g(){return!!n||!e&&a.c(u)}function m(){(t=h[0]||t).viewNode.parentNode.removeChild(t.viewNode),r.pageBreakType=u}return s.loopWithFrame(function(n){for(;t;){o.a(t.formattingContext);var i=(new p.c).find(t.formattingContext);do{if(!t.viewNode)break;if(t.inline&&1!=t.viewNode.nodeType){if(E.p(t.viewNode,t.whitespace))break;if(!t.after)return g()?m():r.checkOverflowAndSaveEdgeAndBreakPosition(c,null,!0,u)?(t=(r.stopAtOverflow&&c||t).modify()).overflow=!0:(t=t.modify()).breakBefore=u,void n.breakLoop()}if(!t.after){if(i&&i.startNonInlineElementNode(t))break;if(t.clearSide&&r.applyClearance(t)&&e&&0===r.breakPositions.length&&r.saveEdgeBreakPosition(t.copy(),u,!1),!r.isBFC(t.formattingContext)||S.c.isInstanceOfRepetitiveElementsOwnerFormattingContext(t.formattingContext)||r.isFloatNodeContext(t)||t.flexContainer)return h.push(t.copy()),u=a.d(u,t.breakBefore),g()?m():!r.checkOverflowAndSaveEdgeAndBreakPosition(c,null,!0,u)&&r.layoutConstraint.allowLayout(t)||((t=(r.stopAtOverflow&&c||t).modify()).overflow=!0),void n.breakLoop()}if(1!=t.viewNode.nodeType)break;var s=t.viewNode.style;if(t.after){if(t.inline)break;if(i&&i.afterNonInlineElementNode(t,r.stopAtOverflow))break;if(d){if(g())return m(),void n.breakLoop();h=[],e=!1,l=!1,u=null}d=!1,c=t.copy(),f.push(c),u=a.d(u,t.breakAfter),!s||r.zeroIndent(s.paddingBottom)&&r.zeroIndent(s.borderBottomWidth)||(f=[c])}else{if(h.push(t.copy()),u=a.d(u,t.breakBefore),!r.layoutConstraint.allowLayout(t)&&(r.checkOverflowAndSaveEdgeAndBreakPosition(c,null,!r.stopAtOverflow,u),(t=t.modify()).overflow=!0,r.stopAtOverflow))return void n.breakLoop();var v=t.viewNode.localName;if(C[v])return g()?m():r.checkOverflowAndSaveEdgeAndBreakPosition(c,null,!0,u)&&((t=(r.stopAtOverflow&&c||t).modify()).overflow=!0),void n.breakLoop();!s||r.zeroIndent(s.paddingTop)&&r.zeroIndent(s.borderTopWidth)||(l=!1,f=[]),d=!0}}while(0);var y=r.nextInTree(t,l);if(y.isPending())return void y.then(function(e){t=e,n.continueLoop()});t=y.get()}r.checkOverflowAndSaveEdgeAndBreakPosition(c,f,!r.stopAtOverflow,u)?c&&r.stopAtOverflow&&((t=c.modify()).overflow=!0):a.c(u)&&(r.pageBreakType=u),n.breakLoop()}).then(function(){c&&(r.lastAfterPosition=c.toNodePosition()),s.finish(t)}),s.result()},e.prototype.skipTailEdges=function(t){var e=t.copy(),n=this,i=w.c("skipEdges"),o=null,r=!1;return i.loopWithFrame(function(i){for(;t;){do{if(!t.viewNode)break;if(t.inline&&1!=t.viewNode.nodeType){if(E.p(t.viewNode,t.whitespace))break;if(!t.after)return a.c(o)&&(n.pageBreakType=o),void i.breakLoop()}if(!t.after&&(n.isFloatNodeContext(t)||t.flexContainer))return o=a.d(o,t.breakBefore),a.c(o)&&(n.pageBreakType=o),void i.breakLoop();if(1!=t.viewNode.nodeType)break;var s=t.viewNode.style;if(t.after){if(r){if(a.c(o))return n.pageBreakType=o,void i.breakLoop();o=null}r=!1,o=a.d(o,t.breakAfter)}else{o=a.d(o,t.breakBefore);var l=t.viewNode.localName;if(C[l])return a.c(o)&&(n.pageBreakType=o),void i.breakLoop();if(s&&(!n.zeroIndent(s.paddingTop)||!n.zeroIndent(s.borderTopWidth)))return void i.breakLoop()}r=!0}while(0);var u=n.layoutContext.nextInTree(t);if(u.isPending())return void u.then(function(e){t=e,i.continueLoop()});t=u.get()}e=null,i.breakLoop()}).then(function(){i.finish(e)}),i.result()},e.prototype.layoutFloatOrFootnote=function(t){return g.h(t.floatReference)||"footnote"===t.floatSide?this.layoutPageFloat(t):this.layoutFloat(t)},e.prototype.layoutNext=function(t,e,n){var i=this,r=w.c("layoutNext");return this.skipEdges(t,e,n||null).then(function(n){if(!(t=n)||i.pageBreakType||i.stopByOverflow(t))r.finish(t);else{var a=t.formattingContext;o.a(a),(new p.c).find(a).layout(t,i,e).thenFinish(r)}}),r.result()},e.prototype.clearOverflownViewNodes=function(t,e){if(t)for(var n=t.parent;t;t=n,n=n?n.parent:null){var i=(n||t).formattingContext;o.a(i),(new p.c).find(i).clearOverflownViewNodes(this,n,t,e),e=!1}},e.prototype.initGeom=function(){var t=this.element.ownerDocument.createElement("div");t.style.position="absolute",t.style.top=this.paddingTop+"px",t.style.right=this.paddingRight+"px",t.style.bottom=this.paddingBottom+"px",t.style.left=this.paddingLeft+"px",this.element.appendChild(t);var e=this.clientLayout.getElementClientRect(t);this.element.removeChild(t);var n=this.originX+this.left+this.getInsetLeft(),i=this.originY+this.top+this.getInsetTop();this.box=new c.c(n,i,n+this.width,i+this.height),this.startEdge=e?this.vertical?e.top:e.left:0,this.endEdge=e?this.vertical?e.bottom:e.right:0,this.beforeEdge=e?this.vertical?e.right:e.top:0,this.afterEdge=e?this.vertical?e.left:e.bottom:0,this.leftFloatEdge=this.beforeEdge,this.rightFloatEdge=this.beforeEdge,this.bottommostFloatTop=this.beforeEdge,this.footnoteEdge=this.afterEdge,this.bands=c.l(this.box,[this.getInnerShape()],this.getExclusions(),8,this.snapHeight,this.vertical),this.createFloats()},e.prototype.init=function(){this.chunkPositions=[],r.F(this.element,"width",this.width+"px"),r.F(this.element,"height",this.height+"px"),this.initGeom(),this.computedBlockSize=0,this.overflown=!1,this.pageBreakType=null,this.lastAfterPosition=null},e.prototype.saveEdgeBreakPosition=function(t,e,n){o.a(t.formattingContext);var i=t.copy(),r=(new p.c).find(t.formattingContext),a=this.calculateClonedPaddingBorder(i),s=r.createEdgeBreakPosition(i,e,n,this.computedBlockSize+a);this.breakPositions.push(s)},e.prototype.saveBoxBreakPosition=function(t){var e=t[0].breakPenalty,n=new x(t,e);this.breakPositions.push(n)},e.prototype.updateMaxReachedAfterEdge=function(t){if(!isNaN(t)){var e=this.getBoxDir()*(t-this.beforeEdge);this.computedBlockSize=Math.max(e,this.computedBlockSize)}},e.prototype.layout=function(t,e,n){if(this.chunkPositions.push(t),t.primary.after&&(this.lastAfterPosition=t.primary),this.stopAtOverflow&&this.overflown)return w.d(t);if(this.isFullWithPageFloats())return t.primary.after&&1===t.primary.steps.length?w.d(null):w.d(t);var i=this,o=w.c("layout");return i.openAllViews(t.primary).then(function(t){var r=null;if(t.viewNode)r=t.copy();else{var a=function(t){t.nodeContext.viewNode&&(r=t.nodeContext,i.layoutContext.removeEventListener("nextInTree",a))};i.layoutContext.addEventListener("nextInTree",a)}var s=new R(e,n);s.layout(t,i).then(function(t){i.doFinishBreak(t,s.context.overflownNodeContext,r,s.initialComputedBlockSize).then(function(t){(i.pseudoParent?w.d(null):i.doFinishBreakOfFragmentLayoutConstraints(t)).then(function(){if(i.pageFloatLayoutContext.isInvalidated())o.finish(null);else if(t){i.overflown=!0;var e=new E.a(t.toNodePosition());o.finish(e)}else o.finish(null)})})})}),o.result()},e.prototype.isFullWithPageFloats=function(){return this.pageFloatLayoutContext.isColumnFullWithPageFloats(this)},e.prototype.getMaxBlockSizeOfPageFloats=function(){return this.pageFloatLayoutContext.getMaxBlockSizeOfPageFloats()},e.prototype.doFinishBreakOfFragmentLayoutConstraints=function(t){var e=this,n=w.c("doFinishBreakOfFragmentLayoutConstraints"),i=[].concat(this.fragmentLayoutConstraints);i.sort(function(t,e){return t.getPriorityOfFinishBreak()-e.getPriorityOfFinishBreak()});var o=0;return n.loop(function(){return o<i.length?i[o++].finishBreak(t,e).thenReturn(!0):w.d(!1)}).then(function(){n.finish(!0)}),n.result()},e.prototype.doLayout=function(t,e,n){var i=this,o=w.c("doLayout"),r=null;return i.breakPositions=[],i.nodeContextOverflowingDueToRepetitiveElements=null,o.loopWithFrame(function(o){for(var a=function(){var a=!0;if(i.layoutNext(t,e,n||null).then(function(s){if(e=!1,n=null,i.nodeContextOverflowingDueToRepetitiveElements&&i.stopAtOverflow?(i.pageBreakType=null,(t=i.nodeContextOverflowingDueToRepetitiveElements).overflow=!0):t=s,i.pageFloatLayoutContext.isInvalidated())o.breakLoop();else if(i.pageBreakType)o.breakLoop();else if(t&&i.stopByOverflow(t)){r=t;var l=i.findAcceptableBreakPosition();t=l.nodeContext,l.breakPosition&&l.breakPosition.breakPositionChosen(i),o.breakLoop()}else a?a=!1:o.continueLoop()}),a)return a=!1,{value:void 0}};t;){var s=a();if("object"==typeof s)return s.value}i.computedBlockSize+=i.getOffsetByRepetitiveElements(),o.breakLoop()}).then(function(){o.finish({nodeContext:t,overflownNodeContext:r})}),o.result()},e.prototype.redoLayout=function(){for(var t=this.chunkPositions,e=this.element.lastChild;e!=this.last;){var n=e.previousSibling;this.element===e.parentNode&&this.layoutContext.isPseudoelement(e)||this.element.removeChild(e),e=n}this.killFloats(),this.init();var i=this,o=w.c("redoLayout"),r=0,a=null,s=!0;return o.loopWithFrame(function(e){if(r<t.length){var n=t[r++];i.layout(n,s).then(function(t){s=!1,t?(a=t,e.breakLoop()):e.continueLoop()})}else e.breakLoop()}).then(function(){o.finish(a)}),o.result()},e.prototype.saveDistanceToBlockEndFloats=function(){var t=this.pageFloatLayoutContext.getBlockStartEdgeOfBlockEndFloats();t>0&&isFinite(t)&&(this.blockDistanceToBlockEndFloats=this.getBoxDir()*(t-this.beforeEdge-this.computedBlockSize))},e.prototype.collectElementsOffset=function(){for(var t=this,e=[],n=this;n;n=n.pseudoParent)n.fragmentLayoutConstraints.forEach(function(n){if(S.c.isInstanceOfRepetitiveElementsOwnerLayoutConstraint(n)){var i=n.getRepetitiveElements();e.push(i)}v.b(n)&&(i=n.getRepetitiveElements(),e.push(i)),S.e.isInstanceOfTableRowLayoutConstraint(n)&&n.getElementsOffsetsForTableCell(t).forEach(function(t){e.push(t)})});return e},e}(E.b),O=/^[^A-Za-z0-9_\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]*([A-Za-z0-9_\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527][^A-Za-z0-9_\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]*)?/,k=function(){function t(){}return t.prototype.breakTextNode=function(t,e,n,i,o,r){if(e.after)e.offsetInNode=t.length;else{var a=n-e.boxOffset,s=t.data;(a=173==s.charCodeAt(a)?this.breakAfterSoftHyphen(t,s,a,e):this.breakAfterOtherCharacter(t,s,a,e))>0&&(e=this.updateNodeContext(e,a,t))}return e},t.prototype.breakAfterSoftHyphen=function(t,e,n,i){return t.replaceData(n,e.length-n,i.breakWord?"":A(i)),n+1},t.prototype.breakAfterOtherCharacter=function(t,e,n,i){var o=e.charAt(n);n++;var a=e.charAt(n);return t.replaceData(n,e.length-n,!i.breakWord&&r.x(o)&&r.x(a)?A(i):""),n},t.prototype.updateNodeContext=function(t,e,n){return(t=t.modify()).offsetInNode+=e,t.breakBefore=null,t},t}();function A(t){return t.hyphenateCharacter||t.parent&&t.parent.hyphenateCharacter||"-"}k.instance=new k;var R=function(t){function e(e,n){var i=t.call(this)||this;return i.leadingEdge=e,i.initialPageBreakType=null,i.initialComputedBlockSize=0,i.initialOverflown=!1,i.context={overflownNodeContext:null},i.breakAfter=n||null,i}return N(e,t),e.prototype.resolveLayoutMode=function(t){return new L(this.leadingEdge,this.breakAfter,this.context)},e.prototype.prepareLayout=function(t,e){e.fragmentLayoutConstraints=[],e.pseudoParent||y.a()},e.prototype.clearNodes=function(e){t.prototype.clearNodes.call(this,e);for(var n=e;n;){var i=n.viewNode;i&&h.f(i.parentNode,i),n=n.parent}},e.prototype.saveState=function(e,n){t.prototype.saveState.call(this,e,n),this.initialPageBreakType=n.pageBreakType,this.initialComputedBlockSize=n.computedBlockSize,this.initialOverflown=n.overflown},e.prototype.restoreState=function(e,n){t.prototype.restoreState.call(this,e,n),n.pageBreakType=this.initialPageBreakType,n.computedBlockSize=this.initialComputedBlockSize,n.overflown=this.initialOverflown},e}(f.a),L=function(){function t(t,e,n){this.leadingEdge=t,this.breakAfter=e,this.context=n}return t.prototype.doLayout=function(t,e){var n=this,i=w.c("DefaultLayoutMode.doLayout");return v.d(t,e).then(function(){e.doLayout(t,n.leadingEdge,n.breakAfter).then(function(t){n.context.overflownNodeContext=t.overflownNodeContext,i.finish(t.nodeContext)})}),i.result()},t.prototype.accept=function(t,e){var n=this;return!(!e.pageFloatLayoutContext.isInvalidated()&&!e.pageBreakType)||e.fragmentLayoutConstraints.length<=0||e.fragmentLayoutConstraints.every(function(i){return i.allowLayout(t,n.context.overflownNodeContext,e)})},t.prototype.postLayout=function(t,e,n,i){if(!i){var o=n.fragmentLayoutConstraints.some(function(e){return e.nextCandidate(t)});i=!o}return n.fragmentLayoutConstraints.forEach(function(o){o.postLayout(i,t,e,n)}),i},t}(),_=function(t){function e(e,n,i,o,r,a,s){var l=t.call(this,n,i,o,r,a)||this;return l.floatSide=e,l.parentContainer=s,l.rootViewNodes=[],l.floatMargins=[],l.adjustContentRelativeSize=!0,l}return N(e,t),e.prototype.openAllViews=function(e){var n=this;return t.prototype.openAllViews.call(this,e).thenAsync(function(t){return t&&n.fixFloatSizeAndPosition(t),w.d(t)})},e.prototype.convertPercentageSizesToPx=function(t){var e=this.parentContainer.getPaddingRect(),n=e.x2-e.x1,i=e.y2-e.y1;function o(e,n){e.forEach(function(e){var i=r.t(t,e);if(i&&"%"===i.charAt(i.length-1)){var o=parseFloat(i),a=n*o/100;r.F(t,e,a+"px")}})}o(["width","max-width","min-width"],n),o(["height","max-height","min-height"],i),o(["margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left"],this.vertical?i:n),["margin-top","margin-right","margin-bottom","margin-left"].forEach(function(e){"auto"===r.t(t,e)&&r.F(t,e,"0")})},e.prototype.fixFloatSizeAndPosition=function(t){for(;t.parent;)t=t.parent;o.a(1===t.viewNode.nodeType);var e=t.viewNode;if(this.rootViewNodes.push(e),this.adjustContentRelativeSize&&this.convertPercentageSizesToPx(e),this.floatMargins.push(this.getComputedMargin(e)),this.adjustContentRelativeSize){var n=this.floatSide;if(this.parentContainer.vertical){if("block-end"===n||"left"===n){var i=r.t(e,"height");""!==i&&"auto"!==i&&r.F(e,"margin-top","auto")}}else if("block-end"===n||"bottom"===n){var a=r.t(e,"width");""!==a&&"auto"!==a&&r.F(e,"margin-left","auto")}}},e.prototype.getContentInlineSize=function(){var t=this;return Math.max.apply(null,this.rootViewNodes.map(function(e,n){var i=t.clientLayout.getElementClientRect(e),o=t.floatMargins[n];return t.vertical?o.top+i.height+o.bottom:o.left+i.width+o.right}))},e}(P)},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return o});var i=[];function o(){i=[]}},function(t,e,n){"use strict";n.r(e);var i,o,r,a=!1;!function(t){t.LTR="ltr",t.RTL="rtl"}(i||(i={})),function(t){t.LEFT="left",t.RIGHT="right"}(o||(o={})),function(t){t.LOADING="loading",t.INTERACTIVE="interactive",t.COMPLETE="complete"}(r||(r={}));var s={PageProgression:i,PageSide:o,ReadyState:r},l=n(9),u=n(6),c=function(){function t(t){this.performanceInstance=t,this.timestamps={},this.registerTiming=h,this.registerStartTiming=this.registerStartTiming=h,this.registerEndTiming=this.registerEndTiming=h}return t.prototype.forceRegisterStartTiming=function(t,e){p.call(this,t,"start",e)},t.prototype.forceRegisterEndTiming=function(t,e){p.call(this,t,"end",e)},t.prototype.printTimings=function(){var t=this.timestamps,e="";Object.keys(t).forEach(function(n){for(var i=t[n],o=i.length,r=0;r<o;r++){var a=i[r];e+=n,o>1&&(e+="("+r+")"),e+=" => start: "+a.start+", end: "+a.end+", duration: "+(a.end-a.start)+"\n"}}),u.b.info(e)},t.prototype.disable=function(){this.registerTiming=h,this.registerStartTiming=this.registerStartTiming=h,this.registerEndTiming=this.registerEndTiming=h},t.prototype.enable=function(){this.registerTiming=p,this.registerStartTiming=this.registerStartTiming=f,this.registerEndTiming=this.registerEndTiming=d},t.prototype.isEnabled=function(){return this.registerStartTiming===f},t}();function h(){}function p(t,e,n){n||(n=this.performanceInstance.now());var i,o=this.timestamps[t];o||(o=this.timestamps[t]=[]);for(var r=o.length-1;r>=0&&(!(i=o[r])||i[e]);r--)i=null;i||(i={},o.push(i)),i[e]=n}function f(t,e){this.registerTiming(t,"start",e)}function d(t,e){this.registerTiming(t,"end",e)}var g={now:Date.now},m=new c(window&&window.performance||g);m.forceRegisterStartTiming("load_vivliostyle");var v={profiler:{registerStartTiming:m.registerStartTiming,registerEndTiming:m.registerEndTiming,printTimings:m.printTimings,disable:m.disable,enable:m.enable}},y=n(7),b=n(1);function w(t){if(1==t.nodeType){var e=t.getAttribute("id");if(e&&e.match(/^[-a-zA-Z_0-9.\u007F-\uFFFF]+$/))return e}return null}function E(t){return"^"+t}function S(t){return t.replace(/[\[\]\(\),=;^]/g,E)}function N(t){return t.substr(1)}function C(t){return t?t.replace(/\^[\[\]\(\),=;^]/g,N):t}function T(t){var e=[];do{var n=t.match(/^(\^,|[^,])*/),i=C(n[0]);if(!(t=t.substr(n[0].length+1))&&!e.length)return i;e.push(i)}while(t);return e}function x(t){for(var e={};t;){var n=t.match(/^;([^;=]+)=(([^;]|\^;)*)/);if(!n)return e;e[n[1]]=T(n[2]),t=t.substr(n[0].length)}return e}var I=function(){function t(){}return t.prototype.appendTo=function(t){t.append("!")},t.prototype.applyTo=function(t){return!1},t}(),P=function(){function t(t,e,n){this.index=t,this.id=e,this.sideBias=n}return t.prototype.appendTo=function(t){t.append("/"),t.append(this.index.toString()),(this.id||this.sideBias)&&(t.append("["),this.id&&t.append(this.id),this.sideBias&&(t.append(";s="),t.append(this.sideBias)),t.append("]"))},t.prototype.applyTo=function(t){if(1!=t.node.nodeType)throw new Error("E_CFI_NOT_ELEMENT");var e,n=t.node,i=n.children,o=i.length,r=Math.floor(this.index/2)-1;if(r<0||0==o)e=n.firstChild,t.node=e||n;else{if(e=i[Math.min(r,o-1)],1&this.index){var a=e.nextSibling;a&&1!=a.nodeType?e=a:t.after=!0}t.node=e}if(this.id&&(t.after||this.id!=w(t.node)))throw new Error("E_CFI_ID_MISMATCH");return t.sideBias=this.sideBias,!0},t}(),O=function(){function t(t,e,n,i){this.offset=t,this.textBefore=e,this.textAfter=n,this.sideBias=i}return t.prototype.applyTo=function(t){if(this.offset>0&&!t.after){for(var e=this.offset,n=t.node;;){var i=n.nodeType;if(1==i)break;var o=n.nextSibling;if(3<=i&&i<=5){var r=n.textContent.length;if(e<=r)break;if(!o){e=r;break}e-=r}if(!o){e=0;break}n=o}t.node=n,t.offset=e}return t.sideBias=this.sideBias,!0},t.prototype.appendTo=function(t){t.append(":"),t.append(this.offset.toString()),(this.textBefore||this.textAfter||this.sideBias)&&(t.append("["),(this.textBefore||this.textAfter)&&(this.textBefore&&t.append(S(this.textBefore)),t.append(","),this.textAfter&&t.append(S(this.textAfter))),this.sideBias&&(t.append(";s="),t.append(this.sideBias)),t.append("]"))},t}(),k=function(){function t(){this.steps=null}return t.prototype.fromString=function(t){var e=t.match(/^#?epubcfi\((.*)\)$/);if(!e)throw new Error("E_CFI_NOT_CFI");for(var n=e[1],i=0,o=[];;){var r=void 0;switch(n.charAt(i)){case"/":if(i++,!(e=n.substr(i).match(/^(0|[1-9][0-9]*)(\[([-a-zA-Z_0-9.\u007F-\uFFFF]+)(;([^\]]|\^\])*)?\])?/)))throw new Error("E_CFI_NUMBER_EXPECTED");i+=e[0].length;var a=parseInt(e[1],10),s=e[3];r=x(e[4]),o.push(new P(a,s,b.g(r.s)));break;case":":if(i++,!(e=n.substr(i).match(/^(0|[1-9][0-9]*)(\[((([^\];,]|\^[\];,])*)(,(([^\];,]|\^[\];,])*))?)(;([^]]|\^\])*)?\])?/)))throw new Error("E_CFI_NUMBER_EXPECTED");i+=e[0].length;var l=parseInt(e[1],10),u=e[4];u&&(u=C(u));var c=e[7];c&&(c=C(c)),r=x(e[10]),o.push(new O(l,u,c,b.g(r.s)));break;case"!":i++,o.push(new I);break;case"~":case"@":case"":return void(this.steps=o);default:throw new Error("E_CFI_PARSE_ERROR")}}},t.prototype.navigate=function(e){for(var n={node:e.documentElement,offset:0,after:!1,sideBias:null,ref:null},i=0;i<this.steps.length;i++)if(!this.steps[i].applyTo(n)){n.ref=new t,n.ref.steps=this.steps.slice(i+1);break}return n},t.prototype.trim=function(t,e){return t.replace(/\s+/g," ").match(e?/^[ -\uD7FF\uE000-\uFFFF]{0,8}/:/[ -\uD7FF\uE000-\uFFFF]{0,8}$/)[0].replace(/^\s/,"").replace(/\s$/,"")},t.prototype.prependPathFromNode=function(t,e,n,i){for(var o=[],r=t.parentNode,a="",s="";t;){switch(t.nodeType){case 3:case 4:case 5:var l=t.textContent,u=l.length;n?(e+=u,a||(a=l)):(e>u&&(e=u),n=!0,a=l.substr(0,e),s=l.substr(e)),t=t.previousSibling;continue;case 8:t=t.previousSibling;continue}break}for((e>0||a||s)&&(a=this.trim(a,!1),s=this.trim(s,!0),o.push(new O(e,a,s,i)),i=null);r&&r&&9!=r.nodeType;){for(var c=n?null:w(t),h=n?1:0;t;)1==t.nodeType&&(h+=2),t=t.previousSibling;o.push(new P(h,c,i)),i=null,t=r,r=r.parentNode,n=!1}o.reverse(),this.steps?(o.push(new I),this.steps=o.concat(this.steps)):this.steps=o},t.prototype.toString=function(){if(!this.steps)return"";var t=new b.d;t.append("epubcfi(");for(var e=0;e<this.steps.length;e++)this.steps[e].appendTo(t);return t.append(")"),t.toString()},t}(),A=n(20),R=n(4);function L(t){var e={};return Object.keys(t).forEach(function(n){e[n]=Array.from(t[n])}),e}var _,F=function(){function t(t,e){this.targetId=t,this.resolved=e,this.pageCounters=null,this.spineIndex=-1,this.pageIndex=-1}return t.prototype.equals=function(t){return this===t||!!t&&this.targetId===t.targetId&&this.resolved===t.resolved&&this.spineIndex===t.spineIndex&&this.pageIndex===t.pageIndex},t.prototype.isResolved=function(){return this.resolved},t.prototype.resolve=function(){this.resolved=!0},t.prototype.unresolve=function(){this.resolved=!1},t}(),D=function(){function t(t,e){this.counterStore=t,this.baseURL=e}return t.prototype.countersOfId=function(t,e){t=this.counterStore.documentURLTransformer.transformFragment(t,this.baseURL),this.counterStore.countersById[t]=e},t.prototype.getExprContentListener=function(){return this.counterStore.getExprContentListener()},t}(),B=function(){function t(t,e,n,i){this.counterStore=t,this.baseURL=e,this.rootScope=n,this.pageScope=i,this.styler=null}return t.prototype.setStyler=function(t){this.styler=t},t.prototype.getFragment=function(t){var e=t.match(/^[^#]*#(.*)$/);return e?e[1]:null},t.prototype.getTransformedId=function(t){var e=this.counterStore.documentURLTransformer.transformURL(b.C(t,this.baseURL),this.baseURL);return"#"===e.charAt(0)&&(e=e.substring(1)),e},t.prototype.getPageCounterVal=function(t,e){var n=this,i=new R.t(this.pageScope,function(){return e((i=n.counterStore.currentPageCounters[t])&&i.length?i[i.length-1]:null);var i},"page-counter-"+t);return this.counterStore.registerPageCounterExpr(t,function(t){return e(t[0])},i),i},t.prototype.getPageCountersVal=function(t,e){var n=this,i=new R.t(this.pageScope,function(){return e(n.counterStore.currentPageCounters[t]||[])},"page-counters-"+t);return this.counterStore.registerPageCounterExpr(t,e,i),i},t.prototype.getTargetCounters=function(t,e,n){var i=this.counterStore.countersById[e];return!i&&n&&t&&(this.styler.styleUntilIdIsReached(t),i=this.counterStore.countersById[e]),i||null},t.prototype.getTargetPageCounters=function(t){return this.counterStore.currentPage.elementsById[t]?this.counterStore.currentPageCounters:this.counterStore.pageCountersById[t]||null},t.prototype.getTargetCounterVal=function(t,e,n){var i=this.getFragment(t),o=this.getTransformedId(t),r=this.getTargetCounters(i,o,!1);if(r&&r[e]){var a=r[e];return new R.f(this.rootScope,n(a[a.length-1]||null))}var s=this;return new R.t(this.pageScope,function(){if(r=s.getTargetCounters(i,o,!0)){if(r[e]){var t=r[e];return n(t[t.length-1]||null)}var a=s.getTargetPageCounters(o);if(a){if(s.counterStore.resolveReference(o),a[e]){var l=a[e];return n(l[l.length-1]||null)}return n(0)}return s.counterStore.saveReferenceOfCurrentPage(o,!1),"??"}return s.counterStore.saveReferenceOfCurrentPage(o,!1),"??"},"target-counter-"+e+"-of-"+t)},t.prototype.getTargetCountersVal=function(t,e,n){var i=this.getFragment(t),o=this.getTransformedId(t),r=this;return new R.t(this.pageScope,function(){var t=r.getTargetPageCounters(o);if(t){r.counterStore.resolveReference(o);var a=t[e]||[],s=r.getTargetCounters(i,o,!0)[e]||[];return n(a.concat(s))}return r.counterStore.saveReferenceOfCurrentPage(o,!1),"??"},"target-counters-"+e+"-of-"+t)},t}(),M=function(){function t(t){this.documentURLTransformer=t,this.countersById={},this.pageCountersById={},this.currentPageCounters={},this.previousPageCounters={},this.currentPageCountersStack=[],this.pageIndicesById={},this.currentPage=null,this.newReferencesOfCurrentPage=[],this.referencesToSolve=[],this.referencesToSolveStack=[],this.unresolvedReferences={},this.resolvedReferences={},this.pagesCounterExprs=[],this.currentPageCounters.page=[0]}return t.prototype.createCounterListener=function(t){return new D(this,t)},t.prototype.createCounterResolver=function(t,e,n){return new B(this,t,e,n)},t.prototype.setCurrentPage=function(t){this.currentPage=t},t.prototype.definePageCounter=function(t,e){this.currentPageCounters[t]?this.currentPageCounters[t].push(e):this.currentPageCounters[t]=[e]},t.prototype.forceSetPageCounter=function(t){var e=this.currentPageCounters.page;e&&e.length?e[e.length-1]=t:this.currentPageCounters.page=[t]},t.prototype.updatePageCounters=function(t,e){var n;this.previousPageCounters=L(this.currentPageCounters);var i,o=t["counter-reset"];if(o){var r=o.evaluate(e);r&&(n=A.b(r,!0))}if(n)for(var a in n)this.definePageCounter(a,n[a]);var s=t["counter-increment"];if(s){var l=s.evaluate(e);l&&(i=A.b(l,!1))}for(var u in i?"page"in i||(i.page=1):(i={}).page=1,i){this.currentPageCounters[u]||this.definePageCounter(u,0);var c=this.currentPageCounters[u];c[c.length-1]+=i[u]}},t.prototype.pushPageCounters=function(t){this.currentPageCountersStack.push(this.currentPageCounters),this.currentPageCounters=L(t)},t.prototype.popPageCounters=function(){this.currentPageCounters=this.currentPageCountersStack.pop()},t.prototype.resolveReference=function(t){var e=this.unresolvedReferences[t],n=this.resolvedReferences[t];n||(n=this.resolvedReferences[t]=[]);for(var i=!1,o=0;o<this.referencesToSolve.length;){var r=this.referencesToSolve[o];if(r.targetId===t){if(r.resolve(),this.referencesToSolve.splice(o,1),e){var a=e.indexOf(r);a>=0&&e.splice(a,1)}n.push(r),i=!0}else o++}i||this.saveReferenceOfCurrentPage(t,!0)},t.prototype.saveReferenceOfCurrentPage=function(t,e){if(!this.newReferencesOfCurrentPage.some(function(e){return e.targetId===t})){var n=new F(t,e);this.newReferencesOfCurrentPage.push(n)}},t.prototype.finishPage=function(t,e){var n=this,i=Object.keys(this.currentPage.elementsById);if(i.length>0){var o=L(this.currentPageCounters);i.forEach(function(i){n.pageCountersById[i]=o;var r=n.pageIndicesById[i];if(r&&r.pageIndex<e){var a=n.resolvedReferences[i];if(a){var s,l=n.unresolvedReferences[i];for(l||(l=n.unresolvedReferences[i]=[]);s=a.shift();)s.unresolve(),l.push(s)}}n.pageIndicesById[i]={spineIndex:t,pageIndex:e}})}for(var r,a=this.previousPageCounters;r=this.newReferencesOfCurrentPage.shift();){r.pageCounters=a,r.spineIndex=t,r.pageIndex=e;var s=void 0;r.isResolved()?(s=this.resolvedReferences[r.targetId])||(s=this.resolvedReferences[r.targetId]=[]):(s=this.unresolvedReferences[r.targetId])||(s=this.unresolvedReferences[r.targetId]=[]),s.every(function(t){return!r.equals(t)})&&s.push(r)}this.currentPage=null},t.prototype.getUnresolvedRefsToPage=function(t){var e=this,n=[];Object.keys(t.elementsById).forEach(function(t){var i=e.unresolvedReferences[t];i&&(n=n.concat(i))}),n.sort(function(t,e){return t.spineIndex-e.spineIndex||t.pageIndex-e.pageIndex});var i=[],o=null;return n.forEach(function(t){o&&o.spineIndex===t.spineIndex&&o.pageIndex===t.pageIndex?o.refs.push(t):(o={spineIndex:t.spineIndex,pageIndex:t.pageIndex,pageCounters:t.pageCounters,refs:[t]},i.push(o))}),i},t.prototype.pushReferencesToSolve=function(t){this.referencesToSolveStack.push(this.referencesToSolve),this.referencesToSolve=t},t.prototype.popReferencesToSolve=function(){this.referencesToSolve=this.referencesToSolveStack.pop()},t.prototype.registerPageCounterExpr=function(t,e,n){"pages"===t&&this.pagesCounterExprs.push({expr:n,format:e})},t.prototype.getExprContentListener=function(){return this.exprContentListener.bind(this)},t.prototype.exprContentListener=function(t,e,n){if(this.pagesCounterExprs.findIndex(function(e){return e.expr===t})>=0){var i=n.createElement("span");return i.textContent=e,i.setAttribute(U,t.key),i}return null},t.prototype.finishLastPage=function(t){var e=this,n=t.root.querySelectorAll("["+U+"]"),i=this.currentPageCounters.page[0];Array.from(n).forEach(function(t){var n=t.getAttribute(U),o=e.pagesCounterExprs.findIndex(function(t){return t.expr.key===n});y.a(o>=0),t.textContent=e.pagesCounterExprs[o].format([i])})},t.prototype.createLayoutConstraint=function(t){return new z(this,t)},t}(),U="data-vivliostyle-pages-counter",z=function(){function t(t,e){this.counterStore=t,this.pageIndex=e}return t.prototype.allowLayout=function(t){if(!t||t.after)return!0;var e=t.viewNode;if(!e||1!==e.nodeType)return!0;var n=e.getAttribute("id")||e.getAttribute("name");if(!n)return!0;if(!this.counterStore.resolvedReferences[n]&&!this.counterStore.unresolvedReferences[n])return!0;var i=this.counterStore.pageIndicesById[n];return!i||this.pageIndex>=i.pageIndex},t}(),V=n(5),H=n(10),G=n(2),W=n(16),j=n(0),X=n(12),K=n(3),q=n(8),Y=(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),$=X.d,Z=function(t){function e(e,n,i,o,r){var a=t.call(this,e,n,"block-end",null,i,r)||this;return a.footnotePolicy=o,a}return Y(e,t),e.prototype.isAllowedToPrecede=function(t){return!(t instanceof e)},e}(X.b),Q=function(t){function e(e,n,i,o){return t.call(this,e,"block-end",n,i,o)||this}return Y(e,t),e.prototype.getOrder=function(){return 1/0},e.prototype.shouldBeStashedBefore=function(t){return t instanceof Z||this.getOrder()<t.getOrder()},e}($),J=function(){function t(t){this.footnote=t}return t.prototype.allowLayout=function(t){var e=t.toNodePosition();return!q.u(e,this.footnote.nodePosition)},t}(),tt=function(){function t(){}return t.prototype.appliesToNodeContext=function(t){return"footnote"===t.floatSide},t.prototype.appliesToFloat=function(t){return t instanceof Z},t.prototype.createPageFloat=function(t,e,n){var i=X.a.REGION,o=e.getPageFloatLayoutContext(i);e.getPageFloatLayoutContext(X.a.PAGE).hasSameContainerAs(o)&&(i=X.a.PAGE);var r=t.toNodePosition();y.a(e.flowName);var a=new Z(r,i,e.flowName,t.footnotePolicy,t.floatMinWrapBlock);return e.addPageFloat(a),K.d(a)},t.prototype.createPageFloatFragment=function(t,e,n,i){var o=t[0].float;return new Q(o.floatReference,t,n,i)},t.prototype.findPageFloatFragment=function(t,e){var n=e.getPageFloatLayoutContext(t.floatReference).floatFragments.filter(function(t){return t instanceof Q});return y.a(n.length<=1),n[0]||null},t.prototype.adjustPageFloatArea=function(t,e,n){t.isFootnote=!0,t.adjustContentRelativeSize=!1;var i=t.element;y.a(i),t.vertical=n.layoutContext.applyFootnoteStyle(e.vertical,n.layoutContext.nodeContext&&"rtl"===n.layoutContext.nodeContext.direction,i),t.convertPercentageSizesToPx(i),n.setComputedInsets(i,t),n.setComputedWidthAndHeight(i,t)},t.prototype.forbid=function(t,e){var n=t;switch(n.footnotePolicy){case j.t.line:var i=new J(n);e.addLayoutConstraint(i,n.floatReference)}},t}();X.f.register(new tt);var et=n(22),nt=n(14),it=n(18),ot=n(29),rt=n(23),at=n(26),st=n(31),lt=n(15),ut=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ct=function(){function t(t,e){this.parent=t,this.rootSourceNode=e,this.formattingContextType="RepetitiveElementsOwner",this.isRoot=!1,this.repetitiveElements=null}return t.prototype.getName=function(){return"Repetitive elements owner formatting context (RepetitiveElementsOwnerFormattingContext)"},t.prototype.isFirstTime=function(t,e){return e},t.prototype.getParent=function(){return this.parent},t.prototype.getRepetitiveElements=function(){return this.repetitiveElements},t.prototype.getRootViewNode=function(t){var e=this.getRootNodeContext(t);return e?e.viewNode:null},t.prototype.getRootNodeContext=function(t){do{if(!t.belongsTo(this)&&t.sourceNode===this.rootSourceNode)return t}while(t=t.parent);return null},t.prototype.initializeRepetitiveElements=function(t){var e=this;this.repetitiveElements||st.b.some(function(t){return t.root===e.rootSourceNode&&(e.repetitiveElements=t.elements,!0)})||(this.repetitiveElements=new ht(t,this.rootSourceNode),st.b.push({root:this.rootSourceNode,elements:this.repetitiveElements}))},t.prototype.saveState=function(){},t.prototype.restoreState=function(t){},t}(),ht=function(){function t(t,e){this.vertical=t,this.ownerSourceNode=e,this.headerSourceNode=null,this.footerSourceNode=null,this.headerViewNode=null,this.footerViewNode=null,this.headerNodePosition=null,this.footerNodePosition=null,this.headerHeight=0,this.footerHeight=0,this.isSkipHeader=!1,this.isSkipFooter=!1,this.enableSkippingFooter=!0,this.enableSkippingHeader=!0,this.doneInitialLayout=!1,this.firstContentSourceNode=null,this.lastContentSourceNode=null,this.affectedNodeCache=[],this.afterLastContentNodeCache=[],this.allowInsert=!1}return t.prototype.setHeaderNodeContext=function(t){this.headerNodePosition||(this.headerNodePosition=q.x(t,0),this.headerSourceNode=t.sourceNode,this.headerViewNode=t.viewNode)},t.prototype.setFooterNodeContext=function(t){this.footerNodePosition||(this.footerNodePosition=q.x(t,0),this.footerSourceNode=t.sourceNode,this.footerViewNode=t.viewNode)},t.prototype.updateHeight=function(t){this.headerViewNode&&(this.headerHeight=nt.b(this.headerViewNode,t,this.vertical),this.headerViewNode=null),this.footerViewNode&&(this.footerHeight=nt.b(this.footerViewNode,t,this.vertical),this.footerViewNode=null)},t.prototype.prepareLayoutFragment=function(){this.isSkipHeader=this.isSkipFooter=!1,this.enableSkippingFooter=!0,this.enableSkippingHeader=!0},t.prototype.appendHeaderToFragment=function(t,e,n){return!this.headerNodePosition||this.isSkipHeader?K.d(!0):this.appendElementToFragment(this.headerNodePosition,t,e,n)},t.prototype.appendFooterToFragment=function(t,e,n){return!this.footerNodePosition||this.isSkipFooter?K.d(!0):this.appendElementToFragment(this.footerNodePosition,t,e,n)},t.prototype.appendElementToFragment=function(t,e,n,i){var o=this,r=e.viewNode.ownerDocument,a=e.viewNode,s=r.createElement("div");a.appendChild(s);var l=new rt.PseudoColumn(i,s,e),u=l.getColumn().pageBreakType;return l.getColumn().pageBreakType=null,this.allowInsertRepeatitiveElements=!0,l.layout(new q.a(t),!0).thenAsync(function(){return o.allowInsertRepeatitiveElements=!1,a.removeChild(s),o.moveChildren(s,a,n),l.getColumn().pageBreakType=u,K.d(!0)})},t.prototype.moveChildren=function(t,e,n){if(e)for(;t.firstChild;){var i=t.firstChild;t.removeChild(i),i.setAttribute(q.m,"1"),n?e.insertBefore(i,n):e.appendChild(i)}},t.prototype.calculateOffset=function(t){var e=0;return t&&!this.affectTo(t)?e:((!this.isSkipFooter||t&&this.isAfterLastContent(t))&&(e+=this.footerHeight),this.isSkipHeader||(e+=this.headerHeight),e)},t.prototype.calculateMinimumOffset=function(t){var e=0;return t&&!this.affectTo(t)?e:(t&&this.isAfterLastContent(t)&&(e+=this.footerHeight),this.enableSkippingHeader||(e+=this.headerHeight),e)},t.prototype.isAfterLastContent=function(t){var e=this;return this.findResultFromCache(t,this.afterLastContentNodeCache,function(n){return e.isAfterNodeContextOf(e.lastContentSourceNode,t,!1)})},t.prototype.affectTo=function(t){var e=this;return this.findResultFromCache(t,this.affectedNodeCache,function(n){return e.isAfterNodeContextOf(e.ownerSourceNode,t,!0)})},t.prototype.findResultFromCache=function(t,e,n){var i=e.filter(function(e){return e.nodeContext.sourceNode===t.sourceNode&&e.nodeContext.after===t.after});if(i.length>0)return i[0].result;var o=n(t);return e.push({nodeContext:t,result:o}),o},t.prototype.isAfterNodeContextOf=function(t,e,n){for(var i=[],o=t;o;o=o.parentNode){if(e.sourceNode===o)return e.after;i.push(o)}for(var r=e.sourceNode;r;r=r.parentNode){var a=i.indexOf(r);if(a>=0)return!!n&&0===a;for(var s=r;s;s=s.previousElementSibling)if(i.includes(s))return!0}return e.after},t.prototype.isFirstContentNode=function(t){return t&&this.firstContentSourceNode===t.sourceNode},t.prototype.isEnableToUpdateState=function(){return!!(!this.isSkipFooter&&this.enableSkippingFooter&&this.footerNodePosition||!this.isSkipHeader&&this.enableSkippingHeader&&this.headerNodePosition)},t.prototype.updateState=function(){!this.isSkipFooter&&this.enableSkippingFooter&&this.footerNodePosition?this.isSkipFooter=!0:!this.isSkipHeader&&this.enableSkippingHeader&&this.headerNodePosition&&(this.isSkipHeader=!0)},t.prototype.preventSkippingHeader=function(){this.isSkipHeader=!1,this.enableSkippingHeader=!1},t.prototype.preventSkippingFooter=function(){this.isSkipFooter=!1,this.enableSkippingFooter=!1},t.prototype.isHeaderRegistered=function(){return!!this.headerNodePosition},t.prototype.isFooterRegistered=function(){return!!this.footerNodePosition},t.prototype.isHeaderSourceNode=function(t){return this.headerSourceNode===t},t.prototype.isFooterSourceNode=function(t){return this.footerSourceNode===t},t}(),pt=function(){function t(t){this.formattingContext=t}return t.prototype.accept=function(t,e){return!!t},t.prototype.postLayout=function(t,e,n,i){var o=this.formattingContext.getRepetitiveElements();return o&&(y.a(n.clientLayout),o.doneInitialLayout||(o.updateHeight(n),o.doneInitialLayout=!0)),i},t}(),ft=function(){function t(t){this.formattingContext=t}return t.prototype.accept=function(t,e){return!0},t.prototype.postLayout=function(t,e,n,i){return i},t}(),dt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.processor=n,i}return ut(e,t),e.prototype.doLayout=function(t,e){return this.processor.doInitialLayout(t,e)},e.prototype.accept=function(t,e){return!1},e}(pt),gt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.processor=n,i}return ut(e,t),e.prototype.doLayout=function(t,e){return t.belongsTo(this.formattingContext)||t.after||e.fragmentLayoutConstraints.unshift(new mt(t)),this.processor.doLayout(t,e)},e}(ft),mt=function(){function t(t){this.flagmentLayoutConstraintType="RepetitiveElementsOwner";var e=wt(t.formattingContext);this.nodeContext=e.getRootNodeContext(t)}return t.prototype.allowLayout=function(t,e,n){var i=this.getRepetitiveElements();return!(i&&!nt.c(this.nodeContext.viewNode)&&i.isEnableToUpdateState()&&(e&&!t||t&&t.overflow))},t.prototype.nextCandidate=function(t){var e=this.getRepetitiveElements();return!!e&&!!e.isEnableToUpdateState()&&(e.updateState(),!0)},t.prototype.postLayout=function(t,e,n,i){var o=this.getRepetitiveElements();o&&t&&i.stopAtOverflow&&(null==e||o.isAfterLastContent(e))&&o.preventSkippingFooter()},t.prototype.finishBreak=function(t,e){var n=wt(this.nodeContext.formattingContext),i=this.getRepetitiveElements();if(!i)return K.d(!0);var o=this.nodeContext;return function(t,e,n){var i=t.getRepetitiveElements();if(i){var o=t.getRootNodeContext(e);if(o.viewNode){var r=o.viewNode.firstChild;return i.appendHeaderToFragment(o,r,n)}}return K.d(!0)}(n,o,e).thenAsync(function(){return function(t,e,n){var i=t.getRepetitiveElements();if(i&&!i.isSkipFooter){var o=t.getRootNodeContext(e);if(o.viewNode)return i.appendFooterToFragment(o,null,n)}return K.d(!0)}(n,o,e).thenAsync(function(){return i.prepareLayoutFragment(),K.d(!0)})})},t.prototype.getRepetitiveElements=function(){return wt(this.nodeContext.formattingContext).getRepetitiveElements()},t.prototype.equalsTo=function(e){return e instanceof t&&wt(this.nodeContext.formattingContext)===wt(e.nodeContext.formattingContext)},t.prototype.getPriorityOfFinishBreak=function(){return 10},t}(),vt=function(t){function e(e,n){var i=t.call(this)||this;return i.formattingContext=e,i.processor=n,i}return ut(e,t),e.prototype.resolveLayoutMode=function(t){var e=this.formattingContext.getRepetitiveElements();return t.belongsTo(this.formattingContext)||e.doneInitialLayout?(t.belongsTo(this.formattingContext)||t.after||e&&e.preventSkippingHeader(),new gt(this.formattingContext,this.processor)):new dt(this.formattingContext,this.processor)},e}(ot.a),yt=function(t){function e(e,n){var i=t.call(this)||this;return i.formattingContext=e,i.column=n,i}return ut(e,t),e.prototype.startNonInlineElementNode=function(t){var e=this.formattingContext,n=t.nodeContext,i=e.getRepetitiveElements();if(n.parent&&e.rootSourceNode===n.parent.sourceNode){switch(n.repeatOnBreak){case"header":if(!i.isHeaderRegistered())return i.setHeaderNodeContext(n),K.d(!0);n.repeatOnBreak="none";break;case"footer":if(!i.isFooterRegistered())return i.setFooterNodeContext(n),K.d(!0);n.repeatOnBreak="none"}i.firstContentSourceNode||(i.firstContentSourceNode=n.sourceNode)}return rt.EdgeSkipper.prototype.startNonInlineElementNode.call(this,t)},e.prototype.afterNonInlineElementNode=function(t){var e=this.formattingContext,n=t.nodeContext;return n.sourceNode===e.rootSourceNode&&(e.getRepetitiveElements().lastContentSourceNode=t.lastAfterNodeContext&&t.lastAfterNodeContext.sourceNode,t.break=!0),"header"===n.repeatOnBreak||"footer"===n.repeatOnBreak?K.d(!0):rt.EdgeSkipper.prototype.afterNonInlineElementNode.call(this,t)},e}(rt.EdgeSkipper);function bt(t,e){t&&function(t,e){for(var n=t;n;n=n.parent){var i=n.formattingContext;i&&i instanceof ct&&!n.belongsTo(i)&&e(i,n)}}(t.after?t.parent:t,function(t,n){lt.e.isInstanceOfTableFormattingContext(t)||e.fragmentLayoutConstraints.push(new mt(n))})}function wt(t){return y.a(t instanceof ct),t}!function(t){ut(function(e,n){var i=t.call(this)||this;return i.formattingContext=e,i.column=n,i},t)}(rt.EdgeSkipper);var Et=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ut(e,t),e.prototype.layout=function(t,e,n){if(e.isFloatNodeContext(t))return e.layoutFloatOrFootnote(t);var i=wt(t.formattingContext);return i.getRootViewNode(t)?(n&&bt(t.parent,e),t.belongsTo(i)?it.b.prototype.layout.call(this,t,e,n):new vt(i,this).layout(t,e)):e.buildDeepElementView(t)},e.prototype.startNonInlineElementNode=function(t){var e=function(t){var e=t.formattingContext;return e&&e instanceof ct?e:null}(t).getRepetitiveElements();return!!e&&(e.allowInsertRepeatitiveElements||!e.isHeaderSourceNode(t.sourceNode)&&!e.isFooterSourceNode(t.sourceNode)||t.viewNode.parentNode.removeChild(t.viewNode),!1)},e.prototype.doInitialLayout=function(t,e){wt(t.formattingContext);var n=K.c("BlockLayoutProcessor.doInitialLayout");return this.layoutEntireBlock(t,e).thenFinish(n),n.result()},e.prototype.layoutEntireBlock=function(t,e){var n=wt(t.formattingContext),i=new yt(n,e);return new rt.LayoutIterator(i,e.layoutContext).iterate(t)},e.prototype.doLayout=function(t,e){var n=wt(t.formattingContext),i=K.c("doLayout"),o=e.layoutContext.nextInTree(t,!1);return at.c(o,e).then(function(t){var o=t;i.loopWithFrame(function(t){for(var i=function(){var i=!0;if(e.layoutNext(o,!1).then(function(r){o=r,e.pageFloatLayoutContext.isInvalidated()?t.breakLoop():e.pageBreakType?t.breakLoop():o&&e.stopByOverflow(o)?t.breakLoop():o&&o.after&&o.sourceNode==n.rootSourceNode?t.breakLoop():i?i=!1:t.continueLoop()}),i)return i=!1,{value:void 0}};o;){var r=i();if("object"==typeof r)return r.value}t.breakLoop()}).then(function(){i.finish(o)})}),i.result()},e.prototype.finishBreak=function(t,e,n,i){return it.b.prototype.finishBreak.call(this,t,e,n,i)},e.prototype.clearOverflownViewNodes=function(t,e,n,i){it.b.prototype.clearOverflownViewNodes(t,e,n,i)},e}(it.b));l.d(l.a.RESOLVE_LAYOUT_PROCESSOR,function(t){return t instanceof ct&&!lt.e.isInstanceOfTableFormattingContext(t)?Et:null});var St=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Nt=function(){function t(t,e){this.rowIndex=t,this.sourceNode=e,this.cells=[]}return t.prototype.addCell=function(t){this.cells.push(t)},t.prototype.getMinimumHeight=function(){return Math.min.apply(null,this.cells.map(function(t){return t.height}))},t}(),Ct=function(){function t(t,e,n){this.rowIndex=t,this.columnIndex=e,this.height=0,this.anchorSlot=null,this.viewElement=n,this.colSpan=n.colSpan||1,this.rowSpan=n.rowSpan||1}return t.prototype.setHeight=function(t){this.height=t},t.prototype.setAnchorSlot=function(t){this.anchorSlot=t},t}(),Tt=function(t,e,n){this.rowIndex=t,this.columnIndex=e,this.cell=n},xt=function(){function t(t,e,n){this.column=t,this.cellNodeContext=n,this.empty=!1,this.pseudoColumn=new rt.PseudoColumn(t,e,n)}return t.prototype.findAcceptableBreakPosition=function(){var t=this.cellNodeContext.viewNode,e=this.cellNodeContext.verticalAlign;"middle"!==e&&"bottom"!==e||b.F(t,"vertical-align","top");var n=this.pseudoColumn.findAcceptableBreakPosition(!0);return b.F(t,"vertical-align",e),n},t}(),It=function(t,e){this.viewNode=t,this.side=e},Pt=function(t){function e(e,n,i,o){var r=t.call(this,e,n,i,o)||this;return r.acceptableCellBreakPositions=null,r.rowIndex=null,r.formattingContext=e.formattingContext,r}return St(e,t),e.prototype.findAcceptableBreak=function(e,n){var i=t.prototype.findAcceptableBreak.call(this,e,n);return n<this.getMinBreakPenalty()?null:this.getAcceptableCellBreakPositions().every(function(t){return!!t.nodeContext})?i:null},e.prototype.getMinBreakPenalty=function(){var e=t.prototype.getMinBreakPenalty.call(this);return this.getAcceptableCellBreakPositions().forEach(function(t){e+=t.breakPosition.getMinBreakPenalty()}),e},e.prototype.getAcceptableCellBreakPositions=function(){if(!this.acceptableCellBreakPositions){this.formattingContext;var t=this.getCellFragments();this.acceptableCellBreakPositions=t.map(function(t){return t.findAcceptableBreakPosition()})}return this.acceptableCellBreakPositions},e.prototype.getRowIndex=function(){return null!=this.rowIndex?this.rowIndex:this.rowIndex=this.formattingContext.findRowIndexBySourceNode(this.position.sourceNode)},e.prototype.getCellFragments=function(){return this.formattingContext.getRowSpanningCellsOverflowingTheRow(this.getRowIndex()).map(this.formattingContext.getCellFragmentOfCell,this.formattingContext)},e}(et.b),Ot=function(t){function e(e,n,i){var o=t.call(this)||this;return o.rowIndex=e,o.beforeNodeContext=n,o.formattingContext=i,o.acceptableCellBreakPositions=null,o}return St(e,t),e.prototype.findAcceptableBreak=function(t,e){if(e<this.getMinBreakPenalty())return null;var n=this.getCellFragments(),i=this.getAcceptableCellBreakPositions(),o=i.every(function(t){return!!t.nodeContext})&&i.some(function(t,e){var i=n[e].pseudoColumn,o=t.nodeContext;return!i.isStartNodeContext(o)&&!i.isLastAfterNodeContext(o)});return this.beforeNodeContext.overflow=i.some(function(t){return t.nodeContext&&t.nodeContext.overflow}),o?this.beforeNodeContext:null},e.prototype.getMinBreakPenalty=function(){var t=this.formattingContext,e=t.getRowByIndex(this.rowIndex),n=0;return t.isFreelyFragmentableRow(e)||(n+=10),this.getAcceptableCellBreakPositions().forEach(function(t){n+=t.breakPosition.getMinBreakPenalty()}),n},e.prototype.getAcceptableCellBreakPositions=function(){if(!this.acceptableCellBreakPositions){var t=this.getCellFragments();this.acceptableCellBreakPositions=t.map(function(t){return t.findAcceptableBreakPosition()})}return this.acceptableCellBreakPositions},e.prototype.getCellFragments=function(){return this.formattingContext.getCellsFallingOnRow(this.rowIndex).map(this.formattingContext.getCellFragmentOfCell,this.formattingContext)},e}(et.a),kt=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.tableSourceNode=n,i.formattingContextType="Table",i.vertical=!1,i.columnCount=-1,i.tableWidth=0,i.captions=[],i.colGroups=null,i.colWidths=null,i.inlineBorderSpacing=0,i.rows=[],i.slots=[],i.cellFragments=[],i.lastRowViewNode=null,i.cellBreakPositions=[],i.repetitiveElements=null,i}return St(e,t),e.prototype.getName=function(){return"Table formatting context (Table.TableFormattingContext)"},e.prototype.isFirstTime=function(t,e){if(!e)return e;switch(t.display){case"table-row":return 0===this.cellBreakPositions.length;case"table-cell":return!this.cellBreakPositions.some(function(e){return e.cellNodePosition.steps[0].node===t.sourceNode});default:return e}},e.prototype.getParent=function(){return this.parent},e.prototype.finishFragment=function(){this.cellFragments=[]},e.prototype.addRow=function(t,e){this.rows[t]=e},e.prototype.getRowSlots=function(t){var e=this.slots[t];return e||(e=this.slots[t]=[]),e},e.prototype.addCell=function(t,e){var n=this.rows[t];n||(this.addRow(t,new Nt(t,null)),n=this.rows[t]),y.a(n),n.addCell(e);for(var i=t+e.rowSpan,o=this.getRowSlots(t),r=0;o[r];)r++;for(;t<i;t++){o=this.getRowSlots(t);for(var a=r;a<r+e.colSpan;a++){var s=o[a]=new Tt(t,a,e);e.anchorSlot||e.setAnchorSlot(s)}}},e.prototype.getRowByIndex=function(t){var e=this.rows[t];return y.a(e),e},e.prototype.findRowIndexBySourceNode=function(t){return this.rows.findIndex(function(e){return t===e.sourceNode})},e.prototype.addCellFragment=function(t,e,n){var i=this.cellFragments[t];i||(i=this.cellFragments[t]=[]),i[e]=n},e.prototype.getCellsFallingOnRow=function(t){return this.getRowSlots(t).reduce(function(t,e){return e.cell!==t[t.length-1]?t.concat(e.cell):t},[])},e.prototype.getRowSpanningCellsOverflowingTheRow=function(t){return this.getCellsFallingOnRow(t).filter(function(e){return e.rowIndex+e.rowSpan-1>t})},e.prototype.getCellFragmentOfCell=function(t){return this.cellFragments[t.rowIndex]&&this.cellFragments[t.rowIndex][t.columnIndex]},e.prototype.isFreelyFragmentableRow=function(t){return t.getMinimumHeight()>this.tableWidth/2},e.prototype.getColumnCount=function(){return this.columnCount<0&&(this.columnCount=Math.max.apply(null,this.rows.map(function(t){return t.cells.reduce(function(t,e){return t+e.colSpan},0)}))),this.columnCount},e.prototype.updateCellSizes=function(t){var e=this;this.rows.forEach(function(n){n.cells.forEach(function(n){var i=t.getElementClientRect(n.viewElement);n.viewElement=null,n.setHeight(e.vertical?i.width:i.height)})})},e.prototype.findCellFromColumn=function(t){if(!t)return null;var e=null,n=0,i=0;t:for(n=0;n<this.cellFragments.length;n++)if(this.cellFragments[n])for(i=0;i<this.cellFragments[n].length;i++)if(this.cellFragments[n][i]&&t===this.cellFragments[n][i].pseudoColumn.getColumn()){e=this.rows[n].cells[i];break t}if(!e)return null;for(;n<this.slots.length;n++)for(;i<this.slots[n].length;i++){var o=this.slots[n][i];if(o.cell===e)return{rowIndex:o.rowIndex,columnIndex:o.columnIndex}}return null},e.prototype.collectElementsOffsetOfUpperCells=function(t){var e=this,n=[];return this.slots.reduce(function(i,o,r){if(r>=t.rowIndex)return i;var a=e.getCellFragmentOfCell(o[t.columnIndex].cell);return!a||n.includes(a)?i:(e.collectElementsOffsetFromColumn(a.pseudoColumn.getColumn(),i),n.push(a),i)},[])},e.prototype.collectElementsOffsetOfHighestColumn=function(){var t=this,e=[];return this.rows.forEach(function(n){n.cells.forEach(function(n,i){e[i]||(e[i]={collected:[],elements:[]});var o=e[i],r=t.getCellFragmentOfCell(n);r&&!o.collected.includes(r)&&(t.collectElementsOffsetFromColumn(r.pseudoColumn.getColumn(),o.elements),o.collected.push(r))})}),[new At(e.map(function(t){return t.elements}))]},e.prototype.collectElementsOffsetFromColumn=function(t,e){t.fragmentLayoutConstraints.forEach(function(t){if(lt.c.isInstanceOfRepetitiveElementsOwnerLayoutConstraint(t)){var n=t.getRepetitiveElements();e.push(n)}lt.e.isInstanceOfTableRowLayoutConstraint(t)&&t.getElementsOffsetsForTableCell(null).forEach(function(t){e.push(t)})})},e.prototype.saveState=function(){return[].concat(this.cellBreakPositions)},e.prototype.restoreState=function(t){this.cellBreakPositions=t},e}(ct),At=function(){function t(t){this.repeatitiveElementsInColumns=t}return t.prototype.calculateOffset=function(t){return this.calculateMaxOffsetOfColumn(t,function(t){return t.current})},t.prototype.calculateMinimumOffset=function(t){return this.calculateMaxOffsetOfColumn(t,function(t){return t.minimum})},t.prototype.calculateMaxOffsetOfColumn=function(t,e){var n=0;return this.repeatitiveElementsInColumns.forEach(function(i){var o=et.c(t,i);n=Math.max(n,e(o))}),n},t}();function Rt(t){return y.a(t instanceof kt),t}function Lt(t){return function(t){return"table-row-group"===t||"table-header-group"===t||"table-footer-group"===t}(t)||function(t){return"table"===t||"inline-table"===t}(t)}function _t(t,e,n){var i=t.nodeContext,o=i.display,r=i.parent?i.parent.display:null,a=!1;if("inline-table"===r&&!(i.formattingContext instanceof kt))for(var s=i.parent;s;s=s.parent)if(s.formattingContext instanceof kt){a=s.formattingContext===e;break}return a||"table-row"===o&&!Lt(r)||"table-cell"===o&&"table-row"!==r&&!Lt(r)||i.formattingContext instanceof kt&&i.formattingContext!==e?n.buildDeepElementView(i).thenAsync(function(e){return t.nodeContext=e,K.d(!0)}):null}var Ft=function(t){function e(e,n){var i=t.call(this)||this;return i.formattingContext=e,i.column=n,i.rowIndex=-1,i.columnIndex=0,i.inRow=!1,i.checkPoints=[],i.inHeaderOrFooter=!1,i}return St(e,t),e.prototype.startNonInlineElementNode=function(e){var n=this.formattingContext,i=_t(e,n,this.column);if(i)return i;this.postLayoutBlockContents(e);var o=e.nodeContext,r=o.display,a=n.getRepetitiveElements();switch(r){case"table":n.inlineBorderSpacing=o.inlineBorderSpacing;break;case"table-caption":var s=new It(o.viewNode,o.captionSide);n.captions.push(s);break;case"table-header-group":return a.isHeaderRegistered()||(this.inHeaderOrFooter=!0,a.setHeaderNodeContext(o)),K.d(!0);case"table-footer-group":return a.isFooterRegistered()||(this.inHeaderOrFooter=!0,a.setFooterNodeContext(o)),K.d(!0);case"table-row":this.inHeaderOrFooter||(this.inRow=!0,this.rowIndex++,y.a(o.sourceNode),this.columnIndex=0,n.addRow(this.rowIndex,new Nt(this.rowIndex,o.sourceNode)),a.firstContentSourceNode||(a.firstContentSourceNode=o.sourceNode))}return t.prototype.startNonInlineElementNode.call(this,e)},e.prototype.afterNonInlineElementNode=function(e){var n=this.formattingContext,i=e.nodeContext,o=i.display,r=this.column.clientLayout;if(this.postLayoutBlockContents(e),i.sourceNode===n.tableSourceNode){var a=r.getElementComputedStyle(n.getRootViewNode(i));n.tableWidth=parseFloat(a[n.vertical?"height":"width"]),n.getRepetitiveElements().lastContentSourceNode=e.lastAfterNodeContext&&e.lastAfterNodeContext.sourceNode,e.break=!0}else switch(o){case"table-header-group":case"table-footer-group":if(this.inHeaderOrFooter)return this.inHeaderOrFooter=!1,K.d(!0);break;case"table-row":this.inHeaderOrFooter||(n.lastRowViewNode=i.viewNode,this.inRow=!1);break;case"table-cell":if(!this.inHeaderOrFooter){this.inRow||(this.rowIndex++,this.columnIndex=0,this.inRow=!0);var s=i.viewNode;n.addCell(this.rowIndex,new Ct(this.rowIndex,this.columnIndex,s)),this.columnIndex++}}return t.prototype.afterNonInlineElementNode.call(this,e)},e.prototype.startNonElementNode=function(t){this.registerCheckPoint(t)},e.prototype.afterNonElementNode=function(t){this.registerCheckPoint(t)},e.prototype.startInlineElementNode=function(t){this.registerCheckPoint(t)},e.prototype.afterInlineElementNode=function(t){this.registerCheckPoint(t)},e.prototype.registerCheckPoint=function(t){var e=t.nodeContext;e&&e.viewNode&&!nt.e(e)&&this.checkPoints.push(e.clone())},e.prototype.postLayoutBlockContents=function(t){this.checkPoints.length>0&&this.column.postLayoutBlock(t.nodeContext,this.checkPoints),this.checkPoints=[]},e}(rt.EdgeSkipper),Dt=function(t){function e(e,n){var i=t.call(this,!0)||this;return i.formattingContext=e,i.column=n,i.inRow=!1,i.currentRowIndex=-1,i.currentColumnIndex=0,i.originalStopAtOverflow=n.stopAtOverflow,n.stopAtOverflow=!1,i}return St(e,t),e.prototype.resetColumn=function(){this.column.stopAtOverflow=this.originalStopAtOverflow},e.prototype.getColSpanningCellWidth=function(t){var e=this.formattingContext.colWidths;y.a(e);for(var n=0,i=0;i<t.colSpan;i++)n+=e[t.anchorSlot.columnIndex+i];return n+this.formattingContext.inlineBorderSpacing*(t.colSpan-1)},e.prototype.layoutCell=function(t,e,n){var i=t.rowIndex,o=t.columnIndex,r=t.colSpan,a=e.viewNode;e.verticalAlign,r>1&&(b.F(a,"box-sizing","border-box"),b.F(a,this.formattingContext.vertical?"height":"width",this.getColSpanningCellWidth(t)+"px"));var s=a.ownerDocument.createElement("div");a.appendChild(s);var l=new xt(this.column,s,e);return this.formattingContext.addCellFragment(i,o,l),1===n.primary.steps.length&&n.primary.after&&(l.empty=!0),l.pseudoColumn.layout(n,!0).thenReturn(!0)},e.prototype.hasBrokenCellAtSlot=function(t){var e=this.formattingContext.cellBreakPositions[0];return!!e&&e.cell.anchorSlot.columnIndex===t},e.prototype.extractRowSpanningCellBreakPositions=function(){var t=this.formattingContext.cellBreakPositions;if(0===t.length)return[];var e=[],n=0;do{var i=t[n],o=i.cell.rowIndex;if(o<this.currentRowIndex){var r=e[o];r||(r=e[o]=[]),r.push(i),t.splice(n,1)}else n++}while(n<t.length);return e},e.prototype.layoutRowSpanningCellsFromPreviousFragment=function(t){var e=this,n=this.formattingContext,i=this.extractRowSpanningCellBreakPositions(),o=i.reduce(function(t){return t+1},0);if(0===o)return K.d(!0);var r=this.column.layoutContext,a=t.nodeContext;a.viewNode.parentNode.removeChild(a.viewNode);var s=K.c("layoutRowSpanningCellsFromPreviousFragment"),l=K.d(!0),u=0,c=[];return i.forEach(function(t){l=l.thenAsync(function(){var i=q.v(t[0].cellNodePosition.steps[1],a.parent);return r.setCurrent(i,!1).thenAsync(function(){var a=K.d(!0),s=0;function l(t){for(;s<t;){if(!c.includes(s)){var e=i.viewNode.ownerDocument.createElement("td");b.F(e,"padding","0"),i.viewNode.appendChild(e)}s++}}return t.forEach(function(t){a=a.thenAsync(function(){var n=t.cell;l(n.anchorSlot.columnIndex);var a=t.cellNodePosition,h=q.v(a.steps[0],i);return h.offsetInNode=a.offsetInNode,h.after=a.after,h.fragmentIndex=a.steps[0].fragmentIndex+1,r.setCurrent(h,!1).thenAsync(function(){for(var i=t.breakChunkPosition,r=0;r<n.colSpan;r++)c.push(s+r);return s+=n.colSpan,e.layoutCell(n,h,i).thenAsync(function(){return h.viewNode.rowSpan=n.rowIndex+n.rowSpan-e.currentRowIndex+o-u,K.d(!0)})})})}),a.thenAsync(function(){return l(n.getColumnCount()),u++,K.d(!0)})})})}),l.then(function(){r.setCurrent(a,!0,t.atUnforcedBreak).then(function(){s.finish(!0)})}),s.result()},e.prototype.startTableRow=function(t){var e=this;if(this.inHeader||this.inFooter)return K.d(!0);var n=t.nodeContext,i=this.formattingContext;return this.currentRowIndex<0?(y.a(n.sourceNode),this.currentRowIndex=i.findRowIndexBySourceNode(n.sourceNode)):this.currentRowIndex++,this.currentColumnIndex=0,this.inRow=!0,this.layoutRowSpanningCellsFromPreviousFragment(t).thenAsync(function(){return e.registerCellFragmentIndex(),e.column.checkOverflowAndSaveEdgeAndBreakPosition(t.lastAfterNodeContext,null,!0,t.breakAtTheEdge)&&0===i.getRowSpanningCellsOverflowingTheRow(e.currentRowIndex-1).length&&(e.resetColumn(),n.overflow=!0,t.break=!0),K.d(!0)})},e.prototype.registerCellFragmentIndex=function(){var t=this;this.formattingContext.getRowByIndex(this.currentRowIndex).cells.forEach(function(e){var n=t.formattingContext.cellBreakPositions[e.columnIndex];if(n&&n.cell.anchorSlot.columnIndex==e.anchorSlot.columnIndex){var i=n.cellNodePosition.steps[0],o=t.column.layoutContext.xmldoc.getElementOffset(i.node);at.e(o,i.fragmentIndex+1,1)}})},e.prototype.startTableCell=function(t){var e=this;if(this.inHeader||this.inFooter)return K.d(!0);var n=t.nodeContext;this.inRow||(this.currentRowIndex<0?this.currentRowIndex=0:this.currentRowIndex++,this.currentColumnIndex=0,this.inRow=!0);var i=this.formattingContext.getRowByIndex(this.currentRowIndex).cells[this.currentColumnIndex],o=n.copy().modify();o.after=!0,t.nodeContext=o;var r,a=K.c("startTableCell");if(this.hasBrokenCellAtSlot(i.anchorSlot.columnIndex)){var s=this.formattingContext.cellBreakPositions.shift();n.fragmentIndex=s.cellNodePosition.steps[0].fragmentIndex+1,r=K.d(s.breakChunkPosition)}else r=this.column.nextInTree(n,t.atUnforcedBreak).thenAsync(function(t){t.viewNode&&n.viewNode.removeChild(t.viewNode);var e=q.x(t,0);return K.d(new q.a(e))});return r.then(function(o){y.a(n),e.layoutCell(i,n,o).then(function(){e.afterNonInlineElementNode(t),e.currentColumnIndex++,a.finish(!0)})}),a.result()},e.prototype.startNonInlineBox=function(t){var e=_t(t,Rt(this.formattingContext),this.column);if(e)return e;var n=t.nodeContext,i=this.formattingContext.getRepetitiveElements(),o=n.display;return"table-header-group"===o&&i&&i.isHeaderSourceNode(n.sourceNode)?(this.inHeader=!0,K.d(!0)):"table-footer-group"===o&&i&&i.isFooterSourceNode(n.sourceNode)?(this.inFooter=!0,K.d(!0)):"table-row"===o?this.startTableRow(t):"table-cell"===o?this.startTableCell(t):K.d(!0)},e.prototype.endNonInlineBox=function(t){var e=t.nodeContext;if("table-row"===e.display&&(this.inRow=!1,!this.inHeader&&!this.inFooter)){var n=e.copy().modify();n.after=!1;var i=new Ot(this.currentRowIndex,n,this.formattingContext);this.column.breakPositions.push(i)}return K.d(!0)},e.prototype.afterNonInlineElementNode=function(n){var i=n.nodeContext,o=this.formattingContext.getRepetitiveElements(),r=i.display;if("table-header-group"===r?o&&!o.allowInsertRepeatitiveElements&&o.isHeaderSourceNode(i.sourceNode)?(this.inHeader=!1,i.viewNode.parentNode.removeChild(i.viewNode)):b.F(i.viewNode,"display","table-row-group"):"table-footer-group"===r&&(o&&!o.allowInsertRepeatitiveElements&&o.isFooterSourceNode(i.sourceNode)?(this.inFooter=!1,i.viewNode.parentNode.removeChild(i.viewNode)):b.F(i.viewNode,"display","table-row-group")),r&&e.ignoreList[r])i.viewNode.parentNode.removeChild(i.viewNode);else{if(i.sourceNode!==this.formattingContext.tableSourceNode)return t.prototype.afterNonInlineElementNode.call(this,n);i.overflow=this.column.checkOverflowAndSaveEdge(i,null),this.resetColumn(),n.break=!0}return K.d(!0)},e.ignoreList={"table-caption":!0,"table-column-group":!0,"table-column":!0},e}(rt.EdgeSkipper),Bt=[],Mt=function(){function t(){}return t.prototype.layoutEntireTable=function(t,e){var n=Rt(t.formattingContext),i=new Ft(n,e);return new rt.LayoutIterator(i,e.layoutContext).iterate(t)},t.prototype.getColumnWidths=function(t,e,n,i){for(var o=t.ownerDocument,r=o.createElement("tr"),a=[],s=0;s<e;s++){var l=o.createElement("td");r.appendChild(l),a.push(l)}t.parentNode.insertBefore(r,t.nextSibling);var u=a.map(function(t){var e=i.getElementClientRect(t);return n?e.height:e.width});return t.parentNode.removeChild(r),u},t.prototype.getColGroupElements=function(t){for(var e=[],n=t.firstElementChild;n;)"colgroup"===n.localName&&e.push(n),n=n.nextElementSibling;return e},t.prototype.normalizeAndGetColElements=function(t){var e=[];return t.forEach(function(t){var n=t.span;t.removeAttribute("span");for(var i=t.firstElementChild;i;){if("col"===i.localName){var o=i.span;for(i.removeAttribute("span"),n-=o;o-- >1;){var r=i.cloneNode(!0);t.insertBefore(r,i),e.push(r)}e.push(i)}i=i.nextElementSibling}for(;n-- >0;)i=t.ownerDocument.createElement("col"),t.appendChild(i),e.push(i)}),e},t.prototype.addMissingColElements=function(t,e,n,i){if(t.length<n){var o=i.ownerDocument.createElement("colgroup");e.push(o);for(var r=t.length;r<n;r++){var a=i.ownerDocument.createElement("col");o.appendChild(a),t.push(a)}}},t.prototype.normalizeColGroups=function(t,e,n){var i=t.vertical,o=t.lastRowViewNode;if(o){y.a(o),t.lastRowViewNode=null;var r=o.ownerDocument.createDocumentFragment(),a=t.getColumnCount();if(a>0){var s=t.colWidths=this.getColumnWidths(o,a,i,n.clientLayout),l=this.getColGroupElements(e),u=this.normalizeAndGetColElements(l);this.addMissingColElements(u,l,a,e),u.forEach(function(t,e){b.F(t,i?"height":"width",s[e]+"px")}),l.forEach(function(t){r.appendChild(t.cloneNode(!0))}),t.colGroups=r}else t.colGroups=r}},t.prototype.doInitialLayout=function(t,e){var n=this,i=Rt(t.formattingContext);i.vertical=t.vertical,i.initializeRepetitiveElements(t.vertical),y.a(t.sourceNode);var o,r,a,s=(o=t.sourceNode,r=Bt.findIndex(function(t){return t.root===o}),(a=Bt[r])?a.tableLayoutOption:null);!function(t){var e=Bt.findIndex(function(e){return e.root===t});e>=0&&Bt.splice(e,1)}(t.sourceNode);var l=K.c("TableLayoutProcessor.doInitialLayout"),u=t.copy();return this.layoutEntireTable(t,e).then(function(o){var r=o.viewNode,a=e.clientLayout.getElementClientRect(r),c=e.vertical?a.left:a.bottom;if(c+=(e.vertical?-1:1)*et.c(t,e.collectElementsOffset()).current,!(e.isOverflown(c)||s&&s.calculateBreakPositionsInside))return e.breakPositions.push(new Vt(u)),void l.finish(o);n.normalizeColGroups(i,r,e),i.updateCellSizes(e.clientLayout),l.finish(null)}),l.result()},t.prototype.addCaptions=function(t,e,n){var i=t.captions;i.forEach(function(t,o){t&&(e.insertBefore(t.viewNode,n),"top"===t.side&&(i[o]=null))})},t.prototype.addColGroups=function(t,e,n){t.colGroups&&0===this.getColGroupElements(e).length&&e.insertBefore(t.colGroups.cloneNode(!0),n)},t.prototype.removeColGroups=function(t,e){if(t.colGroups&&e){var n=this.getColGroupElements(e);n&&n.forEach(function(t){e.removeChild(t)})}},t.prototype.doLayout=function(t,e){var n=Rt(t.formattingContext),i=n.getRootViewNode(t),o=i.firstChild;this.addCaptions(n,i,o),this.addColGroups(n,i,o);var r=new Dt(n,e),a=new rt.LayoutIterator(r,e.layoutContext),s=K.c("TableFormattingContext.doLayout");return a.iterate(t).thenFinish(s),s.result()},t.prototype.layout=function(t,e,n){var i=Rt(t.formattingContext);return i.getRootViewNode(t)?(n&&bt(t.parent,e),new Ut(i,this).layout(t,e)):e.buildDeepElementView(t)},t.prototype.createEdgeBreakPosition=function(t,e,n,i){return new Pt(t,e,n,i)},t.prototype.startNonInlineElementNode=function(t){return!1},t.prototype.afterNonInlineElementNode=function(t,e){return!1},t.prototype.finishBreak=function(t,e,n,i){var o=Rt(e.formattingContext);if("table-row"===e.display){y.a(e.sourceNode);var r,a=o.findRowIndexBySourceNode(e.sourceNode);if(o.cellBreakPositions=[],(r=e.after?o.getRowSpanningCellsOverflowingTheRow(a):o.getCellsFallingOnRow(a)).length){var s=K.c("TableLayoutProcessor.finishBreak"),l=0;return s.loopWithFrame(function(t){if(l!==r.length){var e=r[l++],n=o.getCellFragmentOfCell(e),i=n.findAcceptableBreakPosition().nodeContext;y.a(i);var s=n.cellNodeContext,u=s.toNodePosition(),c=new q.a(i.toNodePosition());o.cellBreakPositions.push({cellNodePosition:u,breakChunkPosition:c,cell:e});var h=s.viewNode;n.column.layoutContext.processFragmentedBlockEdge(n.cellNodeContext),a<e.rowIndex+e.rowSpan-1&&(h.rowSpan=a-e.rowIndex+1),n.empty?t.continueLoop():n.pseudoColumn.finishBreak(i,!1,!0).then(function(){y.a(n),function(t,e,n){var i=e.getRepetitiveElements();if(i){var o=e.vertical,r=t.column,a=t.pseudoColumn.getColumnElement(),s=t.cellNodeContext.viewNode,l=r.clientLayout.getElementClientRect(s),u=r.getComputedPaddingBorder(s);if(o){var c=l.right-r.footnoteEdge-i.calculateOffset(n)-u.right;b.F(a,"max-width",c+"px")}else{var h=r.footnoteEdge-i.calculateOffset(n)-l.top-u.top;b.F(a,"max-height",h+"px")}b.F(a,"overflow","hidden")}}(n,o,i),t.continueLoop()})}else t.breakLoop()}).then(function(){t.clearOverflownViewNodes(e,!1),t.layoutContext.processFragmentedBlockEdge(e),o.finishFragment(),s.finish(!0)}),s.result()}}return o.finishFragment(),it.d.finishBreak(t,e,n,i)},t.prototype.clearOverflownViewNodes=function(t,e,n,i){it.b.prototype.clearOverflownViewNodes(t,e,n,i)},t}(),Ut=function(t){function e(e,n){var i=t.call(this)||this;return i.tableFormattingContext=e,i.processor=n,i}return St(e,t),e.prototype.resolveLayoutMode=function(t){var e=this.tableFormattingContext.getRepetitiveElements();return e&&e.doneInitialLayout?(t.sourceNode!==this.tableFormattingContext.tableSourceNode||t.after||e&&e.preventSkippingHeader(),new Gt(this.tableFormattingContext,this.processor)):new zt(this.tableFormattingContext,this.processor)},e.prototype.clearNodes=function(e){t.prototype.clearNodes.call(this,e);var n=this.tableFormattingContext.getRootViewNode(e);this.processor.removeColGroups(this.tableFormattingContext,n)},e.prototype.restoreState=function(e,n){t.prototype.restoreState.call(this,e,n),this.tableFormattingContext.finishFragment()},e}(ot.a),zt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.processor=n,i}return St(e,t),e.prototype.doLayout=function(t,e){return this.processor.doInitialLayout(t,e)},e}(pt),Vt=function(t){function e(e){return t.call(this,e,null,e.overflow,0)||this}return St(e,t),e.prototype.getMinBreakPenalty=function(){if(!this.isEdgeUpdated)throw new Error("EdgeBreakPosition.prototype.updateEdge not called");return(this.overflows?3:0)+(this.position.parent?this.position.parent.breakPenalty:0)},e.prototype.breakPositionChosen=function(t){t.fragmentLayoutConstraints.push(new Ht(this.position.sourceNode))},e}(et.b),Ht=function(){function t(t){this.tableRootNode=t,this.flagmentLayoutConstraintType="EntireTable"}return t.prototype.allowLayout=function(t,e,n){return y.a(!t.overflow),!1},t.prototype.nextCandidate=function(t){return!0},t.prototype.postLayout=function(t,e,n,i){y.a(e.sourceNode),Bt.push({root:e.sourceNode,tableLayoutOption:{calculateBreakPositionsInside:!0}})},t.prototype.finishBreak=function(t,e){return K.d(!0)},t.prototype.equalsTo=function(e){return e instanceof t&&e.tableRootNode===this.tableRootNode},t.prototype.getPriorityOfFinishBreak=function(){return 0},t}(),Gt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.processor=n,i}return St(e,t),e.prototype.doLayout=function(t,e){var n=this.formattingContext.getRepetitiveElements();if(n&&!n.isAfterLastContent(t)){var i=new Wt(t);e.fragmentLayoutConstraints.some(function(t){return i.equalsTo(t)})||e.fragmentLayoutConstraints.unshift(i)}return this.processor.doLayout(t,e)},e}(ft),Wt=function(t){function e(e){var n=t.call(this,e)||this;return n.flagmentLayoutConstraintType="TableRow",n.cellFragmentLayoutConstraints=[],n}return St(e,t),e.prototype.allowLayout=function(t,e,n){var i=this.getRepetitiveElements();return!(i&&!n.pseudoParent&&!nt.c(this.nodeContext.viewNode)&&i.isEnableToUpdateState()&&(e&&!t||t&&t.overflow))},e.prototype.nextCandidate=function(e){var n=Rt(this.nodeContext.formattingContext);return!!this.collectCellFragmentLayoutConstraints(e,n).some(function(t){return t.constraints.some(function(t){return t.nextCandidate(e)})})||t.prototype.nextCandidate.call(this,e)},e.prototype.postLayout=function(e,n,i,o){var r=Rt(this.nodeContext.formattingContext);if(this.cellFragmentLayoutConstraints=this.collectCellFragmentLayoutConstraints(n,r),this.cellFragmentLayoutConstraints.forEach(function(t){t.constraints.forEach(function(n){n.postLayout(e,t.breakPosition,i,o)})}),!e){var a=r.getRootViewNode(this.nodeContext);(new Mt).removeColGroups(r,a),this.removeDummyRowNodes(i)}t.prototype.postLayout.call(this,e,n,i,o)},e.prototype.finishBreak=function(e,n){var i=this,o=(Rt(this.nodeContext.formattingContext),K.c("finishBreak")),r=this.cellFragmentLayoutConstraints.reduce(function(t,e){return t.concat(e.constraints.map(function(t){return{constraint:t,breakPosition:e.breakPosition}}))},[]),a=0;return o.loop(function(){if(a<r.length){var t=r[a++];return t.constraint.finishBreak(t.breakPosition,n).thenReturn(!0)}return K.d(!1)}).then(function(){o.finish(!0)}),o.result().thenAsync(function(){return t.prototype.finishBreak.call(i,e,n)})},e.prototype.removeDummyRowNodes=function(t){if(t&&"table-row"===t.display&&t.viewNode)for(;t.viewNode.previousElementSibling;){var e=t.viewNode.previousElementSibling;e.parentNode&&e.parentNode.removeChild(e)}},e.prototype.collectCellFragmentLayoutConstraints=function(t,e){return this.getCellFragemnts(t,e).map(function(t){return{constraints:t.fragment.pseudoColumn.getColumn().fragmentLayoutConstraints,breakPosition:t.breakPosition}})},e.prototype.getCellFragemnts=function(t,e){var n=Number.MAX_VALUE;t&&"table-row"===t.display&&(y.a(t.sourceNode),n=e.findRowIndexBySourceNode(t.sourceNode)+1),n=Math.min(e.cellFragments.length,n);for(var i=[],o=0;o<n;o++)e.cellFragments[o]&&e.cellFragments[o].forEach(function(t){t&&i.push({fragment:t,breakPosition:t.findAcceptableBreakPosition().nodeContext})});return i},e.prototype.getElementsOffsetsForTableCell=function(t){var e=Rt(this.nodeContext.formattingContext),n=e.findCellFromColumn(t);return n?e.collectElementsOffsetOfUpperCells(n):e.collectElementsOffsetOfHighestColumn()},e.prototype.equalsTo=function(t){return t instanceof e&&Rt(this.nodeContext.formattingContext)===Rt(t.nodeContext.formattingContext)},e}(mt),jt=new Mt;l.d(l.a.RESOLVE_FORMATTING_CONTEXT,function(t,e,n,i,o,r){if(!e)return null;if(n===j.t.table){var a=t.parent;return new kt(a?a.formattingContext:null,t.sourceNode)}return null}),l.d(l.a.RESOLVE_LAYOUT_PROCESSOR,function(t){return t instanceof kt?jt:null});var Xt=n(13);function Kt(t){return t.reduce(function(t,e){return t+e},0)/t.length}var qt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Yt=function(t,e){this.layoutResult=t,this.penalty=e};function $t(t){return t.vertical?t.width:t.height}function Zt(t,e){t.vertical?t.width=e:t.height=e}var Qt=function(){function t(t,e,n){this.layoutContainer=t,this.columnGenerator=e,this.regionPageFloatLayoutContext=n,this.originalContainerBlockSize=$t(t)}return t.prototype.balanceColumns=function(t){var e=this,n=K.c("ColumnBalancer#balanceColumns");e.preBalance(t),e.savePageFloatLayoutContexts(t),e.layoutContainer.clear();var i=[e.createTrialResult(t)];return n.loopWithFrame(function(t){e.hasNextCandidate(i)?(e.updateCondition(i),e.columnGenerator().then(function(n){e.savePageFloatLayoutContexts(n),e.layoutContainer.clear(),n?(i.push(e.createTrialResult(n)),t.continueLoop()):t.breakLoop()})):t.breakLoop()}).then(function(){var t=i.reduce(function(t,e){return e.penalty<t.penalty?e:t},i[0]);e.restoreContents(t.layoutResult),e.postBalance(),n.finish(t.layoutResult)}),n.result()},t.prototype.createTrialResult=function(t){var e=this.calculatePenalty(t);return new Yt(t,e)},t.prototype.preBalance=function(t){},t.prototype.postBalance=function(){Zt(this.layoutContainer,this.originalContainerBlockSize)},t.prototype.savePageFloatLayoutContexts=function(t){var e=this.regionPageFloatLayoutContext.detachChildren();t&&(t.columnPageFloatLayoutContexts=e)},t.prototype.restoreContents=function(t){var e=this.layoutContainer.element;t.columns.forEach(function(t){e.appendChild(t.element)}),y.a(t.columnPageFloatLayoutContexts),this.regionPageFloatLayoutContext.attachChildren(t.columnPageFloatLayoutContexts)},t}(),Jt=1;function te(t){var e=t[t.length-1];if(0===e.penalty)return!1;var n=t[t.length-2];if(n&&e.penalty>=n.penalty)return!1;var i=e.layoutResult.columns;return Math.max.apply(null,i.map(function(t){return t.computedBlockSize}))>Math.max.apply(null,i.map(function(t){return t.getMaxBlockSizeOfPageFloats()}))+Jt}function ee(t,e){var n=t[t.length-1].layoutResult.columns,i=Math.max.apply(null,n.map(function(t){return isNaN(t.blockDistanceToBlockEndFloats)?t.computedBlockSize:t.computedBlockSize-t.blockDistanceToBlockEndFloats+Jt}))-Jt;i<$t(e)?Zt(e,i):Zt(e,$t(e)-1)}var ne=function(t){function e(e,n,i,o){var r=t.call(this,i,e,n)||this;return r.columnCount=o,r.originalPosition=null,r.foundUpperBound=!1,r}return qt(e,t),e.prototype.preBalance=function(t){var e=t.columns.reduce(function(t,e){return t+e.computedBlockSize},0);Zt(this.layoutContainer,e/this.columnCount),this.originalPosition=t.position},e.prototype.checkPosition=function(t){return this.originalPosition?this.originalPosition.isSamePosition(t):null===t},e.prototype.calculatePenalty=function(t){if(!this.checkPosition(t.position))return 1/0;var e=t.columns;return ie(e)?1/0:Math.max.apply(null,e.map(function(t){return t.computedBlockSize}))},e.prototype.hasNextCandidate=function(t){if(1===t.length)return!0;if(this.foundUpperBound)return te(t);var e=t[t.length-1];return this.checkPosition(e.layoutResult.position)&&!ie(e.layoutResult.columns)?(this.foundUpperBound=!0,!0):$t(this.layoutContainer)<this.originalContainerBlockSize},e.prototype.updateCondition=function(t){if(this.foundUpperBound)ee(t,this.layoutContainer);else{var e=Math.min(this.originalContainerBlockSize,$t(this.layoutContainer)+.1*this.originalContainerBlockSize);Zt(this.layoutContainer,e)}},e}(Qt);function ie(t){if(t.length<=1)return!1;var e=t[t.length-1].computedBlockSize;return t.slice(0,t.length-1).every(function(t){return e>t.computedBlockSize})}var oe,re=function(t){function e(e,n,i){return t.call(this,i,e,n)||this}return qt(e,t),e.prototype.calculatePenalty=function(t){if(t.columns.every(function(t){return 0===t.computedBlockSize}))return 1/0;var e,n,i=t.columns.filter(function(t){return!t.pageBreakType}).map(function(t){return t.computedBlockSize});return n=Kt(e=i),Kt(e.map(function(t){var e=t-n;return e*e}))},e.prototype.hasNextCandidate=function(t){return te(t)},e.prototype.updateCondition=function(t){ee(t,this.layoutContainer)},e}(Qt),ae=n(24),se=function(t,e,n){this.endStuckFixed=t,this.endFixed=e,this.endSlipped=n},le=function(){function t(){this.map=[]}return t.prototype.getMaxFixed=function(){return 0==this.map.length?0:this.map[this.map.length-1].endFixed},t.prototype.getMaxSlipped=function(){return 0==this.map.length?0:this.map[this.map.length-1].endSlipped},t.prototype.addStuckRange=function(t){if(0==this.map.length)this.map.push(new se(t,t,t));else{var e=this.map[this.map.length-1],n=e.endSlipped+t-e.endFixed;e.endFixed==e.endStuckFixed?(e.endFixed=t,e.endStuckFixed=t,e.endSlipped=n):this.map.push(new se(t,t,n))}},t.prototype.addSlippedRange=function(t){0==this.map.length?this.map.push(new se(t,0,0)):this.map[this.map.length-1].endFixed=t},t.prototype.slippedByFixed=function(t){var e=this,n=b.i(this.map.length,function(n){return t<=e.map[n].endFixed}),i=this.map[n];return i.endSlipped-Math.max(0,i.endStuckFixed-t)},t.prototype.fixedBySlipped=function(t){var e=this,n=b.i(this.map.length,function(n){return t<=e.map[n].endSlipped}),i=this.map[n];return i.endStuckFixed-(i.endSlipped-t)},t}(),ue=function(){function t(e,n,i,o,r,a,s,l){if(this.context=e,this.style=n,this.offset=i,this.isRoot=o,this.flowChunk=r,this.atBlockStart=a,this.atFlowStart=s,this.isParentBoxDisplayed=l,this.isBlockValue=null,this.hasBoxValue=null,this.styleValues={},this.beforeBox=null,this.afterBox=null,this.breakBefore=null,this.flowName=r.flowName,this.hasBox()){var u=n._pseudos;if(u&&u.before){var c=new t(e,u.before,i,!1,r,this.isBlock(),s,!0),h=c.styleValue("content");q.y(h)&&(this.beforeBox=c,this.breakBefore=c.breakBefore)}}this.breakBefore=Xt.d(this.getBreakValue("before"),this.breakBefore),this.atFlowStart&&Xt.c(this.breakBefore)&&(r.breakBefore=Xt.d(r.breakBefore,this.breakBefore))}return t.prototype.buildAfterPseudoElementBox=function(e,n,i){if(this.hasBox()){var o=this.style._pseudos;if(o&&o.after){var r=new t(this.context,o.after,e,!1,this.flowChunk,n,i,!0),a=r.styleValue("content");q.y(a)&&(this.afterBox=r)}}},t.prototype.styleValue=function(t,e){if(!(t in this.styleValues)){var n=this.style[t];this.styleValues[t]=n?n.evaluate(this.context,t):e||null}return this.styleValues[t]},t.prototype.displayValue=function(){return this.styleValue("display",j.t.inline)},t.prototype.isBlock=function(){if(null===this.isBlockValue){var t=this.displayValue(),e=this.styleValue("position"),n=this.styleValue("float");this.isBlockValue=ae.d(t,e,n,this.isRoot)}return this.isBlockValue},t.prototype.hasBox=function(){return null===this.hasBoxValue&&(this.hasBoxValue=this.isParentBoxDisplayed&&this.displayValue()!==j.t.none),this.hasBoxValue},t.prototype.getBreakValue=function(t){var e=null;if(this.isBlock()){var n=this.styleValue("break-"+t);n&&(e=n.toString())}return e},t}(),ce=function(){function t(t){this.context=t,this.stack=[],this.atBlockStart=!0,this.atFlowStart=!0,this.atStartStack=[]}return t.prototype.empty=function(){return 0===this.stack.length},t.prototype.lastBox=function(){return this.stack[this.stack.length-1]},t.prototype.lastFlowName=function(){var t=this.lastBox();return t?t.flowChunk.flowName:null},t.prototype.isCurrentBoxDisplayed=function(){return this.stack.every(function(t){return t.displayValue()!==j.t.none})},t.prototype.push=function(t,e,n,i){var o=this.lastBox();i&&o&&i.flowName!==o.flowName&&this.atStartStack.push({atBlockStart:this.atBlockStart,atFlowStart:this.atFlowStart});var r=i||o.flowChunk,a=this.atFlowStart||!!i,s=this.isCurrentBoxDisplayed(),l=new ue(this.context,t,e,n,r,a||this.atBlockStart,a,s);return this.stack.push(l),this.atBlockStart=l.hasBox()?!l.beforeBox&&l.isBlock():this.atBlockStart,this.atFlowStart=l.hasBox()?!l.beforeBox&&a:this.atFlowStart,l},t.prototype.encounteredTextNode=function(t){var e=this.lastBox();if((this.atBlockStart||this.atFlowStart)&&e.hasBox()){var n=e.styleValue("white-space",j.t.normal).toString(),i=q.z(n);y.a(null!==i),q.p(t,i)||(this.atBlockStart=!1,this.atFlowStart=!1)}},t.prototype.pop=function(t){var e=this.stack.pop();if(e.buildAfterPseudoElementBox(t,this.atBlockStart,this.atFlowStart),this.atFlowStart&&e.afterBox){var n=e.afterBox.getBreakValue("before");e.flowChunk.breakBefore=Xt.d(e.flowChunk.breakBefore,n)}var i=this.lastBox();if(i)if(i.flowName===e.flowName)e.hasBox()&&(this.atBlockStart=this.atFlowStart=!1);else{var o=this.atStartStack.pop();this.atBlockStart=o.atBlockStart,this.atFlowStart=o.atFlowStart}return e},t.prototype.nearestBlockStartOffset=function(t){if(!t.atBlockStart)return t.offset;var e=this.stack.length-1,n=this.stack[e];for(n===t&&(e--,n=this.stack[e]);e>=0;){if(n.flowName!==t.flowName)return t.offset;if(!n.atBlockStart)return n.offset;if(n.isRoot)return n.offset;t=n,n=this.stack[--e]}throw new Error("No block start offset found!")},t}(),he=function(){function t(t,e,n,i,o,r,a,s){this.xmldoc=t,this.scope=n,this.context=i,this.primaryFlows=o,this.validatorSet=r,this.counterListener=a,this.rootStyle={},this.styleMap={},this.flows={},this.flowChunks=[],this.flowListener=null,this.flowToReach=null,this.idToReach=null,this.primary=!0,this.primaryStack=[],this.rootBackgroundAssigned=!1,this.rootLayoutAssigned=!1,this.breakBeforeValues={},this.bodyReached=!0,this.root=t.root,this.cascadeHolder=e,this.last=this.root,this.cascade=e.createInstance(i,a,s,t.lang),this.offsetMap=new le;var l=t.getElementOffset(this.root);this.lastOffset=l,this.boxStack=new ce(i),this.offsetMap.addStuckRange(l);var u=this.getAttrStyle(this.root);switch(this.cascade.pushElement(this.root,u,l),this.postprocessTopStyle(u,!1),this.root.namespaceURI){case b.a.XHTML:case b.a.FB2:this.bodyReached=!1}this.primaryStack.push(!0),this.styleMap={},this.styleMap["e"+l]=u,this.lastOffset++,this.replayFlowElementsFromOffset(-1)}return t.prototype.hasProp=function(t,e,n){var i=t[n];return i&&i.evaluate(this.context)!==e[n]},t.prototype.transferPropsToRoot=function(t,e){for(var n in e){var i=t[n];if(i)this.rootStyle[n]=i,delete t[n];else{var o=e[n];o&&(this.rootStyle[n]=new V.c(o,H.c))}}},t.prototype.postprocessTopStyle=function(t,e){var n=this;if(["writing-mode","direction"].forEach(function(i){!t[i]||e&&n.rootStyle[i]||(n.rootStyle[i]=t[i])}),!this.rootBackgroundAssigned){var i=this.hasProp(t,this.validatorSet.backgroundProps,"background-color")?t["background-color"].evaluate(this.context):null,o=this.hasProp(t,this.validatorSet.backgroundProps,"background-image")?t["background-image"].evaluate(this.context):null;(i&&i!==j.t.inherit||o&&o!==j.t.inherit)&&(this.transferPropsToRoot(t,this.validatorSet.backgroundProps),this.rootBackgroundAssigned=!0)}if(!this.rootLayoutAssigned)for(var r=0;r<pe.length;r++)if(this.hasProp(t,this.validatorSet.layoutProps,pe[r])){this.transferPropsToRoot(t,this.validatorSet.layoutProps),this.rootLayoutAssigned=!0;break}if(!e){var a=t["font-size"];if(a){var s=a.evaluate(this.context),l=s.num;switch(s.unit){case"em":case"rem":l*=this.context.initialFontSize;break;case"ex":l*=this.context.initialFontSize*R.G.ex/R.G.em;break;case"%":l*=this.context.initialFontSize/100;break;default:var u=R.G[s.unit];u&&(l*=u)}this.context.rootFontSize=l}}},t.prototype.getTopContainerStyle=function(){for(var t=0;!this.bodyReached&&(t+=5e3,this.styleUntil(t,0)!=Number.POSITIVE_INFINITY););return this.rootStyle},t.prototype.getAttrStyle=function(t){if(t.style instanceof CSSStyleDeclaration){var e=t.getAttribute("style");if(e)return V.E(this.scope,this.validatorSet,this.xmldoc.url,e)}return{}},t.prototype.getReachedOffset=function(){return this.lastOffset},t.prototype.replayFlowElementsFromOffset=function(t){if(!(t>=this.lastOffset)){var e=this.context,n=this.xmldoc.getElementOffset(this.root);if(t<n){var i=this.getStyle(this.root,!1);y.a(i);var o=(l=V.s(i,"flow-into"))?l.evaluate(e,"flow-into").toString():"body",r=this.encounteredFlowElement(o,i,this.root,n);this.boxStack.empty()&&this.boxStack.push(i,n,!0,r)}var a=this.xmldoc.getNodeByOffset(t),s=this.xmldoc.getNodeOffset(a,0,!1);if(!(s>=this.lastOffset))for(;;){if(1!=a.nodeType)s+=a.textContent.length;else{var l,u=a,c=this.getStyle(u,!1);(l=c["flow-into"])&&(o=l.evaluate(e,"flow-into").toString(),this.encounteredFlowElement(o,c,u,s)),s++}if(s>=this.lastOffset)break;var h=a.firstChild;if(null==h)for(;!(h=a.nextSibling);)if((a=a.parentNode)===this.root)return;a=h}}},t.prototype.resetFlowChunkStream=function(t){this.flowListener=t;for(var e=0;e<this.flowChunks.length;e++)this.flowListener.encounteredFlowChunk(this.flowChunks[e],this.flows[this.flowChunks[e].flowName])},t.prototype.styleUntilFlowIsReached=function(t){this.flowToReach=t;for(var e=0;null!=this.flowToReach&&(e+=5e3,this.styleUntil(e,0)!=Number.POSITIVE_INFINITY););},t.prototype.styleUntilIdIsReached=function(t){if(t){this.idToReach=t;for(var e=0;this.idToReach&&(e+=5e3,this.styleUntil(e,0)!==Number.POSITIVE_INFINITY););this.idToReach=null}},t.prototype.encounteredFlowElement=function(t,e,n,i){var o=0,r=Number.POSITIVE_INFINITY,a=!1,s=!1,l=!1,u=e["flow-options"];if(u){var c=A.d(u.evaluate(this.context,"flow-options"));a=!!c.exclusive,s=!!c.static,l=!!c.last}var h=e["flow-linger"];h&&(r=A.c(h.evaluate(this.context,"flow-linger"),Number.POSITIVE_INFINITY));var p=e["flow-priority"];p&&(o=A.c(p.evaluate(this.context,"flow-priority"),0));var f=this.breakBeforeValues[i]||null,d=this.flows[t];if(!d){var g=this.boxStack.lastFlowName();d=this.flows[t]=new q.f(t,g)}var m=new q.g(t,n,i,o,r,a,s,l,f);return this.flowChunks.push(m),this.flowToReach==t&&(this.flowToReach=null),this.flowListener&&this.flowListener.encounteredFlowChunk(m,d),m},t.prototype.registerForcedBreakOffset=function(t,e,n){if(Xt.c(t)){var i=this.flows[n].forcedBreakOffsets;(0===i.length||i[i.length-1]<e)&&i.push(e)}var o=this.breakBeforeValues[e];this.breakBeforeValues[e]=Xt.d(o,t)},t.prototype.styleUntil=function(t,e){var n=-1;if(t<=this.lastOffset&&(n=this.offsetMap.slippedByFixed(t)+e)<this.offsetMap.getMaxSlipped())return this.offsetMap.fixedBySlipped(n);if(null==this.last)return Number.POSITIVE_INFINITY;for(var i=this.context;;){var o=this.last.firstChild;if(null==o)for(;;){if(1==this.last.nodeType){this.cascade.popElement(this.last),this.primary=this.primaryStack.pop();var r=null;if((c=this.boxStack.pop(this.lastOffset)).afterBox){var a=c.afterBox.getBreakValue("before");this.registerForcedBreakOffset(a,c.afterBox.atBlockStart?this.boxStack.nearestBlockStartOffset(c):c.afterBox.offset,c.flowName),r=c.afterBox.getBreakValue("after")}r=Xt.d(r,c.getBreakValue("after")),this.registerForcedBreakOffset(r,this.lastOffset,c.flowName)}if(o=this.last.nextSibling)break;if(this.last=this.last.parentNode,this.last===this.root)return this.last=null,t<this.lastOffset&&(n<0&&(n=this.offsetMap.slippedByFixed(t)+e),n<=this.offsetMap.getMaxSlipped())?this.offsetMap.fixedBySlipped(n):Number.POSITIVE_INFINITY}if(this.last=o,1!=this.last.nodeType)this.lastOffset+=this.last.textContent.length,this.boxStack.encounteredTextNode(this.last),this.primary?this.offsetMap.addStuckRange(this.lastOffset):this.offsetMap.addSlippedRange(this.lastOffset);else{var s=this.last,l=this.getAttrStyle(s);this.primaryStack.push(this.primary),this.cascade.pushElement(s,l,this.lastOffset);var u=s.getAttribute("id")||s.getAttributeNS(b.a.XML,"id");u&&u===this.idToReach&&(this.idToReach=null),this.bodyReached||"body"!=s.localName||s.parentNode!=this.root||(this.postprocessTopStyle(l,!0),this.bodyReached=!0);var c=void 0,h=l["flow-into"];if(h){var p=h.evaluate(i,"flow-into").toString(),f=this.encounteredFlowElement(p,l,s,this.lastOffset);this.primary=!!this.primaryFlows[p],c=this.boxStack.push(l,this.lastOffset,s===this.root,f)}else c=this.boxStack.push(l,this.lastOffset,s===this.root);var d=this.boxStack.nearestBlockStartOffset(c);if(this.registerForcedBreakOffset(c.breakBefore,d,c.flowName),c.beforeBox){var g=c.beforeBox.getBreakValue("after");this.registerForcedBreakOffset(g,c.beforeBox.atBlockStart?d:c.offset,c.flowName)}if(this.primary&&c.displayValue()===j.t.none&&(this.primary=!1),this.styleMap["e"+this.lastOffset]=l,this.lastOffset++,this.primary?this.offsetMap.addStuckRange(this.lastOffset):this.offsetMap.addSlippedRange(this.lastOffset),t<this.lastOffset&&(n<0&&(n=this.offsetMap.slippedByFixed(t)+e),n<=this.offsetMap.getMaxSlipped()))return this.offsetMap.fixedBySlipped(n)}}},t.prototype.getStyle=function(t,e){var n=this.xmldoc.getElementOffset(t),i="e"+n;return e&&(n=this.xmldoc.getNodeOffset(t,0,!0)),this.lastOffset<=n&&this.styleUntil(n,0),this.styleMap[i]},t.prototype.processContent=function(t,e){},t}(),pe=["column-count","column-width","column-fill"],fe="/*\n * Copyright 2013 Google, Inc.\n * Copyright 2015 Trim-marks Inc.\n * Copyright 2019 Vivliostyle Foundation\n *\n * CSS property validation.\n */\nNUM = POS_NUM | ZERO | NEGATIVE;\nNNEG_NUM = POS_NUM | ZERO;\nINT = POS_INT | ZERO | NEGATIVE;\nNNEG_INT = POS_INT | ZERO;\nPERCENTAGE = POS_PERCENTAGE | ZERO | NEGATIVE;\nSTRICT_PERCENTAGE = POS_PERCENTAGE | ZERO_PERCENTAGE | NEGATIVE;\nNNEG_PERCENTAGE = POS_PERCENTAGE | ZERO;\nLENGTH = POS_LENGTH | ZERO | NEGATIVE;\nNNEG_LENGTH = POS_LENGTH | ZERO | NEGATIVE;\nPLENGTH = LENGTH | PERCENTAGE;\nPPLENGTH = POS_LENGTH | ZERO | POS_PERCENTAGE;\nALENGTH = LENGTH | auto;\nAPLENGTH = PLENGTH | auto;\nPAPLENGTH = PPLENGTH | auto;\nANGLE = POS_ANGLE | ZERO | NEGATIVE;\nLENGTH_OR_NUM = LENGTH | NUM;\nANGLE_OR_NUM = ANGLE | NUM;\nSCOLOR = HASHCOLOR | aliceblue: #F0F8FF | antiquewhite: #FAEBD7 | aqua: #00FFFF | aquamarine: #7FFFD4 | azure: #F0FFFF |\n    beige: #F5F5DC | bisque: #FFE4C4 | black: #000000 | blanchedalmond: #FFEBCD | blue: #0000FF | blueviolet: #8A2BE2 | brown: #A52A2A |\n    burlywood: #DEB887 | cadetblue: #5F9EA0 | chartreuse: #7FFF00 | chocolate: #D2691E | coral: #FF7F50 | cornflowerblue: #6495ED |\n    cornsilk: #FFF8DC | crimson: #DC143C | cyan: #00FFFF | darkblue: #00008B | darkcyan: #008B8B | darkgoldenrod: #B8860B |\n    darkgray: #A9A9A9 | darkgreen: #006400 | darkgrey: #A9A9A9 | darkkhaki: #BDB76B | darkmagenta: #8B008B | darkolivegreen: #556B2F |\n    darkorange: #FF8C00 | darkorchid: #9932CC | darkred: #8B0000 | darksalmon: #E9967A | darkseagreen: #8FBC8F | darkslateblue: #483D8B |\n    darkslategray: #2F4F4F | darkslategrey: #2F4F4F | darkturquoise: #00CED1 | darkviolet: #9400D3 | deeppink: #FF1493 |\n    deepskyblue: #00BFFF | dimgray: #696969 | dimgrey: #696969 | dodgerblue: #1E90FF | firebrick: #B22222 | floralwhite: #FFFAF0 |\n    forestgreen: #228B22 | fuchsia: #FF00FF | gainsboro: #DCDCDC | ghostwhite: #F8F8FF | gold: #FFD700 | goldenrod: #DAA520 |\n    gray: #808080 | green: #008000 | greenyellow: #ADFF2F | grey: #808080 | honeydew: #F0FFF0 | hotpink: #FF69B4 | indianred: #CD5C5C |\n    indigo: #4B0082 | ivory: #FFFFF0 | khaki: #F0E68C | lavender: #E6E6FA | lavenderblush: #FFF0F5 | lawngreen: #7CFC00 |\n    lemonchiffon: #FFFACD | lightblue: #ADD8E6 | lightcoral: #F08080 | lightcyan: #E0FFFF | lightgoldenrodyellow: #FAFAD2 |\n    lightgray: #D3D3D3 | lightgreen: #90EE90 | lightgrey: #D3D3D3 | lightpink: #FFB6C1 | lightsalmon: #FFA07A | lightseagreen: #20B2AA |\n    lightskyblue: #87CEFA | lightslategray: #778899 | lightslategrey: #778899 | lightsteelblue: #B0C4DE | lightyellow: #FFFFE0 |\n    lime: #00FF00 | limegreen: #32CD32 | linen: #FAF0E6 | magenta: #FF00FF | maroon: #800000 | mediumaquamarine: #66CDAA |\n    mediumblue: #0000CD | mediumorchid: #BA55D3 | mediumpurple: #9370DB | mediumseagreen: #3CB371 | mediumslateblue: #7B68EE |\n    mediumspringgreen: #00FA9A | mediumturquoise: #48D1CC | mediumvioletred: #C71585 | midnightblue: #191970 | mintcream: #F5FFFA |\n    mistyrose: #FFE4E1 | moccasin: #FFE4B5 | navajowhite: #FFDEAD | navy: #000080 | oldlace: #FDF5E6 | olive: #808000 |\n    olivedrab: #6B8E23 | orange: #FFA500 | orangered: #FF4500 | orchid: #DA70D6 | palegoldenrod: #EEE8AA | palegreen: #98FB98 |\n    paleturquoise: #AFEEEE | palevioletred: #DB7093 | papayawhip: #FFEFD5 | peachpuff: #FFDAB9 | peru: #CD853F | pink: #FFC0CB |\n    plum: #DDA0DD | powderblue: #B0E0E6 | purple: #800080 | rebeccapurple: #663399 | red: #FF0000 | rosybrown: #BC8F8F | royalblue: #4169E1 |\n    saddlebrown: #8B4513 | salmon: #FA8072 | sandybrown: #F4A460 | seagreen: #2E8B57 | seashell: #FFF5EE | sienna: #A0522D |\n    silver: #C0C0C0 | skyblue: #87CEEB | slateblue: #6A5ACD | slategray: #708090 | slategrey: #708090 | snow: #FFFAFA |\n    springgreen: #00FF7F | steelblue: #4682B4 | tan: #D2B48C | teal: #008080 | thistle: #D8BFD8 | tomato: #FF6347 |\n    turquoise: #40E0D0 | violet: #EE82EE | wheat: #F5DEB3 | white: #FFFFFF | whitesmoke: #F5F5F5 | yellow: #FFFF00 |\n    yellowgreen: #9ACD32 | transparent | currentcolor;\nRGBCOLOR = rgb(INT{3}) | rgb(STRICT_PERCENTAGE{3});\nRGBACOLOR = rgba(NUM{4}) | rgba(STRICT_PERCENTAGE{3} NUM);\nHSLCOLOR = hsl(NUM PERCENTAGE{2});\nHSLACOLOR = hsl(NUM PERCENTAGE{2} NUM);\nCOLOR = SCOLOR | RGBCOLOR | RGBACOLOR | HSLCOLOR | HSLACOLOR;\nBG_POSITION_TERM = PLENGTH | left | center | right | top | bottom;\nSIDE_OR_CORNER =  [left | right] || [top | bottom];\nCOLOR_STOP = SPACE(COLOR [PERCENTAGE | LENGTH]?);\nLINEAR_GRADIENT = linear-gradient([ANGLE | SPACE(to SIDE_OR_CORNER)]? COLOR_STOP+) |\n                  repeating-linear-gradient([ANGLE | SPACE(to SIDE_OR_CORNER)]? COLOR_STOP+) |;\nGRADIENT_EXTENT = closest-corner | closest-side | farthest-corner | farthest-side;\nGRADIENT_POSITION = at BG_POSITION_TERM{1,4};\nGRADIENT_SHAPE = SPACE(circle LENGTH? GRADIENT_POSITION?) | SPACE(ellipse PLENGTH{2}? GRADIENT_POSITION?)| SPACE([circle | ellipse] GRADIENT_EXTENT? GRADIENT_POSITION?);\nRADIAL_GRADIENT = radial-gradient([GRADIENT_SHAPE | SPACE(GRADIENT_POSITION)]? COLOR_STOP+) |\n                  repeating-radial-gradient([GRADIENT_SHAPE | SPACE(GRADIENT_POSITION)]? COLOR_STOP+);\nURI_OR_NONE = URI | none;\nIMAGE =  URI | LINEAR_GRADIENT | RADIAL_GRADIENT | none;\nazimuth = ANGLE | [[ left-side | far-left | left | center-left | center | center-right | right | far-right | right-side ] || behind ] | leftwards | rightwards;\nbackground-attachment = COMMA( [scroll | fixed | local]+ );\nbackground-color = COLOR;\nbackground-image = COMMA( IMAGE+ );\nbackground-position = COMMA( SPACE(BG_POSITION_TERM{1,4})+ ); /* relaxed */\nbackground-repeat = COMMA( [repeat | repeat-x | repeat-y | no-repeat]+ );\nborder-collapse = collapse | separate;\nBORDER_SIDE_COLOR = COLOR;\nBORDER_SIDE_STYLE = none | hidden | dotted | dashed | solid | double | groove | ridge | inset | outset;\nBORDER_SIDE_WIDTH = thin: 1px | medium: 3px | thick: 5px | NNEG_LENGTH;\nborder-spacing = LENGTH LENGTH?;\nborder-top-color = BORDER_SIDE_COLOR;\nborder-right-color = BORDER_SIDE_COLOR;\nborder-bottom-color = BORDER_SIDE_COLOR;\nborder-left-color = BORDER_SIDE_COLOR;\nborder-top-style = BORDER_SIDE_STYLE;\nborder-right-style = BORDER_SIDE_STYLE;\nborder-bottom-style = BORDER_SIDE_STYLE;\nborder-left-style = BORDER_SIDE_STYLE;\nborder-top-width = BORDER_SIDE_WIDTH;\nborder-right-width = BORDER_SIDE_WIDTH;\nborder-bottom-width = BORDER_SIDE_WIDTH;\nborder-left-width = BORDER_SIDE_WIDTH;\nBORDER_RADIUS = PLENGTH{1,2};\nborder-top-left-radius = BORDER_RADIUS;\nborder-top-right-radius = BORDER_RADIUS;\nborder-bottom-right-radius = BORDER_RADIUS;\nborder-bottom-left-radius = BORDER_RADIUS;\nborder-image-source = IMAGE;\nborder-image-slice = [NUM | PERCENTAGE]{1,4} || fill; /* relaxed */\nborder-image-width = [NUM | PLENGTH | auto]{1,4};\nborder-image-outset = [NUM | LENGTH]{1,4};\nborder-image-repeat = [ stretch | repeat | round | space ]{1,2};\nbottom = APLENGTH;\ncaption-side = top | bottom;\nclear = none | left | right | top | bottom | both | all | same;\nclip = rect(ALENGTH{4}) | rect(SPACE(ALENGTH{4})) | auto;\ncolor = COLOR;\nLIST_STYLE_TYPE = disc | circle | square | decimal | decimal-leading-zero | lower-roman |\n    upper-roman | lower-greek | lower-latin | upper-latin | armenian | georgian | lower-alpha |\n    upper-alpha | russian | upper-russian | lower-russian | cjk-ideographic | trad-chinese-informal |\n    hebrew | none;\nTYPE_OR_UNIT_IN_ATTR = string | color | url | integer | number | length | angle | time | frequency;\nATTR = attr(SPACE(IDENT TYPE_OR_UNIT_IN_ATTR?) [ STRING | IDENT | COLOR | INT | NUM | PLENGTH | ANGLE | POS_TIME | FREQUENCY]?);\nCONTENT = normal | none |\n    [ STRING | URI | counter(IDENT LIST_STYLE_TYPE?) |\n    counters(IDENT STRING LIST_STYLE_TYPE?) | ATTR |\n    target-counter([ STRING | URI ] IDENT LIST_STYLE_TYPE?) |\n    target-counter(ATTR IDENT LIST_STYLE_TYPE?) |\n    target-counters([ STRING | URI ] IDENT STRING LIST_STYLE_TYPE?) |\n    target-counters(ATTR IDENT STRING LIST_STYLE_TYPE?) |\n    open-quote | close-quote | no-open-quote | no-close-quote ]+;\ncontent = CONTENT;\nCOUNTER = [ IDENT INT? ]+ | none;\ncounter-increment = COUNTER;\ncounter-reset = COUNTER;\ncounter-set = COUNTER;\ncue-after = URI_OR_NONE;\ncue-before = URI_OR_NONE;\ncursor = COMMA(URI* [ auto | crosshair | default | pointer | move | e-resize | ne-resize | nw-resize |\n    n-resize | se-resize | sw-resize | s-resize | w-resize | text | wait | help | progress ]);\ndirection = ltr | rtl;\ndisplay = inline | block | list-item | inline-block | table | inline-table | table-row-group |\n    table-header-group | table-footer-group | table-row | table-column-group | table-column |\n    table-cell | table-caption | none | oeb-page-head | oeb-page-foot | flex | inline-flex |\n    ruby | ruby-base | ruby-text | ruby-base-container | ruby-text-container | run-in | compact | marker;\nelevation = ANGLE | below | level | above | higher | lower;\nempty-cells = show | hide;\nFAMILY = SPACE(IDENT+) | STRING;\nFAMILY_LIST = COMMA( FAMILY+ );\nfont-family = FAMILY_LIST;\nfont-size = xx-small | x-small | small | medium | large | x-large | xx-large | larger | smaller | PPLENGTH | POS_NUM;\nfont-style = normal | italic | oblique;\nfont-variant = normal | small-caps;\nfont-weight = normal | bold | bolder | lighter | 100 | 200 | 300 | 400 | 500 | 600 | 700 | 800 | 900;\nheight = PAPLENGTH | POS_NUM ;\nleft = APLENGTH;\nletter-spacing = normal | LENGTH_OR_NUM;\nline-height = normal | POS_NUM | PPLENGTH;\nlist-style-image = IMAGE;\nlist-style-position = inside | outside;\nlist-style-type = LIST_STYLE_TYPE;\nmargin-right = APLENGTH;\nmargin-left = APLENGTH;\nmargin-top = APLENGTH;\nmargin-bottom = APLENGTH;\nNPLENGTH = none | PLENGTH;\nmax-height = NPLENGTH;\nmax-width = NPLENGTH;\nmin-height = auto | PLENGTH;\nmin-width = auto | PLENGTH;\norphans = POS_INT;\noutline-offset = LENGTH;\noutline-color = COLOR | invert;\noutline-style = BORDER_SIDE_STYLE;\noutline-width = BORDER_SIDE_WIDTH;\noverflow = visible | hidden | scroll | auto;\npadding-right = PPLENGTH;\npadding-left = PPLENGTH;\npadding-top = PPLENGTH;\npadding-bottom = PPLENGTH;\nPAGE_BREAK = auto | always | avoid | left | right | recto | verso;\npage-break-after = PAGE_BREAK;\npage-break-before = PAGE_BREAK;\npage-break-inside = avoid | auto;\nPAUSE = POS_TIME | ZERO | POS_PERCENTAGE;\npause-after = PAUSE;\npause-before = PAUSE;\npitch-range = NUM;\npitch = FREQUENCY | x-low | low | medium | high | x-high;\nplay-during = [URI [ mix || repeat ]?] | auto | none;\nposition = static | relative | absolute | fixed;\nquotes = [STRING STRING]+ | none;\nrichness = NUM;\nright = APLENGTH;\nspeak-header = once | always;\nspeak-numeral = digits | continuous;\nspeak-punctuation = code | none;\nspeech-rate = NUM | x-slow | slow | medium | fast | x-fast | faster | slower;\nstress = NUM;\ntable-layout = auto | fixed;\ntext-align = left | right | center | justify | start | end;\ntext-decoration = none | [ underline || overline || line-through || blink ];\ntext-indent = PLENGTH;\ntext-transform = capitalize | uppercase | lowercase | none;\ntop = APLENGTH;\nvertical-align = baseline | sub | super | top | text-top | middle | bottom | text-bottom | PLENGTH;\nvisibility = visible | hidden | collapse;\nvoice-family = FAMILY_LIST;\nvolume = NUM | PERCENTAGE | silent | x-soft | soft | medium | loud | x-loud;\nwhite-space = normal | pre | nowrap | pre-wrap | pre-line;\nwidows = POS_INT;\nwidth = PAPLENGTH | POS_NUM ;\nword-spacing = normal | LENGTH_OR_NUM;\nz-index = auto | INT;\n\n[epub,moz,ms,webkit]hyphens = auto | manual | none;\n[webkit]hyphenate-character = auto | STRING;\n\n/* css-logical */\nmargin-block-start = APLENGTH;\nmargin-block-end = APLENGTH;\nmargin-inline-start = APLENGTH;\nmargin-inline-end = APLENGTH;\npadding-block-start = APLENGTH;\npadding-block-end = APLENGTH;\npadding-inline-start = APLENGTH;\npadding-inline-end = APLENGTH;\nborder-block-start-color = BORDER_SIDE_COLOR;\nborder-block-end-color = BORDER_SIDE_COLOR;\nborder-inline-start-color = BORDER_SIDE_COLOR;\nborder-inline-end-color = BORDER_SIDE_COLOR;\nborder-block-start-style = BORDER_SIDE_STYLE;\nborder-block-end-style = BORDER_SIDE_STYLE;\nborder-inline-start-style = BORDER_SIDE_STYLE;\nborder-inline-end-style = BORDER_SIDE_STYLE;\nborder-block-start-width = BORDER_SIDE_WIDTH;\nborder-block-end-width = BORDER_SIDE_WIDTH;\nborder-inline-start-width = BORDER_SIDE_WIDTH;\nborder-inline-end-width = BORDER_SIDE_WIDTH;\nblock-start = APLENGTH;\nblock-end = APLENGTH;\ninline-start = APLENGTH;\ninline-end = APLENGTH;\nblock-size = PAPLENGTH | POS_NUM;\ninline-size = PAPLENGTH | POS_NUM;\nmax-block-size = NPLENGTH;\nmax-inline-size = NPLENGTH;\nmin-block-size = auto | PLENGTH;\nmin-inline-size = auto | PLENGTH;\n\nSHAPE = auto | rectangle( PLENGTH{4} ) |  ellipse( PLENGTH{4} ) |  circle( PLENGTH{3} ) |\n    polygon( SPACE(PLENGTH+)+ );\n[epubx]shape-inside = SHAPE;\n[epubx,webkit]shape-outside = SHAPE;\n[epubx,ms]wrap-flow = auto | both | start | end | maximum | clear | around /* epub al */;\n\nTRANSFORM_FUNCTION = matrix(NUM{6}) | translate(PLENGTH{1,2}) | translateX(PLENGTH) | translateY(PLENGTH) |\n scale(NUM{1,2}) | scaleX(NUM) | scaleY(NUM) | rotate(ANGLE) | skewX(ANGLE) | skewY(ANGLE);\n[epub,ms]transform = none | TRANSFORM_FUNCTION+;\n[epub,ms]transform-origin = [[[ top | bottom | left | right] PLENGTH?] | center | PLENGTH]{1,2}; /* relaxed */\n\nBOX = border-box | padding-box | content-box;\nSHADOW = SPACE(inset || LENGTH{2,4} || COLOR); /* relaxed */\n[webkit]background-size = COMMA( SPACE( [PLENGTH | auto ]{1,2} | cover | contain)+ );\n[webkit]background-origin = COMMA( BOX+ );\n[webkit]background-clip = COMMA( BOX+ );\n[webkit]box-shadow = none | COMMA( SHADOW+ );\ntext-shadow = none |  COMMA( SHADOW+ );\n[webkit]box-decoration-break = slice | clone;\nFILTER_FUNCTION = blur(LENGTH) | brightness(NUM | PERCENTAGE) | contrast(NUM | PERCENTAGE) | drop-shadow(SPACE(LENGTH{2,3} COLOR?))\n                | grayscale(NUM | PERCENTAGE) | hue-rotate(ANGLE) | invert(NUM | PERCENTAGE) | opacity(NUM | PERCENTAGE)\n                | saturate(NUM | PERCENTAGE) | sepia(NUM | PERCENTAGE);\nFILTER_FUNCTION_LIST = FILTER_FUNCTION+;\n[webkit]filter = none | FILTER_FUNCTION_LIST;\n\nopacity = NUM;\n\n[moz,webkit]column-width = LENGTH | auto;\n[moz,webkit]column-count = INT | auto;\n[moz,webkit]column-gap = LENGTH | normal;\n[moz,webkit]column-rule-color = COLOR;\n[moz,webkit]column-rule-style = BORDER_SIDE_STYLE;\n[moz,webkit]column-rule-width = BORDER_SIDE_WIDTH;\nBREAK = auto | avoid | avoid-page | page | left | right | recto | verso | avoid-column | column | avoid-region | region;\nbreak-before = BREAK;\nbreak-after = BREAK;\nbreak-inside = auto | avoid | avoid-page | avoid-column | avoid-region;\n[webkit]column-span = none | auto | all;\n[moz]column-fill = auto | balance | balance-all;\n\nsrc = COMMA([SPACE(URI format(STRING+)?) | local(FAMILY)]+); /* for font-face */\n\n[epubx,webkit]flow-from = IDENT;\n[epubx,webkit]flow-into = IDENT;\n[epubx]flow-linger = INT | none;\n[epubx]flow-priority = INT;\n[epubx]flow-options = none | [ exclusive || last || static ];\n[epubx]page = INT | auto;\n[epubx]min-page-width = LENGTH;\n[epubx]min-page-height = LENGTH;\n[epubx]required = true | false;\n[epubx]enabled = true | false;\n[epubx]conflicting-partitions = COMMA(IDENT+);\n[epubx]required-partitions = COMMA(IDENT+);\n[epubx]snap-height = LENGTH | none;\n[epubx]snap-width = LENGTH | none;\n[epubx]flow-consume = all | some;\n[epubx]utilization = NUM;\n[epubx]text-zoom = font-size | scale;\n\n[adapt]template = URI_OR_NONE;\n[adapt]behavior = IDENT;\n\n/* CSS Fonts */\nfont-size-adjust = none | NNEG_NUM;\n[webkit]font-kerning = auto | normal | none;\nfont-variant-east-asian = normal | [[ jis78 | jis83 | jis90 | jis04 | simplified | traditional ] || [ full-width | proportional-width ] || ruby];\nfont-feature-settings = COMMA( SPACE( STRING [ on | off | INT ]? )+ );\nfont-stretch = normal | wider | narrower | ultra-condensed | extra-condensed | condensed | semi-condensed | semi-expanded | expanded | extra-expanded | ultra-expanded;\n\n/* CSS Images */\nimage-resolution = RESOLUTION;\nobject-fit = fill | contain | cover | none | scale-down;\nobject-position = COMMA( SPACE(BG_POSITION_TERM{1,4})+ ); /* relaxed */\n\n/* CSS Paged Media */\nPAGE_SIZE = a5 | a4 | a3 | b5 | b4 | jis-b5 | jis-b4 | letter | legal | ledger;\nbleed = auto | LENGTH;\nmarks = none | [ crop || cross ];\nsize = POS_LENGTH{1,2} | auto | [ PAGE_SIZE || [ portrait | landscape ] ];\n\n/* CSS Page Floats */\nfloat-reference = inline | column | region | page;\nfloat = block-start | block-end | inline-start | inline-end | snap-block | snap-inline | left | right | top | bottom | none | footnote;\nfloat-min-wrap-block = PPLENGTH;\n\n/* CSS Ruby */\nruby-align = start | center | space-between | space-around;\nruby-position = over | under | inter-character;\n\n/* CSS Size Adjust */\n[moz,ms]text-size-adjust = auto | none | POS_PERCENTAGE;\n\n/* CSS Text */\n[ms,webkit]line-break = auto | loose | normal | strict;\noverflow-wrap = normal | break-word;\n[moz]tab-size = NNEG_INT | NNEG_LENGTH;\n[moz,ms]text-align-last = auto | start | end | left | right | center | justify;\n[ms]text-justify = auto | none | inter-word | inter-character | inter-ideograph /* specified in UA stylesheet for IE */;\n[ms]word-break = normal | keep-all | break-all | break-word;\n[ms]word-wrap = normal | break-word;\n\n/* CSS Text Decoration */\n[webkit]text-decoration-color = COLOR;\n[webkit]text-decoration-line = none | [ underline || overline || line-through || blink ];\n[webkit]text-decoration-skip = none | [ objects || spaces || ink || edges || box-decoration ];\n[webkit]text-decoration-style = solid | double | dotted | dashed | wavy;\n[epub,webkit]text-emphasis-color = COLOR;\n[webkit]text-emphasis-position = [ over | under ] [ right | left ];\n[epub,webkit]text-emphasis-style = none | [[ filled | open ] || [ dot | circle | double-circle | triangle | sesame ]] | STRING;\n[ms,webkit]text-underline-position = auto | [ under || [ left | right ]];\n\n/* CSS Transforms */\n[ms,webkit]backface-visibility = visible | hidden;\n\n/* CSS UI */\nbox-sizing = content-box | padding-box | border-box;\n[ms]text-overflow = [clip | ellipsis | STRING]{1,2};\n\n/* CSS Writing Modes */\n[webkit]text-combine = none | horizontal;\n[epub,ms]text-combine-horizontal = none | all | [ digits POS_INT? ]; /* relaxed */\ntext-combine-upright = none | all | [ digits POS_INT? ]; /* relaxed */\n[epub,webkit]text-orientation = mixed | upright | sideways-right | sideways-left | sideways | use-glyph-orientation /* the following values are kept for backward-compatibility */ | vertical-right | rotate-right | rotate-left | rotate-normal | auto;\nunicode-bidi = normal | embed | isolate | bidi-override | isolate-override | plaintext;\n[epub,webkit]writing-mode = horizontal-tb | vertical-rl | lr-tb | rl-tb | tb-rl | lr | rl | tb;\n\n/* CSS Flex box */\nFLEX_BASIS = content | PAPLENGTH;\nflex-direction = row | row-reverse | column | column-reverse;\nflex-wrap = nowrap | wrap | wrap-reverse;\norder = INT;\nflex-grow = NNEG_NUM;\nflex-shrink = NNEG_NUM;\nflex-basis = FLEX_BASIS;\nflex = none | [ [ NNEG_NUM NNEG_NUM? ] || FLEX_BASIS ];\njustify-content = flex-start | flex-end | center | space-between | space-around;\nalign-items = flex-start | flex-end | center | baseline | stretch;\nalign-self = auto | flex-start | flex-end | center | baseline | stretch;\nalign-content = flex-start | flex-end | center | space-between | space-around | stretch;\n\n/* Pointer Events */\n[ms]touch-action = auto | none | [ pan-x || pan-y ] | manipulation;\n\n/* SVG 2 */\nOPACITY_VALUE = NUM | PERCENTAGE;\nDASH_ARRAY = COMMA( SPACE( [ LENGTH | PERCENTAGE | NUM ]+ )+ );\nPAINT = none | child | child(INT) | COLOR | SPACE( URI [none | COLOR]? ) | context-fill | context-stroke;\ncolor-interpolation = auto | sRGB | linearRGB;\ncolor-rendering = auto | optimizeSpeed | optimizeQuality;\nfill = PAINT;\nfill-opacity = OPACITY_VALUE;\nfill-rule = nonzero | evenodd;\nglyph-orientation-vertical = auto | NUM | ANGLE;\nimage-rendering = auto | optimizeSpeed | optimizeQuality | crisp-edges | pixelated;\nmarker-start = none | URI;\nmarker-mid = none | URI;\nmarker-end = none | URI;\npointer-events = bounding-box | visiblePainted | visibleFill | visibleStroke | visible | painted | fill | stroke | all | none;\npaint-order = normal | [ fill || stroke || markers ];\nshape-rendering = auto | optimizeSpeed | crispEdges | geometricPrecision;\nstop-color = COLOR;\nstop-opacity = OPACITY_VALUE;\nstroke = PAINT;\nstroke-dasharray = none | DASH_ARRAY;\nstroke-dashoffset = PERCENTAGE | LENGTH_OR_NUM;\nstroke-linecap = butt | round | square;\nstroke-linejoin = miter | round | bevel;\nstroke-miterlimit = NUM;\nstroke-opacity = OPACITY_VALUE;\nstroke-width = PERCENTAGE | LENGTH_OR_NUM;\ntext-anchor = start | middle | end;\ntext-rendering = auto | optimizeSpeed | optimizeLegibility | geometricPrecision;\nvector-effect = none | SPACE( [ non-scaling-stroke | non-scaling-size | non-rotation | fixed-position ]+ [ viewport | screen ]? );\n\n/* SVG 1.1 */\nalignment-baseline = auto | baseline | before-edge | text-before-edge | middle | central | after-edge | text-after-edge | ideographic | alphabetic | hanging | mathematical;\nbaseline-shift = baseline | sub | super | PERCENTAGE | LENGTH_OR_NUM;\ndominant-baseline = auto | use-script | no-change | reset-size | ideographic | alphabetic | hanging | mathematical | central | middle | text-after-edge | text-before-edge;\nmask = none | URI;\n\n/* css-masking-1 */\nSHAPE_RADIUS = PLENGTH | closest-side | farthest-side;\nFILL_RULE = nonzero | evenodd;\nSHAPE_BOX = BOX | margin-box;\nGEOMETRY_BOX = SHAPE_BOX | fill-box | stroke-box | view-box;\nBASIC_SHAPE =\n    inset( SPACE( PLENGTH{1,4} [ round PLENGTH{1,4} [ SLASH PLENGTH{1,4} ]? ]? ) )\n  | circle(  SPACE( [SHAPE_RADIUS]?    [at BG_POSITION_TERM{1,4}]? ) )\n  | ellipse( SPACE( SHAPE_RADIUS{2}? [at BG_POSITION_TERM{1,4}]? ) )\n  | polygon( FILL_RULE? COMMA( SPACE( PLENGTH{2} )+ )+ );\n[webkit]clip-path = none | URI | [ BASIC_SHAPE || GEOMETRY_BOX ];\nclip-rule = nonzero | evenodd;\n\n/* filters */\nflood-color = COLOR;\nflood-opacity = OPACITY_VALUE;\nlighting-color = COLOR;\n\n/* compositing-1 */\nBLEND_MODE = normal | multiply | screen | overlay | darken | lighten | color-dodge | color-burn | hard-light | soft-light | difference | exclusion | hue | saturation | color | luminosity;\nmix-blend-mode = BLEND_MODE;\nisolation = auto | isolate;\nbackground-blend-mode = COMMA( BLEND_MODE+ );\n\n/* CSS GCPM */\nfootnote-policy = auto | line;\n\n[viv]repeat-on-break = auto | none | header | footer;\n\nDEFAULTS\n\nbackground-attachment: scroll;\nbackground-color: transparent;\nbackground-image: none;\nbackground-repeat: repeat;\nbackground-position: 0% 0%;\nbackground-clip: border-box;\nbackground-origin: padding-box;\nbackground-size: auto;\nborder-top-color: currentColor;\nborder-right-color: currentColor;\nborder-bottom-color: currentColor;\nborder-left-color: currentColor;\nborder-top-style: none;\nborder-right-style: none;\nborder-bottom-style: none;\nborder-left-style: none;\nborder-top-width: 3px;\nborder-right-width: 3px;\nborder-bottom-width: 3px;\nborder-left-width: 3px;\nborder-top-left-radius: 0;\nborder-top-right-radius: 0;\nborder-bottom-right-radius: 0;\nborder-bottom-left-radius: 0;\nborder-image-source: none;\nborder-image-slice: 100%;\nborder-image-width: 1;\nborder-image-outset: 0;\nborder-image-repeat: stretch;\ncolumn-count: auto;\ncolumn-gap: normal;\ncolumn-width: auto;\ncolumn-rule-color: currentColor;\ncolumn-rule-style: none;\ncolumn-rule-width: 3px;\ncolumn-fill: balance;\noutline-color: currentColor;\noutline-style: none;\noutline-width: 3px;\nflex-direction: row;\nflex-wrap: nowrap;\nfont-family: serif;\nfont-style: normal;\nfont-size: medium;\nfont-variant: normal;\nfont-weight: normal;\nfont-stretch: normal;\nline-height: normal;\nlist-style-image: none;\nlist-style-position: outside;\nlist-style-type: disc;\nmargin-bottom: auto;\nmargin-left: auto;\nmargin-right: auto;\nmargin-top: auto;\npadding-bottom: auto;\npadding-left: auto;\npadding-right: auto;\npadding-top: auto;\ntext-emphasis-color: currentColor;\ntext-emphasis-style: none;\nmarker-start: none;\nmarker-mid: none;\nmarker-end: none;\n\n\nSHORTHANDS\n\nbackground = COMMA background-image [background-position [ / background-size ]] background-repeat\n     background-attachment [background-origin background-clip] background-color; /* background-color is a special case, see the code */\nborder-top = border-top-width border-top-style border-top-color;\nborder-right = border-right-width border-right-style border-right-color;\nborder-bottom = border-bottom-width border-bottom-style border-bottom-color;\nborder-left = border-left-width border-left-style border-left-color;\nborder-width = INSETS border-top-width border-right-width border-bottom-width border-left-width;\nborder-style = INSETS border-top-style border-right-style border-bottom-style border-left-style;\nborder-color = INSETS border-top-color border-right-color border-bottom-color border-left-color;\nborder = border-width border-style border-color;\nborder-image = border-image-source border-image-slice [ / border-image-width [ / border-image-outset ] ]\n     border-image-repeat;\nborder-radius = INSETS_SLASH border-top-left-radius border-top-right-radius\n     border-bottom-right-radius border-bottom-left-radius;\n[moz,webkit]columns = column-width column-count;\n[moz,webkit]column-rule = column-rule-width column-rule-style column-rule-color;\nflex-flow = flex-direction flex-wrap;\noeb-column-number = column-count;\noutline = outline-width outline-style outline-color;\nlist-style = list-style-type list-style-position list-style-image;\nmargin = INSETS margin-top margin-right margin-bottom margin-left;\npadding = INSETS padding-top padding-right padding-bottom padding-left;\npause = INSETS pause-before pause-after;\nfont = FONT font-style font-variant font-weight font-stretch /* font-size line-height font-family are special-cased */;\n[epub,webkit]text-emphasis = text-emphasis-style text-emphasis-color;\nmarker = INSETS marker-start marker-mid marker-end;\n\n/* css-logical */\nmargin-block = INSETS margin-block-start margin-block-end;\nmargin-inline = INSETS margin-inline-start margin-inline-end;\npadding-block = INSETS padding-block-start padding-block-end;\npadding-inline = INSETS padding-inline-start padding-inline-end;\nborder-block-width = INSETS border-block-start-width border-block-end-width;\nborder-block-style = INSETS border-block-start-style border-block-end-style;\nborder-block-color = INSETS border-block-start-color border-block-end-color;\nborder-inline-width = INSETS border-inline-start-width border-inline-end-width;\nborder-inline-style = INSETS border-inline-start-style border-inline-end-style;\nborder-inline-color = INSETS border-inline-start-color border-inline-end-color;\nborder-block = border-block-width border-block-style border-block-color;\nborder-inline = border-inline-width border-inline-style border-inline-color;\nborder-block-start = border-block-start-width border-block-start-style border-block-start-color;\nborder-block-end = border-block-end-width border-block-end-style border-block-end-color;\nborder-inline-start = border-inline-start-width border-inline-start-style border-inline-start-color;\nborder-inline-end = border-inline-end-width border-inline-end-style border-inline-end-color;\ninset-block-start = block-start;\ninset-block-end = block-end;\ninset-inline-start = inline-start;\ninset-inline-end = inline-end;\ninset-block = INSETS block-start block-end;\ninset-inline = INSETS inline-start inline-end;\n\n/* old names  */\n[adapt,webkit]margin-before = margin-block-start;\n[adapt,webkit]margin-after = margin-block-end;\n[adapt,webkit]margin-start = margin-inline-start;\n[adapt,webkit]margin-end = margin-inline-end;\n[adapt,webkit]padding-before = padding-block-start;\n[adapt,webkit]padding-after = padding-block-end;\n[adapt,webkit]padding-start = padding-inline-start;\n[adapt,webkit]padding-end = padding-inline-end;\n[adapt,webkit]border-before-color = border-block-start-color;\n[adapt,webkit]border-after-color = border-block-end-color;\n[adapt,webkit]border-start-color = border-inline-start-color;\n[adapt,webkit]border-end-color = border-inline-end-color;\n[adapt,webkit]border-before-style = border-block-start-style;\n[adapt,webkit]border-after-style = border-block-end-style;\n[adapt,webkit]border-start-style = border-inline-start-style;\n[adapt,webkit]border-end-style = border-inline-end-style;\n[adapt,webkit]border-before-width = border-block-start-width;\n[adapt,webkit]border-after-width = border-block-end-width;\n[adapt,webkit]border-start-width = border-inline-start-width;\n[adapt,webkit]border-end-width = border-inline-end-width;\n[adapt,webkit]before = block-start;\n[adapt,webkit]after = block-end;\n[adapt,webkit]start = inline-start;\n[adapt,webkit]end = inline-end;\n",de=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ge=function(){function t(t){this.validator=t,this.success=null,this.failure=null,this.code=0}return t.prototype.isSpecial=function(){return 0!=this.code},t.prototype.markAsStartGroup=function(){this.code=-1},t.prototype.isStartGroup=function(){return-1==this.code},t.prototype.markAsEndGroup=function(){this.code=-2},t.prototype.isEndGroup=function(){return-2==this.code},t.prototype.markAsStartAlternate=function(t){this.code=2*t+1},t.prototype.isStartAlternate=function(){return this.code>0&&this.code%2!=0},t.prototype.markAsEndAlternate=function(t){this.code=2*t+2},t.prototype.isEndAlternate=function(){return this.code>0&&this.code%2==0},t.prototype.getAlternate=function(){return Math.floor((this.code-1)/2)},t}(),me=function(t,e){this.where=t,this.success=e,this.what=-1};!function(t){t[t.FOLLOW=1]="FOLLOW",t[t.OPTIONAL=2]="OPTIONAL",t[t.REPEATED=3]="REPEATED",t[t.ALTERNATE=4]="ALTERNATE"}(oe||(oe={}));var ve=function(){function t(){this.nodes=[],this.connections=[],this.match=[],this.nomatch=[],this.error=[],this.emptyHead=!0}return t.prototype.connect=function(t,e){for(var n=0;n<t.length;n++)this.connections[t[n]].what=e;t.splice(0,t.length)},t.prototype.clone=function(){for(var e,n,i,o=new t,r=0;r<this.nodes.length;r++){var a=this.nodes[r],s=new ge(a.validator);s.code=a.code,o.nodes.push(s)}for(r=0;r<this.connections.length;r++){var l=this.connections[r],u=new me(l.where,l.success);u.what=l.what,o.connections.push(u)}return(e=o.match).push.apply(e,this.match),(n=o.nomatch).push.apply(n,this.nomatch),(i=o.error).push.apply(i,this.error),o},t.prototype.addSpecialToArr=function(t,e,n){var i=this.nodes.length,o=new ge(Ee);n>=0?e?o.markAsStartAlternate(n):o.markAsEndAlternate(n):e?o.markAsStartGroup():o.markAsEndGroup(),this.nodes.push(o),this.connect(t,i);var r=new me(i,!0),a=new me(i,!1);t.push(this.connections.length),this.connections.push(a),t.push(this.connections.length),this.connections.push(r)},t.prototype.endSpecialGroup=function(){for(var t=[this.match,this.nomatch,this.error],e=0;e<t.length;e++)this.addSpecialToArr(t[e],!1,-1)},t.prototype.startSpecialGroup=function(){if(this.nodes.length)throw new Error("invalid call");this.addSpecialToArr(this.match,!0,-1)},t.prototype.endClause=function(t){this.addSpecialToArr(this.match,!1,t)},t.prototype.startClause=function(t){if(this.nodes.length)throw new Error("invalid call");var e=new ge(Ee);e.markAsStartAlternate(t),this.nodes.push(e);var n=new me(0,!0),i=new me(0,!1);this.nomatch.push(this.connections.length),this.connections.push(i),this.match.push(this.connections.length),this.connections.push(n)},t.prototype.addPrimitive=function(t){var e=this.nodes.length;this.nodes.push(new ge(t));var n=new me(e,!0),i=new me(e,!1);this.connect(this.match,e),this.emptyHead?(this.nomatch.push(this.connections.length),this.emptyHead=!1):this.error.push(this.connections.length),this.connections.push(i),this.match.push(this.connections.length),this.connections.push(n)},t.prototype.isSimple=function(){return 1==this.nodes.length&&!this.nodes[0].isSpecial()},t.prototype.isPrimitive=function(){return this.isSimple()&&this.nodes[0].validator instanceof be},t.prototype.addGroup=function(t,e){if(0!=t.nodes.length){var n=this.nodes.length;if(e==oe.ALTERNATE&&1==n&&t.isPrimitive()&&this.isPrimitive())this.nodes[0].validator=this.nodes[0].validator.combine(t.nodes[0].validator);else{for(var i=0;i<t.nodes.length;i++)this.nodes.push(t.nodes[i]);e==oe.ALTERNATE?(this.emptyHead=!0,this.connect(this.nomatch,n)):this.connect(this.match,n);var o=this.connections.length;for(i=0;i<t.connections.length;i++){var r=t.connections[i];r.where+=n,r.what>=0&&(r.what+=n),this.connections.push(r)}for(i=0;i<t.match.length;i++)this.match.push(t.match[i]+o);if(e==oe.REPEATED&&this.connect(this.match,n),e==oe.OPTIONAL||e==oe.REPEATED)for(i=0;i<t.nomatch.length;i++)this.match.push(t.nomatch[i]+o);else if(this.emptyHead){for(i=0;i<t.nomatch.length;i++)this.nomatch.push(t.nomatch[i]+o);this.emptyHead=t.emptyHead}else for(i=0;i<t.nomatch.length;i++)this.error.push(t.nomatch[i]+o);for(i=0;i<t.error.length;i++)this.error.push(t.error[i]+o);t.nodes=null,t.connections=null}}},t.prototype.finish=function(t,e){var n=this.nodes.length;this.nodes.push(t),this.nodes.push(e),this.connect(this.match,n),this.connect(this.nomatch,n+1),this.connect(this.error,n+1);for(var i=0,o=this.connections;i<o.length;i++){var r=o[i];r.success?this.nodes[r.where].success=this.nodes[r.what]:this.nodes[r.where].failure=this.nodes[r.what]}for(var a=0;a<n;a++)if(null==this.nodes[a].failure||null==this.nodes[a].success)throw new Error("Invalid validator state");return this.nodes[0]},t}(),ye=function(t){function e(){return t.call(this)||this}return de(e,t),e.prototype.validateForShorthand=function(t,e){var n=t[e].visit(this);return n?[n]:null},e}(j.m),be=function(t){function e(e,n,i){var o=t.call(this)||this;return o.allowed=e,o.idents=n,o.units=i,o}return de(e,t),e.prototype.visitEmpty=function(t){return 1&this.allowed?t:null},e.prototype.visitSlash=function(t){return 2048&this.allowed?t:null},e.prototype.visitStr=function(t){return 2&this.allowed?t:null},e.prototype.visitIdent=function(t){return this.idents[t.name.toLowerCase()]||(4&this.allowed?t:null)},e.prototype.visitNumeric=function(t){return 0!=t.num||512&this.allowed?t.num<0&&!(256&this.allowed)?null:this.units[t.unit]?t:null:"%"==t.unit&&1024&this.allowed?t:null},e.prototype.visitNum=function(t){return 0==t.num?512&this.allowed?t:null:t.num<=0&&!(256&this.allowed)?null:16&this.allowed?t:null},e.prototype.visitInt=function(t){return 0==t.num?512&this.allowed?t:null:t.num<=0&&!(256&this.allowed)?null:48&this.allowed?t:this.idents[""+t.num]||null},e.prototype.visitColor=function(t){return 64&this.allowed?t:null},e.prototype.visitURL=function(t){return 128&this.allowed?t:null},e.prototype.visitSpaceList=function(t){return null},e.prototype.visitCommaList=function(t){return null},e.prototype.visitFunc=function(t){return null},e.prototype.visitExpr=function(t){return 2046&this.allowed?t:null},e.prototype.combine=function(t){var n={},i={};for(var o in this.idents)n[o]=this.idents[o];for(var o in t.idents)n[o]=t.idents[o];for(var r in this.units)i[r]=this.units[r];for(var r in t.units)i[r]=t.units[r];return new e(this.allowed|t.allowed,n,i)},e}(ye),we={},Ee=new be(0,we,we),Se=function(t){function e(e){var n=t.call(this)||this;return n.successTerminal=new ge(null),n.failureTerminal=new ge(null),n.first=e.finish(n.successTerminal,n.failureTerminal),n}return de(e,t),e.prototype.validateList=function(t,e,n){for(var i=e?[]:t,o=this.first,r=n,a=null,s=null;o!==this.successTerminal&&o!==this.failureTerminal;)if(r>=t.length)o=o.failure;else{var l=t[r],u=l;if(o.isSpecial()){var c=!0;o.isStartGroup()?(a?a.push(s):a=[s],s=[]):o.isEndGroup()?s=a.length>0?a.pop():null:o.isEndAlternate()?s[o.getAlternate()]="taken":c=null==s[o.getAlternate()],o=c?o.success:o.failure}else{if(0==r&&!e&&o.validator instanceof Ne&&this instanceof Ne){if(u=new j.j(t).visit(o.validator)){r=t.length,o=o.success;continue}}else if(0==r&&!e&&o.validator instanceof Ce&&this instanceof Ne){if(u=new j.b(t).visit(o.validator)){r=t.length,o=o.success;continue}}else u=l.visit(o.validator);if(!u){o=o.failure;continue}if(u!==l&&t===i){i=[];for(var h=0;h<r;h++)i[h]=t[h]}t!==i&&(i[r-n]=u),r++,o=o.success}}return o===this.successTerminal&&(e?i.length>0:r==t.length)?i:null},e.prototype.validateSingle=function(t){for(var e=null,n=this.first;n!==this.successTerminal&&n!==this.failureTerminal;)t?n.isSpecial()?n=n.success:(e=t.visit(n.validator))?(t=null,n=n.success):n=n.failure:n=n.failure;return n===this.successTerminal?e:null},e.prototype.visitEmpty=function(t){return this.validateSingle(t)},e.prototype.visitSlash=function(t){return this.validateSingle(t)},e.prototype.visitStr=function(t){return this.validateSingle(t)},e.prototype.visitIdent=function(t){return this.validateSingle(t)},e.prototype.visitNumeric=function(t){return this.validateSingle(t)},e.prototype.visitNum=function(t){return this.validateSingle(t)},e.prototype.visitInt=function(t){return this.validateSingle(t)},e.prototype.visitColor=function(t){return this.validateSingle(t)},e.prototype.visitURL=function(t){return this.validateSingle(t)},e.prototype.visitSpaceList=function(t){return null},e.prototype.visitCommaList=function(t){return null},e.prototype.visitFunc=function(t){return this.validateSingle(t)},e.prototype.visitExpr=function(t){return null},e}(ye),Ne=function(t){function e(e){return t.call(this,e)||this}return de(e,t),e.prototype.visitSpaceList=function(t){var e=this.validateList(t.values,!1,0);return e===t.values?t:e?new j.j(e):null},e.prototype.visitCommaList=function(t){for(var e=this.first,n=!1;e;){if(e.validator instanceof Ce){n=!0;break}e=e.failure}if(n){var i=this.validateList(t.values,!1,0);return i===t.values?t:i?new j.b(i):null}return null},e.prototype.validateForShorthand=function(t,e){return this.validateList(t,!0,e)},e}(Se),Ce=function(t){function e(e){return t.call(this,e)||this}return de(e,t),e.prototype.visitSpaceList=function(t){return this.validateSingle(t)},e.prototype.visitCommaList=function(t){var e=this.validateList(t.values,!1,0);return e===t.values?t:e?new j.b(e):null},e.prototype.validateForShorthand=function(t,e){for(var n,i=this.first;i!==this.failureTerminal;){if(n=i.validator.validateForShorthand(t,e))return n;i=i.failure}return null},e}(Se),Te=function(t){function e(e,n){var i=t.call(this,n)||this;return i.name=e,i}return de(e,t),e.prototype.validateSingle=function(t){return null},e.prototype.visitFunc=function(t){if(t.name.toLowerCase()!=this.name)return null;var e=this.validateList(t.values,!1,0);return e===t.values?t:e?new j.e(t.name,e):null},e}(Se),xe=function(){function t(){}return t.prototype.tryParse=function(t,e,n){return e},t.prototype.success=function(t,e){},t}(),Ie=function(t){function e(e,n){var i=t.call(this)||this;return i.name=n,i.validator=e.validators[i.name],i}return de(e,t),e.prototype.tryParse=function(t,e,n){if(n.values[this.name])return e;var i=this.validator.validateForShorthand(t,e);if(i){var o=i.length,r=o>1?new j.j(i):i[0];return this.success(r,n),e+o}return e},e.prototype.success=function(t,e){e.values[this.name]=t},e}(xe),Pe=function(t){function e(e,n){var i=t.call(this,e,n[0])||this;return i.names=n,i}return de(e,t),e.prototype.success=function(t,e){for(var n=0;n<this.names.length;n++)e.values[this.names[n]]=t},e}(Ie),Oe=function(t){function e(e,n){var i=t.call(this)||this;return i.nodes=e,i.slash=n,i}return de(e,t),e.prototype.tryParse=function(t,e,n){var i=e;if(this.slash){if(t[e]!=j.w)return i;if(++e==t.length)return i}var o=this.nodes[0].tryParse(t,e,n);if(o==e)return i;e=o;for(var r=1;r<this.nodes.length&&e<t.length&&(o=this.nodes[r].tryParse(t,e,n))!=e;r++)e=o;return e},e}(xe),ke=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.syntax=null,e.propList=null,e.error=!1,e.values={},e.validatorSet=null,e}return de(e,t),e.prototype.setOwner=function(t){this.validatorSet=t},e.prototype.syntaxNodeForProperty=function(t){return new Ie(this.validatorSet,t)},e.prototype.clone=function(){var t=new this.constructor;return t.syntax=this.syntax,t.propList=this.propList,t.validatorSet=this.validatorSet,t},e.prototype.init=function(t,e){this.syntax=t,this.propList=e},e.prototype.finish=function(t,e){if(!this.error){for(var n=0,i=this.propList;n<i.length;n++){var o=i[n];e.simpleProperty(o,this.values[o]||this.validatorSet.defaultValues[o],t)}return!0}return!1},e.prototype.propagateInherit=function(t,e){for(var n=0,i=this.propList;n<i.length;n++){var o=i[n];e.simpleProperty(o,j.t.inherit,t)}},e.prototype.validateList=function(t){return this.error=!0,0},e.prototype.validateSingle=function(t){return this.validateList([t]),null},e.prototype.visitEmpty=function(t){return this.validateSingle(t)},e.prototype.visitStr=function(t){return this.validateSingle(t)},e.prototype.visitIdent=function(t){return this.validateSingle(t)},e.prototype.visitNumeric=function(t){return this.validateSingle(t)},e.prototype.visitNum=function(t){return this.validateSingle(t)},e.prototype.visitInt=function(t){return this.validateSingle(t)},e.prototype.visitColor=function(t){return this.validateSingle(t)},e.prototype.visitURL=function(t){return this.validateSingle(t)},e.prototype.visitSpaceList=function(t){return this.validateList(t.values),null},e.prototype.visitCommaList=function(t){return this.error=!0,null},e.prototype.visitFunc=function(t){return this.validateSingle(t)},e.prototype.visitExpr=function(t){return this.error=!0,null},e}(j.m),Ae=function(t){function e(){return t.call(this)||this}return de(e,t),e.prototype.validateList=function(t){for(var e=0,n=0;e<t.length;){var i=this.syntax[n].tryParse(t,e,this);if(i>e)e=i,n=0;else if(++n==this.syntax.length){this.error=!0;break}}return e},e}(ke),Re=function(t){function e(){return t.call(this)||this}return de(e,t),e.prototype.validateList=function(t){if(t.length>this.syntax.length||0==t.length)return this.error=!0,0;for(var e=0;e<this.syntax.length;e++){for(var n=e;n>=t.length;)n=1==n?0:n-2;if(this.syntax[e].tryParse(t,n,this)!=n+1)return this.error=!0,0}return t.length},e.prototype.createSyntaxNode=function(){return new Pe(this.validatorSet,this.propList)},e}(ke),Le=function(t){function e(){return t.call(this)||this}return de(e,t),e.prototype.validateList=function(t){for(var e=t.length,n=0;n<t.length;n++)if(t[n]===j.w){e=n;break}if(e>this.syntax.length||0==t.length)return this.error=!0,0;for(n=0;n<this.syntax.length;n++){for(var i=n;i>=e;)i=1==i?0:i-2;var o=void 0;if(e+1<t.length)for(o=e+n+1;o>=t.length;)o-=o==e+2?1:2;else o=i;var r=[t[i],t[o]];if(2!=this.syntax[n].tryParse(r,0,this))return this.error=!0,0}return t.length},e}(ke),_e=function(t){function e(){return t.call(this)||this}return de(e,t),e.prototype.mergeIn=function(t,e){for(var n=0,i=this.propList;n<i.length;n++){var o=i[n],r=e[o]||this.validatorSet.defaultValues[o],a=t[o];a||(a=[],t[o]=a),a.push(r)}},e.prototype.visitCommaList=function(t){for(var e={},n=0;n<t.values.length;n++)if(this.values={},t.values[n]instanceof j.b?this.error=!0:(t.values[n].visit(this),this.mergeIn(e,this.values),this.values["background-color"]&&n!=t.values.length-1&&(this.error=!0)),this.error)return null;for(var i in this.values={},e)this.values[i]="background-color"==i?e[i].pop():new j.b(e[i]);return null},e}(Ae),Fe=function(t){function e(){return t.call(this)||this}return de(e,t),e.prototype.init=function(e,n){t.prototype.init.call(this,e,n),this.propList.push("font-family","line-height","font-size")},e.prototype.validateList=function(e){var n=t.prototype.validateList.call(this,e);if(n+2>e.length)return this.error=!0,n;this.error=!1;var i=this.validatorSet.validators;if(!e[n].visit(i["font-size"]))return this.error=!0,n;if(this.values["font-size"]=e[n++],e[n]===j.w){if(++n+2>e.length)return this.error=!0,n;if(!e[n].visit(i["line-height"]))return this.error=!0,n;this.values["line-height"]=e[n++]}var o=n==e.length-1?e[n]:new j.j(e.slice(n,e.length));return o.visit(i["font-family"])?(this.values["font-family"]=o,e.length):(this.error=!0,n)},e.prototype.visitCommaList=function(t){if(t.values[0].visit(this),this.error)return null;for(var e=[this.values["font-family"]],n=1;n<t.values.length;n++)e.push(t.values[n]);var i=new j.b(e);return i.visit(this.validatorSet.validators["font-family"])?this.values["font-family"]=i:this.error=!0,null},e.prototype.visitIdent=function(t){var e=this.validatorSet.systemFonts[t.name];if(e)for(var n in e)this.values[n]=e[n];else this.error=!0;return null},e}(Ae),De={SIMPLE:Ae,INSETS:Re,INSETS_SLASH:Le,COMMA:_e,FONT:Fe},Be=function(){function t(){this.validators={},this.prefixes={},this.defaultValues={},this.namedValidators={},this.systemFonts={},this.shorthands={},this.layoutProps={},this.backgroundProps={}}return t.prototype.addReplacement=function(t,e){var n;if(e.type==G.a.NUMERIC)n=new j.i(e.num,e.text);else if(e.type==G.a.HASH)n=H.h(e.text);else{if(e.type!=G.a.IDENT)throw new Error("unexpected replacement");n=j.r(e.text)}if(t.isPrimitive()){var i=t.nodes[0].validator.idents;for(var o in i)i[o]=n;return t}throw new Error("unexpected replacement")},t.prototype.newGroup=function(t,e){var n=new ve;if("||"==t){for(var i=0;i<e.length;i++){var o=new ve;o.startClause(i),o.addGroup(e[i],oe.FOLLOW),o.endClause(i),n.addGroup(o,0==i?oe.FOLLOW:oe.ALTERNATE)}var r=new ve;return r.startSpecialGroup(),r.addGroup(n,oe.REPEATED),r.endSpecialGroup(),r}var a=void 0;switch(t){case" ":a=oe.FOLLOW;break;case"|":case"||":a=oe.ALTERNATE;break;default:throw new Error("unexpected op")}for(i=0;i<e.length;i++)n.addGroup(e[i],0==i?oe.FOLLOW:a);return n},t.prototype.addCounts=function(t,e,n){for(var i=new ve,o=0;o<e;o++)i.addGroup(t.clone(),oe.FOLLOW);if(n==Number.POSITIVE_INFINITY)i.addGroup(t,oe.REPEATED);else for(o=e;o<n;o++)i.addGroup(t.clone(),oe.OPTIONAL);return i},t.prototype.primitive=function(t){var e=new ve;return e.addPrimitive(t),e},t.prototype.newFunc=function(t,e){var n;switch(t){case"COMMA":n=new Ce(e);break;case"SPACE":n=new Ne(e);break;default:n=new Te(t.toLowerCase(),e)}return this.primitive(n)},t.prototype.initBuiltInValidators=function(){this.namedValidators.HASHCOLOR=this.primitive(new be(64,we,we)),this.namedValidators.POS_INT=this.primitive(new be(32,we,we)),this.namedValidators.POS_NUM=this.primitive(new be(16,we,we)),this.namedValidators.POS_PERCENTAGE=this.primitive(new be(8,we,{"%":j.o})),this.namedValidators.NEGATIVE=this.primitive(new be(256,we,we)),this.namedValidators.ZERO=this.primitive(new be(512,we,we)),this.namedValidators.ZERO_PERCENTAGE=this.primitive(new be(1024,we,we)),this.namedValidators.POS_LENGTH=this.primitive(new be(8,we,{em:j.o,ex:j.o,ch:j.o,rem:j.o,vw:j.o,vh:j.o,vi:j.o,vb:j.o,vmin:j.o,vmax:j.o,pvw:j.o,pvh:j.o,pvi:j.o,pvb:j.o,pvmin:j.o,pvmax:j.o,cm:j.o,mm:j.o,in:j.o,px:j.o,pt:j.o,pc:j.o,q:j.o})),this.namedValidators.POS_ANGLE=this.primitive(new be(8,we,{deg:j.o,grad:j.o,rad:j.o,turn:j.o})),this.namedValidators.POS_TIME=this.primitive(new be(8,we,{s:j.o,ms:j.o})),this.namedValidators.FREQUENCY=this.primitive(new be(8,we,{Hz:j.o,kHz:j.o})),this.namedValidators.RESOLUTION=this.primitive(new be(8,we,{dpi:j.o,dpcm:j.o,dppx:j.o})),this.namedValidators.URI=this.primitive(new be(128,we,we)),this.namedValidators.IDENT=this.primitive(new be(4,we,we)),this.namedValidators.STRING=this.primitive(new be(2,we,we)),this.namedValidators.SLASH=this.primitive(new be(2048,we,we));var t={"font-family":j.r("sans-serif")};this.systemFonts.caption=t,this.systemFonts.icon=t,this.systemFonts.menu=t,this.systemFonts["message-box"]=t,this.systemFonts["small-caption"]=t,this.systemFonts["status-bar"]=t},t.prototype.isBuiltIn=function(t){return!!t.match(/^[A-Z_0-9]+$/)},t.prototype.readNameAndPrefixes=function(t,e){var n=t.token();if(n.type==G.a.EOF)return null;var i={"":!0};if(n.type==G.a.O_BRK){do{if(t.consume(),(n=t.token()).type!=G.a.IDENT)throw new Error("Prefix name expected");i[n.text]=!0,t.consume(),n=t.token()}while(n.type==G.a.COMMA);if(n.type!=G.a.C_BRK)throw new Error("']' expected");t.consume(),n=t.token()}if(n.type!=G.a.IDENT)throw new Error("Property name expected");if(2==e?"SHORTHANDS"==n.text:"DEFAULTS"==n.text)return t.consume(),null;var o=n.text;if(t.consume(),2!=e){if(t.token().type!=G.a.EQ)throw new Error("'=' expected");this.isBuiltIn(o)||(this.prefixes[o]=i)}else if(t.token().type!=G.a.COLON)throw new Error("':' expected");return o},t.prototype.parseValidators=function(t){for(var e=function(){var e=n.readNameAndPrefixes(t,1);if(!e)return{value:void 0};for(var i=[],o=[],r="",a=void 0,s=!0,l=n,u=function(){if(0==i.length)throw new Error("No values");return 1==i.length?i[0]:l.newGroup(r,i)},c=function(t){if(s)throw new Error("'"+t+"': unexpected");if(r&&r!=t)throw new Error("mixed operators: '"+t+"' and '"+r+"'");r=t,s=!0},h=null;!h;){t.consume();var p=t.token();switch(p.type){case G.a.IDENT:if(s||c(" "),n.isBuiltIn(p.text)){var f=n.namedValidators[p.text];if(!f)throw new Error("'"+p.text+"' unexpected");i.push(f.clone())}else(d={})[p.text.toLowerCase()]=j.r(p.text),i.push(n.primitive(new be(0,d,we)));s=!1;break;case G.a.INT:var d;(d={})[""+p.num]=new j.g(p.num),i.push(n.primitive(new be(0,d,we))),s=!1;break;case G.a.BAR:c("|");break;case G.a.BAR_BAR:c("||");break;case G.a.O_BRK:s||c(" "),o.push({vals:i,op:r,b:"["}),r="",i=[],s=!0;break;case G.a.FUNC:s||c(" "),o.push({vals:i,op:r,b:"(",fn:p.text}),r="",i=[],s=!0;break;case G.a.C_BRK:a=u();var g=o.pop();if("["!=g.b)throw new Error("']' unexpected");(i=g.vals).push(a),r=g.op,s=!1;break;case G.a.C_PAR:a=u();var m=o.pop();if("("!=m.b)throw new Error("')' unexpected");(i=m.vals).push(n.newFunc(m.fn,a)),r=m.op,s=!1;break;case G.a.COLON:if(s)throw new Error("':' unexpected");t.consume(),i.push(n.addReplacement(i.pop(),t.token()));break;case G.a.QMARK:if(s)throw new Error("'?' unexpected");i.push(n.addCounts(i.pop(),0,1));break;case G.a.STAR:if(s)throw new Error("'*' unexpected");i.push(n.addCounts(i.pop(),0,Number.POSITIVE_INFINITY));break;case G.a.PLUS:if(s)throw new Error("'+' unexpected");i.push(n.addCounts(i.pop(),1,Number.POSITIVE_INFINITY));break;case G.a.O_BRC:if(t.consume(),(p=t.token()).type!=G.a.INT)throw new Error("<int> expected");var v=p.num,y=v;if(t.consume(),(p=t.token()).type==G.a.COMMA){if(t.consume(),(p=t.token()).type!=G.a.INT)throw new Error("<int> expected");y=p.num,t.consume(),p=t.token()}if(p.type!=G.a.C_BRC)throw new Error("'}' expected");i.push(n.addCounts(i.pop(),v,y));break;case G.a.SEMICOL:if(h=u(),o.length>0)throw new Error("unclosed '"+o.pop().b+"'");break;default:throw new Error("unexpected token")}}t.consume(),n.isBuiltIn(e)?n.namedValidators[e]=h:h.isSimple()?n.validators[e]=h.nodes[0].validator:n.validators[e]=new Ne(h)},n=this;;){var i=e();if("object"==typeof i)return i.value}},t.prototype.parseDefaults=function(t){for(;;){var e=this.readNameAndPrefixes(t,2);if(!e)return;for(var n=[];;){t.consume();var i=t.token();if(i.type==G.a.SEMICOL){t.consume();break}switch(i.type){case G.a.IDENT:n.push(j.r(i.text));break;case G.a.NUM:n.push(new j.h(i.num));break;case G.a.INT:n.push(new j.g(i.num));break;case G.a.NUMERIC:n.push(new j.i(i.num,i.text));break;default:throw new Error("unexpected token")}}this.defaultValues[e]=n.length>1?new j.j(n):n[0]}},t.prototype.parseShorthands=function(t){for(;;){var e=this.readNameAndPrefixes(t,3);if(!e)return;var n=t.nthToken(1),i=void 0;n.type==G.a.IDENT&&De[n.text]?(i=new De[n.text],t.consume()):i=new Ae,i.setOwner(this);for(var o=!1,r=[],a=!1,s=[],l=[];!o;)switch(t.consume(),(n=t.token()).type){case G.a.IDENT:if(this.validators[n.text])r.push(i.syntaxNodeForProperty(n.text)),l.push(n.text);else{if(!(this.shorthands[n.text]instanceof Re))throw new Error("'"+n.text+"' is neither a simple property nor an inset shorthand");var u=this.shorthands[n.text];r.push(u.createSyntaxNode()),l.push.apply(l,u.propList)}break;case G.a.SLASH:if(r.length>0||a)throw new Error("unexpected slash");a=!0;break;case G.a.O_BRK:s.push({slash:a,syntax:r}),r=[],a=!1;break;case G.a.C_BRK:var c=new Oe(r,a),h=s.pop();r=h.syntax,a=h.slash,r.push(c);break;case G.a.SEMICOL:o=!0,t.consume();break;default:throw new Error("unexpected token")}i.init(r,l),this.shorthands[e]=i}},t.prototype.parse=function(t){var e=new G.b(t,null);this.parseValidators(e),this.parseDefaults(e),this.parseShorthands(e),this.backgroundProps=this.makePropSet(["background"]),this.layoutProps=this.makePropSet(["margin","border","padding","columns","column-gap","column-rule","column-fill"])},t.prototype.makePropSet=function(t){for(var e={},n=0,i=t;n<i.length;n++)for(var o=i[n],r=this.shorthands[o],a=0,s=r?r.propList:[o];a<s.length;a++){var l=s[a],c=this.defaultValues[l];c?e[l]=c:u.b.warn("Unknown property in makePropSet:",l)}return e},t.prototype.validatePropertyAndHandleShorthand=function(t,e,n,i){var o="",r=t,a=(t=t.toLowerCase()).match(/^-([a-z]+)-([-a-z0-9]+)$/);a&&(o=a[1],t=a[2]);var s=this.prefixes[t];if(s&&s[o]){var l=this.validators[t];if(l){var u=e===j.t.inherit||e.isExpr()?e:e.visit(l);u?i.simpleProperty(t,u,n):i.invalidPropertyValue(r,e)}else{var c=this.shorthands[t].clone();e===j.t.inherit?c.propagateInherit(n,i):(e.visit(c),c.finish(n,i)||i.invalidPropertyValue(r,e))}}else i.unknownProperty(r,e)},t}();function Me(){var t=new Be;return t.initBuiltInValidators(),t.parse(fe),t}var Ue=n(17),ze={"font-style":j.t.normal,"font-variant":j.t.normal,"font-weight":j.t.normal},Ve="OTTO"+(new Date).valueOf(),He=1;function Ge(t,e){var n={};for(var i in t)n[i]=V.s(t,i).evaluate(e,i);return function(t){for(var e in ze)t[e]||(t[e]=ze[e])}(n),n}var We=function(){function t(t){this.properties=t,this.blobURLs=[],this.blobs=[],this.fontTraitKey=function(t){var e=new b.d;for(var n in ze)e.append(" "),e.append(t[n].toString());return e.toString()}(this.properties),this.src=this.properties.src?this.properties.src.toString():null;var e=this.properties["font-family"];this.family=e?e.stringValue():null}return t.prototype.traitsEqual=function(t){return this.fontTraitKey==t.fontTraitKey},t.prototype.makeAtRule=function(t,e){var n=new b.d;for(var i in n.append("@font-face {\n  font-family: "),n.append(this.family),n.append(";\n  "),ze)n.append(i),n.append(": "),this.properties[i].appendTo(n,!0),n.append(";\n  ");if(e){n.append('src: url("');var o=W.d(e);n.append(o),this.blobURLs.push(o),this.blobs.push(e),n.append('")')}else n.append("src: "),n.append(t);return n.append(";\n}\n"),n.toString()},t}(),je=function(){function t(t){this.deobfuscator=t,this.familyMap={}}return t.prototype.registerFamily=function(t,e){var n=t.family,i=this.familyMap[n],o=e.family;if(i){if(i!=o)throw new Error("E_FONT_FAMILY_INCONSISTENT "+t.family)}else this.familyMap[n]=o},t.prototype.filterFontFamily=function(t){if(t instanceof j.b){for(var e=[],n=0,i=t.values;n<i.length;n++){var o=i[n],r=this.familyMap[o.stringValue()];r&&e.push(j.r(r)),e.push(o)}return new j.b(e)}var a=this.familyMap[t.stringValue()];return a?new j.b([j.r(a),t]):t},t}(),Xe=function(){function t(t,e,n){this.head=t,this.body=e,this.srcURLMap={},this.familyCounter=0,this.familyPrefix=n||"Fnt_"}return t.prototype.getViewFontFamily=function(t,e){var n=t.family,i=e.familyMap[n];return i||(i=this.familyPrefix+ ++this.familyCounter,e.familyMap[n]=i,i)},t.prototype.initFont=function(t,e,n){var i=K.c("initFont"),o=this,r=t.src,a={};for(var s in ze)a[s]=t.properties[s];var l=o.getViewFontFamily(t,n);a["font-family"]=j.r(l);var c=new We(a),h=o.body.ownerDocument.createElement("span");h.textContent="M";var p=(new Date).valueOf()+1e3,f=o.head.ownerDocument.createElement("style"),d=Ve+He++;for(var g in f.textContent=c.makeAtRule("",W.e([d])),o.head.appendChild(f),o.body.appendChild(h),h.style.visibility="hidden",h.style.fontFamily=l,ze)b.F(h,g,a[g].toString());var m=h.getBoundingClientRect(),v=m.right-m.left,y=m.bottom-m.top;f.textContent=c.makeAtRule(r,e),u.b.info("Starting to load font:",r);var w=!1;return i.loop(function(){var t=h.getBoundingClientRect(),e=t.right-t.left,n=t.bottom-t.top;return v!=e||y!=n?(w=!0,K.d(!1)):(new Date).valueOf()>p?K.d(!1):i.sleep(10)}).then(function(){w?u.b.info("Loaded font:",r):u.b.warn("Failed to load font:",r),o.body.removeChild(h),i.finish(c)}),i.result()},t.prototype.loadFont=function(t,e){var n=t.src,i=this.srcURLMap[n],o=this;return i?i.piggyback(function(i){var o=i;o.traitsEqual(t)?(e.registerFamily(t,o),u.b.warn("Found already-loaded font:",n)):u.b.warn("E_FONT_FACE_INCOMPATIBLE",t.src)}):(i=new Ue.a(function(){var i=K.c("loadFont"),r=e.deobfuscator?e.deobfuscator(n):null;return r?W.c(n,W.b.BLOB).then(function(n){n.responseBlob?r(n.responseBlob).then(function(n){o.initFont(t,n,e).thenFinish(i)}):i.finish(null)}):o.initFont(t,null,e).thenFinish(i),i.result()},"loadFont "+n),this.srcURLMap[n]=i,i.start()),i},t.prototype.findOrLoadFonts=function(t,e){for(var n=[],i=0,o=t;i<o.length;i++){var r=o[i];r.src&&r.family?n.push(this.loadFont(r,e)):u.b.warn("E_FONT_FACE_INVALID")}return Ue.c(n)},t}(),Ke=n(30),qe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ye=1,$e=function(){function t(t,e,n,i,o){this.name=e,this.pseudoName=n,this.classes=i,this.parent=o,this.specified={},this.children=[],this.pageMaster=null,this.index=0,this._scope=t,this.key="p"+Ye++,o&&(this.index=o.children.length,o.children.push(this))}return Object.defineProperty(t.prototype,"scope",{get:function(){return this._scope},enumerable:!0,configurable:!0}),t.prototype.createInstance=function(t){throw new Error("E_UNEXPECTED_CALL")},t.prototype.clone=function(t){throw new Error("E_UNEXPECTED_CALL")},t.prototype.copySpecified=function(t){var e=this.specified,n=t.specified;for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])},t.prototype.cloneChildren=function(t){for(var e=0;e<this.children.length;e++)this.children[e].clone({parent:t})},t}(),Ze=function(t){function e(e){var n=t.call(this,e,null,null,[],null)||this;return n.specified.width=new V.c(j.q,0),n.specified.height=new V.c(j.p,0),n}return qe(e,t),e}($e),Qe=function(t){function e(e,n){var i=t.call(this,e,function(t,e){var n=t.match(/^([^.]+)\.([^.]+)$/);if(n){var i=o.pageMaster.keyMap[n[1]];if(i){var r=this.lookupInstance(i);if(r)return e?r.resolveFunc(n[2]):r.resolveName(n[2])}}return null})||this;i.pageMaster=n;var o=i;return i}return qe(e,t),e}(R.m),Je=function(t){function e(e,n,i,o,r,a,s){var l=t.call(this,e,n,i,o,r)||this;return l.condition=a,l.specificity=s,l.keyMap={},e instanceof Qe||(l._scope=new Qe(e,l)),l.pageMaster=l,l.specified.width=new V.c(j.q,0),l.specified.height=new V.c(j.p,0),l.specified["wrap-flow"]=new V.c(j.t.auto,0),l.specified.position=new V.c(j.t.relative,0),l.specified.overflow=new V.c(j.t.visible,0),l}return qe(e,t),e.prototype.createInstance=function(t){return new mn(t,this)},e.prototype.clone=function(t){var n=new e(this.scope,this.name,t.pseudoName||this.pseudoName,this.classes,this.parent,this.condition,this.specificity);return this.copySpecified(n),this.cloneChildren(n),n},e.prototype.resetScope=function(){this.scope.pageMaster=this},e}($e),tn=function(t){function e(e,n,i,o,r){var a=t.call(this,e,n,i,o,r)||this;return a.pageMaster=r.pageMaster,n&&(a.pageMaster.keyMap[n]=a.key),a.specified["wrap-flow"]=new V.c(j.t.auto,0),a}return qe(e,t),e.prototype.createInstance=function(t){return new vn(t,this)},e.prototype.clone=function(t){var n=new e(t.parent.scope,this.name,this.pseudoName,this.classes,t.parent);return this.copySpecified(n),this.cloneChildren(n),n},e}($e),en=function(t){function e(e,n,i,o,r){var a=t.call(this,e,n,i,o,r)||this;return a.pageMaster=r.pageMaster,n&&(a.pageMaster.keyMap[n]=a.key),a}return qe(e,t),e.prototype.createInstance=function(t){return new yn(t,this)},e.prototype.clone=function(t){var n=new e(t.parent.scope,this.name,this.pseudoName,this.classes,t.parent);return this.copySpecified(n),this.cloneChildren(n),n},e}($e);function nn(t,e,n){return e&&e!==j.t.auto?e.toExpr(t,n):null}function on(t,e,n){return e&&e!==j.t.auto?e.toExpr(t,n):t.zero}function rn(t,e,n){return e?e===j.t.auto?null:e.toExpr(t,n):t.zero}function an(t,e,n,i){return e&&n!==j.t.none?e.toExpr(t,i):t.zero}function sn(t,e,n){return e?e===j.t._true?t._true:e===j.t._false?t._false:e.toExpr(t,t.zero):n}var ln=function(){function t(t,e){this.parentInstance=t,this.pageBox=e,this.cascaded={},this.style={},this.autoWidth=null,this.autoHeight=null,this.children=[],this.isAutoWidth=!1,this.isAutoHeight=!1,this.isTopDependentOnAutoHeight=!1,this.isRightDependentOnAutoWidth=!1,this.calculatedWidth=0,this.calculatedHeight=0,this.pageMasterInstance=null,this.namedValues={},this.namedFuncs={},this.vertical=!1,this.rtl=!1,this.suppressEmptyBoxGeneration=!1,t&&t.children.push(this)}return t.prototype.reset=function(){this.calculatedWidth=0,this.calculatedHeight=0},t.prototype.addNamedValues=function(t,e){var n=this.resolveName(t),i=this.resolveName(e);if(!n||!i)throw new Error("E_INTERNAL");return R.C(this.pageBox.scope,n,i)},t.prototype.resolveName=function(t){var e=this.namedValues[t];if(e)return e;var n=this.style[t];switch(n&&(e=n.toExpr(this.pageBox.scope,this.pageBox.scope.zero)),t){case"margin-left-edge":e=this.resolveName("left");break;case"margin-top-edge":e=this.resolveName("top");break;case"margin-right-edge":e=this.addNamedValues("border-right-edge","margin-right");break;case"margin-bottom-edge":e=this.addNamedValues("border-bottom-edge","margin-bottom");break;case"border-left-edge":e=this.addNamedValues("margin-left-edge","margin-left");break;case"border-top-edge":e=this.addNamedValues("margin-top-edge","margin-top");break;case"border-right-edge":e=this.addNamedValues("padding-right-edge","border-right-width");break;case"border-bottom-edge":e=this.addNamedValues("padding-bottom-edge","border-bottom-width");break;case"padding-left-edge":e=this.addNamedValues("border-left-edge","border-left-width");break;case"padding-top-edge":e=this.addNamedValues("border-top-edge","border-top-width");break;case"padding-right-edge":e=this.addNamedValues("right-edge","padding-right");break;case"padding-bottom-edge":e=this.addNamedValues("bottom-edge","padding-bottom");break;case"left-edge":e=this.addNamedValues("padding-left-edge","padding-left");break;case"top-edge":e=this.addNamedValues("padding-top-edge","padding-top");break;case"right-edge":e=this.addNamedValues("left-edge","width");break;case"bottom-edge":e=this.addNamedValues("top-edge","height")}if(!e){var i=void 0;if("extent"==t)i=this.vertical?"width":"height";else if("measure"==t)i=this.vertical?"height":"width";else{var o=this.vertical?V.m:V.l;for(var r in i=t,o)i=i.replace(r,o[r])}i!=t&&(e=this.resolveName(i))}return e&&(this.namedValues[t]=e),e},t.prototype.resolveFunc=function(t){var e=this.namedFuncs[t];if(e)return e;switch(t){case"columns":var n=this.pageBox.scope,i=new R.A(n,0),o=this.resolveName("column-count"),r=this.resolveName("column-width"),a=this.resolveName("column-gap");e=R.P(n,R.N(n,new R.d(n,"min",[i,o]),R.C(n,r,a)),a)}return e&&(this.namedFuncs[t]=e),e},t.prototype.initEnabled=function(){var t=this.pageBox.scope,e=this.style,n=sn(t,e.enabled,t._true),i=nn(t,e.page,t.zero);if(i){var o=new R.s(t,"page-number");n=R.D(t,n,new R.i(t,i,o))}var r=nn(t,e["min-page-width"],t.zero);r&&(n=R.D(t,n,new R.j(t,new R.s(t,"page-width"),r)));var a=nn(t,e["min-page-height"],t.zero);a&&(n=R.D(t,n,new R.j(t,new R.s(t,"page-height"),a))),n=this.boxSpecificEnabled(n),e.enabled=new j.c(n)},t.prototype.boxSpecificEnabled=function(t){return t},t.prototype.initHorizontal=function(){var t=this.pageBox.scope,e=this.style,n=this.parentInstance?this.parentInstance.style.width.toExpr(t,null):null,i=nn(t,e.left,n),o=nn(t,e["margin-left"],n),r=an(t,e["border-left-width"],e["border-left-style"],n),a=on(t,e["padding-left"],n),s=nn(t,e.width,n),l=nn(t,e["max-width"],n),u=on(t,e["padding-right"],n),c=an(t,e["border-right-width"],e["border-right-style"],n),h=nn(t,e["margin-right"],n),p=nn(t,e.right,n),f=R.C(t,r,a),d=R.C(t,r,u);if(i&&p&&s){var g=R.P(t,n,R.C(t,s,R.C(t,R.C(t,i,f),d)));o?h?p=R.P(t,g,h):h=R.P(t,g,R.C(t,p,o)):(g=R.P(t,g,p),h?o=R.P(t,g,h):h=o=R.N(t,g,new R.f(t,.5)))}else{o||(o=t.zero),h||(h=t.zero),i||p||s||(i=t.zero),i||s?i||p?s||p||(s=this.autoWidth,this.isAutoWidth=!0):i=t.zero:(s=this.autoWidth,this.isAutoWidth=!0);var m=R.P(t,n,R.C(t,R.C(t,o,f),R.C(t,h,d)));this.isAutoWidth&&(l||(l=R.P(t,m,i||p)),this.vertical||!nn(t,e["column-width"],null)&&!nn(t,e["column-count"],null)||(s=l,this.isAutoWidth=!1)),i?s?p||(p=R.P(t,m,R.C(t,i,s))):s=R.P(t,m,R.C(t,i,p)):i=R.P(t,m,R.C(t,p,s))}var v=on(t,e["snap-width"]||(this.parentInstance?this.parentInstance.style["snap-width"]:null),n);e.left=new j.c(i),e["margin-left"]=new j.c(o),e["border-left-width"]=new j.c(r),e["padding-left"]=new j.c(a),e.width=new j.c(s),e["max-width"]=new j.c(l||s),e["padding-right"]=new j.c(u),e["border-right-width"]=new j.c(c),e["margin-right"]=new j.c(h),e.right=new j.c(p),e["snap-width"]=new j.c(v)},t.prototype.initVertical=function(){var t=this.pageBox.scope,e=this.style,n=this.parentInstance?this.parentInstance.style.width.toExpr(t,null):null,i=this.parentInstance?this.parentInstance.style.height.toExpr(t,null):null,o=nn(t,e.top,i),r=nn(t,e["margin-top"],n),a=an(t,e["border-top-width"],e["border-top-style"],n),s=on(t,e["padding-top"],n),l=nn(t,e.height,i),u=nn(t,e["max-height"],i),c=on(t,e["padding-bottom"],n),h=an(t,e["border-bottom-width"],e["border-bottom-style"],n),p=nn(t,e["margin-bottom"],n),f=nn(t,e.bottom,i),d=R.C(t,a,s),g=R.C(t,h,c);if(o&&f&&l){var m=R.P(t,i,R.C(t,l,R.C(t,R.C(t,o,d),g)));r?p?f=R.P(t,m,r):p=R.P(t,m,R.C(t,f,r)):(m=R.P(t,m,f),p?r=R.P(t,m,p):p=r=R.N(t,m,new R.f(t,.5)))}else{r||(r=t.zero),p||(p=t.zero),o||f||l||(o=t.zero),o||l?o||f?l||f||(l=this.autoHeight,this.isAutoHeight=!0):o=t.zero:(l=this.autoHeight,this.isAutoHeight=!0);var v=R.P(t,i,R.C(t,R.C(t,r,d),R.C(t,p,g)));this.isAutoHeight&&(u||(u=R.P(t,v,o||f)),this.vertical&&(nn(t,e["column-width"],null)||nn(t,e["column-count"],null))&&(l=u,this.isAutoHeight=!1)),o?l?f||(f=R.P(t,v,R.C(t,o,l))):l=R.P(t,v,R.C(t,f,o)):o=R.P(t,v,R.C(t,f,l))}var y=on(t,e["snap-height"]||(this.parentInstance?this.parentInstance.style["snap-height"]:null),n);e.top=new j.c(o),e["margin-top"]=new j.c(r),e["border-top-width"]=new j.c(a),e["padding-top"]=new j.c(s),e.height=new j.c(l),e["max-height"]=new j.c(u||l),e["padding-bottom"]=new j.c(c),e["border-bottom-width"]=new j.c(h),e["margin-bottom"]=new j.c(p),e.bottom=new j.c(f),e["snap-height"]=new j.c(y)},t.prototype.initColumns=function(){var t=this.pageBox.scope,e=this.style,n=nn(t,e[this.vertical?"height":"width"],null),i=nn(t,e["column-width"],n),o=nn(t,e["column-count"],null),r=function(t,e,n){return e&&e!==j.t.normal?e.toExpr(t,null):null}(t,e["column-gap"]);r||(r=new R.x(t,1,"em")),i&&!o&&(o=new R.d(t,"floor",[R.H(t,R.C(t,n,r),R.C(t,i,r))]),o=new R.d(t,"max",[t.one,o])),o||(o=t.one),i=R.P(t,R.H(t,R.C(t,n,r),o),r),e["column-width"]=new j.c(i),e["column-count"]=new j.c(o),e["column-gap"]=new j.c(r)},t.prototype.depends=function(t,e,n){return this.style[t].toExpr(this.pageBox.scope,null).depend(e,n)},t.prototype.init=function(t){t.registerInstance(this.pageBox.key,this);var e=this.pageBox.scope,n=this.style,i=this,o=this.parentInstance?this.parentInstance.getActiveRegions(t):null,r=V.n(this.cascaded,t,o,!1,null);this.vertical=V.z(r,t,!!this.parentInstance&&this.parentInstance.vertical),this.rtl=V.y(r,t,!!this.parentInstance&&this.parentInstance.rtl),V.k(r,n,this.vertical,this.rtl,function(t,e){return e.value}),this.autoWidth=new R.t(e,function(){return i.calculatedWidth},"autoWidth"),this.autoHeight=new R.t(e,function(){return i.calculatedHeight},"autoHeight"),this.initHorizontal(),this.initVertical(),this.initColumns(),this.initEnabled()},t.prototype.getProp=function(t,e){var n=this.style[e];return n&&(n=H.i(t,n,e)),n},t.prototype.getPropAsNumber=function(t,e){var n=this.style[e];return n&&(n=H.i(t,n,e)),j.x(n,t)},t.prototype.getSpecial=function(t,e){var n=V.t(this.cascaded,e);if(n){for(var i=[],o=0;o<n.length;o++){var r=n[o].evaluate(t,"");r&&r!==j.o&&i.push(r)}if(i.length)return i}return null},t.prototype.getActiveRegions=function(t){var e=this.getSpecial(t,"region-id");if(e){for(var n=[],i=0;i<e.length;i++)n[i]=e[i].toString();return n}return null},t.prototype.propagateProperty=function(t,e,n,i){this.propagatePropertyToElement(t,e.element,n,i)},t.prototype.propagatePropertyToElement=function(t,e,n,i){var o=this.getProp(t,n);o&&(o.isNumeric()&&R.O(o.unit)&&(o=j.n(o,t)),"font-family"===n&&(o=i.filterFontFamily(o)),b.F(e,n,o.toString()))},t.prototype.propagateDelayedProperty=function(t,e,n,i){var o=this.getProp(t,n);o&&i.push(new q.d(e.element,n,o))},t.prototype.assignLeftPosition=function(t,e){var n=this.getPropAsNumber(t,"left"),i=this.getPropAsNumber(t,"margin-left"),o=this.getPropAsNumber(t,"padding-left"),r=this.getPropAsNumber(t,"border-left-width"),a=this.getPropAsNumber(t,"width");e.setHorizontalPosition(n,a),b.F(e.element,"margin-left",i+"px"),b.F(e.element,"padding-left",o+"px"),b.F(e.element,"border-left-width",r+"px"),e.marginLeft=i,e.borderLeft=r,e.paddingLeft=o},t.prototype.assignRightPosition=function(t,e){var n=this.getPropAsNumber(t,"right"),i=this.getPropAsNumber(t,"snap-height"),o=this.getPropAsNumber(t,"margin-right"),r=this.getPropAsNumber(t,"padding-right"),a=this.getPropAsNumber(t,"border-right-width");if(b.F(e.element,"margin-right",o+"px"),b.F(e.element,"padding-right",r+"px"),b.F(e.element,"border-right-width",a+"px"),e.marginRight=o,e.borderRight=a,this.vertical&&i>0){var s=n+e.getInsetRight(),l=s-Math.floor(s/i)*i;l>0&&(e.snapOffsetX=i-l,r+=e.snapOffsetX)}e.paddingRight=r,e.snapWidth=i},t.prototype.assignTopPosition=function(t,e){var n=this.getPropAsNumber(t,"snap-height"),i=this.getPropAsNumber(t,"top"),o=this.getPropAsNumber(t,"margin-top"),r=this.getPropAsNumber(t,"padding-top"),a=this.getPropAsNumber(t,"border-top-width");if(e.top=i,e.marginTop=o,e.borderTop=a,e.snapHeight=n,!this.vertical&&n>0){var s=i+e.getInsetTop(),l=s-Math.floor(s/n)*n;l>0&&(e.snapOffsetY=n-l,r+=e.snapOffsetY)}e.paddingTop=r,b.F(e.element,"top",i+"px"),b.F(e.element,"margin-top",o+"px"),b.F(e.element,"padding-top",r+"px"),b.F(e.element,"border-top-width",a+"px")},t.prototype.assignBottomPosition=function(t,e){var n=this.getPropAsNumber(t,"margin-bottom"),i=this.getPropAsNumber(t,"padding-bottom"),o=this.getPropAsNumber(t,"border-bottom-width"),r=this.getPropAsNumber(t,"height")-e.snapOffsetY;b.F(e.element,"height",r+"px"),b.F(e.element,"margin-bottom",n+"px"),b.F(e.element,"padding-bottom",i+"px"),b.F(e.element,"border-bottom-width",o+"px"),e.height=r-e.snapOffsetY,e.marginBottom=n,e.borderBottom=o,e.paddingBottom=i},t.prototype.assignBeforePosition=function(t,e){this.vertical?this.assignRightPosition(t,e):this.assignTopPosition(t,e)},t.prototype.assignAfterPosition=function(t,e){this.vertical?this.assignLeftPosition(t,e):this.assignBottomPosition(t,e)},t.prototype.assignStartEndPosition=function(t,e){this.vertical?(this.assignTopPosition(t,e),this.assignBottomPosition(t,e)):(this.assignRightPosition(t,e),this.assignLeftPosition(t,e))},t.prototype.sizeWithMaxHeight=function(t,e){b.F(e.element,"border-top-width","0px");var n=this.getPropAsNumber(t,"max-height");this.isTopDependentOnAutoHeight?e.setVerticalPosition(0,n):(this.assignTopPosition(t,e),n-=e.snapOffsetY,e.height=n,b.F(e.element,"height",n+"px"))},t.prototype.sizeWithMaxWidth=function(t,e){b.F(e.element,"border-left-width","0px");var n=this.getPropAsNumber(t,"max-width");if(this.isRightDependentOnAutoWidth)e.setHorizontalPosition(0,n);else{this.assignRightPosition(t,e),n-=e.snapOffsetX,e.width=n;var i=this.getPropAsNumber(t,"right");b.F(e.element,"right",i+"px"),b.F(e.element,"width",n+"px")}},t.prototype.prepareContainer=function(t,e,n,i,o){this.parentInstance&&this.vertical==this.parentInstance.vertical||b.F(e.element,"writing-mode",this.vertical?"vertical-rl":"horizontal-tb"),(this.vertical?this.isAutoWidth:this.isAutoHeight)?this.vertical?this.sizeWithMaxWidth(t,e):this.sizeWithMaxHeight(t,e):(this.assignBeforePosition(t,e),this.assignAfterPosition(t,e)),(this.vertical?this.isAutoHeight:this.isAutoWidth)?this.vertical?this.sizeWithMaxHeight(t,e):this.sizeWithMaxWidth(t,e):this.assignStartEndPosition(t,e);for(var r=0;r<un.length;r++)this.propagateProperty(t,e,un[r],i)},t.prototype.transferContentProps=function(t,e,n,i){for(var o=0;o<hn.length;o++)this.propagateProperty(t,e,hn[o],i)},t.prototype.transferSinglUriContentProps=function(t,e,n){for(var i=0;i<pn.length;i++)this.propagatePropertyToElement(t,e,pn[i],n)},t.prototype.finishContainer=function(t,e,n,i,o,r,a){this.vertical?this.calculatedWidth=e.computedBlockSize+e.snapOffsetX:this.calculatedHeight=e.computedBlockSize+e.snapOffsetY;var s=(this.vertical||!i)&&this.isAutoHeight,l=(!this.vertical||!i)&&this.isAutoWidth,u=null;if((l||s)&&(l&&b.F(e.element,"width","auto"),s&&b.F(e.element,"height","auto"),u=r.getElementClientRect(i?i.element:e.element),l&&(this.calculatedWidth=Math.ceil(u.right-u.left-e.paddingLeft-e.borderLeft-e.paddingRight-e.borderRight),this.vertical&&(this.calculatedWidth+=e.snapOffsetX)),s&&(this.calculatedHeight=u.bottom-u.top-e.paddingTop-e.borderTop-e.paddingBottom-e.borderBottom,this.vertical||(this.calculatedHeight+=e.snapOffsetY))),(this.vertical?this.isAutoHeight:this.isAutoWidth)&&this.assignStartEndPosition(t,e),(this.vertical?this.isAutoWidth:this.isAutoHeight)&&((this.vertical?this.isRightDependentOnAutoWidth:this.isTopDependentOnAutoHeight)&&this.assignBeforePosition(t,e),this.assignAfterPosition(t,e)),o>1){var c=this.getPropAsNumber(t,"column-rule-width"),h=this.getProp(t,"column-rule-style"),p=this.getProp(t,"column-rule-color");if(c>0&&h&&h!=j.t.none&&p!=j.t.transparent)for(var f=this.getPropAsNumber(t,"column-gap"),d=this.vertical?e.height:e.width,g=this.vertical?"border-top":"border-left",m=1;m<o;m++){var v=(d+f)*m/o-f/2+e.paddingLeft-c/2,y=e.height+e.paddingTop+e.paddingBottom,w=e.element.ownerDocument.createElement("div");b.F(w,"position","absolute"),b.F(w,this.vertical?"left":"top","0px"),b.F(w,this.vertical?"top":"left",v+"px"),b.F(w,this.vertical?"height":"width","0px"),b.F(w,this.vertical?"width":"height",y+"px"),b.F(w,g,c+"px "+h.toString()+(p?" "+p.toString():"")),e.element.insertBefore(w,e.element.firstChild)}}for(m=0;m<cn.length;m++)this.propagateProperty(t,e,cn[m],a);for(m=0;m<fn.length;m++)this.propagateDelayedProperty(t,e,fn[m],n.delayedItems)},t.prototype.applyCascadeAndInit=function(t,e){var n=this.cascaded,i=this.pageBox.specified;for(var o in i)V.x(o)&&V.F(n,o,V.s(i,o));if(this.pageBox.pseudoName==dn)for(var r in e)(r.match(/^background-/)||"writing-mode"==r)&&(n[r]=e[r]);if("layout-host"==this.pageBox.pseudoName)for(var a in e)a.match(/^background-/)||"writing-mode"==a||(n[a]=e[a]);t.pushRule(this.pageBox.classes,null,n),n.content&&(n.content=n.content.filterValue(new V.e(t,null,t.counterResolver))),this.init(t.context);for(var s=0,l=this.pageBox.children;s<l.length;s++)l[s].createInstance(this).applyCascadeAndInit(t,e);t.popRule()},t.prototype.resolveAutoSizing=function(t){this.isAutoWidth&&(this.isRightDependentOnAutoWidth=this.depends("right",this.autoWidth,t)||this.depends("margin-right",this.autoWidth,t)||this.depends("border-right-width",this.autoWidth,t)||this.depends("padding-right",this.autoWidth,t)),this.isAutoHeight&&(this.isTopDependentOnAutoHeight=this.depends("top",this.autoHeight,t)||this.depends("margin-top",this.autoHeight,t)||this.depends("border-top-width",this.autoHeight,t)||this.depends("padding-top",this.autoHeight,t));for(var e=0,n=this.children;e<n.length;e++)n[e].resolveAutoSizing(t)},t}(),un=["border-left-style","border-right-style","border-top-style","border-bottom-style","border-left-color","border-right-color","border-top-color","border-bottom-color","outline-style","outline-color","outline-width","overflow","visibility"],cn=["border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius","border-image-source","border-image-slice","border-image-width","border-image-outset","border-image-repeat","background-attachment","background-color","background-image","background-repeat","background-position","background-clip","background-origin","background-size","opacity","z-index","background-blend-mode","isolation","mix-blend-mode","filter"],hn=["color","font-family","font-size","font-style","font-weight","font-variant","line-height","letter-spacing","text-align","text-decoration","text-indent","text-transform","white-space","word-spacing","font-feature-settings","font-kerning","font-size-adjust","font-variant-east-asian","font-stretch","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-shadow","text-underline-position"],pn=["width","height","image-resolution","object-fit","object-position"],fn=["transform","transform-origin"],dn="background-host",gn=function(t){function e(e){return t.call(this,null,e)||this}return qe(e,t),e.prototype.applyCascadeAndInit=function(e,n){t.prototype.applyCascadeAndInit.call(this,e,n),this.children.sort(function(t,e){return e.pageBox.specificity-t.pageBox.specificity||t.pageBox.index-e.pageBox.index})},e}(ln),mn=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.pageMasterInstance=i,i}return qe(e,t),e.prototype.boxSpecificEnabled=function(t){var e=this.pageBox.pageMaster;return e.condition&&(t=R.D(e.scope,t,e.condition)),t},e.prototype.adjustPageLayout=function(t,e,n){},e}(ln),vn=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.pageMasterInstance=e.pageMasterInstance,i}return qe(e,t),e}(ln),yn=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.pageMasterInstance=e.pageMasterInstance,i}return qe(e,t),e.prototype.processPartitionList=function(t,e,n){var i=null;if(e instanceof j.f&&(i=[e]),e instanceof j.b&&(i=e.values),i)for(var o=this.pageBox.scope,r=0;r<i.length;r++)if(i[r]instanceof j.f){var a=R.M(i[r].name,"enabled"),s=new R.s(o,a);n&&(s=new R.w(o,s)),t=R.D(o,t,s)}return t},e.prototype.boxSpecificEnabled=function(t){var e=this.pageBox.scope,n=this.style,i=sn(e,n.required,e._false)!==e._false;if(i||this.isAutoHeight){var o=function(t,e,n){return e?e.toExpr(t,t.zero):new R.f(t,"body")}(e,n["flow-from"]),r=new R.d(e,"has-content",[o]);t=R.D(e,t,r)}if(t=this.processPartitionList(t,n["required-partitions"],!1),t=this.processPartitionList(t,n["conflicting-partitions"],!0),i){var a=this.pageMasterInstance.style.enabled,s=a?a.toExpr(e,null):e._true;s=R.D(e,s,t),this.pageMasterInstance.style.enabled=new j.c(s)}return t},e.prototype.prepareContainer=function(e,n,i,o,r){b.F(n.element,"overflow","hidden"),t.prototype.prepareContainer.call(this,e,n,i,o,r)},e}(ln),bn=function(t){function e(e,n,i,o){var r=t.call(this,e,n,!1)||this;return r.target=i,r.validatorSet=o,r}return qe(e,t),e.prototype.property=function(t,e,n){this.validatorSet.validatePropertyAndHandleShorthand(t,e,n,this)},e.prototype.unknownProperty=function(t,e){this.report("E_INVALID_PROPERTY "+t+": "+e.toString())},e.prototype.invalidPropertyValue=function(t,e){this.report("E_INVALID_PROPERTY_VALUE "+t+": "+e.toString())},e.prototype.simpleProperty=function(t,e,n){this.target.specified[t]=new V.c(e,n?H.d:H.e)},e}(H.f),wn=function(t){function e(e,n,i,o){return t.call(this,e,n,i,o)||this}return qe(e,t),e}(bn),En=function(t){function e(e,n,i,o){var r=t.call(this,e,n,i,o)||this;return i.specified.width=new V.c(j.s,0),i.specified.height=new V.c(j.s,0),r}return qe(e,t),e.prototype.startPartitionRule=function(t,e,n){var i=new en(this.scope,t,e,n,this.target),o=new wn(this.scope,this.owner,i,this.validatorSet);this.owner.pushHandler(o)},e.prototype.startPartitionGroupRule=function(t,n,i){var o=new tn(this.scope,t,n,i,this.target),r=new e(this.scope,this.owner,o,this.validatorSet);this.owner.pushHandler(r)},e}(bn),Sn=function(t){function e(e,n,i,o){return t.call(this,e,n,i,o)||this}return qe(e,t),e.prototype.startPartitionRule=function(t,e,n){var i=new en(this.scope,t,e,n,this.target),o=new wn(this.scope,this.owner,i,this.validatorSet);this.owner.pushHandler(o)},e.prototype.startPartitionGroupRule=function(t,e,n){var i=new tn(this.scope,t,e,n,this.target),o=new En(this.scope,this.owner,i,this.validatorSet);this.owner.pushHandler(o)},e}(bn),Nn=n(19),Cn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();function Tn(t){var e=t["writing-mode"];e=e&&e.value;var n=t.direction;return n=n&&n.value,e===j.t.vertical_lr||e!==j.t.vertical_rl&&n!==j.t.rtl?i.LTR:i.RTL}var xn,In,Pn={a5:{width:new j.i(148,"mm"),height:new j.i(210,"mm")},a4:{width:new j.i(210,"mm"),height:new j.i(297,"mm")},a3:{width:new j.i(297,"mm"),height:new j.i(420,"mm")},b5:{width:new j.i(176,"mm"),height:new j.i(250,"mm")},b4:{width:new j.i(250,"mm"),height:new j.i(353,"mm")},"jis-b5":{width:new j.i(182,"mm"),height:new j.i(257,"mm")},"jis-b4":{width:new j.i(257,"mm"),height:new j.i(364,"mm")},letter:{width:new j.i(8.5,"in"),height:new j.i(11,"in")},legal:{width:new j.i(8.5,"in"),height:new j.i(14,"in")},ledger:{width:new j.i(11,"in"),height:new j.i(17,"in")}},On=new j.i(.24,"pt"),kn=new j.i(3,"mm"),An=new j.i(10,"mm"),Rn=new j.i(13,"mm");function Ln(t){var e={width:j.q,height:j.p,bleed:j.u,bleedOffset:j.u},n=t.size;if(n&&n.value!==j.t.auto){var i=n.value,o=void 0,r=void 0;if(i.isSpaceList()?(o=i.values[0],r=i.values[1]):(o=i,r=null),o.isNumeric())e.width=o,e.height=r||o;else{var a=o.name&&Pn[o.name.toLowerCase()];a&&(r&&r===j.t.landscape?(e.width=a.height,e.height=a.width):(e.width=a.width,e.height=a.height))}}var s=t.marks;s&&s.value!==j.t.none&&(e.bleedOffset=Rn);var l=t.bleed;return l&&l.value!==j.t.auto?l.value&&l.value.isNumeric()&&(e.bleed=l.value):s&&(s.value.isSpaceList()?s.value.values.some(function(t){return t===j.t.crop}):s.value===j.t.crop)&&(e.bleed=new j.i(6,"pt")),e}function _n(t,e){var n={},i=t.bleed.num*e.queryUnitSize(t.bleed.unit,!1),o=t.bleedOffset.num*e.queryUnitSize(t.bleedOffset.unit,!1),r=i+o,a=t.width;a===j.q?e.pref.defaultPaperSize?n.pageWidth=e.pref.defaultPaperSize.width*e.queryUnitSize("px",!1):n.pageWidth=(e.pref.spreadView?Math.floor(e.viewportWidth/2)-e.pref.pageBorder:e.viewportWidth)-2*r:n.pageWidth=a.num*e.queryUnitSize(a.unit,!1);var s=t.height;return s===j.p?e.pref.defaultPaperSize?n.pageHeight=e.pref.defaultPaperSize.height*e.queryUnitSize("px",!1):n.pageHeight=e.viewportHeight-2*r:n.pageHeight=s.num*e.queryUnitSize(s.unit,!1),n.bleed=i,n.bleedOffset=o,n.cropOffset=r,n}function Fn(t,e,n){var i=t.createElementNS(b.a.SVG,"svg");return i.setAttribute("width",e),i.setAttribute("height",n),i.style.position="absolute",i}function Dn(t,e,n){n=n||"polyline";var i=t.createElementNS(b.a.SVG,n);return i.setAttribute("stroke","black"),i.setAttribute("stroke-width",e),i.setAttribute("fill","none"),i}!function(t){t.TOP_LEFT="top left",t.TOP_RIGHT="top right",t.BOTTOM_LEFT="bottom left",t.BOTTOM_RIGHT="bottom right"}(xn||(xn={})),function(t){t.TOP="top",t.BOTTOM="bottom",t.LEFT="left",t.RIGHT="right"}(In||(In={}));var Bn,Mn,Un=(Bn={width:!0,height:!0,"block-size":!0,"inline-size":!0,margin:!0,padding:!0,border:!0,outline:!0,"outline-width":!0,"outline-style":!0,"outline-color":!0},["left","right","top","bottom","before","after","start","end","block-start","block-end","inline-start","inline-end"].forEach(function(t){Bn["margin-"+t]=!0,Bn["padding-"+t]=!0,Bn["border-"+t+"-width"]=!0,Bn["border-"+t+"-style"]=!0,Bn["border-"+t+"-color"]=!0}),Bn);!function(t){t.START="start",t.CENTER="center",t.END="end"}(Mn||(Mn={}));var zn,Vn,Hn={"top-left-corner":{order:1,isInTopRow:!0,isInBottomRow:!1,isInLeftColumn:!0,isInRightColumn:!0,positionAlongVariableDimension:null},"top-left":{order:2,isInTopRow:!0,isInBottomRow:!1,isInLeftColumn:!1,isInRightColumn:!1,positionAlongVariableDimension:Mn.START},"top-center":{order:3,isInTopRow:!0,isInBottomRow:!1,isInLeftColumn:!1,isInRightColumn:!1,positionAlongVariableDimension:Mn.CENTER},"top-right":{order:4,isInTopRow:!0,isInBottomRow:!1,isInLeftColumn:!1,isInRightColumn:!1,positionAlongVariableDimension:Mn.END},"top-right-corner":{order:5,isInTopRow:!0,isInBottomRow:!1,isInLeftColumn:!1,isInRightColumn:!0,positionAlongVariableDimension:null},"right-top":{order:6,isInTopRow:!1,isInBottomRow:!1,isInLeftColumn:!1,isInRightColumn:!0,positionAlongVariableDimension:Mn.START},"right-middle":{order:7,isInTopRow:!1,isInBottomRow:!1,isInLeftColumn:!1,isInRightColumn:!0,positionAlongVariableDimension:Mn.CENTER},"right-bottom":{order:8,isInTopRow:!1,isInBottomRow:!1,isInLeftColumn:!1,isInRightColumn:!0,positionAlongVariableDimension:Mn.END},"bottom-right-corner":{order:9,isInTopRow:!1,isInBottomRow:!0,isInLeftColumn:!1,isInRightColumn:!0,positionAlongVariableDimension:null},"bottom-right":{order:10,isInTopRow:!1,isInBottomRow:!0,isInLeftColumn:!1,isInRightColumn:!1,positionAlongVariableDimension:Mn.END},"bottom-center":{order:11,isInTopRow:!1,isInBottomRow:!0,isInLeftColumn:!1,isInRightColumn:!1,positionAlongVariableDimension:Mn.CENTER},"bottom-left":{order:12,isInTopRow:!1,isInBottomRow:!0,isInLeftColumn:!1,isInRightColumn:!1,positionAlongVariableDimension:Mn.START},"bottom-left-corner":{order:13,isInTopRow:!1,isInBottomRow:!0,isInLeftColumn:!0,isInRightColumn:!1,positionAlongVariableDimension:null},"left-bottom":{order:14,isInTopRow:!1,isInBottomRow:!1,isInLeftColumn:!0,isInRightColumn:!1,positionAlongVariableDimension:Mn.END},"left-middle":{order:15,isInTopRow:!1,isInBottomRow:!1,isInLeftColumn:!0,isInRightColumn:!1,positionAlongVariableDimension:Mn.CENTER},"left-top":{order:16,isInTopRow:!1,isInBottomRow:!1,isInLeftColumn:!0,isInRightColumn:!1,positionAlongVariableDimension:Mn.START}},Gn=(zn=Hn,Object.keys(zn).sort(function(t,e){return zn[t].order-zn[e].order})),Wn="vivliostyle-page-rule-master",jn="_marginBoxes",Xn=function(t){function e(e,n,i){var o=t.call(this,e,null,Wn,[],n,null,0)||this;o.pageMarginBoxes={};var r=Ln(i),a=new Kn(o.scope,o,i,r);return o.bodyPartitionKey=a.key,o.createPageMarginBoxes(i),o.applySpecified(i,r),o}return Cn(e,t),e.prototype.createPageMarginBoxes=function(t){var e=t[jn];if(e){var n=this;Gn.forEach(function(i){e[i]&&(n.pageMarginBoxes[i]=new qn(n.scope,n,i,t))})}},e.prototype.applySpecified=function(t,e){for(var n in this.specified.position=new V.c(j.t.relative,0),this.specified.width=new V.c(e.width,0),this.specified.height=new V.c(e.height,0),t)Un[n]||"background-clip"===n||(this.specified[n]=t[n])},e.prototype.createInstance=function(t){return new Yn(t,this)},e}(Je),Kn=function(t){function e(e,n,i,o){var r=t.call(this,e,null,null,[],n)||this;return r.pageSize=o,r.specified["z-index"]=new V.c(new j.g(0),0),r.applySpecified(i),r}return Cn(e,t),e.prototype.applySpecified=function(t){for(var e in this.specified["flow-from"]=new V.c(j.r("body"),0),this.specified.position=new V.c(j.t.absolute,0),this.specified.overflow=new V.c(j.t.visible,0),Un)Un.hasOwnProperty(e)&&(this.specified[e]=t[e])},e.prototype.createInstance=function(t){return new Jn(t,this)},e}(en),qn=function(t){function e(e,n,i,o){var r=t.call(this,e,null,null,[],n)||this;return r.marginBoxName=i,r.applySpecified(o),r}return Cn(e,t),e.prototype.applySpecified=function(t){var e=t[jn][this.marginBoxName];for(var n in t){var i=t[n],o=e[n];(V.v[n]||o&&o.value===j.t.inherit)&&(this.specified[n]=i)}for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i=e[n])&&i.value!==j.t.inherit&&(this.specified[n]=i)},e.prototype.createInstance=function(t){return new ti(t,this)},e}(en),Yn=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.pageAreaDimension=null,i.pageMarginBoxInstances={},i}return Cn(e,t),e.prototype.applyCascadeAndInit=function(e,n){var i=this.cascaded;for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o))switch(o){case"writing-mode":case"direction":i[o]=n[o]}t.prototype.applyCascadeAndInit.call(this,e,n)},e.prototype.initHorizontal=function(){var t=this.style;t.left=j.u,t["margin-left"]=j.u,t["border-left-width"]=j.u,t["padding-left"]=j.u,t["padding-right"]=j.u,t["border-right-width"]=j.u,t["margin-right"]=j.u,t.right=j.u},e.prototype.initVertical=function(){var t=this.style;t.top=j.u,t["margin-top"]=j.u,t["border-top-width"]=j.u,t["padding-top"]=j.u,t["padding-bottom"]=j.u,t["border-bottom-width"]=j.u,t["margin-bottom"]=j.u,t.bottom=j.u},e.prototype.setPageAreaDimension=function(t){this.pageAreaDimension=t;var e=this.style;e.width=new j.c(t.borderBoxWidth),e.height=new j.c(t.borderBoxHeight),e["padding-left"]=new j.c(t.marginLeft),e["padding-right"]=new j.c(t.marginRight),e["padding-top"]=new j.c(t.marginTop),e["padding-bottom"]=new j.c(t.marginBottom)},e.prototype.adjustPageLayout=function(t,e,n){var i=e.marginBoxes,o={start:this.pageAreaDimension.marginLeft,end:this.pageAreaDimension.marginRight,extent:this.pageAreaDimension.borderBoxWidth},r={start:this.pageAreaDimension.marginTop,end:this.pageAreaDimension.marginBottom,extent:this.pageAreaDimension.borderBoxHeight};this.sizeMarginBoxesAlongVariableDimension(i.top,!0,o,t,n),this.sizeMarginBoxesAlongVariableDimension(i.bottom,!0,o,t,n),this.sizeMarginBoxesAlongVariableDimension(i.left,!1,r,t,n),this.sizeMarginBoxesAlongVariableDimension(i.right,!1,r,t,n)},e.prototype.sizeMarginBoxesAlongVariableDimension=function(t,e,n,i,o){var r=Mn.START,a=Mn.CENTER,s=Mn.END,l=this.pageBox.scope,u={},c={},h={};for(var p in t){var f=Hn[p];if(f){var d=t[p],g=this.pageMarginBoxInstances[p],m=new $n(d,g.style,e,l,o);u[f.positionAlongVariableDimension]=d,c[f.positionAlongVariableDimension]=g,h[f.positionAlongVariableDimension]=m}}var v={start:n.start.evaluate(i),end:n.end.evaluate(i),extent:n.extent.evaluate(i)},y=this.getSizesOfMarginBoxesAlongVariableDimension(h,v.extent),b=!1,w={};Object.keys(u).forEach(function(t){var r=t,a=nn(l,c[r].style[e?"max-width":"max-height"],n.extent);if(a){var s=a.evaluate(i);if(y[r]>s){var p=h[r]=new Qn(u[r],c[r].style,e,l,o,s);w[r]=p.getOuterSize(),b=!0}}}),b&&(y=this.getSizesOfMarginBoxesAlongVariableDimension(h,v.extent),b=!1,[r,a,s].forEach(function(t){y[t]=w[t]||y[t]}));var E={};Object.keys(u).forEach(function(t){var r=t,a=nn(l,c[r].style[e?"min-width":"min-height"],n.extent);if(a){var s=a.evaluate(i);if(y[r]<s){var p=h[r]=new Qn(u[r],c[r].style,e,l,o,s);E[r]=p.getOuterSize(),b=!0}}}),b&&(y=this.getSizesOfMarginBoxesAlongVariableDimension(h,v.extent),[r,a,s].forEach(function(t){y[t]=E[t]||y[t]}));var S=v.start+v.extent,N=v.start+(v.start+v.extent);[r,a,s].forEach(function(t){var n=y[t];if(n){var i=u[t],o=0;switch(t){case r:o=e?i.left:i.top;break;case a:o=(N-n)/2;break;case s:o=S-n}e?i.setHorizontalPosition(o,n-i.getInsetLeft()-i.getInsetRight()):i.setVerticalPosition(o,n-i.getInsetTop()-i.getInsetBottom())}})},e.prototype.getSizesOfMarginBoxesAlongVariableDimension=function(t,e){var n=t[Mn.START],i=t[Mn.CENTER],o=t[Mn.END],r={};if(i){var a=[n,o].filter(function(t){return t}),s=a.length?new Zn(a):null,l=this.distributeAutoMarginBoxSizes(i,s,e);l.xSize&&(r[Mn.CENTER]=l.xSize);var u=(e-(l.xSize||i.getOuterSize()))/2;n&&n.hasAutoSize()&&(r[Mn.START]=u),o&&o.hasAutoSize()&&(r[Mn.END]=u)}else{var c=this.distributeAutoMarginBoxSizes(n,o,e);c.xSize&&(r[Mn.START]=c.xSize),c.ySize&&(r[Mn.END]=c.ySize)}return r},e.prototype.distributeAutoMarginBoxSizes=function(t,e,n){var i={xSize:null,ySize:null};if(t&&e)if(t.hasAutoSize()&&e.hasAutoSize()){var o=t.getOuterMaxContentSize(),r=e.getOuterMaxContentSize();if(o>0&&r>0){var a=o+r;if(a<n)i.xSize=n*o/a;else{var s=t.getOuterMinContentSize(),l=s+e.getOuterMinContentSize();l<n?i.xSize=s+(n-l)*(o-s)/(a-l):l>0&&(i.xSize=n*s/l)}i.xSize>0&&(i.ySize=n-i.xSize)}else o>0?i.xSize=n:r>0&&(i.ySize=n)}else t.hasAutoSize()?i.xSize=Math.max(n-e.getOuterSize(),0):e.hasAutoSize()&&(i.ySize=Math.max(n-t.getOuterSize(),0));else t?t.hasAutoSize()&&(i.xSize=n):e&&e.hasAutoSize()&&(i.ySize=n);return i},e.prototype.prepareContainer=function(e,n,i,o,r){t.prototype.prepareContainer.call(this,e,n,i,o,r),n.element.setAttribute("data-vivliostyle-page-box",!0)},e}(mn),$n=function(){function t(t,e,n,i,o){this.container=t,this.isHorizontal=n,this.clientLayout=o,this.size=null,this.hasAutoSize_=!nn(i,e[n?"width":"height"],new R.x(i,0,"px"))}return t.prototype.hasAutoSize=function(){return this.hasAutoSize_},t.prototype.getSize=function(){if(!this.size){var t=this.isHorizontal?[Nn.a.MAX_CONTENT_WIDTH,Nn.a.MIN_CONTENT_WIDTH]:[Nn.a.MAX_CONTENT_HEIGHT,Nn.a.MIN_CONTENT_HEIGHT];this.size=Nn.b(this.clientLayout,this.container.element,t)}return this.size},t.prototype.getOuterMaxContentSize=function(){var t=this.getSize();return this.isHorizontal?this.container.getInsetLeft()+t[Nn.a.MAX_CONTENT_WIDTH]+this.container.getInsetRight():this.container.getInsetTop()+t[Nn.a.MAX_CONTENT_HEIGHT]+this.container.getInsetBottom()},t.prototype.getOuterMinContentSize=function(){var t=this.getSize();return this.isHorizontal?this.container.getInsetLeft()+t[Nn.a.MIN_CONTENT_WIDTH]+this.container.getInsetRight():this.container.getInsetTop()+t[Nn.a.MIN_CONTENT_HEIGHT]+this.container.getInsetBottom()},t.prototype.getOuterSize=function(){return this.isHorizontal?this.container.getInsetLeft()+this.container.width+this.container.getInsetRight():this.container.getInsetTop()+this.container.height+this.container.getInsetBottom()},t}(),Zn=function(){function t(t){this.params=t}return t.prototype.hasAutoSize=function(){return this.params.some(function(t){return t.hasAutoSize()})},t.prototype.getOuterMaxContentSize=function(){var t=this.params.map(function(t){return t.getOuterMaxContentSize()});return Math.max.apply(null,t)*t.length},t.prototype.getOuterMinContentSize=function(){var t=this.params.map(function(t){return t.getOuterMinContentSize()});return Math.max.apply(null,t)*t.length},t.prototype.getOuterSize=function(){var t=this.params.map(function(t){return t.getOuterSize()});return Math.max.apply(null,t)*t.length},t}(),Qn=function(t){function e(e,n,i,o,r,a){var s=t.call(this,e,n,i,o,r)||this;return s.fixedSize=a,s}return Cn(e,t),e.prototype.hasAutoSize=function(){return!1},e.prototype.getOuterMaxContentSize=function(){return this.getOuterSize()},e.prototype.getOuterMinContentSize=function(){return this.getOuterSize()},e.prototype.getOuterSize=function(){return this.isHorizontal?this.container.getInsetLeft()+this.fixedSize+this.container.getInsetRight():this.container.getInsetTop()+this.fixedSize+this.container.getInsetBottom()},e}($n),Jn=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.borderBoxWidth=null,i.borderBoxHeight=null,i.marginTop=null,i.marginRight=null,i.marginBottom=null,i.marginLeft=null,i}return Cn(e,t),e.prototype.applyCascadeAndInit=function(e,n){var i=this.cascaded;for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(o.match(/^column.*$/)||o.match(/^background-/))&&(i[o]=n[o]);t.prototype.applyCascadeAndInit.call(this,e,n),this.parentInstance.setPageAreaDimension({borderBoxWidth:this.borderBoxWidth,borderBoxHeight:this.borderBoxHeight,marginTop:this.marginTop,marginRight:this.marginRight,marginBottom:this.marginBottom,marginLeft:this.marginLeft})},e.prototype.initHorizontal=function(){var t=this.resolvePageBoxDimensions({start:"left",end:"right",extent:"width"});this.borderBoxWidth=t.borderBoxExtent,this.marginLeft=t.marginStart,this.marginRight=t.marginEnd},e.prototype.initVertical=function(){var t=this.resolvePageBoxDimensions({start:"top",end:"bottom",extent:"height"});this.borderBoxHeight=t.borderBoxExtent,this.marginTop=t.marginStart,this.marginBottom=t.marginEnd},e.prototype.resolvePageBoxDimensions=function(t){var e=this.style,n=this.pageBox.pageSize,i=this.pageBox.scope,o=t.start,r=t.end,a=t.extent,s=n[a].toExpr(i,null),l=nn(i,e[a],s),u=nn(i,e["margin-"+o],s),c=nn(i,e["margin-"+r],s),h=on(i,e["padding-"+o],s),p=on(i,e["padding-"+r],s),f=an(i,e["border-"+o+"-width"],e["border-"+o+"-style"],s),d=an(i,e["border-"+r+"-width"],e["border-"+r+"-style"],s),g=R.P(i,s,R.C(i,R.C(i,f,h),R.C(i,d,p)));return l?(g=R.P(i,g,l),u||c?u?c=R.P(i,g,u):u=R.P(i,g,c):c=u=R.N(i,g,new R.f(i,.5))):(u||(u=i.zero),c||(c=i.zero),l=R.P(i,g,R.C(i,u,c))),e[o]=new j.c(u),e[r]=new j.c(c),e["margin-"+o]=j.u,e["margin-"+r]=j.u,e["padding-"+o]=new j.c(h),e["padding-"+r]=new j.c(p),e["border-"+o+"-width"]=new j.c(f),e["border-"+r+"-width"]=new j.c(d),e[a]=new j.c(l),e["max-"+a]=new j.c(l),{borderBoxExtent:R.P(i,s,R.C(i,u,c)),marginStart:u,marginEnd:c}},e.prototype.prepareContainer=function(e,n,i,o,r){t.prototype.prepareContainer.call(this,e,n,i,o,r),i.pageAreaElement=n.element,e.pageAreaWidth=parseFloat(i.pageAreaElement.style.width),e.pageAreaHeight=parseFloat(i.pageAreaElement.style.height)},e}(yn),ti=function(t){function e(e,n){var i=t.call(this,e,n)||this;i.suppressEmptyBoxGeneration=!0;var o=n.marginBoxName;return i.boxInfo=Hn[o],e.pageMarginBoxInstances[o]=i,i}return Cn(e,t),e.prototype.prepareContainer=function(e,n,i,o,r){this.applyVerticalAlign(e,n.element),t.prototype.prepareContainer.call(this,e,n,i,o,r)},e.prototype.applyVerticalAlign=function(t,e){b.F(e,"display","flex");var n=this.getProp(t,"vertical-align"),i=null;n===j.r("middle")?i="center":n===j.r("top")?i="flex-start":n===j.r("bottom")&&(i="flex-end"),i&&(b.F(e,"flex-flow",this.vertical?"row":"column"),b.F(e,"justify-content",i))},e.prototype.positionAlongVariableDimension=function(t,e){var n=this.style,i=this.pageBox.scope,o=t.start,r=t.end,a=t.extent,s="left"===o,l=s?e.borderBoxWidth:e.borderBoxHeight,u=nn(i,n[a],l),c=s?e.marginLeft:e.marginTop;if(this.boxInfo.positionAlongVariableDimension===Mn.START)n[o]=new j.c(c);else if(u){var h=on(i,n["margin-"+o],l),p=on(i,n["margin-"+r],l),f=on(i,n["padding-"+o],l),d=on(i,n["padding-"+r],l),g=an(i,n["border-"+o+"-width"],n["border-"+o+"-style"],l),m=an(i,n["border-"+r+"-width"],n["border-"+r+"-style"],l),v=R.C(i,u,R.C(i,R.C(i,f,d),R.C(i,R.C(i,g,m),R.C(i,h,p))));switch(this.boxInfo.positionAlongVariableDimension){case Mn.CENTER:n[o]=new j.c(R.C(i,c,R.H(i,R.P(i,l,v),new R.f(i,2))));break;case Mn.END:n[o]=new j.c(R.P(i,R.C(i,c,l),v))}}},e.prototype.positionAndSizeAlongFixedDimension=function(t,e){var n=this.style,i=this.pageBox.scope,o=t.inside,r=t.outside,a=t.extent,s=e["margin"+r.charAt(0).toUpperCase()+r.substring(1)],l=rn(i,n["margin-"+o],s),u=rn(i,n["margin-"+r],s),c=on(i,n["padding-"+o],s),h=on(i,n["padding-"+r],s),p=an(i,n["border-"+o+"-width"],n["border-"+o+"-style"],s),f=an(i,n["border-"+r+"-width"],n["border-"+r+"-style"],s),d=nn(i,n[a],s),g=null;function m(t){if(g)return g;g={extent:d?d.evaluate(t):null,marginInside:l?l.evaluate(t):null,marginOutside:u?u.evaluate(t):null};var e=s.evaluate(t),n=0;return[p,c,h,f].forEach(function(e){e&&(n+=e.evaluate(t))}),(null===g.marginInside||null===g.marginOutside)&&n+g.extent+g.marginInside+g.marginOutside>e&&(null===g.marginInside&&(g.marginInside=0),null===g.marginOutside&&(g.marginOutside=0)),null!==g.extent&&null!==g.marginInside&&null!==g.marginOutside&&(g.marginOutside=null),null===g.extent&&null!==g.marginInside&&null!==g.marginOutside?g.extent=e-n-g.marginInside-g.marginOutside:null!==g.extent&&null===g.marginInside&&null!==g.marginOutside?g.marginInside=e-n-g.extent-g.marginOutside:null!==g.extent&&null!==g.marginInside&&null===g.marginOutside?g.marginOutside=e-n-g.extent-g.marginInside:null===g.extent?(g.marginInside=g.marginOutside=0,g.extent=e-n):g.marginInside=g.marginOutside=(e-n-g.extent)/2,g}n[a]=new j.c(new R.t(i,function(){var t=m(this).extent;return null===t?0:t},a)),n["margin-"+o]=new j.c(new R.t(i,function(){var t=m(this).marginInside;return null===t?0:t},"margin-"+o)),n["margin-"+r]=new j.c(new R.t(i,function(){var t=m(this).marginOutside;return null===t?0:t},"margin-"+r)),"left"===o?n.left=new j.c(R.C(i,e.marginLeft,e.borderBoxWidth)):"top"===o&&(n.top=new j.c(R.C(i,e.marginTop,e.borderBoxHeight)))},e.prototype.initHorizontal=function(){var t=this.parentInstance.pageAreaDimension;this.boxInfo.isInLeftColumn?this.positionAndSizeAlongFixedDimension({inside:"right",outside:"left",extent:"width"},t):this.boxInfo.isInRightColumn?this.positionAndSizeAlongFixedDimension({inside:"left",outside:"right",extent:"width"},t):this.positionAlongVariableDimension({start:"left",end:"right",extent:"width"},t)},e.prototype.initVertical=function(){var t=this.parentInstance.pageAreaDimension;this.boxInfo.isInTopRow?this.positionAndSizeAlongFixedDimension({inside:"bottom",outside:"top",extent:"height"},t):this.boxInfo.isInBottomRow?this.positionAndSizeAlongFixedDimension({inside:"top",outside:"bottom",extent:"height"},t):this.positionAlongVariableDimension({start:"top",end:"bottom",extent:"height"},t)},e.prototype.finishContainer=function(e,n,i,o,r,a,s){t.prototype.finishContainer.call(this,e,n,i,o,r,a,s);var l=i.marginBoxes,u=this.pageBox.marginBoxName,c=this.boxInfo;c.isInLeftColumn||c.isInRightColumn?c.isInTopRow||c.isInBottomRow||(c.isInLeftColumn?l.left[u]=n:c.isInRightColumn&&(l.right[u]=n)):c.isInTopRow?l.top[u]=n:c.isInBottomRow&&(l.bottom[u]=n)},e}(yn),ei=function(){function t(t,e,n,i,o){this.cascadeInstance=t,this.pageScope=e,this.rootPageBoxInstance=n,this.context=i,this.docElementStyle=o,this.pageMasterCache={},this.definePageProgression()}return t.prototype.definePageProgression=function(){var t=this.pageScope,e=new R.s(t,"page-number"),n=new R.i(t,new R.q(t,e,new R.f(t,2)),t.zero);t.defineName("recto-page",new R.w(t,n)),t.defineName("verso-page",n),(this.context.pageProgression||Tn(this.docElementStyle))===i.LTR?(t.defineName("left-page",n),t.defineName("right-page",new R.w(t,n))):(t.defineName("left-page",new R.w(t,n)),t.defineName("right-page",n))},t.prototype.getCascadedPageStyle=function(){var t={};return this.cascadeInstance.pushRule([],"",t),this.cascadeInstance.popRule(),t},t.prototype.getPageRulePageMaster=function(t,e){var n=t.pageBox;if(0===Object.keys(e).length)return n.resetScope(),t;var i=this.makeCacheKey(e,n),o=this.pageMasterCache[i];return o||(o=n.pseudoName===dn?this.generatePageRuleMaster(e):this.generateCascadedPageMaster(e,n),this.pageMasterCache[i]=o),o.pageBox.resetScope(),o},t.prototype.makeCacheKey=function(t,e){var n=this.makeCascadeValueObjectKey(t);return e.key+"^"+n},t.prototype.makeCascadeValueObjectKey=function(t){var e=[];for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i,o=t[n];i=o instanceof V.c?""+o.value:this.makeCascadeValueObjectKey(o),e.push(n+i+(o.priority||""))}return e.sort().join("^")},t.prototype.generatePageRuleMaster=function(t){var e=new Xn(this.pageScope,this.rootPageBoxInstance.pageBox,t).createInstance(this.rootPageBoxInstance);return e.applyCascadeAndInit(this.cascadeInstance,this.docElementStyle),e.resolveAutoSizing(this.context),e},t.prototype.generateCascadedPageMaster=function(t,e){var n=e.clone({pseudoName:Wn}),i=n.specified,o=t.size;if(o){var r=Ln(t),a=o.priority;i.width=V.i(this.context,i.width,new V.c(r.width,a)),i.height=V.i(this.context,i.height,new V.c(r.height,a))}["counter-reset","counter-increment"].forEach(function(e){i[e]&&(t[e]=i[e])});var s=n.createInstance(this.rootPageBoxInstance);return s.applyCascadeAndInit(this.cascadeInstance,this.docElementStyle),s.resolveAutoSizing(this.context),s},t}(),ni=function(t){function e(e){var n=t.call(this)||this;return n.pageType=e,n}return Cn(e,t),e.prototype.apply=function(t){t.currentPageType===this.pageType&&this.chained.apply(t)},e.prototype.getPriority=function(){return 3},e.prototype.makePrimary=function(t){return this.chained&&t.insertInTable(t.pagetypes,this.pageType,this.chained),!0},e}(V.d),ii=function(t){function e(e){var n=t.call(this)||this;return n.scope=e,n}return Cn(e,t),e.prototype.apply=function(t){1===new R.s(this.scope,"page-number").evaluate(t.context)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 2},e}(V.d),oi=function(t){function e(e){var n=t.call(this)||this;return n.scope=e,n}return Cn(e,t),e.prototype.apply=function(t){new R.s(this.scope,"left-page").evaluate(t.context)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 1},e}(V.d),ri=function(t){function e(e){var n=t.call(this)||this;return n.scope=e,n}return Cn(e,t),e.prototype.apply=function(t){new R.s(this.scope,"right-page").evaluate(t.context)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 1},e}(V.d),ai=function(t){function e(e){var n=t.call(this)||this;return n.scope=e,n}return Cn(e,t),e.prototype.apply=function(t){new R.s(this.scope,"recto-page").evaluate(t.context)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 1},e}(V.d),si=function(t){function e(e){var n=t.call(this)||this;return n.scope=e,n}return Cn(e,t),e.prototype.apply=function(t){new R.s(this.scope,"verso-page").evaluate(t.context)&&this.chained.apply(t)},e.prototype.getPriority=function(){return 1},e}(V.d),li=function(t){function e(e,n){return t.call(this,e,n,null,null,null)||this}return Cn(e,t),e.prototype.apply=function(t){!function(t,e,n,i,o){V.B(t,e,n,i,null,null,null);var r=n[jn];if(r){var a=V.q(e,jn);for(var s in r)if(r.hasOwnProperty(s)){var l=a[s];l||(l={},a[s]=l),V.B(t,l,r[s],i,null,null,null)}}}(t.context,t.currentStyle,this.style,this.specificity)},e}(V.a),ui=function(t){function e(e,n,i,o,r){var a=t.call(this,e,n,null,i,null,o,!1)||this;return a.pageProps=r,a.currentPageSelectors=[],a.currentNamedPageSelector="",a.currentPseudoPageClassSelectors=[],a}return Cn(e,t),e.prototype.startPageRule=function(){this.startSelectorRule()},e.prototype.tagSelector=function(t,e){y.a(e),this.currentNamedPageSelector=e,e&&(this.chain.push(new ni(e)),this.specificity+=65536)},e.prototype.pseudoclassSelector=function(t,e){switch(e&&this.reportAndSkip("E_INVALID_PAGE_SELECTOR :"+t+"("+e.join("")+")"),this.currentPseudoPageClassSelectors.push(":"+t),t.toLowerCase()){case"first":this.chain.push(new ii(this.scope)),this.specificity+=256;break;case"left":this.chain.push(new oi(this.scope)),this.specificity+=1;break;case"right":this.chain.push(new ri(this.scope)),this.specificity+=1;break;case"recto":this.chain.push(new ai(this.scope)),this.specificity+=1;break;case"verso":this.chain.push(new si(this.scope)),this.specificity+=1;break;default:this.reportAndSkip("E_INVALID_PAGE_SELECTOR :"+t)}},e.prototype.finishSelector=function(){var t;t=this.currentNamedPageSelector||this.currentPseudoPageClassSelectors.length?[this.currentNamedPageSelector].concat(this.currentPseudoPageClassSelectors.sort()):null,this.currentPageSelectors.push({selectors:t,specificity:this.specificity}),this.currentNamedPageSelector="",this.currentPseudoPageClassSelectors=[]},e.prototype.nextSelector=function(){this.finishSelector(),t.prototype.nextSelector.call(this)},e.prototype.startRuleBody=function(){this.finishSelector(),t.prototype.startRuleBody.call(this)},e.prototype.simpleProperty=function(e,n,i){var o=this;if("bleed"!==e&&"marks"!==e||this.currentPageSelectors.some(function(t){return null===t.selectors})){t.prototype.simpleProperty.call(this,e,n,i);var r=V.s(this.elementStyle,e),a=this.pageProps;if("bleed"===e||"marks"===e)a[""]||(a[""]={}),Object.keys(a).forEach(function(t){V.F(a[t],e,r)});else if("size"===e){var s=a[""];this.currentPageSelectors.forEach(function(t){var n=new V.c(r.value,r.priority+t.specificity),i=t.selectors?t.selectors.join(""):"",l=a[i];if(l){var u=V.s(l,e);n=u?V.i(null,n,u):n,V.F(l,e,n)}else l=a[i]={},V.F(l,e,n),s&&["bleed","marks"].forEach(function(t){s[t]&&V.F(l,t,s[t])},o)})}}},e.prototype.insertNonPrimary=function(t){this.cascade.insertInTable(this.cascade.pagetypes,"*",t)},e.prototype.makeApplyRuleAction=function(t){return new li(this.elementStyle,t)},e.prototype.startPageMarginBoxRule=function(t){var e=V.q(this.elementStyle,jn),n=e[t];n||(n={},e[t]=n);var i=new ci(this.scope,this.owner,this.validatorSet,n);this.owner.pushHandler(i)},e}(V.b),ci=function(t){function e(e,n,i,o){var r=t.call(this,e,n,!1)||this;return r.validatorSet=i,r.boxStyle=o,r}return Cn(e,t),e.prototype.property=function(t,e,n){this.validatorSet.validatePropertyAndHandleShorthand(t,e,n,this)},e.prototype.invalidPropertyValue=function(t,e){this.report("E_INVALID_PROPERTY_VALUE "+t+": "+e.toString())},e.prototype.unknownProperty=function(t,e){this.report("E_INVALID_PROPERTY "+t+": "+e.toString())},e.prototype.simpleProperty=function(t,e,n){var i=n?this.getImportantSpecificity():this.getBaseSpecificity(),o=new V.c(e,i);V.F(this.boxStyle,t,o)},e}(H.f),hi=n(27),pi=n(25),fi=n(21),di=function(t,e,n){return t.replace(/[uU][rR][lL]\(\s*"((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^"\r\n])+)"/gm,function(t,i){return'url("'+n.transformURL(i,e)+'"'}).replace(/[uU][rR][lL]\(\s*'((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^'\r\n])+)'/gm,function(t,i){return"url('"+n.transformURL(i,e)+"'"}).replace(/[uU][rR][lL]\(\s*((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^"'\r\n\)\s])+)/gm,function(t,i){return"url("+n.transformURL(i,e)})},gi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),mi={},vi={"text-indent":"0px","margin-top":"0px","padding-top":"0px","border-top-width":"0px","border-top-style":"none","border-top-color":"transparent","border-top-left-radius":"0px","border-top-right-radius":"0px"},yi={"text-indent":"0px","margin-right":"0px","padding-right":"0px","border-right-width":"0px","border-right-style":"none","border-right-color":"transparent","border-top-right-radius":"0px","border-bottom-right-radius":"0px"},bi={"margin-top":"0px"},wi={"margin-right":"0px"},Ei=function(t){function e(e,n,i,o,r,a,s,l,u,c,h,p,f){var d=t.call(this)||this;return d.flowName=e,d.context=n,d.viewport=i,d.styler=o,d.regionIds=r,d.xmldoc=a,d.docFaces=s,d.footnoteStyle=l,d.stylerProducer=u,d.page=c,d.customRenderer=h,d.fallbackMap=p,d.documentURLTransformer=f,d.nodeContext=null,d.viewRoot=null,d.isFootnote=!1,d.sourceNode=null,d.offsetInNode=0,d.viewNode=null,d.document=i.document,d.exprContentListener=o.counterListener.getExprContentListener(),d}return gi(e,t),e.prototype.clone=function(){return new e(this.flowName,this.context,this.viewport,this.styler,this.regionIds,this.xmldoc,this.docFaces,this.footnoteStyle,this.stylerProducer,this.page,this.customRenderer,this.fallbackMap,this.documentURLTransformer)},e.prototype.createPseudoelementShadow=function(t,e,n,i,o,r,a,s){var l=this.getPseudoMap(n,this.regionIds,this.isFootnote,this.nodeContext,r);if(!l)return s;for(var u=[],c=fi.c.createElementNS(b.a.SHADOW,"root"),h=c,p=0,f=fi.e;p<f.length;p++){var d=f[p],g=void 0;if(d){if(!l[d])continue;if(!("footnote-marker"!=d||e&&this.isFootnote))continue;if(d.match(/^first-/)){var m=i.display;if(!m||m===j.t.inline)continue}if("before"===d||"after"===d){var v=l[d].content;if(!v||v===j.t.normal||v===j.t.none)continue}u.push(d),g=fi.c.createElementNS(b.a.XHTML,"span"),fi.f(g,d)}else g=fi.c.createElementNS(b.a.SHADOW,"content");h.appendChild(g),d.match(/^first-/)&&(h=g)}if(!u.length)return s;var y=new fi.b(t,n,o,r,this.exprContentListener);return new q.n(t,c,null,a,s,q.o.ROOTLESS,y)},e.prototype.getPseudoMap=function(t,e,n,i,o){var r=V.u(t,"_pseudos");if(!r)return null;var a={},s=function(t){var i=a[t]={};V.C(i,r[t],o),V.D(i,o,r[t]),V.o(r[t],e,n,function(t,e){V.C(i,e,o),V.p(e,function(t){V.C(i,t,o)})})};for(var l in r)s(l);return a},e.prototype.createRefShadow=function(t,e,n,i,o){var r=this,a=K.c("createRefShadow");return r.xmldoc.store.load(t).then(function(s){var l=s;if(l){var u=l.getElement(t);if(u){var c=r.stylerProducer.getStylerForDoc(l);o=new q.n(n,u,l,i,o,e,c)}}a.finish(o)}),a.result()},e.prototype.createShadows=function(t,e,n,i,o,r,a){var s,l=this,u=K.c("createShadows"),c=i.template;if(c instanceof j.l){var h=c.url;s=l.createRefShadow(h,q.o.ROOTLESS,t,a,null)}else s=K.d(null);return s.then(function(s){var c=null;if(t.namespaceURI==b.a.SHADOW&&"include"==t.localName){var h=t.getAttribute("href"),p=null;h?p=a?a.xmldoc:l.xmldoc:a&&(h=a.owner.namespaceURI==b.a.XHTML?a.owner.getAttribute("href"):a.owner.getAttributeNS(b.a.XLINK,"href"),p=a.parentShadow?a.parentShadow.xmldoc:l.xmldoc),h&&(h=b.C(h,p.url),c=l.createRefShadow(h,q.o.ROOTED,t,a,s))}null==c&&(c=K.d(s));var f=null;c.then(function(e){if(i.display===j.t.table_cell){var n=b.C("user-agent.xml#table-cell",b.D);f=l.createRefShadow(n,q.o.ROOTLESS,t,a,e)}else f=K.d(e)}),f.then(function(s){s=l.createPseudoelementShadow(t,e,n,i,o,r,a,s),u.finish(s)})}),u.result()},e.prototype.setViewRoot=function(t,e){this.viewRoot=t,this.isFootnote=e},e.prototype.computeStyle=function(t,e,n,i){var o=this.context,r=V.n(n,o,this.regionIds,this.isFootnote,this.nodeContext);t=V.z(r,o,t),e=V.y(r,o,e);var a=this;V.k(r,i,t,e,function(t,e){var n=e.evaluate(o,t);return"font-family"==t&&(n=a.docFaces.filterFontFamily(n)),n});var s=i.position,l=i.float,u=ae.c(i.display||j.t.inline,s,l,this.sourceNode===this.xmldoc.root);return["display","position","float"].forEach(function(t){u[t]&&(i[t]=u[t])}),t},e.prototype.inheritFromSourceParent=function(t){for(var e=this.nodeContext.sourceNode,n=[],i=null,o=this.nodeContext.shadowContext,r=-1;e&&1==e.nodeType;){var a=o&&o.root==e;if(!a||o.type==q.o.ROOTLESS){var s=(o?o.styler:this.styler).getStyle(e,!1);n.push(s),i=i||b.u(e)}a?(e=o.owner,o=o.parentShadow):(e=e.parentNode,r++)}for(var l=0===r,u=this.context.queryUnitSize("em",l),c={"font-size":new V.c(new j.i(u,"px"),0)},h=new V.g(c,this.context),p=n.length-1;p>=0;--p){var f=n[p],d=[];for(var g in f)V.w(g)&&d.push(g);d.sort(j.v);for(var m=0,v=d;m<v.length;m++){var y=v[m];h.setPropName(y);var w=V.s(f,y);w.value!==j.t.inherit&&(c[y]=w.filterValue(h))}}for(var E in t)V.w(E)||(c[E]=t[E]);return{lang:i,elementStyle:c}},e.prototype.resolveURL=function(t){return t=b.C(t,this.xmldoc.url),this.fallbackMap[t]||t},e.prototype.inheritLangAttribute=function(){this.nodeContext.lang=b.u(this.nodeContext.sourceNode)||this.nodeContext.parent&&this.nodeContext.parent.lang||this.nodeContext.lang},e.prototype.transferPolyfilledInheritedProps=function(t){var e=V.r().filter(function(e){return t[e]});if(e.length){var n=this.nodeContext.inheritedProps;if(this.nodeContext.parent)for(var i in n=this.nodeContext.inheritedProps={},this.nodeContext.parent.inheritedProps)n[i]=this.nodeContext.parent.inheritedProps[i];e.forEach(function(e){var i=t[e];if(i){if(i instanceof j.g)n[e]=i.num;else if(i instanceof j.f)n[e]=i.name;else if(i instanceof j.i){var o=i;switch(o.unit){case"dpi":case"dpcm":case"dppx":n[e]=o.num*R.G[o.unit]}}else n[e]=i;delete t[e]}})}},e.prototype.resolveFormattingContext=function(t,e,n,i,o,r){for(var a=l.b(l.a.RESOLVE_FORMATTING_CONTEXT),s=0;s<a.length;s++){var u=a[s](t,e,n,i,o,r);if(u)return void(t.formattingContext=u)}},e.prototype.createElementView=function(t,e){var n=this,i=!0,o=K.c("createElementView"),r=n.sourceNode,a=n.nodeContext.shadowContext?n.nodeContext.shadowContext.styler:n.styler,s=a.getStyle(r,!1);if(!n.nodeContext.shadowContext){var l=this.xmldoc.getElementOffset(r);pi.b.registerFragmentIndex(l,n.nodeContext.fragmentIndex,0)}var u={};if(!n.nodeContext.parent){var c=n.inheritFromSourceParent(s);s=c.elementStyle,n.nodeContext.lang=c.lang}var h=s["float-reference"]&&X.g(s["float-reference"].value.toString());n.nodeContext.parent&&h&&X.h(h)&&(c=n.inheritFromSourceParent(s),s=c.elementStyle,n.nodeContext.lang=c.lang),n.nodeContext.vertical=n.computeStyle(n.nodeContext.vertical,"rtl"===n.nodeContext.direction,s,u),a.processContent(r,u),this.transferPolyfilledInheritedProps(u),this.inheritLangAttribute(),u.direction&&(n.nodeContext.direction=u.direction.toString());var p=u["flow-into"];if(p&&p.toString()!=n.flowName)return o.finish(!1),o.result();var f=u.display;if(f===j.t.none)return o.finish(!1),o.result();var d=null==n.nodeContext.parent;return n.nodeContext.flexContainer=f===j.t.flex,n.createShadows(r,d,s,u,a,n.context,n.nodeContext.shadowContext).then(function(l){n.nodeContext.nodeShadow=l;var c=u.position,p=u.float,g=u.clear,m=n.nodeContext.vertical?j.t.vertical_rl:j.t.horizontal_tb,v=n.nodeContext.parent?n.nodeContext.parent.vertical?j.t.vertical_rl:j.t.horizontal_tb:m,y=ae.e(r);n.nodeContext.establishesBFC=ae.a(f,c,p,u.overflow,m,v,y),n.nodeContext.containingBlockForAbsolute=ae.b(c),!n.nodeContext.isInsideBFC()||p===j.t.footnote||h&&X.h(h)||(p=null,g=null);var w=p===j.t.left||p===j.t.right||p===j.t.top||p===j.t.bottom||p===j.t.inline_start||p===j.t.inline_end||p===j.t.block_start||p===j.t.block_end||p===j.t.snap_block||p===j.t.footnote;p&&(delete u.float,p===j.t.footnote&&(n.isFootnote?(w=!1,u.display=j.t.block):u.display=j.t.inline)),g&&(g===j.t.inherit&&n.nodeContext.parent&&n.nodeContext.parent.clearSide&&(g=j.r(n.nodeContext.parent.clearSide)),g!==j.t.left&&g!==j.t.right&&g!==j.t.top&&g!==j.t.bottom&&g!==j.t.both&&g!==j.t.all&&g!==j.t.same||(delete u.clear,u.display&&u.display!=j.t.inline&&(n.nodeContext.clearSide=g.toString())));var E=f===j.t.list_item&&u["ua-list-item-count"];if((w||u["break-inside"]&&u["break-inside"]!==j.t.auto)&&n.nodeContext.breakPenalty++,f&&f!==j.t.inline&&ae.f(f)&&n.nodeContext.breakPenalty++,n.nodeContext.inline=!w&&!f||ae.f(f)||ae.g(f),n.nodeContext.display=f?f.toString():"inline",n.nodeContext.floatSide=w?p.toString():null,n.nodeContext.floatReference=h||X.a.INLINE,n.nodeContext.floatMinWrapBlock=u["float-min-wrap-block"]||null,n.nodeContext.columnSpan=u["column-span"],!n.nodeContext.inline){var S=u["break-after"];S&&(n.nodeContext.breakAfter=S.toString());var N=u["break-before"];N&&(n.nodeContext.breakBefore=N.toString())}n.nodeContext.verticalAlign=u["vertical-align"]&&u["vertical-align"].toString()||"baseline",n.nodeContext.captionSide=u["caption-side"]&&u["caption-side"].toString()||"top";var C=u["border-collapse"];if(!C||C===j.r("separate")){var T=u["border-spacing"],x=void 0,I=void 0;T&&(T.isSpaceList()?(x=T.values[0],I=T.values[1]):x=I=T,x.isNumeric()&&(n.nodeContext.inlineBorderSpacing=j.x(x,n.context)),I.isNumeric()&&(n.nodeContext.blockBorderSpacing=j.x(I,n.context)))}n.nodeContext.footnotePolicy=u["footnote-policy"];var P=u["x-first-pseudo"];if(P){var O=n.nodeContext.parent?n.nodeContext.parent.firstPseudo:null;n.nodeContext.firstPseudo=new q.e(O,P.num)}n.nodeContext.inline||n.processAfterIfcontinues(r,s,a,n.context);var k=u["white-space"];if(k){var A=q.z(k.toString());null!==A&&(n.nodeContext.whitespace=A)}var R=u["hyphenate-character"];R&&R!==j.t.auto&&(n.nodeContext.hyphenateCharacter=R.str);var L=u["word-break"],_=u["overflow-wrap"]||["word-wrap"];n.nodeContext.breakWord=L===j.t.break_all||_===j.t.break_word,n.resolveFormattingContext(n.nodeContext,t,f,c,p,d),n.nodeContext.parent&&n.nodeContext.parent.formattingContext&&(t=n.nodeContext.parent.formattingContext.isFirstTime(n.nodeContext,t)),n.nodeContext.inline||(n.nodeContext.repeatOnBreak=n.processRepeatOnBreak(u),n.findAndProcessRepeatingElements(r,a));var F,D=!1,B=null,M=[],U=r.namespaceURI,z=r.localName;if(U==b.a.XHTML)"html"==z||"body"==z||"script"==z||"link"==z||"meta"==z?z="div":"vide_"==z?z="video":"audi_"==z?z="audio":"object"==z&&(D=!!n.customRenderer),r.getAttribute(fi.a)&&s.content&&s.content.value&&s.content.value.url&&(z="img");else if(U==b.a.epub)z="span",U=b.a.XHTML;else if(U==b.a.FB2){if(U=b.a.XHTML,"image"==z){z="div";var V=r.getAttributeNS(b.a.XLINK,"href");if(V&&"#"==V.charAt(0)){var H=n.xmldoc.getElement(V);if(H){B=n.createElement(U,"img");var G="data:"+(H.getAttribute("content-type")||"image/jpeg")+";base64,"+H.textContent.replace(/[ \t\n\t]/g,"");M.push(Ue.b(B,G))}}}else z=Si[z];z||(z=n.nodeContext.inline?"span":"div")}else if(U==b.a.NCX)if(U=b.a.XHTML,"ncx"==z||"navPoint"==z)z="div";else if("navLabel"==z){z="span";var W=r.parentNode;if(W){for(var Y=null,$=W.firstChild;$;$=$.nextSibling)if(1==$.nodeType){var Z=$;if(Z.namespaceURI==b.a.NCX&&"content"==Z.localName){Y=Z.getAttribute("src");break}}Y&&(z="a",(r=r.ownerDocument.createElementNS(U,"a")).setAttribute("href",Y))}}else z="span";else U==b.a.SHADOW?(U=b.a.XHTML,z=n.nodeContext.inline?"span":"div"):D=!!n.customRenderer;if(E)t?z="li":(z="div",f=j.t.block,u.display=f);else if("body"==z||"li"==z)z="div";else if("q"==z)z="span";else if("a"==z){var Q=u["hyperlink-processing"];Q&&"normal"!=Q.toString()&&(z="span")}if(u.behavior&&"none"!=u.behavior.toString()&&n.customRenderer&&(D=!0),r.dataset&&"true"===r.getAttribute("data-math-typeset")&&(D=!0),D){var J=n.nodeContext.parent?n.nodeContext.parent.viewNode:null;F=n.customRenderer(r,J,u)}else F=K.d(null);F.then(function(a){var s;a?D&&(i="true"==a.getAttribute("data-adapt-process-children")):a=n.createElement(U,z),"a"==z&&a.addEventListener("click",n.page.hrefHandler,!1),B&&(n.applyPseudoelementStyle(n.nodeContext,"inner",B),a.appendChild(B)),"iframe"==a.localName&&a.namespaceURI==b.a.XHTML&&(s=a).addEventListener("load",function(){s.contentWindow.navigator.epubReadingSystem={name:"adapt",version:"0.1",layoutStyle:"paginated",hasFeature:function(t,e){switch(t){case"mouse-events":return!0}return!1}}},!1);var l=n.nodeContext.inheritedProps["image-resolution"],c=[],h=u.width,p=u.height,f=r.getAttribute("width"),d=r.getAttribute("height"),g=h===j.t.auto||!h&&!f,m=p===j.t.auto||!p&&!d;if(r.namespaceURI!=b.a.FB2||"td"==z){for(var v=r.attributes,y=v.length,w=null,S=0;S<y;S++){var N=v[S],C=N.namespaceURI,T=N.localName,x=N.nodeValue;if(C){if("http://www.w3.org/2000/xmlns/"==C)continue;C==b.a.XLINK&&"href"==T&&(x=n.resolveURL(x))}else{if(T.match(/^on/))continue;if("style"==T)continue;if(("id"==T||"name"==T)&&t){x=n.documentURLTransformer.transformFragment(x,n.xmldoc.url),a.setAttribute(T,x),n.page.registerElementWithId(a,x);continue}if("src"==T||"href"==T||"poster"==T?(x=n.resolveURL(x),"href"===T&&(x=n.documentURLTransformer.transformURL(x,n.xmldoc.url))):"srcset"==T&&(x=x.split(",").map(function(t){return n.resolveURL(t.trim())}).join(",")),"poster"===T&&"video"===z&&U===b.a.XHTML&&g&&m){var I=new Image,P=Ue.b(I,x);M.push(P),c.push({image:I,element:a,fetcher:P})}}if(U==b.a.SVG&&/^[A-Z\-]+$/.test(T)&&(T=T.toLowerCase()),n.isSVGUrlAttribute(T)&&(x=di(x,n.xmldoc.url,n.documentURLTransformer)),C){var O=mi[C];O&&(T=O+":"+T)}"src"!=T||C||"img"!=z&&"input"!=z||U!=b.a.XHTML?"href"==T&&"image"==z&&U==b.a.SVG&&C==b.a.XLINK?n.page.fetchers.push(Ue.b(a,x)):C?a.setAttributeNS(C,T,x):a.setAttribute(T,x):w=x}if(w){I="input"===z?new Image:a;var k=Ue.b(I,w);I!==a&&(a.src=w),g||m?(g&&m&&l&&1!==l&&c.push({image:I,element:a,fetcher:k}),M.push(k)):n.page.fetchers.push(k)}}delete u.content;var A=u["list-style-image"];if(A&&A instanceof j.l){var R=A.url;M.push(Ue.b(new Image,R))}if(n.preprocessElementStyle(u),n.applyComputedStyles(a,u),!n.nodeContext.inline){var L=null;if(t?e&&(L=n.nodeContext.vertical?wi:bi):L="clone"!==n.nodeContext.inheritedProps["box-decoration-break"]?n.nodeContext.vertical?yi:vi:n.nodeContext.vertical?wi:bi,L)for(var _ in L)b.F(a,_,L[_])}E&&a.setAttribute("value",u["ua-list-item-count"].stringValue()),n.viewNode=a,M.length?Ue.c(M).then(function(){l>0&&n.modifyElemDimensionWithImageResolution(c,l,u,n.nodeContext.vertical),o.finish(i)}):o.timeSlice().then(function(){o.finish(i)})})}),o.result()},e.prototype.processAfterIfcontinues=function(t,e,n,i){var o=this.getPseudoMap(e,this.regionIds,this.isFootnote,this.nodeContext,i);if(o&&o["after-if-continues"]&&o["after-if-continues"].content){var r=new fi.b(t,e,n,i,this.exprContentListener);this.nodeContext.afterIfContinues=new at.a(t,r)}},e.prototype.isSVGUrlAttribute=function(t){return e.SVG_URL_ATTRIBUTES.includes(t.toLowerCase())},e.prototype.modifyElemDimensionWithImageResolution=function(t,e,n,i){var o=this;t.forEach(function(t){if("load"===t.fetcher.get().get()){var r=t.image,a=r.width/e,s=r.height/e,l=t.element;if(a>0&&s>0)if(n["box-sizing"]===j.t.border_box&&(n["border-left-style"]!==j.t.none&&(a+=j.x(n["border-left-width"],o.context)),n["border-right-style"]!==j.t.none&&(a+=j.x(n["border-right-width"],o.context)),n["border-top-style"]!==j.t.none&&(s+=j.x(n["border-top-width"],o.context)),n["border-bottom-style"]!==j.t.none&&(s+=j.x(n["border-bottom-width"],o.context))),e>1){var u=n["max-width"]||j.t.none,c=n["max-height"]||j.t.none;if(u===j.t.none&&c===j.t.none)b.F(l,"max-width",a+"px");else if(u!==j.t.none&&c===j.t.none)b.F(l,"width",a+"px");else if(u===j.t.none&&c!==j.t.none)b.F(l,"height",s+"px");else{y.a(u.isNumeric()),y.a(c.isNumeric());var h=u,p=c;"%"!==h.unit?b.F(l,"max-width",Math.min(a,j.x(h,o.context))+"px"):"%"!==p.unit?b.F(l,"max-height",Math.min(s,j.x(p,o.context))+"px"):i?b.F(l,"height",s+"px"):b.F(l,"width",a+"px")}}else if(e<1){var f=n["min-width"]||j.u,d=n["min-height"]||j.u;y.a(f.isNumeric()),y.a(f.isNumeric());var g=f,m=d;0===g.num&&0===m.num?b.F(l,"min-width",a+"px"):0!==g.num&&0===m.num?b.F(l,"width",a+"px"):0===g.num&&0!==m.num?b.F(l,"height",s+"px"):"%"!==g.unit?b.F(l,"min-width",Math.max(a,j.x(g,o.context))+"px"):"%"!==m.unit?b.F(l,"min-height",Math.max(s,j.x(m,o.context))+"px"):i?b.F(l,"height",s+"px"):b.F(l,"width",a+"px")}}})},e.prototype.preprocessElementStyle=function(t){var e=this;l.b(l.a.PREPROCESS_ELEMENT_STYLE).forEach(function(n){n(e.nodeContext,t)})},e.prototype.findAndProcessRepeatingElements=function(t,e){for(var n=t.firstChild;n;n=n.nextSibling)if(1===n.nodeType){var i={},o=e.getStyle(n,!1);if(this.computeStyle(this.nodeContext.vertical,"rtl"===this.nodeContext.direction,o,i),this.processRepeatOnBreak(i)){if(this.nodeContext.formattingContext instanceof ct&&!this.nodeContext.belongsTo(this.nodeContext.formattingContext))return;var r=this.nodeContext.parent,a=r&&r.formattingContext;return this.nodeContext.formattingContext=new ct(a,this.nodeContext.sourceNode),void this.nodeContext.formattingContext.initializeRepetitiveElements(this.nodeContext.vertical)}}},e.prototype.processRepeatOnBreak=function(t){var e=t["repeat-on-break"];return e!==j.t.none&&(e===j.t.auto&&(e=t.display===j.t.table_header_group?j.t.header:t.display===j.t.table_footer_group?j.t.footer:j.t.none),e&&e!==j.t.none)?e.toString():null},e.prototype.createTextNodeView=function(){var t=this,e=K.c("createTextNodeView");return this.preprocessTextContent().then(function(){var n=t.offsetInNode||0,i=hi.d(t.nodeContext.preprocessedTextContent).substr(n);t.viewNode=document.createTextNode(i),e.finish(!0)}),e.result()},e.prototype.preprocessTextContent=function(){if(null!=this.nodeContext.preprocessedTextContent)return K.d(!0);var t,e=this,n=t=e.sourceNode.textContent,i=K.c("preprocessTextContent"),o=l.b(l.a.PREPROCESS_TEXT_CONTENT),r=0;return i.loop(function(){return r>=o.length?K.d(!1):o[r++](e.nodeContext,n).thenAsync(function(t){return n=t,K.d(!0)})}).then(function(){e.nodeContext.preprocessedTextContent=hi.a(t,n),i.finish(!0)}),i.result()},e.prototype.createNodeView=function(t,e){var n,i=this,o=K.c("createNodeView"),r=!0;return 1==i.sourceNode.nodeType?n=i.createElementView(t,e):8==i.sourceNode.nodeType?(i.viewNode=null,n=K.d(!0)):n=i.createTextNodeView(),n.then(function(t){if(r=t,i.nodeContext.viewNode=i.viewNode,i.viewNode){var e=i.nodeContext.parent?i.nodeContext.parent.viewNode:i.viewRoot;e&&e.appendChild(i.viewNode)}o.finish(r)}),o.result()},e.prototype.setCurrent=function(t,e,n){return this.nodeContext=t,t?(this.sourceNode=t.sourceNode,this.offsetInNode=t.offsetInNode):(this.sourceNode=null,this.offsetInNode=-1),this.viewNode=null,this.nodeContext?this.createNodeView(e,!!n):K.d(!0)},e.prototype.processShadowContent=function(t){if(null==t.shadowContext||"content"!=t.sourceNode.localName||t.sourceNode.namespaceURI!=b.a.SHADOW)return t;var e,n,i,o=t.boxOffset,r=t.shadowContext,a=t.parent;r.subShadow?(i=r.subShadow,e=r.root,(n=r.type)==q.o.ROOTLESS&&(e=e.firstChild)):(i=r.parentShadow,e=r.owner.firstChild,n=q.o.ROOTLESS);var s=t.sourceNode.nextSibling;if(s?(t.sourceNode=s,t.resetView()):t.shadowSibling?t=t.shadowSibling:e?t=null:(t=t.parent.modify()).after=!0,e){var l=new q.k(e,a,o);return l.shadowContext=i,l.shadowType=n,l.shadowSibling=t,l}return t.boxOffset=o,t},e.prototype.nextPositionInTree=function(t){var e=t.boxOffset+1;if(t.after){if(!t.parent)return null;if(t.shadowType!=q.o.ROOTED){var n=t.sourceNode.nextSibling;if(n)return(t=t.modify()).boxOffset=e,t.sourceNode=n,t.resetView(),this.processShadowContent(t)}return t.shadowSibling?((t=t.shadowSibling.modify()).boxOffset=e,t):((t=t.parent.modify()).boxOffset=e,t.after=!0,t)}if(t.nodeShadow){var i=t.nodeShadow.root;if(t.nodeShadow.type==q.o.ROOTLESS&&(i=i.firstChild),i){var o=new q.k(i,t,e);return o.shadowContext=t.nodeShadow,o.shadowType=t.nodeShadow.type,this.processShadowContent(o)}}var r=t.sourceNode.firstChild;return r?this.processShadowContent(new q.k(r,t,e)):(1!=t.sourceNode.nodeType&&(e+=hi.d(t.preprocessedTextContent).length-1-t.offsetInNode),(t=t.modify()).boxOffset=e,t.after=!0,t)},e.prototype.isTransclusion=function(t,e,n){var i=V.s(e,"hyperlink-processing");if(!i)return!1;var o=i.evaluate(this.context,"hyperlink-processing");return!!o&&o.toString()==n},e.prototype.nextInTree=function(t,e){var n=this,i=this.nextPositionInTree(t);if(!i||i.after)return K.d(i);var o=K.c("nextInTree");return this.setCurrent(i,!0,e).then(function(t){i.viewNode&&t||((i=i.modify()).after=!0,i.viewNode||(i.inline=!0)),n.dispatchEvent({type:"nextInTree",nodeContext:i}),o.finish(i)}),o.result()},e.prototype.addImageFetchers=function(t){if(t instanceof j.b)for(var e=t.values,n=0;n<e.length;n++)this.addImageFetchers(e[n]);else if(t instanceof j.l){var i=t.url;this.page.fetchers.push(Ue.b(new Image,i))}},e.prototype.applyComputedStyles=function(t,e){var n=e["background-image"];n&&this.addImageFetchers(n);var i=e.position===j.t.relative;for(var o in e)if(!Ni[o]){var r=e[o];(r=r.visit(new A.a(this.xmldoc.url,this.documentURLTransformer))).isNumeric()&&R.O(r.unit)&&(r=j.n(r,this.context)),q.s[o]||i&&q.t[o]?this.page.delayedItems.push(new q.d(t,o,r)):b.F(t,o,r.toString())}},e.prototype.applyPseudoelementStyle=function(t,e,n){if(!t.after){var i=this.sourceNode,o=(t.shadowContext?t.shadowContext.styler:this.styler).getStyle(i,!1),r=V.u(o,"_pseudos");if(r&&(o=r[e])){var a={};t.vertical=this.computeStyle(t.vertical,"rtl"===t.direction,o,a);var s=a.content;q.y(s)&&(s.visit(new q.c(n,this.context,s,this.exprContentListener)),delete a.content),this.applyComputedStyles(n,a)}}},e.prototype.peelOff=function(t,e){var n=K.c("peelOff"),i=t.firstPseudo,o=t.offsetInNode,r=t.after;if(e>0){var a=t.viewNode.textContent;t.viewNode.textContent=a.substr(0,e),o+=e}else if(!r&&t.viewNode&&0==o){var s=t.viewNode.parentNode;s&&s.removeChild(t.viewNode)}for(var l=t.boxOffset+e,u=[];t.firstPseudo===i;)u.push(t),t=t.parent;var c=u.pop(),h=c.shadowSibling,p=this;return n.loop(function(){for(;u.length>0;){c=u.pop(),t=new q.k(c.sourceNode,t,l),0==u.length&&(t.offsetInNode=o,t.after=r),t.shadowType=c.shadowType,t.shadowContext=c.shadowContext,t.nodeShadow=c.nodeShadow,t.shadowSibling=c.shadowSibling?c.shadowSibling:h,h=null;var e=p.setCurrent(t,!1);if(e.isPending())return e}return K.d(!1)}).then(function(){n.finish(t)}),n.result()},e.prototype.createElement=function(t,e){return t==b.a.XHTML?this.document.createElement(e):this.document.createElementNS(t,e)},e.prototype.applyFootnoteStyle=function(t,e,n){var i={},o=V.u(this.footnoteStyle,"_pseudos");if(t=this.computeStyle(t,e,this.footnoteStyle,i),o&&o.before){var r={},a=this.createElement(b.a.XHTML,"span");fi.f(a,"before"),n.appendChild(a),this.computeStyle(t,e,o.before,r),delete r.content,this.applyComputedStyles(a,r)}return delete i.content,this.applyComputedStyles(n,i),t},e.prototype.processFragmentedBlockEdge=function(t){t&&t.walkUpBlocks(function(t){var e=t.inheritedProps["box-decoration-break"];if(!e||"slice"===e){var n=t.viewNode;y.a(n instanceof Element),t.vertical?(b.F(n,"padding-left","0"),b.F(n,"border-left","none"),b.F(n,"border-top-left-radius","0"),b.F(n,"border-bottom-left-radius","0")):(b.F(n,"padding-bottom","0"),b.F(n,"border-bottom","none"),b.F(n,"border-bottom-left-radius","0"),b.F(n,"border-bottom-right-radius","0"))}})},e.prototype.convertLengthToPx=function(t,e,n){var i=t.num,o=t.unit;if(R.J(o)){for(var r=e;r&&1!==r.nodeType;)r=r.parentNode;y.a(r);var a=parseFloat(n.getElementComputedStyle(r)["font-size"]);return y.a(this.context),V.j(t,a,this.context).num}var s=this.context.queryUnitSize(o,!1);return s?i*s:t},e.prototype.isSameNodePositionStep=function(t,e){if(t.shadowContext){if(!e.shadowContext)return!1;var n=1===t.node.nodeType?t.node:t.node.parentElement,i=1===e.node.nodeType?e.node:e.node.parentElement;return t.shadowContext.owner===e.shadowContext.owner&&fi.d(n)===fi.d(i)}return t.node===e.node},e.prototype.isSameNodePosition=function(t,e){var n=this;return t.offsetInNode===e.offsetInNode&&t.after==e.after&&t.steps.length===e.steps.length&&t.steps.every(function(t,i){var o=e.steps[i];return n.isSameNodePositionStep(t,o)})},e.prototype.isPseudoelement=function(t){return!!fi.d(t)},e.SVG_URL_ATTRIBUTES=["color-profile","clip-path","cursor","filter","marker","marker-start","marker-end","marker-mid","fill","stroke","mask"],e}(b.c),Si={a:"a",sub:"sub",sup:"sup",table:"table",tr:"tr",td:"td",th:"th",code:"code",body:"div",p:"p",v:"p",date:"p",emphasis:"em",strong:"strong",style:"span",strikethrough:"del"},Ni={"box-decoration-break":!0,"float-min-wrap-block":!0,"float-reference":!0,"flow-into":!0,"flow-linger":!0,"flow-options":!0,"flow-priority":!0,"footnote-policy":!0,page:!0},Ci=function(){function t(t){this.layoutBox=t.layoutBox,this.window=t.window}return t.prototype.subtractOffsets=function(t,e){var n=e.left,i=e.top;return{left:t.left-n,top:t.top-i,right:t.right-n,bottom:t.bottom-i,width:t.width,height:t.height}},t.prototype.getRangeClientRects=function(t){var e=this,n=t.getClientRects(),i=this.layoutBox.getBoundingClientRect();return Array.from(n).map(function(t){return e.subtractOffsets(t,i)})},t.prototype.getElementClientRect=function(t){var e=t.getBoundingClientRect(),n=this.layoutBox.getBoundingClientRect();return this.subtractOffsets(e,n)},t.prototype.getElementComputedStyle=function(t){return this.window.getComputedStyle(t,null)},t}(),Ti=function(){function t(t,e,n,i,o){this.window=t,this.fontSize=e,this.document=t.document,this.root=n||this.document.body;var r=this.root.firstElementChild;r||((r=this.document.createElement("div")).setAttribute("data-vivliostyle-outer-zoom-box","true"),this.root.appendChild(r));var a=r.firstElementChild;a||((a=this.document.createElement("div")).setAttribute("data-vivliostyle-spread-container","true"),r.appendChild(a));var s=r.nextElementSibling;s||((s=this.document.createElement("div")).setAttribute("data-vivliostyle-layout-box","true"),this.root.appendChild(s)),this.outerZoomBox=r,this.contentContainer=a,this.layoutBox=s;var l=new Ci(this).getElementComputedStyle(this.root);this.width=i||parseFloat(l.width)||t.innerWidth,this.height=o||parseFloat(l.height)||t.innerHeight}return t.prototype.resetZoom=function(){b.F(this.outerZoomBox,"width",""),b.F(this.outerZoomBox,"height",""),b.F(this.contentContainer,"width",""),b.F(this.contentContainer,"height",""),b.F(this.contentContainer,"transform","")},t.prototype.zoom=function(t,e,n){b.F(this.outerZoomBox,"width",t*n+"px"),b.F(this.outerZoomBox,"height",e*n+"px"),b.F(this.contentContainer,"width",t+"px"),b.F(this.contentContainer,"height",e+"px"),b.F(this.contentContainer,"transform","scale("+n+")")},t.prototype.clear=function(){for(var t=this.root;t.lastChild;)t.removeChild(t.lastChild)},t}(),xi="data-adapt-eloff",Ii=function(){function t(t,e,n){this.store=t,this.url=e,this.document=n,this.lang=null,this.totalOffset=-1,this.lastOffset=1,this.root=n.documentElement;var i=null,o=null;if(this.root.namespaceURI==b.a.XHTML){for(var r=this.root.firstChild;r;r=r.nextSibling)if(1==r.nodeType&&(s=r).namespaceURI==b.a.XHTML)switch(s.localName){case"head":o=s;break;case"body":i=s}this.lang=this.root.getAttribute("lang")}else if(this.root.namespaceURI==b.a.FB2){for(o=this.root,r=this.root.firstChild;r;r=r.nextSibling)1==r.nodeType&&(s=r).namespaceURI==b.a.FB2&&"body"==s.localName&&(i=s);var a=this.doc().child("FictionBook").child("description").child("title-info").child("lang").textContent();a.length>0&&(this.lang=a[0])}else if(this.root.namespaceURI==b.a.SSE)for(var s=this.root.firstElementChild;s;s=s.nextElementSibling){var l=s.localName;"meta"===l?o=s:"body"===l&&(i=s)}this.body=i,this.head=o,this.last=this.root,this.last.setAttribute(xi,"0")}return t.prototype.doc=function(){return new Ai([this.document])},t.prototype.getElementOffset=function(t){var e=t.getAttribute(xi);if(e)return parseInt(e,10);for(var n=this.lastOffset,i=this.last;i!=t;){var o=i.firstChild;if(!o)for(;!(o=i.nextSibling);)if(null==(i=i.parentNode))throw new Error("Internal error");i=o,1==o.nodeType?(o.setAttribute(xi,n.toString()),++n):n+=o.textContent.length}return this.lastOffset=n,this.last=t,n-1},t.prototype.getNodeOffset=function(t,e,n){var i=0,o=t,r=null;if(1==o.nodeType){if(!n)return this.getElementOffset(o)}else{if(i=e,!(r=o.previousSibling))return o=o.parentNode,i+=1,this.getElementOffset(o)+i;o=r}for(;;){for(;o.lastChild;)o=o.lastChild;if(1==o.nodeType)break;if(i+=o.textContent.length,!(r=o.previousSibling)){o=o.parentNode;break}o=r}return i+=1,this.getElementOffset(o)+i},t.prototype.getTotalOffset=function(){return this.totalOffset<0&&(this.totalOffset=this.getNodeOffset(this.root,0,!0)),this.totalOffset},t.prototype.getNodeByOffset=function(t){for(var e,n=this,i=this.root,o=function(){if((e=r.getElementOffset(i))>=t)return{value:i};var o=i.children;if(!o)return"break";var a=b.i(o.length,function(e){var i=o[e];return n.getElementOffset(i)>t});if(0==a)return"break";i=o[a-1]},r=this;;){var a=o();if("object"==typeof a)return a.value;if("break"===a)break}for(var s=e+1,l=i,u=l.firstChild||l.nextSibling,c=null;;){if(u){if(1==u.nodeType)break;if(c=l=u,(s+=u.textContent.length)>t)break}else if(!(l=l.parentNode))break;u=l.nextSibling}return c||i},t.prototype.buildIdMap=function(t){var e=t.getAttribute("id");e&&!this.idMap[e]&&(this.idMap[e]=t);var n=t.getAttributeNS(b.a.XML,"id");n&&!this.idMap[n]&&(this.idMap[n]=t);for(var i=t.firstElementChild;i;i=i.nextElementSibling)this.buildIdMap(i)},t.prototype.getElement=function(t){var e=t.match(/([^#]*)#(.+)$/);if(!e||e[1]&&e[1]!=this.url)return null;var n=e[2],i=this.document.getElementById(n);return!i&&this.document.getElementsByName&&(i=this.document.getElementsByName(n)[0]),i||(this.idMap||(this.idMap={},this.buildIdMap(this.document.documentElement)),i=this.idMap[n]),i},t}();function Pi(t,e,n){var i,o=n||new DOMParser;try{i=o.parseFromString(t,e)}catch(t){}if(!i)return null;var r=i.documentElement;if("parsererror"===r.localName)return null;for(var a=r.firstElementChild;a;a=a.nextElementSibling)if("parsererror"===a.localName)return null;return i}function Oi(t,e){var n=t.responseXML;if(!n){var i=new DOMParser,o=t.responseText;if(o){var r=function(t){var e=t.contentType;if(e){for(var n=Object.keys(Vn),i=0;i<n.length;i++)if(Vn[n[i]]===e)return e;if(e.match(/\+xml$/))return Vn.APPLICATION_XML}var o=t.url.match(/\.([^.\/]+)$/);if(o)switch(o[1]){case"html":case"htm":return Vn.TEXT_HTML;case"xhtml":case"xht":return Vn.APPLICATION_XHTML_XML;case"svg":case"svgz":return Vn.IMAGE_SVG_XML;case"opf":case"xml":return Vn.APPLICATION_XML}return null}(t);if((n=Pi(o,r||Vn.APPLICATION_XML,i))&&!r){var a=n.documentElement;"html"!==a.localName.toLowerCase()||a.namespaceURI?"svg"===a.localName.toLowerCase()&&n.contentType!==Vn.IMAGE_SVG_XML&&(n=Pi(o,Vn.IMAGE_SVG_XML,i)):n=Pi(o,Vn.TEXT_HTML,i)}n||(n=Pi(o,Vn.TEXT_HTML,i))}}var s=n?new Ii(e,t.url,n):null;return K.d(s)}!function(t){t.TEXT_HTML="text/html",t.TEXT_XML="text/xml",t.APPLICATION_XML="application/xml",t.APPLICATION_XHTML_XML="application/xhtml_xml",t.IMAGE_SVG_XML="image/svg+xml"}(Vn||(Vn={}));var ki=new(function(){function t(t){this.fn=t}return t.prototype.check=function(t){return this.fn(t)},t.prototype.withAttribute=function(e,n){var i=this;return new t(function(t){return i.check(t)&&1==t.nodeType&&t.getAttribute(e)==n})},t.prototype.withChild=function(e,n){var i=this;return new t(function(t){if(!i.check(t))return!1;var o=new Ai([t]);return o=o.child(e),n&&(o=o.predicate(n)),o.size()>0})},t}())(function(t){return!0}),Ai=function(){function t(t){this.nodes=t}return t.prototype.asArray=function(){return this.nodes},t.prototype.size=function(){return this.nodes.length},t.prototype.predicate=function(e){for(var n=[],i=0,o=this.nodes;i<o.length;i++){var r=o[i];e.check(r)&&n.push(r)}return new t(n)},t.prototype.forEachNode=function(e){for(var n=[],i=function(t){n.push(t)},o=0;o<this.nodes.length;o++)e(this.nodes[o],i);return new t(n)},t.prototype.forEach=function(t){for(var e=[],n=0;n<this.nodes.length;n++)e.push(t(this.nodes[n]));return e},t.prototype.forEachNonNull=function(t){for(var e=[],n=0;n<this.nodes.length;n++){var i=t(this.nodes[n]);null!=i&&e.push(i)}return e},t.prototype.child=function(t){return this.forEachNode(function(e,n){for(var i=e.firstChild;i;i=i.nextSibling)1==i.nodeType&&i.localName==t&&n(i)})},t.prototype.childElements=function(){return this.forEachNode(function(t,e){for(var n=t.firstChild;n;n=n.nextSibling)1==n.nodeType&&e(n)})},t.prototype.attribute=function(t){return this.forEachNonNull(function(e){return 1==e.nodeType?e.getAttribute(t):null})},t.prototype.textContent=function(){return this.forEach(function(t){return t.textContent})},t}(),Ri=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Li=new Ue.a(function(){var t=K.c("uaStylesheetBase"),e=Me(),n=b.C("user-agent-base.css",b.D),i=new V.b(null,null,null,null,null,e,!0);return i.startStylesheet(H.g.USER_AGENT),V.G(i.cascade),H.k('@namespace html "http://www.w3.org/1999/xhtml";\n\nhtml|html, html|address, html|blockquote, html|body, html|dd, html|div,\nhtml|dl, html|dt, html|fieldset, html|form, html|frame, html|frameset,\nhtml|h1, html|h2, html|h3, html|h4, html|h5, html|h6, html|noframes,\nhtml|ol, html|p, html|ul, html|center, html|dir, html|hr, html|menu, html|pre,\nhtml|article, html|section, html|nav, html|aside, html|hgroup, html|footer, html|header,\nhtml|figure, html|figcaption, html|main {\n   display: block;\n   unicode-bidi: normal;\n}\nhtml|li {\n  display: list-item;\n}\nhtml|head {\n  display: none !important;\n}\nhtml|table {\n  display: table;\n}\nhtml|tr {\n  display: table-row;\n}\nhtml|thead {\n  display: table-header-group;\n  break-after: avoid;\n}\nhtml|tbody {\n  display: table-row-group;\n}\nhtml|tfoot {\n  display: table-footer-group;\n  break-before: avoid;\n}\nhtml|col {\n  display: table-column;\n}\nhtml|colgroup {\n  display: table-column-group;\n}\nhtml|td, html|th {\n  display: table-cell;\n}\nhtml|caption {\n  display: table-caption;\n  text-align: center;\n}\nhtml|th {\n  font-weight: bolder;\n  text-align: center;\n}\nhtml|script {\n  display: none;\n}\nhtml|body {\n  margin: 8px;\n}\nhtml|h1 {\n  font-size: 2em;\n  margin-block-start: 0.67em;\n  margin-block-end: 0.67em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h2 {\n  font-size: 1.5em;\n  margin-block-start: 0.75em;\n  margin-block-end: 0.75em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h3 {\n  font-size: 1.17em;\n  margin-block-start: 0.83em;\n  margin-block-end: 0.83em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h4, html|p, html|blockquote, html|ul, html|fieldset,\nhtml|form, html|ol, html|dl, html|dir, html|menu, html|h5, html|h6 {\n  margin-block-start: 1em;\n  margin-block-end: 1em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h5 {\n  font-size: .83em;\n}\nhtml|h6 {\n  font-size: .75em;\n}\nhtml|h1, html|h2, html|h3, html|h4, html|h5, html|h6, html|b, html|strong {\n  font-weight: bolder;\n}\nhtml|h1, html|h2, html|h3, html|h4, html|h5, html|h6 {\n  break-after: avoid;\n}\nhtml|blockquote {\n  margin-block-start: 0px;\n  margin-block-end: 0px;\n  margin-inline-start: 40px;\n  margin-inline-end: 40px;\n}\nhtml|i, html|cite, html|em, html|var, html|address {\n  font-style: italic;\n}\nhtml|pre, html|tt, html|code, html|kbd, html|samp {\n  font-family: monospace;\n}\nhtml|pre {\n  white-space: pre;\n}\nhtml|button, html|textarea, html|input, html|select {\n  display: inline-block;\n}\nhtml|big {\n  font-size: 1.17em;\n}\nhtml|small, html|sub, html|sup {\n  font-size: .83em;\n}\nhtml|sub {\n  vertical-align: sub;\n}\nhtml|sup {\n  vertical-align: super;\n}\nhtml|table {\n  border-spacing: 2px;\n}\nhtml|thead, html|tbody, html|tfoot {\n  vertical-align: middle;\n}\n/* for XHTML tables without tbody */\nhtml|table > html|tr {\n  vertical-align: middle;\n}\nhtml|td, html|th {\n  vertical-align: inherit;\n}\nhtml|s, html|strike, html|del {\n  text-decoration: line-through;\n}\nhtml|hr {\n  border: 1px inset;\n}\nhtml|ol, html|ul, html|dir, html|menu, html|dd {\n  margin: 0px;\n  margin-inline-start: 40px;\n}\nhtml|ol {\n  list-style-type: decimal;\n}\nhtml|ol html|ul, html|ul html|ol, html|ul html|ul, html|ol html|ol {\n  margin-top: 0;\n  margin-bottom: 0;\n}\nhtml|u, html|ins {\n  text-decoration: underline;\n}\nhtml|center {\n  text-align: center;\n}\nhtml|q:before {\n  content: open-quote;\n}\nhtml|q:after {\n  content: close-quote;\n}\n\nhtml|audio, html|video {\n  break-inside: avoid;\n}\n\nhtml|ruby {\n  display: ruby;\n}\nhtml|rp {\n  display: none;\n}\nhtml|rbc {\n  display: ruby-base-container;\n}\nhtml|rtc {\n  display: ruby-text-container;\n}\nhtml|rb {\n  display: ruby-base;\n  white-space: nowrap;\n}\nhtml|rt {\n  display: ruby-text;\n}\nhtml|ruby, html|rb, html|rt, html|rbc, html|rtc {\n  unicode-bidi: isolate;\n}\n\nhtml|rtc, html|rt {\n  font-variant-east-asian: ruby;\n  text-emphasis: none;\n  white-space: nowrap;\n  line-height: 1;\n}\n\nhtml|rtc:lang(zh), html|rt:lang(zh) {\n  ruby-align: center;\n}\n\nhtml|rtc, html|rt {\n  font-size: 50%;\n}\n\nhtml|rtc:lang(zh-TW), html|rt:lang(zh-TW) {\n  font-size: 30%;\n}\n\nhtml|rtc > html|rt, html|rtc > html|rt:lang(zh-TW) {\n  font-size: 100%;\n}\n\n/* Bidi settings */\nhtml|bdo[dir="ltr"] {\n  direction: ltr;\n  unicode-bidi: bidi-override;\n}\nhtml|bdo[dir="rtl"] {\n  direction: rtl;\n  unicode-bidi: bidi-override;\n}\nhtml|*[dir="ltr"] {\n  direction: ltr;\n  unicode-bidi: embed;\n}\nhtml|*[dir="rtl"] {\n  direction: rtl;\n  unicode-bidi: embed;\n}\n\n/*------------------ epub-specific ---------------------*/\n\n@namespace epub "http://www.idpf.org/2007/ops";\n\nhtml|a[epub|type="noteref"] {\n  font-size: 0.75em;\n  vertical-align: super;\n  line-height: 0.01;\n}\n\nhtml|a[epub|type="noteref"]:href-epub-type(footnote) {\n  -adapt-template: url(user-agent.xml#footnote);\n  text-decoration: none;\n}\n\nhtml|aside[epub|type="footnote"] {\n  display: none;\n}\n\nhtml|aside[epub|type="footnote"]:footnote-content {\n  display: block;\n  margin: 0.25em;\n  font-size: 1.2em;\n  line-height: 1.2;\n}\n\nepub|trigger {\n  display: none;\n}\n\nepub|switch {\n  display: inline;\n}\n\nepub|default {\n  display: inline;\n}\n\nepub|case {\n  display: none;\n}\n\nepub|case[required-namespace::supported] {\n  display: inline;\n}\n\nepub|case[required-namespace::supported] ~ epub|case {\n  display: none;\n}\n\nepub|case[required-namespace::supported] ~ epub|default {\n  display: none;\n}\n\n/*--------------- ncx and toc ----------------------*/\n\n@namespace ncx "http://www.daisy.org/z3986/2005/ncx/";\n\nncx|ncx {\n  display: block;\n  padding-top: 10px;\n  padding-bottom: 10px;\n}\n\nncx|content {\n  display: none;\n}\n\nbody > * {\n  -adapt-behavior: body-child;\n}\n\n[role=doc-toc], [role=directory], nav, .toc, #toc,\n#table-of-contents, #contents {\n  -adapt-behavior: toc-root;\n}\n\n[role=doc-toc] a,\n[role=directory] a,\nnav a,\n.toc a,\n#toc a,\nncx|navLabel {\n  -adapt-behavior: toc-node-anchor;\n}\n\n[role=doc-toc] li,\n[role=directory] li,\nnav li,\n.toc li,\n#toc li,\nncx|navPoint {\n  -adapt-behavior: toc-node;\n}\n\n[role=doc-toc] li > *:first-child,\n[role=directory] li > *:first-child,\nnav li > *:first-child,\n.toc li > *:first-child,\n#toc li > *:first-child {\n  -adapt-behavior: toc-node-first-child;\n}\n\n[role=doc-toc] ol,\n[role=directory] ol,\nnav ol,\n.toc ol,\n#toc ol,\n[role=doc-toc] ul,\n[role=directory] ul,\nnav ul,\n.toc ul,\n#toc ul,\nol[role=doc-toc],\nol[role=directory],\nol.toc,\nol#toc,\nul[role=doc-toc],\nul[role=directory],\nul.toc,\nul#toc {\n  -adapt-behavior: toc-container;\n}\n\n/*---------------- fb2 ---------------------*/\n\n@namespace fb2 "http://www.gribuser.ru/xml/fictionbook/2.0";\n\nfb2|FictionBook {\n  display: block;\n}\n\nfb2|body {\n  font-family: serif;\n  margin: 8px;\n  column-width: 25em;\n}\n\nfb2|a {\n  line-height: 0.1;\n  vertical-align: super;\n  font-size: 0.7em;\n}\n\nfb2|sub {\n  line-height: 0.1;\n  font-size: 0.7em;\n}\n\nfb2|sup {\n  line-height: 0.1;\n  font-size: 0.7em;\n}\n\nfb2|table {\n  display: table;\n  font-size: 0.8em;\n  font-family: sans-serif;\n  margin: 0.5em;\n  border-collapse: collapse;\n  border: 1px solid black;\n}\n\nfb2|td {\n  border: 1px solid black;\n  padding: 0.3em;\n}\n\nfb2|th {\n  font-weight: bold;\n  text-align: center;\n  border: 1px solid black;\n  background-color: #CEE;\n  padding: 0.3em;\n}\n\nfb2|code {\n  font-family: monospace;\n}\n\nfb2|p {\n  display: block;\n  margin: 0px;\n  text-indent: 1.5em;\n  text-align: justify;\n}\n\nfb2|title fb2|p {\n  margin: 0px 0px 0.5em 0px;\n  text-indent: 0px;\n  text-align: inherit;\n}\n\nfb2|title {\n  font-size: 2.2em;\n  font-weight: bold;\n  break-inside: avoid;\n  break-after: avoid;\n  text-align: center;\n  margin: 1em 0px 0.5em 0px;\n  display: block;\n}\n\nfb2|section {\n  display: block;\n}\n\nfb2|section fb2|title {\n  font-size: 1.8em;\n  text-align: center;\n  margin: 1em 0px 0.5em 0px;\n}\n\nfb2|section fb2|section fb2|title {\n  font-size: 1.5em;\n  text-align: left;\n  margin: 1em 0px 0.5em 1.5625em;\n}\n\nfb2|section fb2|section fb2|section fb2|title {\n  font-size: 1.3em;\n  text-align: left;\n  margin: 1em 0px 0.5em 1.923em;\n}\n\nfb2|section fb2|section fb2|section fb2|section fb2|title {\n  font-size: 1.2em;\n  text-align: left;\n  margin: 1em 0px 0.5em 2.083em;\n}\n\nfb2|section fb2|section fb2|section fb2|section fb2|section fb2|title {\n  font-size: 1.1em;\n  text-align: left;\n  margin: 1em 0px 0.5em 2.272em;\n}\n\nfb2|section fb2|section fb2|section fb2|section fb2|section fb2|section fb2|title {\n  text-align: left;\n  margin: 1em 0px 0.5em 2.5em;\n}\n\nfb2|epigraph {\n  text-align: left;\n  font-style: italic;\n  margin: 1em 1em 2em 30%;\n  display: block;\n}\n\nfb2|image {\n  text-align: center;\n  padding: 3px;\n}\n\nfb2|image::inner {\n  max-width: 95%;\n}\n\nfb2|image::after {\n  display: block;\n  content: attr(title);\n}\n\nfb2|v {\n  text-indent: -1em;\n  padding-left: 1em;\n  margin: 0px;\n  display: block;\n}\nfb2|poem {\n  margin: 0.5em 0px 0.5em 2em;\n  display: block;\n}\nfb2|date {\n  margin: 0.5em 0px 0.5em 50%;\n  font-style: italic;\n  display: block;\n}\nfb2|stanza {\n  margin: 0.5em 0px;\n  break-inside: avoid;\n  display: block;\n}\nfb2|empty-line {\n  height: 1em;\n  margin: 0px;\n  display: block;\n}\nfb2|cite {\n  margin: 0.5em 0px 0.5em 1em;\n  font-size: 0.95em;\n  display: block;\n}\nfb2|subtitle {\n  text-indent: 0px;\n  text-align: center;\n  font-style: italic;\n  font-weight: bold;\n  margin: 0.5em 2em;\n  break-inside: avoid;\n  break-after: avoid;\n  display: block;\n}\nfb2|annotation {\n  margin: 1em 0px 1em 2em;\n  text-indent: 0px;\n  font-style: italic;\n  display: block;\n}\nfb2|text-author {\n  text-indent: 0px;\n  margin: 0.2em 0px 0px 3em;\n  display: block;\n}\nfb2|emphasis {\n  font-style: italic;\n}\nfb2|strong {\n  font-weight: bold;\n}\nfb2|strikethrough {\n  text-decoration: line-through;\n}\nfb2|*.italic {\n  font-style: italic;\n}\nfb2|*.bold {\n  font-weight: bold;\n}\n\nfb2|binary, fb2|description, fb2|stylesheet {\n  display: none;\n}\n\nfb2|a[type="note"] {\n  font-size: 0.75em;\n  vertical-align: super;\n  line-height: 0.01;\n  text-decoration: none;\n  -adapt-template: url(user-agent.xml#footnote);\n}\n\nfb2|body[name="notes"] {\n  display: none;\n}\n\nfb2|body[name="notes"] fb2|title {\n  display: inline;\n  vertical-align: super;\n  line-height: 0.01;\n  text-align: left;\n  font-size: 0.75em;\n  font-weight: bold;\n  margin: 0px;\n}\n\nfb2|body[name="notes"] fb2|p {\n  text-indent: 0px;\n  display: inline;  /* for now */\n}\n\nfb2|body[name="notes"] fb2|p + fb2|p {\n  display: block;\n}\n\nfb2|body[name="notes"] fb2|section {\n  text-indent: 0px;\n  line-height: 1.2;\n  font-size: 1.2em;\n}\n',i,n,null,null).thenFinish(t),t.result()},"uaStylesheetBaseFetcher"),_i=function(){function t(t,e,n,i,o,r,a,s,l,u){this.store=t,this.rootScope=e,this.pageScope=n,this.cascade=i,this.rootBox=o,this.fontFaces=r,this.footnoteProps=a,this.flowProps=s,this.viewportProps=l,this.pageProps=u,this.fontDeobfuscator=t.fontDeobfuscator,this.validatorSet=t.validatorSet,this.pageScope.defineBuiltIn("has-content",function(t){t=t;var e=this.currentLayoutPosition,n=e.firstFlowChunkOfFlow(t);return this.matchPageSide(e.startSideOfFlow(t))&&e.hasContent(t,this.lookupOffset)&&!!n&&!this.flowChunkIsAfterParentFlowForcedBreak(n)}),this.pageScope.defineName("page-number",new R.t(this.pageScope,function(){return this.pageNumberOffset+this.currentLayoutPosition.page},"page-number"))}return t.prototype.sizeViewport=function(t,e,n,i){if(this.viewportProps.length){var o=new R.g(this.rootScope,t,e,n),r=V.A(o,this.viewportProps),a=r.width,s=r.height,l=r["text-zoom"],u=1;if(a&&s||l){var c=R.G.em;if((l?l.evaluate(o,"text-zoom"):null)===j.t.scale&&(u=c/n,n=c,t*=u,e*=u),a&&s){var h=j.x(a.evaluate(o,"width"),o),p=j.x(s.evaluate(o,"height"),o);if(h>0&&p>0)return{width:i&&i.spreadView?2*(h+i.pageBorder):h,height:p,fontSize:n}}}}return{width:t,height:e,fontSize:n}},t}(),Fi=function(t){function e(e,n,i,o,r,a,s,l,u,c,h,p){var f=t.call(this,e.rootScope,o.width,o.height,o.fontSize)||this;for(var d in f.style=e,f.xmldoc=n,f.viewport=o,f.clientLayout=r,f.fontMapper=a,f.customRenderer=s,f.fallbackMap=l,f.pageNumberOffset=u,f.documentURLTransformer=c,f.counterStore=h,f.primaryFlows={body:!0},f.rootPageBoxInstance=null,f.styler=null,f.stylerMap=null,f.currentLayoutPosition=null,f.layoutPositionAtPageStart=null,f.lookupOffset=0,f.pageBoxInstances={},f.pageManager=null,f.pageBreaks={},f.pageProgression=null,f.pageSheetSize={},f.pageSheetHeight=0,f.pageSheetWidth=0,f.lang=n.lang||i,f.faces=new je(f.style.fontDeobfuscator),f.rootPageFloatLayoutContext=new X.e(null,null,null,null,null,null,null),f.pageProgression=p||null,e.flowProps){var g=e.flowProps[d],m=V.s(g,"flow-consume");m&&(m.evaluate(f,"flow-consume")==j.t.all?f.primaryFlows[d]=!0:delete f.primaryFlows[d])}return f}return Ri(e,t),e.prototype.init=function(){var t=this,e=K.c("StyleInstance.init"),n=this.counterStore.createCounterListener(this.xmldoc.url),i=this.counterStore.createCounterResolver(this.xmldoc.url,this.style.rootScope,this.style.pageScope);this.styler=new he(this.xmldoc,this.style.cascade,this.style.rootScope,this,this.primaryFlows,this.style.validatorSet,n,i),i.setStyler(this.styler),this.styler.resetFlowChunkStream(this),this.stylerMap={},this.stylerMap[this.xmldoc.url]=this.styler;var o=this.styler.getTopContainerStyle();this.pageProgression||(this.pageProgression=Tn(o));var r=this.style.rootBox;this.rootPageBoxInstance=new gn(r);var a=this.style.cascade.createInstance(this,n,i,this.lang);this.rootPageBoxInstance.applyCascadeAndInit(a,o),this.rootPageBoxInstance.resolveAutoSizing(this),this.pageManager=new ei(a,this.style.pageScope,this.rootPageBoxInstance,this,o);for(var s=[],l=0,u=this.style.fontFaces;l<u.length;l++){var c=u[l];if(!c.condition||c.condition.evaluate(this)){var h=Ge(c.properties,this),p=new We(h);s.push(p)}}this.fontMapper.findOrLoadFonts(s,this.faces).thenFinish(e);var f=this.style.pageProps;return Object.keys(f).forEach(function(e){var n=_n(Ln(f[e]),t);t.pageSheetSize[e]={width:n.pageWidth+2*n.cropOffset,height:n.pageHeight+2*n.cropOffset}}),e.result()},e.prototype.getStylerForDoc=function(t){var e=this.stylerMap[t.url];if(!e){var n=this.style.store.getStyleForDoc(t),i=new R.g(n.rootScope,this.pageWidth(),this.pageHeight(),this.initialFontSize),o=this.counterStore.createCounterListener(t.url),r=this.counterStore.createCounterResolver(t.url,n.rootScope,n.pageScope);e=new he(t,n.cascade,n.rootScope,i,this.primaryFlows,n.validatorSet,o,r),this.stylerMap[t.url]=e}return e},e.prototype.registerInstance=function(t,e){this.pageBoxInstances[t]=e},e.prototype.lookupInstance=function(t){return this.pageBoxInstances[t]},e.prototype.encounteredFlowChunk=function(t,e){var n=this.currentLayoutPosition;if(n){n.flows[t.flowName]?e=n.flows[t.flowName]:n.flows[t.flowName]=e;var i=n.flowPositions[t.flowName];i||(i=new q.i,n.flowPositions[t.flowName]=i);var o=q.w(t.element),r=new q.a(o),a=new q.h(r,t);i.positions.push(a)}},e.prototype.getConsumedOffset=function(t){for(var e=Number.POSITIVE_INFINITY,n=0;n<t.positions.length;n++){for(var i=t.positions[n].chunkPosition.primary,o=i.steps[0].node,r=i.offsetInNode,a=i.after,s=0;o.ownerDocument!=this.xmldoc.document;)s++,o=i.steps[s].node,a=!1,r=0;var l=this.xmldoc.getNodeOffset(o,r,a);l<e&&(e=l)}return e},e.prototype.getPosition=function(t,e){if(!t)return 0;var n=Number.POSITIVE_INFINITY;for(var i in this.primaryFlows){var o=t.flowPositions[i];if(e||o&&0!=o.positions.length||!this.currentLayoutPosition||(this.styler.styleUntilFlowIsReached(i),o=this.currentLayoutPosition.flowPositions[i],t!=this.currentLayoutPosition&&o&&(o=o.clone(),t.flowPositions[i]=o)),o){var r=this.getConsumedOffset(o);r<n&&(n=r)}}return n},e.prototype.dumpLocation=function(t){for(var e in u.b.debug("Location - page",this.currentLayoutPosition.page),u.b.debug("  current:",t),u.b.debug("  lookup:",this.lookupOffset),this.currentLayoutPosition.flowPositions)for(var n=0,i=this.currentLayoutPosition.flowPositions[e].positions;n<i.length;n++){var o=i[n];u.b.debug("  Chunk",e+":",o.flowChunk.startOffset)}},e.prototype.matchPageSide=function(t){switch(t){case"left":case"right":case"recto":case"verso":return new R.s(this.style.pageScope,t+"-page").evaluate(this);default:return!0}},e.prototype.updateStartSide=function(t){for(var e in t.flowPositions){var n=t.flowPositions[e];if(n&&n.positions.length>0){var i=n.positions[0].flowChunk;if(this.getConsumedOffset(n)===i.startOffset){var o=n.positions[0].flowChunk.breakBefore,r=Xt.e(n.startSide);n.startSide=Xt.a(Xt.d(r,o))}}}},e.prototype.selectPageMaster=function(t){var e=this.currentLayoutPosition,n=this.getPosition(e);if(n==Number.POSITIVE_INFINITY)return null;for(var i,o=this.rootPageBoxInstance.children,r=0;r<o.length;r++)if((i=o[r]).pageBox.pseudoName!==Wn){var a=1,s=i.getProp(this,"utilization");s&&s.isNum()&&(a=s.num);var l=this.queryUnitSize("em",!1),u=this.pageWidth()*this.pageHeight(),c=Math.ceil(a*u/(l*l));this.lookupOffset=this.styler.styleUntil(n,c),y.a(e),this.updateStartSide(e),this.layoutPositionAtPageStart=e.clone(),this.initLingering(),this.clearScope(this.style.pageScope);var h=i.getProp(this,"enabled");if(!h||h===j.t._true)return this.pageManager.getPageRulePageMaster(i,t)}throw new Error("No enabled page masters")},e.prototype.flowChunkIsAfterParentFlowForcedBreak=function(t){var e=this.layoutPositionAtPageStart.flows,n=e[t.flowName].parentFlowName;if(n){var i=t.startOffset,o=e[n].forcedBreakOffsets;if(!o.length||i<o[0])return!1;var r=b.i(o.length,function(t){return o[t]>i})-1,a=o[r],s=this.layoutPositionAtPageStart.flowPositions[n],l=this.getConsumedOffset(s);return!(a<l)&&(l<a||!this.matchPageSide(s.startSide))}return!1},e.prototype.setFormattingContextToColumn=function(t,e){var n=this.currentLayoutPosition.flows[e];n.formattingContext||(n.formattingContext=new it.a(null)),t.flowRootFormattingContext=n.formattingContext},e.prototype.layoutDeferredPageFloats=function(t){var e=t.pageFloatLayoutContext,n=e.getDeferredPageFloatContinuations(),i=K.c("layoutDeferredPageFloats"),o=!1,r=0;return i.loopWithFrame(function(i){if(r!==n.length){var a=n[r++],s=a.float,l=(new X.f).findByFloat(s),u=l.findPageFloatFragment(s,e);if(!u||!u.hasFloat(s))return e.isForbidden(s)||e.hasPrecedingFloatsDeferredToNext(s)?(e.deferPageFloat(a),void i.breakLoop()):void t.layoutPageFloatInner(a,l,null,u).then(function(t){if(t){var n=e.parent.isInvalidated();n?i.breakLoop():(e.isInvalidated()&&!n&&(o=!0,e.validate()),i.continueLoop())}else i.breakLoop()});i.continueLoop()}else i.breakLoop()}).then(function(){o&&e.invalidate(),i.finish(!0)}),i.result()},e.prototype.getLastAfterPositionIfDeferredFloatsExists=function(t,e){if(t.pageFloatLayoutContext.getPageFloatContinuationsDeferredToNext().length>0){if(t.lastAfterPosition){var n=void 0;return e?(n=e.clone()).primary=t.lastAfterPosition:n=new q.a(t.lastAfterPosition),n}return y.a("column.lastAfterPosition === null"),null}return null},e.prototype.layoutColumn=function(t,e){var n=this.currentLayoutPosition.flowPositions[e];if(!n||!this.matchPageSide(n.startSide))return K.d(!0);n.startSide="any",this.setFormattingContextToColumn(t,e),t.init(),this.primaryFlows[e]&&t.bands.length>0&&(t.forceNonfitting=!1);var i=this,o=K.c("layoutColumn");return this.layoutDeferredPageFloats(t).then(function(){if(t.pageFloatLayoutContext.isInvalidated())o.finish(!0);else{var r=[],a=[],s=!0;o.loopWithFrame(function(o){if(t.pageFloatLayoutContext.hasContinuingFloatFragmentsInFlow(e))o.breakLoop();else{for(var l=function(){for(var e=0;a.includes(e);)e++;var l=n.positions[e];if(l.flowChunk.startOffset>i.lookupOffset||i.flowChunkIsAfterParentFlowForcedBreak(l.flowChunk))return"break";for(var u=e+1;u<n.positions.length;u++)if(!a.includes(u)){var c=n.positions[u];if(c.flowChunk.startOffset>i.lookupOffset||i.flowChunkIsAfterParentFlowForcedBreak(c.flowChunk))break;c.flowChunk.isBetter(l.flowChunk)&&(l=c,e=u)}var h=l.flowChunk,p=!0;return t.layout(l.chunkPosition,s,n.breakAfter).then(function(u){if(t.pageFloatLayoutContext.isInvalidated())o.breakLoop();else{if(s=!1,l.flowChunk.repeated&&(null===u||h.exclusive)&&r.push(e),h.exclusive)return a.push(e),void o.breakLoop();var c=!!u||!!t.pageBreakType,f=i.getLastAfterPositionIfDeferredFloatsExists(t,u);t.pageBreakType&&f?(l.chunkPosition=f,n.breakAfter=t.pageBreakType,t.pageBreakType=null):(a.push(e),(u||f)&&(l.chunkPosition=u||f,r.push(e)),t.pageBreakType&&(n.startSide=Xt.a(t.pageBreakType))),c?o.breakLoop():(t.forceNonfitting=!1,p?p=!1:o.continueLoop())}}),p?(p=!1,{value:void 0}):void 0};n.positions.length-a.length>0;){var u=l();if("object"==typeof u)return u.value;if("break"===u)break}o.breakLoop()}}).then(function(){if(!t.pageFloatLayoutContext.isInvalidated()){n.positions=n.positions.filter(function(t,e){return r.includes(e)||!a.includes(e)}),"column"===n.breakAfter&&(n.breakAfter=null),t.saveDistanceToBlockEndFloats();var e=t.pageFloatLayoutContext.getMaxReachedAfterEdge();t.updateMaxReachedAfterEdge(e)}o.finish(!0)})}}),o.result()},e.prototype.createLayoutConstraint=function(t){var e=this.currentLayoutPosition.page-1,n=this.counterStore.createLayoutConstraint(e);return new Ke.a([n].concat(t.getLayoutConstraints()))},e.prototype.createAndLayoutColumn=function(t,e,n,i,o,r,a,s,l,u,c,h,p,f){var d,g=this,m=t.vertical?t.isAutoWidth&&t.isRightDependentOnAutoWidth:t.isAutoHeight&&t.isTopDependentOnAutoHeight,v=o.element,y=new X.e(s,X.a.COLUMN,null,a,null,null,null),w=g.currentLayoutPosition.clone(),E=K.c("createAndLayoutColumn");return E.loopWithFrame(function(t){var E=g.createLayoutConstraint(y);if(l>1){var S=g.viewport.document.createElement("div");if(b.F(S,"position","absolute"),v.appendChild(S),(d=new Ke.b(S,p,g.clientLayout,E,y)).forceNonfitting=f,d.vertical=o.vertical,d.snapHeight=o.snapHeight,d.snapWidth=o.snapWidth,o.vertical){var N=r*(c+u)+o.paddingTop;d.setHorizontalPosition(o.paddingLeft,o.width),d.setVerticalPosition(N,c)}else{var C=r*(c+u)+o.paddingLeft;d.setVerticalPosition(o.paddingTop,o.height),d.setHorizontalPosition(C,c)}d.originX=e,d.originY=n}else(d=new Ke.b(v,p,g.clientLayout,E,y)).copyFrom(o);d.exclusions=m?[]:i.concat(),d.innerShape=h,y.setContainer(d),d.width>=0?g.layoutColumn(d,a).then(function(){y.isInvalidated()||y.finish(),d.pageFloatLayoutContext.isInvalidated()&&!s.isInvalidated()?(d.pageFloatLayoutContext.validate(),g.currentLayoutPosition=w.clone(),d.element!==v&&v.removeChild(d.element),t.continueLoop()):t.breakLoop()}):(y.finish(),t.breakLoop())}).then(function(){E.finish(d)}),E.result()},e.prototype.setPagePageFloatLayoutContextContainer=function(t,e,n){(e instanceof Jn||e instanceof mn&&!(e instanceof Yn))&&t.setContainer(n)},e.prototype.getRegionPageFloatLayoutContext=function(t,e,n,i){y.a(e instanceof yn);var o=e.getProp(this,"writing-mode")||null,r=e.getProp(this,"direction")||null;return new X.e(t,X.a.REGION,n,i,null,o,r)},e.prototype.layoutFlowColumnsWithBalancing=function(t,e,n,i,o,r,a,s,l){var u=this,c=u.currentLayoutPosition.clone(),h=u.getRegionPageFloatLayoutContext(r,e,a,s),p=!0;function f(){return u.currentLayoutPosition=c.clone(),u.layoutFlowColumns(t,e,n,i,o,r,h,a,s,l,p).thenAsync(function(t){return t?K.d({columns:t,position:u.currentLayoutPosition}):K.d(null)})}return f().thenAsync(function(t){if(!t)return K.d(null);if(l<=1)return K.d(t.columns);var n=e.getProp(u,"column-fill")||j.t.balance,i=u.currentLayoutPosition.flowPositions[s];y.a(i);var o=function(t,e,n,i,o,r,a){if(e===j.t.auto)return null;var s=0===a.positions.length,l=r[r.length-1],u=!(!l||!l.pageBreakType);return s||u?new ne(n,i,o,t):e===j.t.balance_all?new re(n,i,o):(y.a(e===j.t.balance),null)}(l,n,f,h,a,t.columns,i);return o?(p=!1,r.lock(),h.lock(),o.balanceColumns(t).thenAsync(function(t){return r.unlock(),r.validate(),h.unlock(),u.currentLayoutPosition=t.position,K.d(t.columns)})):K.d(t.columns)})},e.prototype.layoutFlowColumns=function(t,e,n,i,o,r,a,s,l,u,c){var h=this,p=K.c("layoutFlowColumns"),f=h.currentLayoutPosition.clone(),d=e.getPropAsNumber(h,"column-gap"),g=u>1?e.getPropAsNumber(h,"column-width"):s.width,m=e.getActiveRegions(h),v=e.getProp(h,"shape-inside"),y=A.e(v,0,0,s.width,s.height,h),b=new Ei(l,h,h.viewport,h.styler,m,h.xmldoc,h.faces,h.style.footnoteProps,h,t,h.customRenderer,h.fallbackMap,this.documentURLTransformer),w=0,E=null,S=[];return p.loopWithFrame(function(t){h.createAndLayoutColumn(e,n,i,o,s,w++,l,a,u,d,g,y,b,c).then(function(e){return r.isInvalidated()?(S=null,void t.breakLoop()):(!(e.pageBreakType&&"column"!==e.pageBreakType)&&w!==u||a.isInvalidated()||a.finish(),a.isInvalidated()?(w=0,h.currentLayoutPosition=f.clone(),a.validate(),void(a.isLocked()?(S=null,t.breakLoop()):t.continueLoop())):(E=e,S[w-1]=E,E.pageBreakType&&"column"!=E.pageBreakType&&(w=u,"region"!=E.pageBreakType&&(h.pageBreaks[l]=!0)),void(w<u?t.continueLoop():t.breakLoop())))})}).then(function(){p.finish(S)}),p.result()},e.prototype.layoutContainer=function(t,e,n,i,o,r,a){var s=this;e.reset();var l=e.getProp(s,"enabled");if(l&&l!==j.t._true)return K.d(!0);var u=K.c("layoutContainer"),c=e.getProp(s,"wrap-flow")===j.t.auto,h=e.getProp(s,"flow-from"),p=s.viewport.document.createElement("div"),f=e.getProp(s,"position");b.F(p,"position",f?f.name:"absolute"),n.insertBefore(p,n.firstChild);var d,g=new q.b(p);g.vertical=e.vertical,g.exclusions=r,e.prepareContainer(s,g,t,s.faces,s.clientLayout),g.originX=i,g.originY=o,i+=g.left+g.marginLeft+g.borderLeft,o+=g.top+g.marginTop+g.borderTop,this.setPagePageFloatLayoutContextContainer(a,e,g);var m=!1;if(h&&h.isIdent())if(s.pageBreaks[h.toString()])a.isInvalidated()||e.finishContainer(s,g,t,null,1,s.clientLayout,s.faces),d=K.d(!0);else{var v=K.c("layoutContainer.inner"),w=h.toString(),E=e.getPropAsNumber(s,"column-count");s.layoutFlowColumnsWithBalancing(t,e,i,o,r,a,g,w,E).then(function(n){if(!a.isInvalidated()){var i=n[0];y.a(i),i.element===p&&(g=i),g.computedBlockSize=Math.max.apply(null,n.map(function(t){return t.computedBlockSize})),e.finishContainer(s,g,t,i,E,s.clientLayout,s.faces);var o=s.currentLayoutPosition.flowPositions[w];o&&"region"===o.breakAfter&&(o.breakAfter=null)}v.finish(!0)}),d=v.result()}else{var S=e.getProp(s,"content");if(S&&q.y(S)){var N="span";S.url&&(N="img");var C=s.viewport.document.createElement(N);S.visit(new q.c(C,s,S,s.counterStore.getExprContentListener())),p.appendChild(C),"img"==N&&e.transferSinglUriContentProps(s,C,s.faces),e.transferContentProps(s,g,t,s.faces)}else e.suppressEmptyBoxGeneration&&(n.removeChild(p),m=!0);m||e.finishContainer(s,g,t,null,1,s.clientLayout,s.faces),d=K.d(!0)}return d.then(function(){if(a.isInvalidated())u.finish(!0);else{if(!e.isAutoHeight||Math.floor(g.computedBlockSize)>0){if(!m&&!c){var l=e.getProp(s,"shape-outside"),h=g.getOuterShape(l,s);r.push(h)}}else if(0==e.children.length)return n.removeChild(p),void u.finish(!0);var f=e.children.length-1;u.loop(function(){for(;f>=0;){var n=e.children[f--],l=s.layoutContainer(t,n,p,i,o,r,a);if(l.isPending())return l.thenAsync(function(){return K.d(!a.isInvalidated())});if(a.isInvalidated())break}return K.d(!1)}).then(function(){u.finish(!0)})}}),u.result()},e.prototype.processLinger=function(){var t=this.currentLayoutPosition.page;for(var e in this.currentLayoutPosition.flowPositions)for(var n=this.currentLayoutPosition.flowPositions[e],i=n.positions.length-1;i>=0;i--){var o=n.positions[i];o.flowChunk.startPage>=0&&o.flowChunk.startPage+o.flowChunk.linger-1<=t&&n.positions.splice(i,1)}},e.prototype.initLingering=function(){var t=this.currentLayoutPosition.page;for(var e in this.currentLayoutPosition.flowPositions)for(var n=this.currentLayoutPosition.flowPositions[e],i=n.positions.length-1;i>=0;i--){var o=n.positions[i];o.flowChunk.startPage<0&&o.flowChunk.startOffset<this.lookupOffset&&(o.flowChunk.startPage=t)}},e.prototype.noMorePrimaryFlows=function(t){for(var e in this.primaryFlows){var n=t.flowPositions[e];if(n&&n.positions.length>0)return!1}return!0},e.prototype.layoutNextPage=function(t,e){var n=this,i=t.container===t.bleedBox;n.pageBreaks={},e?(n.currentLayoutPosition=e.clone(),n.styler.replayFlowElementsFromOffset(e.highestSeenOffset)):(n.currentLayoutPosition=new q.j,n.styler.replayFlowElementsFromOffset(-1)),this.lang&&t.bleedBox.setAttribute("lang",this.lang),(e=n.currentLayoutPosition).page++,n.clearScope(n.style.pageScope),n.layoutPositionAtPageStart=e.clone();var r=i?{}:n.pageManager.getCascadedPageStyle(),a=n.selectPageMaster(r);if(!a)return K.d(null);var s=0;if(!i){t.setAutoPageWidth(a.pageBox.specified.width.value===j.q),t.setAutoPageHeight(a.pageBox.specified.height.value===j.p),n.counterStore.setCurrentPage(t),n.counterStore.updatePageCounters(r,n);var l=_n(Ln(r),this);n.setPageSizeAndBleed(l,t),function(t,e,n,i){var o=!1,r=!1,a=t.marks;if(a){var s=a.value;s.isSpaceList()?s.values.forEach(function(t){t===j.t.crop?o=!0:t===j.t.cross&&(r=!0)}):s===j.t.crop?o=!0:s===j.t.cross&&(r=!0)}if(o||r){var l=n.container,u=l.ownerDocument;y.a(u);var c=e.bleed,h=j.x(On,i),p=j.x(kn,i),f=j.x(An,i);if(c){var d=t["background-color"];d&&d.value&&(n.bleedBox.style.backgroundColor=d.value.stringValue())}o&&Object.keys(xn).forEach(function(t){var e=xn[t],n=function(t,e,n,i,o,r){var a=i;a<=o+2*R.G.mm&&(a=o+i/2);var s=Math.max(i,a),l=o+s+n/2,u=Fn(t,l,l),c=[[0,o+i],[i,o+i],[i,o+i-a]],h=c.map(function(t){return[t[1],t[0]]});e!==xn.TOP_RIGHT&&e!==xn.BOTTOM_RIGHT||(c=c.map(function(t){return[o+s-t[0],t[1]]}),h=h.map(function(t){return[o+s-t[0],t[1]]})),e!==xn.BOTTOM_LEFT&&e!==xn.BOTTOM_RIGHT||(c=c.map(function(t){return[t[0],o+s-t[1]]}),h=h.map(function(t){return[t[0],o+s-t[1]]}));var p=Dn(t,n);p.setAttribute("points",c.map(function(t){return t.join(",")}).join(" ")),u.appendChild(p);var f=Dn(t,n);return f.setAttribute("points",h.map(function(t){return t.join(",")}).join(" ")),u.appendChild(f),e.split(" ").forEach(function(t){u.style[t]=r+"px"}),u}(u,e,h,f,c,p);l.appendChild(n)}),r&&Object.keys(In).forEach(function(t){var e=In[t],n=function(t,e,n,i,o){var r,a,s=2*i;e===In.TOP||e===In.BOTTOM?(r=s,a=i):(r=i,a=s);var l=Fn(t,r,a),u=Dn(t,n);u.setAttribute("points","0,"+a/2+" "+r+","+a/2),l.appendChild(u);var c=Dn(t,n);c.setAttribute("points",r/2+",0 "+r/2+","+a),l.appendChild(c);var h,p=Dn(t,n,"circle");switch(p.setAttribute("cx",r/2),p.setAttribute("cy",a/2),p.setAttribute("r",i/4),l.appendChild(p),e){case In.TOP:h=In.BOTTOM;break;case In.BOTTOM:h=In.TOP;break;case In.LEFT:h=In.RIGHT;break;case In.RIGHT:h=In.LEFT}return Object.keys(In).forEach(function(t){var n=In[t];n===e?l.style[n]=o+"px":n!==h&&(l.style[n]="0",l.style["margin-"+n]="auto")}),l}(u,e,h,f,p);l.appendChild(n)})}}(r,l,t,this),s=l.bleedOffset+l.bleed}var u=!i&&a.getProp(n,"writing-mode")||j.t.horizontal_tb;this.pageVertical=u!=j.t.horizontal_tb;var c=a.getProp(n,"direction")||j.t.ltr,h=new X.e(n.rootPageFloatLayoutContext,X.a.PAGE,null,null,null,u,c),p=K.c("layoutNextPage");return p.loopWithFrame(function(e){n.layoutContainer(t,a,t.bleedBox,s,s,[],h).then(function(){h.isInvalidated()||h.finish(),h.isInvalidated()?(n.currentLayoutPosition=n.layoutPositionAtPageStart.clone(),h.validate(),e.continueLoop()):e.breakLoop()})}).then(function(){if(a.adjustPageLayout(n,t,n.clientLayout),!i){var r=new R.s(a.pageBox.scope,"left-page");t.side=r.evaluate(n)?o.LEFT:o.RIGHT,n.processLinger(),e=n.currentLayoutPosition,Object.keys(e.flowPositions).forEach(function(t){var i=e.flowPositions[t],o=i.breakAfter;!o||"page"!==o&&n.matchPageSide(o)||(i.breakAfter=null)})}n.currentLayoutPosition=n.layoutPositionAtPageStart=null,e.highestSeenOffset=n.styler.getReachedOffset();var s=n.style.store.getTriggersForDoc(n.xmldoc);t.finish(s,n.clientLayout),n.noMorePrimaryFlows(e)&&(e=null),p.finish(e)}),p.result()},e.prototype.setPageSizeAndBleed=function(t,e){this.actualPageWidth=t.pageWidth,this.actualPageHeight=t.pageHeight,this.pageSheetWidth=t.pageWidth+2*t.cropOffset,this.pageSheetHeight=t.pageHeight+2*t.cropOffset,e.container.style.width=this.pageSheetWidth+"px",e.container.style.height=this.pageSheetHeight+"px",e.bleedBox.style.left=t.bleedOffset+"px",e.bleedBox.style.right=t.bleedOffset+"px",e.bleedBox.style.top=t.bleedOffset+"px",e.bleedBox.style.bottom=t.bleedOffset+"px",e.bleedBox.style.padding=t.bleed+"px",e.bleedBox.style.paddingTop=t.bleed+.01+"px"},e}(R.g),Di=function(t){function e(e,n,i,o){var r=t.call(this,e.rootScope,e,n,i,o,e.validatorSet,!i)||this;return r.masterHandler=e,r.insideRegion=!1,r}return Ri(e,t),e.prototype.startPageTemplateRule=function(){},e.prototype.startPageMasterRule=function(t,e,n){var i=new Je(this.masterHandler.pageScope,t,e,n,this.masterHandler.rootBox,this.condition,this.owner.getBaseSpecificity());this.masterHandler.pushHandler(new Sn(i.scope,this.masterHandler,i,this.validatorSet))},e.prototype.startWhenRule=function(t){var n=t.expr;null!=this.condition&&(n=R.D(this.scope,this.condition,n)),this.masterHandler.pushHandler(new e(this.masterHandler,n,this,this.regionId))},e.prototype.startDefineRule=function(){this.masterHandler.pushHandler(new V.f(this.scope,this.owner))},e.prototype.startFontFaceRule=function(){var t={};this.masterHandler.fontFaces.push({properties:t,condition:this.condition}),this.masterHandler.pushHandler(new V.h(this.scope,this.owner,null,t,this.masterHandler.validatorSet))},e.prototype.startFlowRule=function(t){var e=this.masterHandler.flowProps[t];e||(e={},this.masterHandler.flowProps[t]=e),this.masterHandler.pushHandler(new V.h(this.scope,this.owner,null,e,this.masterHandler.validatorSet))},e.prototype.startViewportRule=function(){var t={};this.masterHandler.viewportProps.push(t),this.masterHandler.pushHandler(new V.h(this.scope,this.owner,this.condition,t,this.masterHandler.validatorSet))},e.prototype.startFootnoteRule=function(t){var e=this.masterHandler.footnoteProps;if(t){var n=V.q(e,"_pseudos");(e=n[t])||(e={},n[t]=e)}this.masterHandler.pushHandler(new V.h(this.scope,this.owner,null,e,this.masterHandler.validatorSet))},e.prototype.startRegionRule=function(){this.insideRegion=!0,this.startSelectorRule()},e.prototype.startPageRule=function(){var t=new ui(this.masterHandler.pageScope,this.masterHandler,this,this.validatorSet,this.masterHandler.pageProps);this.masterHandler.pushHandler(t),t.startPageRule()},e.prototype.startRuleBody=function(){if(V.b.prototype.startRuleBody.call(this),this.insideRegion){this.insideRegion=!1;var t="R"+this.masterHandler.regionCount++;this.special("region-id",j.r(t)),this.endRule();var n=new e(this.masterHandler,this.condition,this,t);this.masterHandler.pushHandler(n),n.startRuleBody()}},e}(V.b);function Bi(t){var e=t.getAttribute("content");if(!e)return"";for(var n,i={};null!=(n=e.match(/^,?\s*([-A-Za-z_.][-A-Za-z_0-9.]*)\s*=\s*([-+A-Za-z_0-9.]*)\s*/));)e=e.substr(n[0].length),i[n[1]]=n[2];var o=i.width-0,r=i.height-0;return o&&r?"@-epubx-viewport{width:"+o+"px;height:"+r+"px;}":""}var Mi=function(t){function e(e){var n=t.call(this)||this;return n.validatorSet=e,n.regionCount=0,n.fontFaces=[],n.footnoteProps={},n.flowProps={},n.viewportProps=[],n.pageProps={},n.rootScope=new R.m(null),n.pageScope=new R.m(n.rootScope),n.rootBox=new Ze(n.rootScope),n.cascadeParserHandler=new Di(n,null,null,null),n.slave=n.cascadeParserHandler,n}return Ri(e,t),e.prototype.error=function(t,e){u.b.warn("CSS parser:",t)},e}(H.a);function Ui(t,e){return e.parseOPSResource(t)}var zi=function(t){function e(e){var n=t.call(this,Ui,W.b.DOCUMENT)||this;return n.fontDeobfuscator=e,n.styleByKey={},n.styleFetcherByKey={},n.styleByDocURL={},n.triggersByDocURL={},n.validatorSet=null,n.styleSheets=[],n.triggerSingleDocumentPreprocessing=!1,n}return Ri(e,t),e.prototype.init=function(t,e){var n=this;this.setStyleSheets(t,e);var i=b.C("user-agent.xml",b.D),o=K.c("OPSDocStore.init");return this.validatorSet=Me(),Li.get().then(function(){n.load(i).then(function(){n.triggerSingleDocumentPreprocessing=!0,o.finish(!0)})}),o.result()},e.prototype.getStyleForDoc=function(t){return this.styleByDocURL[t.url]},e.prototype.getTriggersForDoc=function(t){return this.triggersByDocURL[t.url]},e.prototype.setStyleSheets=function(t,e){this.clearStyleSheets(),t&&t.forEach(this.addAuthorStyleSheet,this),e&&e.forEach(this.addUserStyleSheet,this)},e.prototype.clearStyleSheets=function(){this.styleSheets.splice(0)},e.prototype.addAuthorStyleSheet=function(t){var e=t.url;e&&(e=b.C(b.n(e),b.h)),this.styleSheets.push({url:e,text:t.text,flavor:H.g.AUTHOR,classes:null,media:null})},e.prototype.addUserStyleSheet=function(t){var e=t.url;e&&(e=b.C(b.n(e),b.h)),this.styleSheets.push({url:e,text:t.text,flavor:H.g.USER,classes:null,media:null})},e.prototype.parseOPSResource=function(t){var e=K.c("OPSDocStore.load"),n=this,i=t.url,o=i.endsWith("?viv-toc-box");return Oi(t,n).then(function(t){if(t){if(n.triggerSingleDocumentPreprocessing)for(var r=l.b(l.a.PREPROCESS_SINGLE_DOCUMENT),a=0;a<r.length;a++)try{r[a](t.document)}catch(t){u.b.warn("Error during single document preprocessing:",t)}var s=[],c=t.document.getElementsByTagNameNS(b.a.epub,"trigger");for(a=0;a<c.length;a++){var h=c[a],p=h.getAttributeNS(b.a.EV,"observer"),f=h.getAttributeNS(b.a.EV,"event"),d=h.getAttribute("action"),g=h.getAttribute("ref");p&&f&&d&&g&&s.push({observer:p,event:f,action:d,ref:g})}n.triggersByDocURL[i]=s;var m=[],v=b.C("user-agent-page.css",b.D);m.push({url:v,text:'@namespace html "http://www.w3.org/1999/xhtml";\n@namespace fb2 "http://www.gribuser.ru/xml/fictionbook/2.0";\n\nhtml|body, fb2|body {\n  hyphens: -epubx-expr(pref-hyphenate?"auto":"manual");\n}\n\n@-adapt-footnote-area {\n  display: block;\n  margin-block-start: 0.5em;\n  margin-block-end: 0.5em;\n}\n\n@-adapt-footnote-area ::before {\n  display: block;\n  border-block-start-width: 1px;\n  border-block-start-style: solid;\n  border-block-start-color: black;\n  margin-block-end: 0.4em;\n  margin-inline-start: 0;\n  margin-inline-end: 60%;\n}\n\n/* default page master */\n@-epubx-page-master :background-host {\n  @-epubx-partition :layout-host {\n    -epubx-flow-from: body;\n    top: -epubx-expr(header.margin-bottom-edge);\n    bottom: -epubx-expr(page-height - footer.margin-top-edge);\n    left: 0px;\n    right: 0px;\n    column-width: 25em;\n  }\n  @-epubx-partition footer :oeb-page-foot {\n    writing-mode: horizontal-tb;\n    -epubx-flow-from: oeb-page-foot;\n    bottom: 0px;\n    left: 0px;\n    right: 0px;\n  }\n  @-epubx-partition header :oeb-page-head {\n    writing-mode: horizontal-tb;\n    -epubx-flow-from: oeb-page-head;\n    top: 0px;\n    left: 0px;\n    right: 0px;\n  }\n}\n\n@page {\n  @top-left-corner {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @top-left {\n    text-align: left;\n    vertical-align: middle;\n  }\n  @top-center {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @top-right {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @top-right-corner {\n    text-align: left;\n    vertical-align: middle;\n  }\n  @left-top {\n    text-align: center;\n    vertical-align: top;\n  }\n  @left-middle {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @left-bottom {\n    text-align: center;\n    vertical-align: bottom;\n  }\n  @right-top {\n    text-align: center;\n    vertical-align: top;\n  }\n  @right-middle {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @right-bottom {\n    text-align: center;\n    vertical-align: bottom;\n  }\n  @bottom-left-corner {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @bottom-left {\n    text-align: left;\n    vertical-align: middle;\n  }\n  @bottom-center {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @bottom-right {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @bottom-right-corner {\n    text-align: left;\n    vertical-align: middle;\n  }\n}\n\n@media print {\n  @page {\n    margin: 10%;\n  }\n}\n',flavor:H.g.USER_AGENT,classes:null,media:null});var y=t.head;if(!o&&y)for(var w=y.firstChild;w;w=w.nextSibling)if(1==w.nodeType){var E=w,S=E.namespaceURI,N=E.localName;if(S==b.a.XHTML)if("style"==N){var C=E.getAttribute("class"),T=E.getAttribute("media"),x=E.getAttribute("title");m.push({url:i,text:E.textContent,flavor:H.g.AUTHOR,classes:x?C:null,media:T})}else if("link"==N){var I=E.getAttribute("rel");if(C=E.getAttribute("class"),T=E.getAttribute("media"),"stylesheet"==I||"alternate stylesheet"==I&&C){var P=E.getAttribute("href");P=b.C(P,i),x=E.getAttribute("title"),m.push({url:P,text:null,classes:x?C:null,media:T,flavor:H.g.AUTHOR})}}else"meta"==N&&"viewport"==E.getAttribute("name")&&m.push({url:i,text:Bi(E),flavor:H.g.AUTHOR,classes:null,media:null});else if(S==b.a.FB2)"stylesheet"==N&&"text/css"==E.getAttribute("type")&&m.push({url:i,text:E.textContent,flavor:H.g.AUTHOR,classes:null,media:null});else if(S==b.a.SSE&&"property"===N){var O=E.getElementsByTagName("name")[0];if(O&&"stylesheet"===O.textContent){var k=E.getElementsByTagName("value")[0];k&&(P=b.C(k.textContent,i),m.push({url:P,text:null,classes:null,media:null,flavor:H.g.AUTHOR}))}}}if(!o)for(a=0;a<n.styleSheets.length;a++)m.push(n.styleSheets[a]);var A="";for(a=0;a<m.length;a++)A+=m[a].url,A+="^",m[a].text&&(A+=m[a].text),A+="^";var R=n.styleByKey[A];if(R)return n.styleByDocURL[i]=R,void e.finish(t);var L=n.styleFetcherByKey[A];L||(L=new Ue.a(function(){var t=K.c("fetchStylesheet"),e=0,i=new Mi(n.validatorSet);return t.loop(function(){if(e<m.length){var t=m[e++];return i.startStylesheet(t.flavor),null!==t.text?H.k(t.text,i,t.url,t.classes,t.media).thenReturn(!0):H.l(t.url,i,t.classes,t.media)}return K.d(!1)}).then(function(){var e=i.cascadeParserHandler.finish();R=new _i(n,i.rootScope,i.pageScope,e,i.rootBox,i.fontFaces,i.footnoteProps,i.flowProps,i.viewportProps,i.pageProps),n.styleByKey[A]=R,delete n.styleFetcherByKey[A],t.finish(R)}),t.result()},"FetchStylesheet "+i),n.styleFetcherByKey[A]=L,L.start()),L.get().then(function(o){n.styleByDocURL[i]=o,e.finish(t)})}else e.finish(null)}),e.result()},e}(W.a);function Vi(t){return String.fromCharCode(t>>>24&255,t>>>16&255,t>>>8&255,255&t)}function Hi(t){return(255&t.charCodeAt(0))<<24|(255&t.charCodeAt(1))<<16|(255&t.charCodeAt(2))<<8|255&t.charCodeAt(3)}function Gi(t){var e=new b.d;e.append(t);var n=55-t.length&63;for(e.append("");n>0;)n--,e.append("\0");e.append("\0\0\0\0"),e.append(Vi(8*t.length)),t=e.toString();for(var i,o=[1732584193,4023233417,2562383102,271733878,3285377520],r=[],a=0;a<t.length;a+=64){for(i=0;i<16;i++)r[i]=Hi(t.substr(a+4*i,4));for(;i<80;i++){var s=r[i-3]^r[i-8]^r[i-14]^r[i-16];r[i]=s<<1|s>>>31}var l=o[0],u=o[1],c=o[2],h=o[3],p=o[4],f=void 0;for(i=0;i<80;i++)f=i<20?1518500249+(u&c|~u&h):i<40?1859775393+(u^c^h):i<60?2400959708+(u&c|u&h|c&h):3395469782+(u^c^h),f+=(l<<5|l>>>27)+p+r[i],p=h,h=c,c=u<<30|u>>>2,u=l,l=f;o[0]=o[0]+l|0,o[1]=o[1]+u|0,o[2]=o[2]+c|0,o[3]=o[3]+h|0,o[4]=o[4]+p|0}return o}var Wi="▸",ji="▾",Xi=function(){function t(t,e,n,i,o,r,a,s,l,u){this.store=t,this.url=e,this.lang=n,this.clientLayout=i,this.fontMapper=o,this.rendererFactory=a,this.fallbackMap=s,this.documentURLTransformer=l,this.counterStore=u,this.page=null,this.instance=null,this.pref=R.E(r),this.pref.spreadView=!1}return t.prototype.setAutoHeight=function(t,e){if(0!=e--)for(var n=t.firstChild;n;n=n.nextSibling)if(1==n.nodeType){var i=n;"auto"!=b.t(i,"height","auto")&&(b.F(i,"height","auto"),this.setAutoHeight(i,e)),"absolute"==b.t(i,"position","static")&&(b.F(i,"position","relative"),this.setAutoHeight(i,e))}},t.prototype.makeCustomRenderer=function(t){var e=this.rendererFactory.makeCustomRenderer(t);return function(t,n,i){var o=i.behavior;if(o)switch(o.toString()){case"body-child":t.parentElement.getAttribute("data-vivliostyle-primary-entry")&&(t.querySelector("[role=doc-toc], [role=directory], nav li a, .toc, #toc")||(i.display=j.t.none));break;case"toc-node-anchor":i.color=j.t.inherit,i["text-decoration"]=j.t.none;break;case"toc-node":i.display=j.t.block,i.margin=j.u,i.padding=j.u,i["padding-inline-start"]=new j.i(1.25,"em");break;case"toc-node-first-child":i.display=j.t.inline_block,i.margin=new j.i(.2,"em"),i["vertical-align"]=j.t.top,i.color=j.t.inherit,i["text-decoration"]=j.t.none}if(!o||"toc-node"!=o.toString()&&"toc-container"!=o.toString())return e(t,n,i);var r=t.firstChild;r&&1!==r.nodeType&&""===r.textContent.trim()&&t.replaceChild(t.ownerDocument.createComment(r.textContent),r);var a=n.getAttribute("data-adapt-class");"toc-node"==a&&(s=n.firstChild).textContent!=Wi&&(s.textContent=Wi,b.F(s,"cursor","pointer"),s.addEventListener("click",Ki,!1),s.setAttribute("role","button"),s.setAttribute("aria-expanded","false"),n.setAttribute("aria-expanded","false"),"0px"!==n.style.height&&(s.tabIndex=0));var s,l=n.ownerDocument.createElement("div");if(l.setAttribute("data-adapt-process-children","true"),"toc-node"==o.toString())if((s=n.ownerDocument.createElement("div")).textContent="▹",b.F(s,"margin","0.2em 0 0 -1em"),b.F(s,"margin-inline-start","-1em"),b.F(s,"margin-inline-end","0"),b.F(s,"display","inline-block"),b.F(s,"width","1em"),b.F(s,"text-align","center"),b.F(s,"vertical-align","top"),b.F(s,"cursor","default"),b.F(s,"font-family","Menlo,sans-serif"),l.appendChild(s),b.F(l,"overflow","hidden"),l.setAttribute("data-adapt-class","toc-node"),l.setAttribute("role","treeitem"),"toc-node"==a||"toc-container"==a){b.F(l,"height","0px");var u=t.firstElementChild;u&&"a"===u.localName&&(u.tabIndex=-1)}else n.setAttribute("role","tree");else"toc-node"==a&&(l.setAttribute("data-adapt-class","toc-container"),l.setAttribute("role","group"),l.setAttribute("aria-hidden","true"));return K.d(l)}},t.prototype.showTOC=function(t,e,n,i,o){var r=this;if(this.page)return K.d(this.page);var a=this,s=K.c("showTOC"),l=new q.l(t,t);this.page=l;var u=this.url+"?viv-toc-box";return this.store.load(u).then(function(i){var u=r.store.resources[r.url];u&&u.body&&u.body.getAttribute("data-vivliostyle-primary-entry")&&i.body.setAttribute("data-vivliostyle-primary-entry",!0);var c=a.store.getStyleForDoc(i),h=c.sizeViewport(n,1e5,o);e=new Ti(e.window,h.fontSize,e.root,h.width,h.height);var p=a.makeCustomRenderer(i),f=new Fi(c,i,a.lang,e,a.clientLayout,a.fontMapper,p,a.fallbackMap,0,a.documentURLTransformer,a.counterStore);a.instance=f,f.pref=a.pref,f.init().then(function(){f.layoutNextPage(l,null).then(function(){Array.from(l.container.querySelectorAll("[data-vivliostyle-toc-box]>*>*>*>*>*[style*='display: none']")).forEach(function(t){t.setAttribute("aria-hidden","true"),t.setAttribute("hidden","hidden")}),a.setAutoHeight(t,2),s.finish(l)})})}),s.result()},t.prototype.hideTOC=function(){this.page&&(this.page.container.style.visibility="hidden",this.page.container.setAttribute("aria-hidden","true"))},t.prototype.isTOCVisible=function(){return!!this.page&&"visible"===this.page.container.style.visibility},t}();function Ki(t){var e=t.target,n=e.textContent==Wi;e.textContent=n?ji:Wi;var i=e.parentNode;e.setAttribute("aria-expanded",n?"true":"false"),i.setAttribute("aria-expanded",n?"true":"false");for(var o=i.firstChild;o;){if(1===o.nodeType){var r=o,a=r.getAttribute("data-adapt-class");if("toc-container"===a){if(r.setAttribute("aria-hidden",n?"false":"true"),r.firstChild){o=r.firstChild;continue}}else if("toc-node"===a&&(r.style.height=n?"auto":"0px",r.children.length>=2&&(r.children[1].tabIndex=n?0:-1),r.children.length>=3&&(r.children[0].tabIndex=n?0:-1,!n))){var s=r.children[0];if(s.textContent==ji){s.textContent=Wi,s.setAttribute("aria-expanded","false"),r.setAttribute("aria-expanded","false"),o=r.children[2];continue}}}for(;!o.nextSibling&&o.parentNode!==i;)o=o.parentNode;o=o.nextSibling}t.stopPropagation()}var qi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Yi=function(t){function e(){var e=t.call(this,null)||this;return e.opfByURL={},e.primaryOPFByEPubURL={},e.deobfuscators={},e.documents={},e.fontDeobfuscator=e.makeDeobfuscatorFactory(),e.plainXMLStore=new W.a(Oi,W.b.DOCUMENT),e.jsonStore=W.f(),e}return qi(e,t),e.prototype.makeDeobfuscatorFactory=function(){var t=this;return function(e){return t.deobfuscators[e]}},e.prototype.loadAsPlainXML=function(t,e,n){return this.plainXMLStore.load(t,e,n)},e.prototype.startLoadingAsPlainXML=function(t){this.plainXMLStore.fetch(t)},e.prototype.loadAsJSON=function(t,e,n){return this.jsonStore.load(t,e,n)},e.prototype.startLoadingAsJSON=function(t){this.jsonStore.fetch(t)},e.prototype.loadPubDoc=function(t,e){var n=this,i=K.c("loadPubDoc");return W.c(t,null,"HEAD").then(function(o){if(o.status>=400)n.loadEPUBDoc(t,e).then(function(e){e?i.finish(e):(u.b.error("Failed to fetch a source document from "+t+" ("+o.status+(o.statusText?" "+o.statusText:"")+")"),i.finish(null))});else if(o.status||o.responseXML||o.responseText||o.responseBlob||o.contentType||/\/[^\/.]+(?:[#?]|$)/.test(t)&&(t=t.replace(/([#?]|$)/,"/$1")),"application/oebps-package+xml"==o.contentType||/\.opf(?:[#?]|$)/.test(t)){var r=t.match(/^((?:.*\/)?)([^\/]*)$/),a=r[1],s=r[2];n.loadOPF(a,s,e).thenFinish(i)}else"application/ld+json"==o.contentType||"application/webpub+json"==o.contentType||"application/audiobook+json"==o.contentType||"application/json"==o.contentType||/\.json(?:ld)?(?:[#?]|$)/.test(t)?n.loadAsJSON(t,!0).then(function(e){if(!e)return u.b.error("Received an empty response for "+t+". This may be caused by the server not allowing cross-origin resource sharing (CORS)."),void i.finish(null);var o=new ao(n,t);o.initWithWebPubManifest(e).then(function(){i.finish(o)})}):n.loadWebPub(t).then(function(o){o?i.finish(o):n.loadEPUBDoc(t,e).then(function(e){e?i.finish(e):(u.b.error("Failed to load "+t+"."),i.finish(null))})})}),i.result()},e.prototype.loadEPUBDoc=function(t,e){var n=this,i=K.c("loadEPUBDoc");t.endsWith("/")||(t+="/"),e&&this.startLoadingAsJSON(t+"?r=list"),this.startLoadingAsPlainXML(t+"META-INF/encryption.xml");var o=t+"META-INF/container.xml";return this.loadAsPlainXML(o).then(function(o){if(o){for(var r=0,a=o.doc().child("container").child("rootfiles").child("rootfile").attribute("full-path");r<a.length;r++){var s=a[r];if(s)return void n.loadOPF(t,s,e).thenFinish(i)}i.finish(null)}}),i.result()},e.prototype.loadOPF=function(t,e,n){var i=this,o=t+e,r=i.opfByURL[o];if(r)return K.d(r);var a=K.c("loadOPF");return i.loadAsPlainXML(o,!0,"Failed to fetch EPUB OPF "+o).then(function(e){e?i.loadAsPlainXML(t+"META-INF/encryption.xml").then(function(s){(n?i.loadAsJSON(t+"?r=list"):K.d(null)).then(function(n){(r=new ao(i,t)).initWithXMLDoc(e,s,n,t+"?r=manifest").then(function(){i.opfByURL[o]=r,i.primaryOPFByEPubURL[t]=r,a.finish(r)})})}):u.b.error("Received an empty response for EPUB OPF "+o+". This may be caused by the server not allowing cross-origin resource sharing (CORS).")}),a.result()},e.prototype.loadWebPub=function(t){var e=this,n=K.c("loadWebPub");return this.load(t).then(function(i){if(i)if(i.document.querySelector("a[href='META-INF/'],a[href$='/META-INF/']"))n.finish(null);else{var o=i.document,r=new ao(e,t);o.body&&o.body.setAttribute("data-vivliostyle-primary-entry",!0);var a=o.querySelector("link[rel='publication'],link[rel='manifest'][type='application/webpub+json']");if(a){var s=a.getAttribute("href");if(/^#/.test(s)){var l=b.H(o.getElementById(s.substr(1)).textContent);r.initWithWebPubManifest(l,o).then(function(){n.finish(r)})}else e.loadAsJSON(b.C(a.getAttribute("href"),t)).then(function(t){r.initWithWebPubManifest(t,o).then(function(){n.finish(r)})})}else r.initWithWebPubManifest({},o).then(function(){r.xhtmlToc&&r.xhtmlToc.src===i.url&&(o.querySelector("[role=doc-toc], [role=directory], nav, .toc, #toc")||(r.xhtmlToc=null)),n.finish(r)})}else u.b.error("Received an empty response for "+t+". This may be caused by the server not allowing cross-origin resource sharing (CORS).")}),n.result()},e.prototype.addDocument=function(t,e){var n=K.c("EPUBDocStore.load"),i=b.I(t);return(this.documents[i]=this.parseOPSResource({status:200,statusText:"",url:i,contentType:e.contentType,responseText:null,responseXML:e,responseBlob:null})).thenFinish(n),n.result()},e.prototype.load=function(e){var n=b.I(e),i=this.documents[n];if(i)return i.isPending()?i:K.d(i.get());var o=K.c("EPUBDocStore.load");return(i=t.prototype.load.call(this,n,!0,"Failed to fetch a source document from "+n)).then(function(t){t?o.finish(t):n.startsWith("data:")?u.b.error("Failed to load "+n+". Invalid data."):n.startsWith("http:")&&b.h.startsWith("https:")?u.b.error("Failed to load "+n+'. Mixed Content ("http:" content on "https:" context) is not allowed.'):u.b.error("Received an empty response for "+n+". This may be caused by the server not allowing cross-origin resource sharing (CORS).")}),o.result()},e}(zi),$i=function(){function t(){this.id=null,this.src="",this.mediaType=null,this.title=null,this.itemRefElement=null,this.spineIndex=-1,this.compressedSize=0,this.compressed=null,this.epage=0,this.epageCount=0,this.startPage=null,this.skipPagesBefore=null,this.itemProperties=b.o}return t.prototype.initWithElement=function(t,e){this.id=t.getAttribute("id"),this.src=b.C(t.getAttribute("href"),e),this.mediaType=t.getAttribute("media-type");var n=t.getAttribute("properties");n&&(this.itemProperties=b.f(n.split(/\s+/)))},t.prototype.initWithParam=function(t){this.spineIndex=t.index,this.id="item"+(t.index+1),this.src=t.url,this.startPage=t.startPage,this.skipPagesBefore=t.skipPagesBefore},t}();function Zi(t){return t.id}function Qi(t){return"1040:"+function(t){for(var e=function(t){for(var e=Gi(t),n=new b.d,i=0;i<e.length;i++)n.append(Vi(e[i]));return n.toString()}(t),n=new b.d,i=0;i<e.length;i++)n.append((256|e.charCodeAt(i)).toString(16).substr(1));return n.toString()}(t)}var Ji={dcterms:"http://purl.org/dc/terms/",marc:"http://id.loc.gov/vocabulary/",media:"http://www.idpf.org/epub/vocab/overlays/#",rendition:"http://www.idpf.org/vocab/rendition/#",onix:"http://www.editeur.org/ONIX/book/codelists/current.html#",xsd:"http://www.w3.org/2001/XMLSchema#"},to="http://idpf.org/epub/vocab/package/#",eo={language:Ji.dcterms+"language",title:Ji.dcterms+"title",creator:Ji.dcterms+"creator",layout:Ji.rendition+"layout",titleType:to+"title-type",displaySeq:to+"display-seq",alternateScript:to+"alternate-script"};function no(t,e){var n={};return function(i,o){var r,a=i.r||n,s=o.r||n;if(t==eo.title&&(r="main"==a[eo.titleType])!=("main"==s[eo.titleType]))return r?-1:1;var l=parseInt(a[eo.displaySeq],10);isNaN(l)&&(l=Number.MAX_VALUE);var u=parseInt(s[eo.displaySeq],10);return isNaN(u)&&(u=Number.MAX_VALUE),l!=u?l-u:t!=eo.language&&e&&(r=(a[eo.language]||a[eo.alternateScript])==e)!=((s[eo.language]||s[eo.alternateScript])==e)?r?-1:1:i.o-o.o}}function io(){var t=window.MathJax;return t?t.Hub:null}var oo,ro={"application/xhtml+xml":!0,"image/jpeg":!0,"image/png":!0,"image/svg+xml":!0,"image/gif":!0,"audio/mp3":!0},ao=function(){function t(t,e){this.store=t,this.pubURL=e,this.opfXML=null,this.encXML=null,this.items=null,this.spine=null,this.itemMap=null,this.itemMapByPath=null,this.uid=null,this.bindings={},this.lang=null,this.epageCount=0,this.prePaginated=!1,this.epageIsRenderedPage=!0,this.epageCountCallback=null,this.metadata={},this.ncxToc=null,this.xhtmlToc=null,this.cover=null,this.fallbackMap={},this.pageProgression=null,this.documentURLTransformer=this.createDocumentURLTransformer(),io()&&(V.H[b.a.MATHML]=!0)}return t.prototype.createDocumentURLTransformer=function(){var t=this;return new(function(){function e(){}return e.prototype.transformFragment=function(t,e){var n=e+(t?"#"+t:"");return"viv-id-"+b.r(n,":")},e.prototype.transformURL=function(e,n){var i=e.match(/^([^#]*)#?(.*)$/);if(i){var o=i[1]||n,r=i[2];if(o&&t.items.some(function(t){return t.src===o}))return"#"+this.transformFragment(r,o)}return e},e.prototype.restoreURL=function(t){"#"===t.charAt(0)&&(t=t.substring(1)),0===t.indexOf("viv-id-")&&(t=t.substring("viv-id-".length));var e=b.J(t,":").match(/^([^#]*)#?(.*)$/);return e?[e[1],e[2]]:[]},e}())},t.prototype.getMetadata=function(){return this.metadata},t.prototype.getPathFromURL=function(t){if(t.startsWith("data:"))return t===this.pubURL?"":t;if(this.pubURL){var e=b.C("",this.pubURL);return t===e||t+"/"===e?"":("/"!=e.charAt(e.length-1)&&(e+="/"),t.substr(0,e.length)==e?decodeURI(t.substr(e.length)):null)}return t},t.prototype.initWithXMLDoc=function(t,e,n,o){var r=this;this.opfXML=t,this.encXML=e;var a=t.doc().child("package"),s=a.attribute("unique-identifier")[0];if(s){var l=t.getElement(t.url+"#"+s);l&&(this.uid=l.textContent.replace(/[ \n\r\t]/g,""))}var u={};for(var c in this.items=a.child("manifest").child("item").asArray().map(function(e){var n=new $i,i=e;n.initWithElement(i,t.url);var o=i.getAttribute("fallback");return o&&!ro[n.mediaType]&&(u[n.src]=o),!r.xhtmlToc&&n.itemProperties.nav&&(r.xhtmlToc=n),!r.cover&&n.itemProperties["cover-image"]&&(r.cover=n),n}),this.itemMap=b.w(this.items,Zi),this.itemMapByPath=b.w(this.items,function(t){return r.getPathFromURL(t.src)}),u)for(var h=c;T=this.itemMap[u[h]];){if(ro[T.mediaType]){this.fallbackMap[c]=T.src;break}h=T.src}this.spine=a.child("spine").child("itemref").asArray().map(function(t,e){var n=t,i=n.getAttribute("idref"),o=r.itemMap[i];return o&&(o.itemRefElement=n,o.spineIndex=e),o});var p=a.child("spine").attribute("toc")[0];p&&(this.ncxToc=this.itemMap[p]);var f=a.child("spine").attribute("page-progression-direction")[0];f&&(this.pageProgression=function(t){switch(t){case"ltr":return i.LTR;case"rtl":return i.RTL;default:throw new Error("unknown PageProgression: "+t)}}(f));for(var d=e?e.doc().child("encryption").child("EncryptedData").predicate(ki.withChild("EncryptionMethod",ki.withAttribute("Algorithm","http://www.idpf.org/2008/embedding"))).child("CipherData").child("CipherReference").attribute("URI"):[],g=a.child("bindings").child("mediaType").asArray(),m=0;m<g.length;m++){var v=g[m].getAttribute("handler");(I=g[m].getAttribute("media-type"))&&v&&this.itemMap[v]&&(this.bindings[I]=this.itemMap[v].src)}if(this.metadata=function(t,e){var n;if(e){for(var i in n={},Ji)n[i]=Ji[i];for(var o=void 0;null!=(o=e.match(/^\s*([A-Z_a-z\u007F-\uFFFF][-.A-Z_a-z0-9\u007F-\uFFFF]*):\s*(\S+)/));)e=e.substr(o[0].length),n[o[1]]=o[2]}else n=Ji;var r=function(t){if(t){var e=t.match(/^\s*(([^:]*):)?(\S+)\s*$/);if(e){var i=e[2]?n[e[2]]:to;if(i)return i+e[3]}}return null},a=1,s=t.childElements().forEachNonNull(function(t){if("meta"==t.localName){var e=r(t.getAttribute("property"));if(e)return{name:e,value:t.textContent,id:t.getAttribute("id"),order:a++,refines:t.getAttribute("refines"),lang:null,scheme:r(t.getAttribute("scheme"))}}else if(t.namespaceURI==b.a.DC)return{name:Ji.dcterms+t.localName,order:a++,lang:t.getAttribute("xml:lang"),value:t.textContent,id:t.getAttribute("id"),refines:null,scheme:null};return null}),l=b.A(s,function(t){return t.refines}),u=function(t){return b.z(t,function(t,e){return t.map(function(t){var e={v:t.value,o:t.order};if(t.schema&&(e.s=t.scheme),t.id||t.lang){var n=l[t.id];if(n||t.lang){if(t.lang){var i={name:eo.language,value:t.lang,lang:null,id:null,refines:t.id,scheme:null,order:t.order};n?n.push(i):n=[i]}var o=b.A(n,function(t){return t.name});e.r=u(o)}}return e})})},c=u(b.A(s,function(t){return t.refines?null:t.name})),h=null;c[eo.language]&&(h=c[eo.language][0].v);var p=function(t){for(var e in t){var n=t[e];n.sort(no(e,h));for(var i=0;i<n.length;i++){var o=n[i].r;o&&p(o)}}};return p(c),c}(a.child("metadata"),a.attribute("prefix")[0]),this.metadata[eo.language]&&(this.lang=this.metadata[eo.language][0].v),this.metadata[eo.layout]&&(this.prePaginated="pre-paginated"===this.metadata[eo.layout][0].v),!n){if(d.length>0&&this.uid){var y=function(t){var e=function(t){for(var e=[],n=0,i=Gi(t);n<i.length;n++){var o=i[n];e.push(o>>>24&255,o>>>16&255,o>>>8&255,255&o)}return e}(t);return function(t){var n,i,o=K.c("deobfuscator");return t.slice?(n=t.slice(0,1040),i=t.slice(1040,t.size)):(n=t.webkitSlice(0,1040),i=t.webkitSlice(1040,t.size-1040)),W.g(n).then(function(t){for(var n=new DataView(t),r=0;r<n.byteLength;r++){var a=n.getUint8(r);a^=e[r%20],n.setUint8(r,a)}o.finish(W.e([n,i]))}),o.result()}}(this.uid);for(m=0;m<d.length;m++)this.store.deobfuscators[this.pubURL+d[m]]=y}return this.prePaginated&&this.assignAutoPages(),K.d(!0)}var w=new b.d,E={};if(d.length>0&&this.uid){var S=Qi(this.uid);for(m=0;m<d.length;m++)E[d[m]]=S}for(m=0;m<n.length;m++){var N=n[m],C=N.n;if(C){var T,x=decodeURI(C),I=null;(T=this.itemMapByPath[x])&&(T.compressed=0!=N.m,T.compressedSize=N.c,T.mediaType&&(I=T.mediaType.replace(/\s+/g,"")));var P=E[x];(I||P)&&(w.append(C),w.append(" "),w.append(I||"application/octet-stream"),P&&(w.append(" "),w.append(P)),w.append("\n"))}}return r.assignAutoPages(),W.c(o,W.b.DEFAULT,"POST",w.toString(),"text/plain")},t.prototype.assignAutoPages=function(){for(var t=0,e=0,n=this.spine;e<n.length;e++){var i=n[e],o=this.prePaginated?1:Math.ceil(i.compressedSize/1024);i.epage=t,i.epageCount=o,t+=o}this.epageCount=t,this.epageCountCallback&&this.epageCountCallback(this.epageCount)},t.prototype.setEPageCountMode=function(t){this.epageIsRenderedPage=t||this.prePaginated},t.prototype.countEPages=function(t){var e=this;if(this.epageCountCallback=t,this.epageIsRenderedPage)return this.prePaginated&&0==this.epageCount&&this.assignAutoPages(),K.d(!0);var n=0,i=0,o=K.c("countEPages");return o.loopWithFrame(function(t){if(i!==e.spine.length){var o=e.spine[i++];o.epage=n,e.store.load(o.src).then(function(i){var r=1800,a=i.lang||e.lang;a&&a.match(/^(ja|ko|zh)/)&&(r/=3),o.epageCount=Math.ceil(i.getTotalOffset()/r),n+=o.epageCount,e.epageCount=n,e.epageCountCallback&&e.epageCountCallback(e.epageCount),t.continueLoop()})}else t.breakLoop()}).thenFinish(o),o.result()},t.prototype.initWithChapters=function(t,e){var n=this;this.itemMap={},this.itemMapByPath={},this.items=[],this.spine=this.items;var i=this.opfXML=new Ii(null,"",(new DOMParser).parseFromString("<spine></spine>","text/xml"));return t.forEach(function(t){var e=new $i;e.initWithParam(t),y.a(e.id);var o=i.document.createElement("itemref");o.setAttribute("idref",e.id),i.root.appendChild(o),e.itemRefElement=o,n.itemMap[e.id]=e;var r=n.getPathFromURL(t.url);null==r&&(r=t.url),n.itemMapByPath[r]=e,n.items.push(e)}),e?this.store.addDocument(t[0].url,e):K.d(null)},t.prototype.initWithWebPubManifest=function(t,e){var n=this;t.readingProgression&&(this.pageProgression=t.readingProgression),void 0===this.metadata&&(this.metadata={});var i=e&&e.title||t.name||t.metadata&&t.metadata.title;i&&(this.metadata[eo.title]=[{v:i}]);var o=this.getPathFromURL(this.pubURL);!t.readingOrder&&e&&null!==o&&(t.readingOrder=[encodeURI(o)],Array.from(e.querySelectorAll("[role=doc-toc] a[href],[role=directory] a[href],nav li a[href],.toc a[href],#toc a[href]")).forEach(function(e){var i=b.I(b.C(e.getAttribute("href"),n.pubURL)),o=n.getPathFromURL(i),r=null!==o?encodeURI(o):i;-1==t.readingOrder.indexOf(r)&&t.readingOrder.push(r)}));var r=[],a=0,s=-1;[t.readingOrder,t.resources].forEach(function(e){e instanceof Array&&e.forEach(function(e){var i=t.readingOrder.includes(e),o="string"==typeof e?e:e.url||e.href,l="string"==typeof e?"":e.encodingFormat||e.href&&e.type||"";if(i||"text/html"===l||"application/xhtml+xml"===l||/(^|\/)([^\/]+\.(x?html|htm|xht)|[^\/.]*)([#?]|$)/.test(o)){var u={url:b.C(b.n(o),n.pubURL),index:a++,startPage:null,skipPagesBefore:null};"contents"===e.rel&&-1===s&&(s=u.index),r.push(u)}})});var l=K.c("initWithWebPubManifest");return this.initWithChapters(r).then(function(){-1!==s&&(n.xhtmlToc=n.items[s]),n.xhtmlToc||(n.xhtmlToc=n.itemMapByPath[o]),l.finish(!0)}),l.result()},t.prototype.getCFI=function(t,e){var n=this.spine[t],i=K.c("getCFI");return this.store.load(n.src).then(function(t){var o=t.getNodeByOffset(e),r=null;if(o){var a=t.getNodeOffset(o,0,!1),s=e-a,l=new k;l.prependPathFromNode(o,s,!1,null),n.itemRefElement&&l.prependPathFromNode(n.itemRefElement,0,!1,null),r=l.toString()}i.finish(r)}),i.result()},t.prototype.resolveFragment=function(t){var e=this;return K.b("resolveFragment",function(n){if(t){var i,o=new k;if(o.fromString(t),e.opfXML){var r=o.navigate(e.opfXML.document);if(1!=r.node.nodeType||r.after||!r.ref)return void n.finish(null);var a=r.node,s=a.getAttribute("idref");if("itemref"!=a.localName||!s||!e.itemMap[s])return void n.finish(null);i=e.itemMap[s],o=r.ref}else i=e.spine[0];e.store.load(i.src).then(function(t){var e=o.navigate(t.document),r=t.getNodeOffset(e.node,e.offset,e.after);n.finish({spineIndex:i.spineIndex,offsetInItem:r,pageIndex:-1})})}else n.finish(null)},function(e,n){u.b.warn(n,"Cannot resolve fragment:",t),e.finish(null)})},t.prototype.resolveEPage=function(t){var e=this;return K.b("resolveEPage",function(n){if(t<=0)n.finish({spineIndex:0,offsetInItem:0,pageIndex:-1});else if(e.epageIsRenderedPage){var i=e.spine.findIndex(function(e){return 0==e.epage&&0==e.epageCount||e.epage<=t&&e.epage+e.epageCount>t});-1==i&&(i=e.spine.length-1);var o=e.spine[i];o&&0!=o.epageCount||(o=e.spine[--i]);var r=Math.floor(t-o.epage);n.finish({spineIndex:i,offsetInItem:-1,pageIndex:r})}else{var a=b.i(e.spine.length,function(n){var i=e.spine[n];return i.epage+i.epageCount>t});a==e.spine.length&&a--;var s=e.spine[a];e.store.load(s.src).then(function(e){(t-=s.epage)>s.epageCount&&(t=s.epageCount);var i=0;if(t>0){var o=e.getTotalOffset();(i=Math.round(o*t/s.epageCount))==o&&i--}n.finish({spineIndex:a,offsetInItem:i,pageIndex:-1})})}},function(e,n){u.b.warn(n,"Cannot resolve epage:",t),e.finish(null)})},t.prototype.getEPageFromPosition=function(t){var e=this.spine[t.spineIndex];if(this.epageIsRenderedPage){var n=e.epage+t.pageIndex;return K.d(n)}if(t.offsetInItem<=0)return K.d(e.epage);var i=K.c("getEPage");return this.store.load(e.src).then(function(n){var o=n.getTotalOffset(),r=Math.min(o,t.offsetInItem);i.finish(e.epage+r*e.epageCount/o)}),i.result()},t}(),so=function(t,e){return{page:t,position:{spineIndex:t.spineIndex,pageIndex:e,offsetInItem:t.offset}}},lo=function(){function t(t,e,n,i,o){this.opf=t,this.viewport=e,this.fontMapper=n,this.pageSheetSizeReporter=o,this.spineItems=[],this.spineItemLoadingContinuations=[],this.tocAutohide=!1,this.pref=R.E(i),this.clientLayout=new Ci(e),this.counterStore=new M(t.documentURLTransformer)}return t.prototype.getPage=function(t){var e=this.spineItems[t.spineIndex];return e?e.pages[t.pageIndex]:null},t.prototype.getCurrentPageProgression=function(t){if(this.opf.pageProgression)return this.opf.pageProgression;var e=this.spineItems[t?t.spineIndex:0];return e?e.instance.pageProgression:null},t.prototype.finishPageContainer=function(t,e,n){e.container.style.display="none",e.container.style.visibility="visible",e.container.style.position="",e.container.style.top="",e.container.style.left="",e.container.setAttribute("data-vivliostyle-page-side",e.side);var i=t.pages[n];if(e.isFirstPage=0==t.item.spineIndex&&0==n,t.pages[n]=e,this.opf.epageIsRenderedPage){if(0==n&&t.item.spineIndex>0){var o=this.opf.spine[t.item.spineIndex-1];t.item.epage=o.epage+o.epageCount}t.item.epageCount=t.pages.length,this.opf.epageCount=this.opf.spine.reduce(function(t,e){return t+e.epageCount},0),this.opf.epageCountCallback&&this.opf.epageCountCallback(this.opf.epageCount)}if(i)t.instance.viewport.contentContainer.replaceChild(e.container,i.container),i.dispatchEvent({type:"replaced",target:null,currentTarget:null,preventDefault:null,newPage:e});else{var r=null;if(n>0)r=t.pages[n-1].container.nextElementSibling;else for(var a=t.item.spineIndex+1;a<this.spineItems.length;a++){var s=this.spineItems[a];if(s&&s.pages[0]){r=s.pages[0].container;break}}t.instance.viewport.contentContainer.insertBefore(e.container,r)}this.pageSheetSizeReporter({width:t.instance.pageSheetWidth,height:t.instance.pageSheetHeight},t.instance.pageSheetSize,t.item.spineIndex,t.instance.pageNumberOffset+n)},t.prototype.renderSinglePage=function(t,e){var n=K.c("renderSinglePage"),i=this.makePage(t,e),o=this;return t.instance.layoutNextPage(i,e).then(function(r){var a=(e=r)?e.page-1:t.layoutPositions.length-1;o.finishPageContainer(t,i,a),o.counterStore.finishPage(i.spineIndex,a);var s=null;if(e){var l=t.layoutPositions[e.page];t.layoutPositions[e.page]=e,l&&t.pages[e.page]&&(e.isSamePosition(l)||(s=o.renderSinglePage(t,e)))}s||(s=K.d(!0)),s.then(function(){var r=o.counterStore.getUnresolvedRefsToPage(i),s=0;n.loopWithFrame(function(t){if(++s>r.length)t.breakLoop();else{var e=r[s-1];e.refs=e.refs.filter(function(t){return!t.isResolved()}),0!==e.refs.length?o.getPageViewItem(e.spineIndex).then(function(n){if(n){o.counterStore.pushPageCounters(e.pageCounters),o.counterStore.pushReferencesToSolve(e.refs);var r=n.layoutPositions[e.pageIndex];o.renderSinglePage(n,r).then(function(e){o.counterStore.popPageCounters(),o.counterStore.popReferencesToSolve();var n=e.pageAndPosition.position;n.spineIndex===i.spineIndex&&n.pageIndex===a&&(i=e.pageAndPosition.page),t.continueLoop()})}else t.continueLoop()}):t.continueLoop()}}).then(function(){i.container.parentElement||(i=t.pages[a]),i.isLastPage=!e&&t.item.spineIndex===o.opf.spine.length-1,i.isLastPage&&(y.a(o.viewport),o.counterStore.finishLastPage(o.viewport)),n.finish({pageAndPosition:so(i,a),nextLayoutPosition:e})})})}),n.result()},t.prototype.normalizeSeekPosition=function(t,e){var n=t.pageIndex,i=-1;if(n<0){i=t.offsetInItem;var o=b.i(e.layoutPositions.length,function(t){return e.instance.getPosition(e.layoutPositions[t],!0)>i});n=o===e.layoutPositions.length?e.complete?e.layoutPositions.length-1:Number.POSITIVE_INFINITY:o-1}else n===Number.POSITIVE_INFINITY&&-1!==t.offsetInItem&&(i=t.offsetInItem);return{spineIndex:t.spineIndex,pageIndex:n,offsetInItem:i}},t.prototype.findPage=function(t,e){var n=this,i=K.c("findPage");return n.getPageViewItem(t.spineIndex).then(function(o){if(o){var r,a=null;i.loopWithFrame(function(s){var l=n.normalizeSeekPosition(t,o);r=l.pageIndex,(a=o.pages[r])?s.breakLoop():o.complete?(r=o.layoutPositions.length-1,a=o.pages[r],s.breakLoop()):e?n.renderPage(l).then(function(t){t&&(a=t.page,r=t.position.pageIndex),s.breakLoop()}):i.sleep(100).then(function(){s.continueLoop()})}).then(function(){y.a(a),i.finish(so(a,r))})}else i.finish(null)}),i.result()},t.prototype.renderPage=function(t){var e=this,n=K.c("renderPage");return e.getPageViewItem(t.spineIndex).then(function(i){if(i){var o=e.normalizeSeekPosition(t,i),r=o.pageIndex,a=o.offsetInItem,s=i.pages[r];s?n.finish(so(s,r)):n.loopWithFrame(function(t){if(r<i.layoutPositions.length)t.breakLoop();else{if(i.complete)return r=i.layoutPositions.length-1,void t.breakLoop();var n=i.layoutPositions[i.layoutPositions.length-1];e.renderSinglePage(i,n).then(function(e){var o=e.pageAndPosition.page;if(n=e.nextLayoutPosition){if(a>=0&&i.instance.getPosition(n)>a)return s=o,r=i.layoutPositions.length-2,void t.breakLoop();t.continueLoop()}else s=o,r=e.pageAndPosition.position.pageIndex,i.complete=!0,t.breakLoop()})}}).then(function(){s=s||i.pages[r];var t=i.layoutPositions[r];s?n.finish(so(s,r)):e.renderSinglePage(i,t).then(function(t){t.nextLayoutPosition||(i.complete=!0),n.finish(t.pageAndPosition)})})}else n.finish(null)}),n.result()},t.prototype.renderAllPages=function(){return this.renderPagesUpto({spineIndex:this.opf.spine.length-1,pageIndex:Number.POSITIVE_INFINITY,offsetInItem:-1},!1)},t.prototype.renderPagesUpto=function(t,e){var n=this,i=K.c("renderPagesUpto");t||(t={spineIndex:0,pageIndex:0,offsetInItem:0});var o,r=t.spineIndex,a=t.pageIndex,s=0;return e&&(s=r),i.loopWithFrame(function(e){var i={spineIndex:s,pageIndex:s===r?a:Number.POSITIVE_INFINITY,offsetInItem:s===r?t.offsetInItem:-1};n.renderPage(i).then(function(t){o=t,++s>r?e.breakLoop():e.continueLoop()})}).then(function(){i.finish(o)}),i.result()},t.prototype.firstPage=function(t,e){return this.findPage({spineIndex:0,pageIndex:0,offsetInItem:-1},e)},t.prototype.lastPage=function(t,e){return this.findPage({spineIndex:this.opf.spine.length-1,pageIndex:Number.POSITIVE_INFINITY,offsetInItem:-1},e)},t.prototype.nextPage=function(t,e){var n=this,i=this,o=t.spineIndex,r=t.pageIndex,a=K.c("nextPage");return i.getPageViewItem(o).then(function(t){if(t){if(t.complete&&r==t.layoutPositions.length-1){if(o>=i.opf.spine.length-1)return void a.finish(null);o++,r=0;var s=n.spineItems[o],l=s&&s.pages[0],u=t.pages[t.pages.length-1];l&&u&&l.side==u.side&&(s.pages.forEach(function(t){t.container&&t.container.remove()}),n.spineItems[o]=null,n.spineItemLoadingContinuations[o]=null)}else r++;i.findPage({spineIndex:o,pageIndex:r,offsetInItem:-1},e).thenFinish(a)}else a.finish(null)}),a.result()},t.prototype.previousPage=function(t,e){var n=t.spineIndex,i=t.pageIndex;if(0==i){if(0==n)return K.d(null);n--,i=Number.POSITIVE_INFINITY}else i--;return this.findPage({spineIndex:n,pageIndex:i,offsetInItem:-1},e)},t.prototype.isRectoPage=function(t,e){var n=t.side===o.LEFT,r=this.getCurrentPageProgression(e)===i.LTR;return!n&&r||n&&!r},t.prototype.getSpread=function(t,e){var n=this,i=K.c("getCurrentSpread"),r=this.getPage(t);if(!r)return K.d({left:null,right:null});var a=r.side===o.LEFT;return(this.isRectoPage(r,t)?this.previousPage(t,e):this.nextPage(t,e)).then(function(e){var o=n.getPage(t),r=e&&e.page;r&&r.side===o.side&&(r=null),a?i.finish({left:o,right:r}):i.finish({left:r,right:o})}),i.result()},t.prototype.nextSpread=function(t,e){var n=this.getPage(t);if(!n)return K.d(null);var i=this.isRectoPage(n,t),o=this.nextPage(t,e);if(i)return o;var r=this;return o.thenAsync(function(t){if(t){if(t.page.side===n.side)return o;var i=r.nextPage(t.position,e);return i.thenAsync(function(t){return t?i:o})}return K.d(null)})},t.prototype.previousSpread=function(t,e){var n=this.getPage(t);if(!n)return K.d(null);var i=this.isRectoPage(n,t),o=this.previousPage(t,e),r=n.container.previousElementSibling;if(i){var a=this;return o.thenAsync(function(t){return t?t.page.side===n.side?o:t.page.container!==r?o:a.previousPage(t.position,e):K.d(null)})}return o},t.prototype.navigateToEPage=function(t,e,n){var i=K.c("navigateToEPage"),o=this;return this.opf.resolveEPage(t).then(function(t){t?o.findPage(t,n).thenFinish(i):i.finish(null)}),i.result()},t.prototype.navigateToFragment=function(t,e,n){var i=K.c("navigateToCFI"),o=this;return o.opf.resolveFragment(t).then(function(t){t?o.findPage(t,n).thenFinish(i):i.finish(null)}),i.result()},t.prototype.navigateTo=function(t,e,n){u.b.debug("Navigate to",t);var i=this.opf.getPathFromURL(b.I(t));if(!i){if(this.opf.opfXML&&t.match(/^#epubcfi\(/))i=this.opf.getPathFromURL(this.opf.opfXML.url);else if("#"===t.charAt(0)){var o=this.opf.documentURLTransformer.restoreURL(t);this.opf.opfXML?null==(i=this.opf.getPathFromURL(o[0]))&&(i=o[0]):i=o[0],t=i+(o[1]?"#"+o[1]:"")}if(null==i)return K.d(null)}var r=this.opf.itemMapByPath[i];if(!r){if(this.opf.opfXML&&i==this.opf.getPathFromURL(this.opf.opfXML.url)){var a=t.indexOf("#");if(a>=0)return this.navigateToFragment(t.substr(a+1),e,n)}return K.d(null)}var s=K.c("navigateTo"),l=this;return l.getPageViewItem(r.spineIndex).then(function(i){if(i){var o=i.xmldoc.getElement(t);o?l.findPage({spineIndex:r.spineIndex,pageIndex:-1,offsetInItem:i.xmldoc.getElementOffset(o)},n).thenFinish(s):e.spineIndex!==r.spineIndex?l.findPage({spineIndex:r.spineIndex,pageIndex:0,offsetInItem:-1},n).thenFinish(s):s.finish(null)}else s.finish(null)}),s.result()},t.prototype.makePage=function(t,e){var n=t.instance.viewport,i=n.document.createElement("div");i.setAttribute("data-vivliostyle-page-container","true"),i.setAttribute("role","region"),i.style.position="absolute",i.style.top="0",i.style.left="0",a||(i.style.visibility="hidden",i.setAttribute("aria-hidden","true")),n.layoutBox.appendChild(i);var o=n.document.createElement("div");o.setAttribute("data-vivliostyle-bleed-box","true"),i.appendChild(o);var r=new q.l(i,o);if(r.spineIndex=t.item.spineIndex,r.position=e,r.offset=t.instance.getPosition(e),0===r.offset){var s=this.opf.documentURLTransformer.transformFragment("",t.item.src);o.setAttribute("id",s),r.registerElementWithId(o,s)}if(n!==this.viewport){var l=R.L(this.viewport.width,this.viewport.height,n.width,n.height),u=H.m(null,new G.b(l,null),"");r.delayedItems.push(new q.d(i,"transform",u))}return r},t.prototype.makeObjectView=function(t,e,n,i){var o=e.getAttribute("data"),r=null;if(o){o=b.C(o,t.url);var a=e.getAttribute("media-type");if(!a){var s=this.opf.getPathFromURL(o);if(s){var l=this.opf.itemMapByPath[s];l&&(a=l.mediaType)}}if(a){var u=this.opf.bindings[a];if(u){(r=this.viewport.document.createElement("iframe")).style.border="none";var c=b.y(o),h=b.y(a),p=new b.d;p.append(u),p.append("?src="),p.append(c),p.append("&type="),p.append(h);for(var f=e.firstChild;f;f=f.nextSibling)if(1==f.nodeType){var d=f;if("param"==d.localName&&d.namespaceURI==b.a.XHTML){var g=d.getAttribute("name"),m=d.getAttribute("value");g&&m&&(p.append("&"),p.append(encodeURIComponent(g)),p.append("="),p.append(encodeURIComponent(m)))}}r.setAttribute("src",p.toString());var v=e.getAttribute("width");v&&r.setAttribute("width",v);var y=e.getAttribute("height");y&&r.setAttribute("height",y)}}}return r||(r=this.viewport.document.createElement("span")).setAttribute("data-adapt-process-children","true"),K.d(r)},t.prototype.makeMathJaxView=function(t,e,n,i){var o=io();if(o){var r=n.ownerDocument,a=r.createElement("span");n.appendChild(a);var s=r.importNode(e,!0);this.resolveURLsInMathML(s,t),a.appendChild(s);var l=o.queue;l.Push(["Typeset",o,a]);var u=K.c("makeMathJaxView"),c=u.suspend();return l.Push(function(){c.schedule(a)}),u.result()}return K.d(null)},t.prototype.resolveURLsInMathML=function(t,e){if(null!=t){if(1===t.nodeType&&"mglyph"===t.tagName)for(var n=0,i=Array.from(t.attributes);n<i.length;n++){var o=i[n];if("src"===o.name){var r=b.C(o.nodeValue,e.url);o.namespaceURI?t.setAttributeNS(o.namespaceURI,o.name,r):t.setAttribute(o.name,r)}}t.firstChild&&this.resolveURLsInMathML(t.firstChild,e),t.nextSibling&&this.resolveURLsInMathML(t.nextSibling,e)}},t.prototype.makeSSEView=function(t,e,n,i){var o,r=n?n.ownerDocument:this.viewport.document,a=e.localName;switch(a){case"t":case"tab":case"ec":case"nt":case"fraction":case"comment":case"mark":o="span";break;case"ruby":case"rp":case"rt":o=a;break;default:o="div"}var s=r.createElement(o);return s.setAttribute("data-adapt-process-children","true"),K.d(s)},t.prototype.makeCustomRenderer=function(t){var e=this;return function(n,i,o){return"object"==n.localName&&n.namespaceURI==b.a.XHTML?e.makeObjectView(t,n,i,o):n.namespaceURI==b.a.MATHML?e.makeMathJaxView(t,n,i,o):n.namespaceURI==b.a.SSE?e.makeSSEView(t,n,i,o):n.dataset&&"true"==n.dataset.mathTypeset?e.makeMathJaxView(t,n,i,o):K.d(null)}},t.prototype.getPageViewItem=function(t){var e=this;if(-1===t||t>=e.opf.spine.length)return K.d(null);var n=e.spineItems[t];if(n)return K.d(n);var i=K.c("getPageViewItem"),o=this.spineItemLoadingContinuations[t];if(o){var r=i.suspend();return o.push(r),i.result()}o=this.spineItemLoadingContinuations[t]=[];var a=e.opf.spine[t],s=e.opf.store;return s.load(a.src).then(function(r){a.title=r.document.title;var l=s.getStyleForDoc(r),u=e.makeCustomRenderer(r),c=e.viewport,h=l.sizeViewport(c.width,c.height,c.fontSize,e.pref);h.width==c.width&&h.height==c.height&&h.fontSize==c.fontSize||(c=new Ti(c.window,h.fontSize,c.root,h.width,h.height));var p,f=e.spineItems[t-1];null!==a.startPage?p=a.startPage-1:(!(t>0)||f&&f.complete?p=f?f.instance.pageNumberOffset+f.pages.length:0:(p=a.epage||t,e.opf.prePaginated||p%2!=0||p++),null!==a.skipPagesBefore&&(p+=a.skipPagesBefore)),e.counterStore.forceSetPageCounter(p);var d=new Fi(l,r,e.opf.lang,c,e.clientLayout,e.fontMapper,u,e.opf.fallbackMap,p,e.opf.documentURLTransformer,e.counterStore,e.opf.pageProgression);d.pref=e.pref;var g=e.opf.metadata&&e.opf.metadata[eo.title];d.pubTitle=g&&g[0]&&g[0].v||"",d.docTitle=a.title||"",d.init().then(function(){n={item:a,xmldoc:r,instance:d,layoutPositions:[null],pages:[],complete:!1},e.spineItems[t]=n,i.finish(n),o.forEach(function(t){t.schedule(n)})})}),i.result()},t.prototype.removeRenderedPages=function(){for(var t=0,e=this.spineItems;t<e.length;t++){var n=e[t];n&&n.pages.splice(0)}this.viewport.clear()},t.prototype.hasAutoSizedPages=function(){for(var t=0,e=this.spineItems;t<e.length;t++){var n=e[t];if(n)for(var i=0,o=n.pages;i<o.length;i++){var r=o[i];if(r.isAutoPageWidth&&r.isAutoPageHeight)return!0}}return!1},t.prototype.hasPages=function(){return this.spineItems.some(function(t){return t&&t.pages.length>0})},t.prototype.showTOC=function(t){var e=this.opf,n=e.xhtmlToc||e.ncxToc;if(this.tocAutohide=t,!n)return K.d(null);if(this.tocView&&this.tocView.page)return this.tocView.page.container.style.visibility="visible",this.tocView.page.container.setAttribute("aria-hidden","false"),K.d(this.tocView.page);var i=K.c("showTOC");this.tocView||(this.tocView=new Xi(e.store,n.src,e.lang,this.clientLayout,this.fontMapper,this.pref,this,e.fallbackMap,e.documentURLTransformer,this.counterStore));var o=this.viewport,r=Math.min(350,Math.round(.67*o.width)-16),a=o.height-6,s=o.document.createElement("div");return o.root.appendChild(s),s.style.visibility="hidden",s.style.width=r+10+"px",s.style.maxHeight=a+"px",s.setAttribute("data-vivliostyle-toc-box","true"),s.setAttribute("role","navigation"),this.tocView.showTOC(s,o,r,a,this.viewport.fontSize).then(function(t){s.style.visibility="visible",s.setAttribute("aria-hidden","false"),i.finish(t)}),i.result()},t.prototype.hideTOC=function(){this.tocView&&this.tocView.hideTOC()},t.prototype.isTOCVisible=function(){return!!this.tocView&&this.tocView.isTOCVisible()},t}(),uo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),co="data-vivliostyle-viewer-status";!function(t){t.SINGLE_PAGE="singlePage",t.SPREAD="spread",t.AUTO_SPREAD="autoSpread"}(oo||(oo={}));var ho,po=function(){function t(t,e,n,i){this.window=t,this.viewportElement=e,this.instanceId=n,this.callbackFn=i,this.pageSheetSizeAlreadySet=!1,this.renderTask=null;var o=this;e.setAttribute("data-vivliostyle-viewer-viewport",!0),a&&e.setAttribute("data-vivliostyle-debug",!0),e.setAttribute(co,"loading");var r=t.document;this.fontMapper=new Xe(r.head,e),this.init(),this.kick=function(){},this.sendCommand=function(){},this.resizeListener=function(){o.needResize=!0,o.kick()},this.pageReplacedListener=this.pageReplacedListener.bind(this),this.hyperlinkListener=function(t){},this.pageRuleStyleElement=r.getElementById("vivliostyle-page-rules"),this.actions={loadPublication:this.loadPublication,loadXML:this.loadXML,configure:this.configure,moveTo:this.moveTo,toc:this.showTOC},this.addLogListeners()}return t.prototype.init=function(){this.readyState=r.LOADING,this.packageURL=[],this.opf=null,this.haveZipMetadata=!1,this.touchActive=!1,this.touchX=0,this.touchY=0,this.needResize=!1,this.needRefresh=!1,this.viewportSize=null,this.currentPage=null,this.currentSpread=null,this.pagePosition=null,this.fontSize=16,this.zoom=1,this.fitToScreen=!1,this.pageViewMode=oo.SINGLE_PAGE,this.waitForLoading=!1,this.renderAllPages=!0,this.pref=R.F(),this.pageSizes=[]},t.prototype.addLogListeners=function(){var t=this,e=u.a;u.b.addListener(e.DEBUG,function(e){t.callback({t:"debug",content:e})}),u.b.addListener(e.INFO,function(e){t.callback({t:"info",content:e})}),u.b.addListener(e.WARN,function(e){t.callback({t:"warn",content:e})}),u.b.addListener(e.ERROR,function(e){t.callback({t:"error",content:e})})},t.prototype.callback=function(t){t.i=this.instanceId,this.callbackFn(t)},t.prototype.setReadyState=function(t){this.readyState!==t&&(this.readyState=t,this.viewportElement.setAttribute(co,t),this.callback({t:"readystatechange"}))},t.prototype.loadPublication=function(t){m.registerStartTiming("beforeRender"),this.setReadyState(r.LOADING);var e=t.url,n=t.fragment,i=!!t.zipmeta,o=t.authorStyleSheet,a=t.userStyleSheet;this.viewport=null;var s=K.c("loadPublication"),l=this;return l.configure(t).then(function(){var t=new Yi;t.init(o,a).then(function(){var o=b.C(b.n(e),l.window.location.href);l.packageURL=[o],t.loadPubDoc(o,i).then(function(t){t?(l.opf=t,l.render(n).then(function(){s.finish(!0)})):s.finish(!1)})})}),s.result()},t.prototype.loadXML=function(t){m.registerStartTiming("beforeRender"),this.setReadyState(r.LOADING);var e=t.url,n=t.document,i=t.fragment,o=t.authorStyleSheet,a=t.userStyleSheet;this.viewport=null;var s=K.c("loadXML"),l=this;return l.configure(t).then(function(){var t=new Yi;t.init(o,a).then(function(){var o=e.map(function(t,e){return{url:b.C(b.n(t.url),l.window.location.href),index:e,startPage:t.startPage,skipPagesBefore:t.skipPagesBefore}});l.packageURL=o.map(function(t){return t.url}),l.opf=new ao(t,""),l.opf.initWithChapters(o,n).then(function(){l.render(i).then(function(){s.finish(!0)})})})}),s.result()},t.prototype.render=function(t){this.cancelRenderingTask();var e=this;return(t?this.opf.resolveFragment(t).thenAsync(function(t){return e.pagePosition=t,K.d(!0)}):K.d(!0)).thenAsync(function(){return m.registerEndTiming("beforeRender"),e.resize()})},t.prototype.resolveLength=function(t){var e,n=parseFloat(t);if("string"==typeof t&&(e=t.match(/[a-z]+$/))){var i=e[0];if("em"===i||"rem"===i)return n*this.fontSize;if("ex"===i)return n*R.G.ex*this.fontSize/R.G.em;var o=R.G[i];if(o)return n*o}return n},t.prototype.configure=function(t){if("boolean"==typeof t.autoresize&&(t.autoresize?(this.viewportSize=null,this.window.addEventListener("resize",this.resizeListener,!1),this.needResize=!0):this.window.removeEventListener("resize",this.resizeListener,!1)),"number"==typeof t.fontSize){var e=t.fontSize;e>=5&&e<=72&&this.fontSize!=e&&(this.fontSize=e,this.needResize=!0)}if("object"==typeof t.viewport&&t.viewport){var n=t.viewport,i={marginLeft:this.resolveLength(n["margin-left"])||0,marginRight:this.resolveLength(n["margin-right"])||0,marginTop:this.resolveLength(n["margin-top"])||0,marginBottom:this.resolveLength(n["margin-bottom"])||0,width:this.resolveLength(n.width)||0,height:this.resolveLength(n.height)||0};(i.width>=200||i.height>=200)&&(this.window.removeEventListener("resize",this.resizeListener,!1),this.viewportSize=i,this.needResize=!0)}return"boolean"==typeof t.hyphenate&&(this.pref.hyphenate=t.hyphenate,this.needResize=!0),"boolean"==typeof t.horizontal&&(this.pref.horizontal=t.horizontal,this.needResize=!0),"boolean"==typeof t.nightMode&&(this.pref.nightMode=t.nightMode,this.needResize=!0),"number"==typeof t.lineHeight&&(this.pref.lineHeight=t.lineHeight,this.needResize=!0),"number"==typeof t.columnWidth&&(this.pref.columnWidth=t.columnWidth,this.needResize=!0),"string"==typeof t.fontFamily&&(this.pref.fontFamily=t.fontFamily,this.needResize=!0),"boolean"==typeof t.load&&(this.waitForLoading=t.load),"boolean"==typeof t.renderAllPages&&(this.renderAllPages=t.renderAllPages),"string"==typeof t.userAgentRootURL&&(b.E(t.userAgentRootURL.replace(/resources\/?$/,"")),b.G(t.userAgentRootURL)),"string"==typeof t.rootURL&&(b.E(t.rootURL),b.G(b.h+"resources/")),"string"==typeof t.pageViewMode&&t.pageViewMode!==this.pageViewMode&&(this.pageViewMode=t.pageViewMode,this.needResize=!0),"number"==typeof t.pageBorder&&t.pageBorder!==this.pref.pageBorder&&(this.viewport=null,this.pref.pageBorder=t.pageBorder,this.needResize=!0),"number"==typeof t.zoom&&t.zoom!==this.zoom&&(this.zoom=t.zoom,this.needRefresh=!0),"boolean"==typeof t.fitToScreen&&t.fitToScreen!==this.fitToScreen&&(this.fitToScreen=t.fitToScreen,this.needRefresh=!0),"object"==typeof t.defaultPaperSize&&"number"==typeof t.defaultPaperSize.width&&"number"==typeof t.defaultPaperSize.height&&(this.viewport=null,this.pref.defaultPaperSize=t.defaultPaperSize,this.needResize=!0),this.configurePlugins(t),K.d(!0)},t.prototype.configurePlugins=function(t){var e=this;l.b(l.a.CONFIGURATION).forEach(function(n){var i=n(t);e.needResize=i.needResize||e.needResize,e.needRefresh=i.needRefresh||e.needRefresh})},t.prototype.pageReplacedListener=function(t){var e=this.currentPage,n=this.currentSpread,i=t.target;n?n.left!==i&&n.right!==i||this.showCurrent(t.newPage):e===t.target&&this.showCurrent(t.newPage)},t.prototype.forCurrentPages=function(t){var e=[];this.currentPage&&e.push(this.currentPage),this.currentSpread&&(e.push(this.currentSpread.left),e.push(this.currentSpread.right)),e.forEach(function(e){e&&t(e)})},t.prototype.removePageListeners=function(){var t=this;this.forCurrentPages(function(e){e.removeEventListener("hyperlink",t.hyperlinkListener,!1),e.removeEventListener("replaced",t.pageReplacedListener,!1)})},t.prototype.hidePages=function(){this.removePageListeners(),this.forCurrentPages(function(t){b.F(t.container,"display","none"),t.container.setAttribute("aria-hidden","true")}),this.currentPage=null,this.currentSpread=null},t.prototype.showSinglePage=function(t){t.addEventListener("hyperlink",this.hyperlinkListener,!1),t.addEventListener("replaced",this.pageReplacedListener,!1),b.F(t.container,"visibility","visible"),b.F(t.container,"display","block"),t.container.setAttribute("aria-hidden","false")},t.prototype.showPage=function(t){this.hidePages(),this.currentPage=t,t.container.style.marginLeft="",t.container.style.marginRight="",this.showSinglePage(t)},t.prototype.showSpread=function(t){if(this.hidePages(),this.currentSpread=t,t.left&&t.right){var e=parseFloat(t.left.container.style.width),n=parseFloat(t.right.container.style.width);e&&n&&e!==n&&(e<n?t.left.container.style.marginLeft=n-e+"px":t.right.container.style.marginRight=e-n+"px")}t.left&&(this.showSinglePage(t.left),t.right?t.left.container.removeAttribute("data-vivliostyle-unpaired-page"):t.left.container.setAttribute("data-vivliostyle-unpaired-page",!0)),t.right&&(this.showSinglePage(t.right),t.left?t.right.container.removeAttribute("data-vivliostyle-unpaired-page"):t.right.container.setAttribute("data-vivliostyle-unpaired-page",!0))},t.prototype.reportPosition=function(){var t=K.c("reportPosition"),e=this;return y.a(e.pagePosition),e.opf.getCFI(this.pagePosition.spineIndex,this.pagePosition.offsetInItem).then(function(n){var i=e.currentPage;(e.waitForLoading&&i.fetchers.length>0?Ue.c(i.fetchers):K.d(!0)).then(function(){e.sendLocationNotification(i,n).thenFinish(t)})}),t.result()},t.prototype.createViewport=function(){var t=this.viewportElement;if(this.viewportSize){var e=this.viewportSize;return t.style.marginLeft=e.marginLeft+"px",t.style.marginRight=e.marginRight+"px",t.style.marginTop=e.marginTop+"px",t.style.marginBottom=e.marginBottom+"px",new Ti(this.window,this.fontSize,t,e.width,e.height)}return new Ti(this.window,this.fontSize,t)},t.prototype.resolveSpreadView=function(t){switch(this.pageViewMode){case oo.SINGLE_PAGE:return!1;case oo.SPREAD:return!0;case oo.AUTO_SPREAD:default:return t.width/t.height>=1.45&&t.width>800}},t.prototype.updateSpreadView=function(t){this.pref.spreadView=t,this.viewportElement.setAttribute("data-vivliostyle-spread-view",t.toString())},t.prototype.sizeIsGood=function(){var t=this.createViewport(),e=this.resolveSpreadView(t),n=this.pref.spreadView!==e;return this.updateSpreadView(e),!(this.viewportSize||!this.viewport||this.viewport.fontSize!=this.fontSize||(n||t.width!=this.viewport.width||t.height!=this.viewport.height)&&(n||t.width!=this.viewport.width||t.height==this.viewport.height||!/Android|iPhone|iPad|iPod/.test(navigator.userAgent))&&(!this.opfView||!this.opfView.hasPages()||this.opfView.hasAutoSizedPages()||(this.viewport.width=t.width,this.viewport.height=t.height,this.needRefresh=!0,0)))},t.prototype.setPageSize=function(t,e,n,i){this.pageSizes[i]=t,this.setPageSizePageRules(e,n,i)},t.prototype.setPageSizePageRules=function(t,e,n){if(!this.pageSheetSizeAlreadySet&&this.pageRuleStyleElement){var i="";Object.keys(t).forEach(function(e){i+="@page "+e+"{margin:0;size:";var n=t[e];i+=n.width+"px "+n.height+"px;}"}),this.pageRuleStyleElement.textContent=i,this.pageSheetSizeAlreadySet=!0}},t.prototype.removePageSizePageRules=function(){this.pageRuleStyleElement&&(this.pageRuleStyleElement.textContent="",this.pageSheetSizeAlreadySet=!1)},t.prototype.reset=function(){var t=!1,e=!1;this.opfView&&(t=this.opfView.isTOCVisible(),e=this.opfView.tocAutohide,this.opfView.hideTOC(),this.opfView.removeRenderedPages()),this.removePageSizePageRules(),this.viewport=this.createViewport(),this.viewport.resetZoom(),this.opfView=new lo(this.opf,this.viewport,this.fontMapper,this.pref,this.setPageSize.bind(this)),t&&this.sendCommand({a:"toc",v:"show",autohide:e})},t.prototype.showCurrent=function(t,e){this.needRefresh=!1,this.removePageListeners();var n=this;return this.pref.spreadView?this.opfView.getSpread(this.pagePosition,e).thenAsync(function(e){return n.showSpread(e),n.setSpreadZoom(e),n.currentPage=t,K.d(null)}):(this.showPage(t),this.setPageZoom(t),this.currentPage=t,K.d(null))},t.prototype.setPageZoom=function(t){var e=this.getAdjustedZoomFactor(t.dimensions);this.viewport.zoom(t.dimensions.width,t.dimensions.height,e)},t.prototype.setSpreadZoom=function(t){var e=this.getSpreadDimensions(t);this.viewport.zoom(e.width,e.height,this.getAdjustedZoomFactor(e))},t.prototype.getAdjustedZoomFactor=function(t){return this.fitToScreen?this.calculateZoomFactorToFitInsideViewPort(t):this.zoom},t.prototype.getSpreadDimensions=function(t){var e=0,n=0;return t.left&&(e+=t.left.dimensions.width,n=t.left.dimensions.height),t.right&&(e+=t.right.dimensions.width,n=Math.max(n,t.right.dimensions.height)),t.left&&t.right&&(e+=2*this.pref.pageBorder,e+=Math.abs(t.left.dimensions.width-t.right.dimensions.width)),{width:e,height:n}},t.prototype.queryZoomFactor=function(t){if(!this.currentPage)throw new Error("no page exists.");switch(t){case ho.FIT_INSIDE_VIEWPORT:var e=void 0;return this.pref.spreadView?(y.a(this.currentSpread),e=this.getSpreadDimensions(this.currentSpread)):e=this.currentPage.dimensions,this.calculateZoomFactorToFitInsideViewPort(e);default:throw new Error("unknown zoom type: "+t)}},t.prototype.calculateZoomFactorToFitInsideViewPort=function(t){var e=this.viewport.width/t.width,n=this.viewport.height/t.height;return Math.min(e,n)},t.prototype.cancelRenderingTask=function(){this.renderTask&&this.renderTask.interrupt(new fo),this.renderTask=null},t.prototype.resize=function(){if(this.needResize=!1,this.needRefresh=!1,this.sizeIsGood())return K.d(!0);var t=this;this.setReadyState(r.LOADING),this.cancelRenderingTask();var e=K.a().getScheduler().run(function(){return K.b("resize",function(n){t.opf?(t.renderTask=e,m.registerStartTiming("render (resize)"),t.reset(),t.pagePosition&&(0==t.pagePosition.pageIndex&&0==t.pagePosition.offsetInItem||(t.pagePosition.pageIndex=-1)),t.opf.setEPageCountMode(t.renderAllPages),t.opfView.renderPagesUpto(t.pagePosition,!t.renderAllPages).then(function(i){i?(t.pagePosition=i.position,t.showCurrent(i.page,!0).then(function(){t.setReadyState(r.INTERACTIVE),t.opf.countEPages(function(e){var n={t:"nav",epageCount:e,first:t.currentPage.isFirstPage,last:t.currentPage.isLastPage,metadata:t.opf.metadata,docTitle:t.opf.spine[t.pagePosition.spineIndex].title};(t.currentPage.isFirstPage||0==t.pagePosition.pageIndex&&t.opf.spine[t.pagePosition.spineIndex].epage)&&(n.epage=t.opf.spine[t.pagePosition.spineIndex].epage),t.callback(n)}).then(function(){t.reportPosition().then(function(i){(t.renderAllPages?t.opfView.renderAllPages():K.d(null)).then(function(){t.renderTask===e&&(t.renderTask=null),m.registerEndTiming("render (resize)"),t.renderAllPages&&t.setReadyState(r.COMPLETE),t.callback({t:"loaded"}),n.finish(i)})})})})):n.finish(!1)})):n.finish(!1)},function(t,e){if(!(e instanceof fo))throw e;m.registerEndTiming("render (resize)"),u.b.debug(e.message)})});return K.d(!0)},t.prototype.sendLocationNotification=function(t,e){var n=K.c("sendLocationNotification"),i={t:"nav",first:t.isFirstPage,last:t.isLastPage,metadata:this.opf.metadata,docTitle:this.opf.spine[t.spineIndex].title},o=this;return this.opf.getEPageFromPosition(o.pagePosition).then(function(t){i.epage=t,i.epageCount=o.opf.epageCount,e&&(i.cfi=e),o.callback(i),n.finish(!0)}),n.result()},t.prototype.getCurrentPageProgression=function(){return this.opfView?this.opfView.getCurrentPageProgression(this.pagePosition):null},t.prototype.moveTo=function(t){var e,n=this;if(this.readyState!==r.COMPLETE&&"next"!==t.where&&this.setReadyState(r.LOADING),"string"==typeof t.where){var i;switch(t.where){case"next":i=this.pref.spreadView?this.opfView.nextSpread:this.opfView.nextPage;break;case"previous":i=this.pref.spreadView?this.opfView.previousSpread:this.opfView.previousPage;break;case"last":i=this.opfView.lastPage;break;case"first":i=this.opfView.firstPage;break;default:return K.d(!0)}i&&(e=function(){return i.call(n.opfView,n.pagePosition,!n.renderAllPages)})}else if("number"==typeof t.epage){var o=t.epage;e=function(){return n.opfView.navigateToEPage(o,n.pagePosition,!n.renderAllPages)}}else{if("string"!=typeof t.url)return K.d(!0);var a=t.url;e=function(){return n.opfView.navigateTo(a,n.pagePosition,!n.renderAllPages)}}var s=K.c("moveTo");return e.call(n.opfView).then(function(t){var e;if(t){n.pagePosition=t.position;var i=K.c("moveTo.showCurrent");e=i.result(),n.showCurrent(t.page,!n.renderAllPages).then(function(){n.reportPosition().thenFinish(i)})}else e=K.d(!0);e.then(function(t){n.readyState===r.LOADING&&n.setReadyState(r.INTERACTIVE),s.finish(t)})}),s.result()},t.prototype.showTOC=function(t){var e=!!t.autohide,n=t.v,i=this.opfView.isTOCVisible(),o=e!=this.opfView.tocAutohide&&"hide"!=n;if(i){if("show"==n&&!o)return K.d(!0)}else if("hide"==n)return K.d(!0);if(i&&"show"!=n)return this.opfView.hideTOC(),K.d(!0);var r=this,a=K.c("showTOC");return this.opfView.showTOC(e).then(function(t){t&&(o&&(t.listeners={}),e&&t.addEventListener("hyperlink",function(){r.opfView.hideTOC()},!1),t.addEventListener("hyperlink",r.hyperlinkListener,!1)),a.finish(!0)}),a.result()},t.prototype.runCommand=function(t){var e=this,n=t.a||"";return K.b("runCommand",function(i){var o=e.actions[n];o?o.call(e,t).then(function(){e.callback({t:"done",a:n}),i.finish(!0)}):(u.b.error("No such action:",n),i.finish(!0))},function(t,e){u.b.error(e,"Error during action:",n),t.finish(!0)})},t.prototype.initEmbed=function(t){var e=go(t),n=null,i=this;K.e(function(){var t=K.c("commandLoop"),o=K.a().getScheduler();return i.hyperlinkListener=function(t){var e=t,n="#"===e.href.charAt(0)||i.packageURL.some(function(t){return e.href.substr(0,t.length)==t});if(n){t.preventDefault();var r={t:"hyperlink",href:e.href,internal:n};o.run(function(){return i.callback(r),K.d(!0)})}},t.loopWithFrame(function(t){if(i.needResize)i.resize().then(function(){t.continueLoop()});else if(i.needRefresh)i.currentPage&&i.showCurrent(i.currentPage).then(function(){t.continueLoop()});else if(e){var o=e;e=null,i.runCommand(o).then(function(){t.continueLoop()})}else{var r=K.c("waitForCommand");n=r.suspend(self),r.result().then(function(){t.continueLoop()})}}).thenFinish(t),t.result()}),i.kick=function(){var t=n;t&&(n=null,t.schedule(!0))},i.sendCommand=function(t){return!e&&(e=go(t),i.kick(),!0)},this.window.adapt_command=i.sendCommand},t}();(ho||(ho={})).FIT_INSIDE_VIEWPORT="fit inside viewport";var fo=function(t){function e(){var n=t.call(this)||this;return n.name="RenderingCanceledError",n.message="Page rendering has been canceled",Object.setPrototypeOf(n,e.prototype),n.stack=(new Error).stack,n}return uo(e,t),e}(Error);function go(t){return"string"==typeof t?b.H(t):t}var mo=i;function vo(t){var e={};return Object.keys(t).forEach(function(n){var i=t[n];switch(n){case"autoResize":e.autoresize=i;break;case"pageBorderWidth":e.pageBorder=i;break;default:e[n]=i}}),e}var yo,bo=function(){function t(t,e){var n;this.settings=t,this.initialized=!1,n=t.debug,a=n,this.viewer_=new po(t.window||window,t.viewportElement,"main",this.dispatcher.bind(this)),this.options={autoResize:!0,fontSize:16,pageBorderWidth:1,renderAllPages:!0,pageViewMode:Eo.AUTO_SPREAD,zoom:1,fitToScreen:!1,defaultPaperSize:void 0},e&&this.setOptions(e),this.eventTarget=new b.c,Object.defineProperty(this,"readyState",{get:function(){return this.viewer_.readyState}})}return t.prototype.setOptions=function(t){var e=Object.assign({a:"configure"},vo(t));this.viewer_.sendCommand(e),Object.assign(this.options,t)},t.prototype.dispatcher=function(t){var e={type:t.t},n=t;Object.keys(n).forEach(function(t){"t"!==t&&(e[t]=n[t])}),this.eventTarget.dispatchEvent(e)},t.prototype.addListener=function(t,e){this.eventTarget.addEventListener(t,e,!1)},t.prototype.removeListener=function(t,e){this.eventTarget.removeEventListener(t,e,!1)},t.prototype.loadDocument=function(t,e,n){t||this.eventTarget.dispatchEvent({type:"error",content:"No URL specified"}),this.loadDocumentOrPublication(t,null,e,n)},t.prototype.loadPublication=function(t,e,n){t||this.eventTarget.dispatchEvent({type:"error",content:"No URL specified"}),this.loadDocumentOrPublication(null,t,e,n)},t.prototype.loadDocumentOrPublication=function(t,e,n,i){var o=n||{};function r(t){return t?t.map(function(t){return{url:t.url||null,text:t.text||null}}):void 0}var a=r(o.authorStyleSheet),s=r(o.userStyleSheet);i&&Object.assign(this.options,i);var l=Object.assign({a:t?"loadXML":"loadPublication",userAgentRootURL:this.settings.userAgentRootURL,url:wo(t)||e,document:o.documentObject,fragment:o.fragment,authorStyleSheet:a,userStyleSheet:s},vo(this.options));this.initialized?this.viewer_.sendCommand(l):(this.initialized=!0,this.viewer_.initEmbed(l))},t.prototype.getCurrentPageProgression=function(){return this.viewer_.getCurrentPageProgression()},t.prototype.resolveNavigation=function(t){switch(t){case yo.LEFT:return this.getCurrentPageProgression()===mo.LTR?yo.PREVIOUS:yo.NEXT;case yo.RIGHT:return this.getCurrentPageProgression()===mo.LTR?yo.NEXT:yo.PREVIOUS;default:return t}},t.prototype.navigateToPage=function(t,e){t===yo.EPAGE?this.viewer_.sendCommand({a:"moveTo",epage:e}):this.viewer_.sendCommand({a:"moveTo",where:this.resolveNavigation(t)})},t.prototype.navigateToInternalUrl=function(t){this.viewer_.sendCommand({a:"moveTo",url:t})},t.prototype.isTOCVisible=function(){return this.viewer_.opfView&&this.viewer_.opfView.opf&&(this.viewer_.opfView.opf.xhtmlToc||this.viewer_.opfView.opf.ncxToc)?!!this.viewer_.opfView.isTOCVisible():null},t.prototype.showTOC=function(t,e){var n=null==t?"toggle":t?"show":"hide";this.viewer_.sendCommand({a:"toc",v:n,autohide:e})},t.prototype.queryZoomFactor=function(t){return this.viewer_.queryZoomFactor(t)},t.prototype.getPageSizes=function(){return this.viewer_.pageSizes},t}();function wo(t){function e(t){return"number"==typeof t?t:null}function n(t){return"string"==typeof t?{url:t,startPage:null,skipPagesBefore:null}:{url:t.url,startPage:e(t.startPage),skipPagesBefore:e(t.skipPagesBefore)}}return Array.isArray(t)?t.map(n):t?[n(t)]:null}!function(t){t.PREVIOUS="previous",t.NEXT="next",t.LEFT="left",t.RIGHT="right",t.FIRST="first",t.LAST="last",t.EPAGE="epage"}(yo||(yo={}));var Eo=oo,So={Viewer:bo,PageViewMode:Eo,ZoomType:ho};m.forceRegisterEndTiming("load_vivliostyle"),e.default={constants:s,plugin:l.c,profile:v,viewer:So}}]).default},"object"==typeof n&&"object"==typeof e?e.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof n?n.vivliostyle=o():i.vivliostyle=o()},{}]},{},[5]);